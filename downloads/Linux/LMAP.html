
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Rekall Memory Forensic Framework</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Rekall Memory Forensic Framework">

    <link href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px;
      }
    </style>
    <link href="/css/rekall.css" rel="stylesheet">
    <link href="/css/asciidoc.css" rel="stylesheet">
    <link href="/css/treeview.css" rel="stylesheet">
    <script src="//code.jquery.com/jquery-1.11.0.min.js"></script>
    <script src="//code.jquery.com/ui/1.10.4/jquery-ui.js"></script>
    <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="//code.jquery.com/ui/1.10.4/themes/smoothness/jquery-ui.css">

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></sc\
ript>
    <![endif]-->
  </head>

  <body>



   <nav class="navbar navbar-inverse navbar-fixed-top"
     role="navigation">
     <div class="container-fluid">
       <div class="navbar-header">
         <a class="navbar-brand" href="#">Rekall Memory Forensic Framework</a>
       </div>

       <div class="navbar-collapse collapse">
         <ul class="nav navbar-nav">

        <li>
          <a class="" href="/index.html">
            Home
          </a>
        </li>

        <li>
          <a class="" href="/about.html">
            About
          </a>
        </li>

        <li>
          <a class="" href="/blog.html">
            Blog
          </a>
        </li>

        <li>
          <a class="" href="/docs.html">
            Documentation
          </a>
        </li>

        <li>
          <a class="" href="/downloads.html">
            Downloads
          </a>
        </li>

        <li>
          <a class="" href="/faq.html">
            FAQ
          </a>
        </li>

         </ul>
         <form class="navbar-form navbar-right" role="search" action="/search.html">
           <div class="form-group">
             <input type="text" name="q" class="form-control" placeholder="Site Search">
           </div>
           <button type="submit" class="btn btn-default">
             <span class="glyphicon glyphicon-search"></span>
           </button>
         </form>
       </div> <!-- navbar-collapse -->
     </div> <!-- container-fluid -->
   </nav>

<div class="container-fluid">
<div class="row">
  <div class="col-md-2">
    
  </div>

  <div class="col-md-8">
    
<div id="header">
</div>
<div id="content">
<div class="paragraph"><p>Author: Johannes Stuettgen (<a href="mailto:johannes.stuettgen@gmail.com">johannes.stuettgen@gmail.com</a>)</p></div>
<div class="sect1">
<h2 id="_summary">Summary:</h2>
<div class="sectionbody">
<div class="paragraph"><p>This is a collection of tools to load a memory acquisition driver without having
to build anything on the target system.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_available_tools">Available Tools:</h2>
<div class="sectionbody">
<div class="olist arabic"><ol class="arabic">
<li>
<p>
lmap:
  This is the end-user tool. It works by injecting a minimal acquisition driver
  into a compatible kernel module on the running system and then loading that.
  It is statically linked and should work on any Linux x86-64 system from kernel
  2.6 to 3.X [1].
</p>
</li>
<li>
<p>
elfrelink:
  The functionality of lmap requires relinking and modification of ELF64 files,
  as well as their relocation and symbol tables. Elfrelink is the library that
  provides this functionality.
</p>
</li>
<li>
<p>
kohook:
  The kohook program allows use of the elfrelink library from the command line.
  It is meant to allow users to script the relinking functionality from the
  shell or even a make-file. Check the build target "hooked_pmem" for an
  example.
</p>
</li>
<li>
<p>
minpmem:
  The minpmem kernel module is a stripped down version of the Linux pmem driver,
  utilizing pte remapping to access physical memory [2].
</p>
</li>
</ol></div>
</div>
</div>
<div class="sect1">
<h2 id="_usage">Usage:</h2>
<div class="sectionbody">
<div class="paragraph"><p>See the README file in <em>release/</em> for details (generated during build).</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_compatibility">Compatibility:</h2>
<div class="sectionbody">
<div class="paragraph"><p>The entire tool suite is only compatible with x86-64 processors and binaries.
32 Bit x86 and ARM support is still in development.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_building_from_source">Building from Source:</h2>
<div class="sectionbody">
<div class="paragraph"><p>The <em>build.sh</em> file automates the build process for your convenience. It
creates a CMake build environment in <em>build/</em> and builds all relevant drivers
and libraries. It then generates the lmap binary and places it in the <em>release/</em>
folder together with the generated documentation.</p></div>
<div class="paragraph"><p>You can also manually create and modify the build environment with CMake.
1. Change to the <em>build/</em> directory and verify it is empty.
  (You can always <em>rm -r *</em> in <em>build/</em> to clean it up.)
2 Use CMake to generate a makefile in the <em>build</em> directory by calling
  <em>cmake ..</em>.
3. Call <em>make</em> and it will build all the binaries and place them into their
  respective subfolders in <em>build/</em>.</p></div>
<div class="paragraph"><p>There are no external dependencies except the kernel headers, gcc, cmake, make
and libc. On Ubuntu systems you need to install the packages <em>build-essential</em>,
<em>cmake</em> and <em>linux-headers-<tt>uname -r</tt></em>.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_important">IMPORTANT:</h2>
<div class="sectionbody">
<div class="paragraph"><p>Never build LMAP with ftrace enabled in your build environment. This will
introduce a symbol dependency on certain ftrace symbols and the resulting
module will not be loadable on non-ftrace kernels.</p></div>
<div class="paragraph"><p>The CMake scripts create a copy of your kernel headers and config in
<em>build/kernel_headers</em>. Any FTRACE options enabled in your original kernel
config will be disabled there and the pmem module will be compiled with this
config to guarantee an FTRACE free build.</p></div>
<div class="paragraph"><p>You can check the symbol dependencies of your built pmem driver using the
<tt>readelf</tt> program:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>~/rekall/tools/linux/lmap$ readelf -s build/modules/pmem_pte.ko

Symbol table '.symtab' contains 29 entries:
   Num:    Value          Size Type    Bind   Vis      Ndx Name
     0: 0000000000000000     0 NOTYPE  LOCAL  DEFAULT  UND
     1: 0000000000000000     0 SECTION LOCAL  DEFAULT    1
     2: 0000000000000000     0 SECTION LOCAL  DEFAULT    7
     3: 0000000000000000     0 SECTION LOCAL  DEFAULT    8
     4: 0000000000000000     0 SECTION LOCAL  DEFAULT   11
     5: 0000000000000000     0 SECTION LOCAL  DEFAULT    3
     6: 0000000000000000     0 SECTION LOCAL  DEFAULT    5
     7: 0000000000000000     0 SECTION LOCAL  DEFAULT    9
     8: 0000000000001020   184 OBJECT  GLOBAL DEFAULT   11 self
     9: 0000000000000008     8 OBJECT  GLOBAL DEFAULT   11 pte_mmap
    10: 0000000000000000    45 FUNC    GLOBAL DEFAULT    1 pmem_llseek
    11: 0000000000000870   160 FUNC    GLOBAL DEFAULT    1 pte_virt_find_phys
    12: 0000000000000b00    73 FUNC    GLOBAL DEFAULT    1 pte_mmap_init
    13: 0000000000000c80     7 FUNC    GLOBAL DEFAULT    1 pte_disable_interrupts
    14: 0000000000000c90     7 FUNC    GLOBAL DEFAULT    1 pte_enable_interrupts
    15: 0000000000000c60    15 FUNC    GLOBAL DEFAULT    1 pte_get_cr4
    16: 0000000000000000    43 FUNC    GLOBAL DEFAULT    5 pmem_cleanup
    17: 0000000000000000     4 OBJECT  GLOBAL DEFAULT   11 major
    18: 0000000000000030   198 FUNC    GLOBAL DEFAULT    1 pmem_read
    19: 0000000000000e40    11 FUNC    GLOBAL DEFAULT    1 pte_mmap_linux_delete
    20: 0000000000000b50    67 FUNC    GLOBAL DEFAULT    1 pte_mmap_cleanup
    21: 0000000000000000     0 NOTYPE  GLOBAL DEFAULT  UND _copy_to_user
    22: 0000000000000c10    66 FUNC    GLOBAL DEFAULT    1 pte_busy_wait
    23: 0000000000000000     0 NOTYPE  GLOBAL DEFAULT  UND __register_chrdev
    24: 0000000000000000    70 FUNC    GLOBAL DEFAULT    3 pmem_init
    25: 0000000000000c70    12 FUNC    GLOBAL DEFAULT    1 pte_set_cr4
    26: 0000000000000cc0   384 FUNC    GLOBAL DEFAULT    1 pte_mmap_linux_new
    27: 0000000000000000   216 OBJECT  GLOBAL DEFAULT    9 pmem_fops
    28: 0000000000000000     0 NOTYPE  GLOBAL DEFAULT  UND __unregister_chrdev</tt></pre>
</div></div>
<div class="paragraph"><p>You should only see these limited external dependecies <tt>_copy_to_user</tt>,
<tt>__register_chrdev</tt> and <tt>__unregister_chrdev</tt>. You should definitely not see the
<tt>__fentry__</tt> above since that if an ftrace dependency. Generally the fewer
dependencies here the more reliable the parasite will be.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_references">References:</h2>
<div class="sectionbody">
<div class="paragraph"><p>[1] Stüttgen, Johannes, and Michael Cohen.
  "Robust Linux Memory Acquisition with Minimal Target Impact"
  Digital Investigation 11 (2014): P112-P119.</p></div>
<div class="paragraph"><p>[2] Stüttgen, Johannes, and Michael Cohen.
  "Anti-forensic resilient memory acquisition"
  Digital Investigation 10 (2013): P105-P115.</p></div>
</div>
</div>
</div>
<div id="footnotes"><hr /></div>
<div id="footer">
<div id="footer-text">
Last updated 2014-07-30 03:10:47 CEST
</div>
</div>
<script src="/js/asciidoc.js"></script>
  </div>
  <div class="col-md-2 sidebar">
    <img src="/img/Rekall.png" class="logo"></img>


  </div>
</div>
</div>
  <script>
   $(".activate_tooltip").tooltip();
  </script>
  </body>
</html>

