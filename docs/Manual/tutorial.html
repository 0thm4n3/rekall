
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Rekall Memory Forensic Framework</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Rekall Memory Forensic Framework">

    <link href="/css/bootstrap.min.css" rel="stylesheet">
    <link href="/css/rekall.css" rel="stylesheet">
    <link href="/css/asciidoc.css" rel="stylesheet">
    <link href="/css/font-awesome.css" rel="stylesheet">
    <script src="//code.jquery.com/jquery-1.11.0.min.js"></script>
    <script src="//code.jquery.com/ui/1.10.4/jquery-ui.js"></script>
    <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="//code.jquery.com/ui/1.10.4/themes/smoothness/jquery-ui.css">

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></sc\
ript>
    <![endif]-->
  </head>

  <body>


  <div class="background">
   <header class="header">
    <div class="navbar navbar-fixed-top navbar-inverse">
     <div class="navbar-inner">
      <div class="container">
       <a class="navbar-brand" href="/"
          style="padding-top: 0px; padding-bottom: 0px;"
          >
          <img src="/img/Rekall-small.png" class="small_logo"></img>
       </a>
       <ul class="nav navbar-nav navbar-collapse collapse">

        <li class="divider-vertical"></li>
        
    <li class="">
     <a href="/index.html">
      Home
     </a>
    </li>
    
        <li class="divider-vertical"></li>
        
    <li class="">
     <a href="/about.html">
      About
     </a>
    </li>
    
        <li class="divider-vertical"></li>
        
    <li class=" dropdown">
     <a class="dropdown-toggle"
      id="dropdownMenuReleases"
      data-toggle="dropdown"
      aria-expanded="true">
    Releases
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuReleases">

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/Releases/releases-1.2.1.html">Version 1.2.1 Col de la Croix.</a></li>

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/Releases/releases-1.3.1.html">Version 1.3.2 Dammastock.</a></li>

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/Releases/releases-1.4.0.html">Version 1.4.0 Etzel.</a></li>

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/Releases/releases-1.5.2.html">Version 1.5.2 Furka..</a></li>

  </ul>
 </li>

        <li class="divider-vertical"></li>
        
    <li class=" dropdown">
     <a class="dropdown-toggle"
      id="dropdownMenuDocumentation"
      data-toggle="dropdown"
      aria-expanded="true">
    Documentation
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuDocumentation">

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/docs/Manual">Rekall User Manual</a></li>

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/docs/Developers">Developer Documentation.</a></li>

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/docs/GUI">Rekall GUI</a></li>

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/docs/MemoryAnalysis.html">Memory Analysis Course</a></li>

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/docs/References">References</a></li>

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/docs/Tools">The Pmem Memory acquisition suite.</a></li>

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/docs/index.html"></a></li>

  </ul>
 </li>

        <li class="divider-vertical"></li>
        
    <li class=" dropdown">
     <a class="dropdown-toggle"
      id="dropdownMenuDiscuss"
      data-toggle="dropdown"
      aria-expanded="true">
    Discuss
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuDiscuss">

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/Discuss/blog.html">The Rekall Blog</a></li>

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/Discuss/github.html">GitHub</a></li>

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/Discuss/index.html"></a></li>

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/Discuss/issue.html">Issue Tracker</a></li>

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/Discuss/mailinglist.html">Mailing List</a></li>

  </ul>
 </li>

        <li class="divider-vertical"></li>
        
    <li class="">
     <a href="/faq.html">
      FAQ
     </a>
    </li>
    
       <li>
        <a href="https://github.com/google/rekall/edit/gh-pages/docs/Manual/tutorial.txt?message=Describe%20your%20change..."
           data-toggle="tooltip"
           data-placement="bottom"
           title="Improve this page"
           class="improve-docs activate_tooltip">
         <i class="glyphicon glyphicon-edit"></i>
        </a>
       </ul>

       <form class="navbar-search col-md-3 docs-search" role="search"
             action="/search.html">
       <span class="glyphicon glyphicon-search search-icon"></span>
       <input type="text" name="q" data-i-search-input="true"
         class="search-query"
         placeholder="Site Search">
       </form>
      </div>
     </div>
    </div>
   </header>

<div class="container-fluid page-background container">
<div class="main">
  <div class="col-md-2">
    
<ul class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix rekall-side-nav">
 <a href="/docs/index.html" class="btn btn-default btn-lg btn-block">
  <span class="glyphicon glyphicon-arrow-left"></span> docs
 </a>

 <a href='/docs/Manual/index.html' class="btn btn-default btn-lg btn-block">
   Manual
 </a>
 <p>

<ul class='nav nav-pills nav-stacked'>
        <li>
          <a href='/docs/Manual/Plugins' class="category-directory-link">
            Plugins
          </a>
        </li>
        
    <li class=''>
      <a href='/docs/Manual/overview.html' class="category-link">
        Rekall Overview
      </a>
    </li>
    
    <li class='active'>
      <a href='/docs/Manual/tutorial.html' class="category-link">
        Rekall Tutorial
      </a>
    </li>
    </ul></ul>
  </div>

  <div class="col-md-10">
    

<nav class="navbar navbar-default plugins" role="navigation">

  <ul class="nav navbar-nav navbar-left">
    <li class="active">
       <a href="/docs/Manual/overview.html">
         <span class="glyphicon glyphicon-arrow-left"></span>
         Rekall Overview
       </a>
    </li>
  </ul>


</nav>


<h1 id="#Rekall Tutorial" class="anchor" >Rekall Tutorial</h1>


<div class="abstract">
<h2></h2>
</div>




<div id="header">
<div id="toc">
  <div id="toctitle">Table of Contents</div>
  <noscript><p><b>JavaScript must be enabled in your browser to display the table of contents.</b></p></noscript>
</div>
</div>
<div id="content">
<div class="paragraph"><p>The main goals of the Rekall framework are to enhance user experience by making
common tasks easier and more intuitive as well as provide a powerful and capable
interface for automation and performing more complex operations.</p></div>
<div class="sect1">
<h2 id="_installation">1. Installation</h2>
<div class="sectionbody">
<div class="paragraph"><p>Rekall is available as a python package installable via the pip package
manager. We support running Rekall under a virtualenv environment (This
guarantees that the exact versions of all dependencies are met).</p></div>
<div class="paragraph"><p>Simply type (for example on Linux):</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ virtualenv  /tmp/MyEnv
New python executable in /tmp/MyEnv/bin/python
Installing setuptools, pip...done.
$ source /tmp/MyEnv/bin/activate
$ pip install rekall</code></pre>
</div></div>
<div class="paragraph"><p>To have all the dependencies installed. You still need to have python and pip
installed first.</p></div>
<div class="paragraph"><p>To be able to run the Rekall GUI, you will need to install the <code>rekall-gui</code>
package:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ pip install rekall-gui</code></pre>
</div></div>
<div class="paragraph"><p>For windows, Rekall is also available as a self contained installer
package. Please check the download page for the most appropriate installer to
use.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_a_rekall_walkthrough">2. A Rekall walkthrough</h2>
<div class="sectionbody">
<div class="paragraph"><p>This section is a quick tour of the Rekall user interface. The program can
accept command line options - which we can learn more about by using the --help
option (Abbreviates to show only the important options):</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ rekal -h
usage: rekal [-p PROFILE] [-v] [-q] [--debug] [--output_style {concise,full}]
             [--logging_level {DEBUG,INFO,WARNING,ERROR,CRITICAL}]
...
             [--version] [-]

Output control:
  -v, --verbose         Set logging to debug level.
  --output_style {concise,full}
                        How much information to show. Default is 'concise'.
  --plugin [PLUGIN [PLUGIN ...]]
                        Load user provided plugin bundle.
  -h, --help            Show help about global paramters.
  --cache {file,memory,timed}
                        Type of cache to use.
  --repository_path [REPOSITORY_PATH [REPOSITORY_PATH ...]]
                        Path to search for profiles. This can take any form
                        supported by the IO Manager (e.g. zip files,
                        directories, URLs etc)
  -f FILENAME, --filename FILENAME
                        The raw image to load.
  --live                Enable live memory analysis.
  --version             Prints the Rekall version and exits.

Interface:
  --pager PAGER         The pager to use when output is larger than a screen
                        full.
  -F {text,json,wide,xls,test,data}, --format {text,json,wide,xls,test,data}
                        The output format to use. Default (text)
  --timezone TIMEZONE   Timezone to output all times (e.g. Australia/Sydney).

Plugin shell options:
  -p PROFILE, --profile PROFILE
                        Name of the profile to load. This is the filename of
                        the profile found in the profiles directory. Profiles
                        are searched in the profile path order.</code></pre>
</div></div>
<div class="paragraph"><p>Some of the most frequently used flags are described below:</p></div>
<div class="dlist"><dl>
<dt class="hdlist1">
--verbose
</dt>
<dd>
<p>
This is a shorthand to setting the logging level to DEBUG. Rekall will produce
debug messages of its operation. You should use this if you want to know more of
what Rekall is doing and also to attach output for bug reports.
</p>
</dd>
<dt class="hdlist1">
--plugin
</dt>
<dd>
<p>
If provided, Rekall loads this python file at start time. The file may define
any plugins, overlays etc which might add additional functionality to Rekall.
</p>
</dd>
<dt class="hdlist1">
--cache
</dt>
<dd>
<p>
Rekall has a caching mechanism to be able to remember important information
about images in between executions. When Rekall starts up it looks in the cache
to see if this particular image has been previously analyzed. This allows Rekall
to load previously derived data from cache instead of recalculating it. There
are 3 cache modes: <code>file</code> is the usual persistant cache (by default in
~/.rekall-cache). <code>memory</code> cache is only present in memory for the life of this
process. <code>timed</code> cache is used for live images which keep changing (it is
essentially a memory cache which is flushed periodically).
</p>
</dd>
<dt class="hdlist1">
--repository_path
</dt>
<dd>
<p>
Rekall normally loads the required profiles from a profile repository. By
default, Rekall will use the rekall public repository. If you do not have
internet access or want to host the repository locally, you can use <code>git clone</code>
to copy the entire repository somewhere and then specify --repository_path to
indicate where profiles should be loaded.
</p>
</dd>
<dt class="hdlist1">
--filename
</dt>
<dd>
<p>
The <em>--filename</em> option is the name of the image to analyse. If you are using
the raw device as provided by the winpmem driver, this will be <em>\\.\pmem</em>
(windows) for example or <em>/proc/kcore</em> (linux). You almost always want to specify
a filename to operate on. A notable exception is when using the <em>--live</em> option
which will set the appropriate filename automatically.
</p>
</dd>
<dt class="hdlist1">
--live
</dt>
<dd>
<p>
The <em>--live</em> option enables live memory analysis. Note that you would usually need to be
running as <code>root</code> to do this. When running on Windows, Rekall will insert the
winpmem driver. On OSX, Rekall will insert the macpmem driver. On Linux, Rekall
will attempt to use the <code>/proc/kcore</code> memory device. When specifying this option
you do not need to specify the --filename option because Rekall will
automatically open the right device. When Rekall exits, the driver will be
unloaded.
</p>
</dd>
<dt class="hdlist1">
--profile
</dt>
<dd>
<p>
The <em>--profile</em> flag specifies the profile to use. The profile is a JSON file
with operating system specific data used to parse the data structures in the
image. The profile used must exactly match the operating system version in the
image. This parameter is usually only needed if you are generating your own
profile (e.g. when analyzing an unusual Linux system). Profiles are normally
autodetected in Rekall and are not usually specified by the user.
</p>
</dd>
<dt class="hdlist1">
--pager
</dt>
<dd>
<p>
The pager can be specified as the program that will be used to inspect the
result of each plugin. Since many plugins produce a great deal of output text, a
pager is often needed. Rekall will write the output to a temporary
file, and launch this program to view it. For example, on windows it is useful
to use notepad to examine the output from each plugin (e.g. <em>--pager notepad</em>). On
linux use <em>--pager less</em> for example, or even <em>--pager "gvim -f"</em>.
</p>
</dd>
<dt class="hdlist1">
--format
</dt>
<dd>
<p>
Rekall output is produced in a number of formats. The default format is <em>text</em>
which consists of tabulated human readable output. The <code>wide</code> format produces
expanded rows (useful for very wide tables with many columns). Often it is
useful to further process the output by machine. In that case the <em>data</em> format
can be used to produce machine parsable JSON data. Rekall can also produce an
Excel compatible spreadsheet (if you have the <code>openpyxl</code> package installed).
</p>
</dd>
<dt class="hdlist1">
--timezone
</dt>
<dd>
<p>
Internally Rekall always works with times in UTC (i.e. without a timezone)
however it is often convenient to output data in a particular timezone. Use this
option to cause output to be produced in that timezone. Note that Rekall always
fully specifies all times so it does not really matter what timezone you use for
output. For example specify <code>--timezone Australia/Sydney</code> will cause timestamps
to be written as <em>2012-10-02 07:39:51+1000</em> instead of <em>2012-10-01 21:39:51Z</em>
</p>
</dd>
</dl></div>
<div class="paragraph"><p>The Rekall architecture is built around <em>plugins</em>. A plugin is an extension with
a name (e.g. pslist) which produces some analysis tasks and generates some
output. There are many Rekall plugins for many operating systems and
configurations. Not all plugins are applicable for all images. For example, a
plugin which is designed to work on Windows 7 will not be active on a Windows XP
image.</p></div>
<div class="paragraph"><p>Similarly we try to keep the names of plugins consistent across operating
systems. For example, the pslist plugin is named the same for all operating
systems, even though it is actually implemented by different code for each OSX.</p></div>
<div class="dlist"><dl>
<dt class="hdlist1">
The interactive shell
</dt>
<dd>
<p>
If the command is followed by a plugin name, the tool will not use the
interactive shell, but rather run the plugin and exit:
</p>
</dd>
</dl></div>
<div class="listingblock">
<div class="title">Example: Running plugin from command line.</div>
<div class="content">
<pre><code>$ rekal -f xp-laptop-2005-06-25.img pslist
Offset (V) Name                    PID   PPID   Thds     Hnds   Sess  Wow64 Start                Exit
---------- -------------------- ------ ------ ------ -------- ------ ------ -------------------- --------------------
0x823c87c0 System                    4      0     61     1140 ------  False -                    -
0x81fdf020 smss.exe                448      4      3       21 ------  False 2005-06-25 16:47:28  -
0x81f5a3b8 csrss.exe               504    448     12      596      0  False 2005-06-25 16:47:30  -
0x81f8eb10 winlogon.exe            528    448     21      508      0  False 2005-06-25 16:47:31  -
0x820e0da0 services.exe            580    528     18      401      0  False 2005-06-25 16:47:31  -
...</code></pre>
</div></div>
<div class="paragraph"><p>Some command plugins use additional options specific to their module. You can
read plugin specific help by specifying the <em>--help</em> option after the name of the
plugin:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ rekal -f xp-laptop-2005-06-25.img pslist --help
usage: rekal pslist [-h] [--kdbg KDBG] [--eprocess EPROCESS [EPROCESS ...]]
                     [--phys_eprocess PHYS_EPROCESS [PHYS_EPROCESS ...]]
                     [--pid PID [PID ...]] [--proc_regex PROC_REGEX]

List processes for windows.

optional arguments:
  -h, --help            show this help message and exit
  --eprocess EPROCESS [EPROCESS ...]
                        Kernel addresses of eprocess structs.
  --phys_eprocess PHYS_EPROCESS [PHYS_EPROCESS ...]
                        Physical addresses of eprocess structs.
  --pid PID [PID ...]   One or more pids of processes to select.
  --proc_regex PROC_REGEX
                        A regex to select a profile by name.</code></pre>
</div></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img alt="Note" src="data:image/png;base64,
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" />
</td>
<td class="content">
<div class="paragraph"><p>Because Rekall does not know which specific plugin will handle a particular
plugin name until it inspects the image, it is essential that the image be
specified with the --filename arg. If this is not specified, Rekall must assume
there is no such plugin (so above <code>rekal pslist -h</code> will not work because Rekall
does not know which version of pslist we are searching for).</p></div>
<div class="paragraph"><p>For this reason we recommend that users use the interactive mode as much as
possible (see below).</p></div>
</td>
</tr></table>
</div>
<div class="paragraph"><p>For example to list all the <strong>svchost</strong> processes, we can apply a regex to process
names:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ rekal -f xp-laptop-2005-06-25.img pslist --proc_regex svc
Offset (V) Name                    PID   PPID   Thds     Hnds   Sess  Wow64 Start                Exit
---------- -------------------- ------ ------ ------ -------- ------ ------ -------------------- --------------------
0x81fa5aa0 svchost.exe             740    580     17      198      0  False 2005-06-25 16:47:32  -
0x81fa8650 svchost.exe             800    580     10      302      0  False 2005-06-25 16:47:33  -
0x81faba78 svchost.exe             840    580     83     1589      0  False 2005-06-25 16:47:33  -
0x81f8dda0 svchost.exe             984    580      6       90      0  False 2005-06-25 16:47:35  -
0x81f6e7e8 svchost.exe            1024    580     15      207      0  False 2005-06-25 16:47:35  -
0x82081da0 svchost.exe            1484    580      6      119      0  False 2005-06-25 16:47:59  -</code></pre>
</div></div>
<div class="paragraph"><p>In order to use the interactive shell, do not specify any plugin to run:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ rekal -f ~/images/win7.elf
 ---------------------------------------------------------------------------
 The Rekall Memory Forensic framework 1.5.0 (Furka).

 "We can remember it for you wholesale!"

 This program is free software; you can redistribute it and/or modify it under
 the terms of the GNU General Public License.

 See http://www.rekall-forensic.com/docs/Manual/tutorial.html to get started.
 ----------------------------------------------------------------------------
 [1] win7.elf 13:54:24&gt;</code></pre>
</div></div>
<div class="paragraph"><p>The interactive shell marks input lines with the name of the image and a time of
day. In order to run a plugin simply type its name and press enter:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>[1] win7.elf 13:54:24&gt; pslist   <img alt="1" src="data:image/png;base64,
iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAABjSURBVHja
VY6xDcAwCAS/pPQaLim9QmajdOk2I2SNrMEIlARIoigU8Cek/4e7zdHaWOYOVwaoA6wOCw05Y7FB
gE0tIWQ+sBcwKM8qoD/wB5wGL8hjfdzWrh01GRp1hInGjDoXwHgsFuzBVLQAAABDdEVYdFNvZnR3
YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8wMSBjcmlzdHlAbXlzdGljLmVzLmR1cG9u
dC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUANThhMDcyZTA3MGRhMjJmNjEzNWNiZDNlNDE0NTQ2
ZjloaiHtAAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30AAAAASUVORK5CYII=" />
---------------------&gt; pslist() <img alt="2" src="data:image/png;base64,
iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAAB7SURBVHja
HY6hFcMwDEQ/NDQsNSwU9Apdo7Cw0CsIBoZmhKzQEQJLDQsFVclHpHu693W429Zr7bu541Pg3kCm
Y0K75u9TEUPhuGgWU4mQDvieEaSQEnsT6zKPeZY0EUNtrHMCXvYUuSUg0PsMjUSvpysUT6OOSil9
izp/VNk1YJ8vf6MAAABDdEVYdFNvZnR3YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8w
MSBjcmlzdHlAbXlzdGljLmVzLmR1cG9udC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUAODBlYWU1
MjljOTRhN2Y0N2RlY2NmYWRhMjhhY2I5ZGblb7ENAAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30A
AAAASUVORK5CYII=" />
Offset (V) Name                    PID   PPID   Thds     Hnds   Sess  Wow64 Start                Exit
---------- -------------------- ------ ------ ------ -------- ------ ------ -------------------- --------------------
0x823c87c0 System                    4      0     61     1140 ------  False -                    -
0x81fdf020 smss.exe                448      4      3       21 ------  False 2005-06-25 16:47:28  -</code></pre>
</div></div>
<div class="colist arabic"><table>
<tr><td><img alt="1" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAABjSURBVHja
VY6xDcAwCAS/pPQaLim9QmajdOk2I2SNrMEIlARIoigU8Cek/4e7zdHaWOYOVwaoA6wOCw05Y7FB
gE0tIWQ+sBcwKM8qoD/wB5wGL8hjfdzWrh01GRp1hInGjDoXwHgsFuzBVLQAAABDdEVYdFNvZnR3
YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8wMSBjcmlzdHlAbXlzdGljLmVzLmR1cG9u
dC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUANThhMDcyZTA3MGRhMjJmNjEzNWNiZDNlNDE0NTQ2
ZjloaiHtAAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30AAAAASUVORK5CYII=" /></td><td>
The user enters the bare word pslist as a command.
</td></tr>
<tr><td><img alt="2" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAAB7SURBVHja
HY6hFcMwDEQ/NDQsNSwU9Apdo7Cw0CsIBoZmhKzQEQJLDQsFVclHpHu693W429Zr7bu541Pg3kCm
Y0K75u9TEUPhuGgWU4mQDvieEaSQEnsT6zKPeZY0EUNtrHMCXvYUuSUg0PsMjUSvpysUT6OOSil9
izp/VNk1YJ8vf6MAAABDdEVYdFNvZnR3YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8w
MSBjcmlzdHlAbXlzdGljLmVzLmR1cG9udC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUAODBlYWU1
MjljOTRhN2Y0N2RlY2NmYWRhMjhhY2I5ZGblb7ENAAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30A
AAAASUVORK5CYII=" /></td><td>
IPython is configured for auto-execution and assumed the user wants to run a
function called pslist()
</td></tr>
</table></div>
<div class="paragraph"><p>Plugins appear as functions in the namespace the shell is running in. IPython
sees the bare word <em>pslist</em> and assumes you mean to run the function
<em>pslist()</em>. Running this function will render the output to the screen.</p></div>
<div class="paragraph"><p>All plugins which are applicable to the current image and profile are also
collected in the variable <em>plugins</em> in the namespace. This means we can use
command line completion to discover all the plugins we could use on the current
image:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>In [3]: plugins.[tab][tab]
plugins.callbacks    plugins.handles      plugins.modules      plugins.raw2dmp
plugins.cmdscan      plugins.hashdump     plugins.mutantscan   plugins.regdump
plugins.connections  plugins.hivedump     plugins.null         plugins.sockets
plugins.connscan     plugins.hivescan     plugins.pas2vas      plugins.svcscan
plugins.consoles     plugins.impscan      plugins.pedump       plugins.symlinkscan</code></pre>
</div></div>
<div class="paragraph"><p>To learn more about each of these plugins we can follow the name of the plugin
with a single question mark:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>[1] win7.elf 13:56:55&gt; plugins.pslist?
file:       /home/scudette/rekall/rekall-core/rekall/plugins/windows/taskmods.py
Plugin:     WinPsList (pslist)
Parameters:
  profile:       Name of the profile to load. This is the filename of the profile found in the profiles directory. Profiles are searched in the profile path order.
  dtb:           The DTB physical address. (type: IntParser)
  eprocess:      Kernel addresses of eprocess structs. (type: ArrayIntParser)
  phys_eprocess: Physical addresses of eprocess structs. (type: ArrayIntParser)
  pid:           One or more pids of processes to select. (type: ArrayIntParser)
  proc_regex:    A regex to select a process by name. (type: RegEx)
  method:        Method to list processes (Default uses all methods). (type: ChoiceArray)
Docstring:  List processes for windows.
Link:       http://www.rekall-forensic.com/epydocs/rekall.plugins.windows.taskmods.WinPsList-class.html</code></pre>
</div></div>
<div class="paragraph"><p>Following the name of the plugin with two question marks lists the source of the
plugin as well:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>[1] win7.elf 13:58:57&gt; plugins.pslist??
file:       /home/scudette/rekall/rekall-core/rekall/plugins/windows/taskmods.py
Plugin:     WinPsList (pslist)
Parameters:
  profile:       Name of the profile to load. This is the filename of the profile found in the profiles directory. Profiles are searched in the profile path order.
  dtb:           The DTB physical address. (type: IntParser)
  eprocess:      Kernel addresses of eprocess structs. (type: ArrayIntParser)
  phys_eprocess: Physical addresses of eprocess structs. (type: ArrayIntParser)
  pid:           One or more pids of processes to select. (type: ArrayIntParser)
  proc_regex:    A regex to select a process by name. (type: RegEx)
  method:        Method to list processes (Default uses all methods). (type: ChoiceArray)
Docstring:  List processes for windows.
Link:       http://www.rekall-forensic.com/epydocs/rekall.plugins.windows.taskmods.WinPsList-class.html
source:
class WinPsList(common.WinProcessFilter):
    """List processes for windows."""

    __name = "pslist"

    eprocess = None

    @classmethod
    def args(cls, metadata):
        super(WinPsList, cls).args(metadata)
        metadata.set_description("""
        Lists the processes by following the _EPROCESS.PsActiveList.

        In the windows operating system, processes are linked together through a
        doubly linked list. This plugin follows the list around, printing
        information about each process.

        To begin, we need to find any element on the list. This can be done by:

        1) Obtaining the _KDDEBUGGER_DATA64.PsActiveProcessHead - debug
           information.

        2) Finding any _EPROCESS in memory (e.g. through psscan) and following
           its list.

        This plugin supports both approaches.
        """)
...</code></pre>
</div></div>
<div class="paragraph"><p>This is useful in order to verify how a particular plugin works. Note that
commandline completion can be used to speed up plugin selection and arguments
for plugins:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>[1] win7.elf 14:01:37&gt; plugins.ps[tab][tab]
plugins.pslist   plugins.psscan   plugins.pstree   plugins.psxview
[1] win7.elf 14:01:37&gt; plugins.pslist [tab][tab]
dtb=            eprocess=       method=         phys_eprocess=  pid=            proc_regex=     profile=
[1] win7.elf 14:01:37&gt; plugins.pslist pr[tab][tab]
proc_regex=  profile=
[1] win7.elf 14:01:37&gt; plugins.pslist proc_regex="svc"</code></pre>
</div></div>
<div class="paragraph"><p>We can now specify the parameters to be passed to the plugin (This is the same
as the command line example above):</p></div>
<div class="listingblock">
<div class="title">Example: Specifying plugin options in the interactive shell.</div>
<div class="content">
<pre><code>[1] win7.elf 14:15:55&gt; pslist proc_regex="svc"
---------------------&gt; pslist(proc_regex="svc")
  _EPROCESS            Name          PID   PPID   Thds    Hnds    Sess  Wow64           Start                     Exit
-------------- -------------------- ----- ------ ------ -------- ------ ------ ------------------------ ------------------------
0xfa80024f85d0 svchost.exe            236    480     19      455      0 False  2012-10-01 14:40:01Z     -
0xfa80023f6770 svchost.exe            608    480     12      352      0 False  2012-10-01 21:39:59Z     -
0xfa8002522b30 svchost.exe            624    480     16      372      0 False  2012-10-01 14:40:01Z     -
0xfa800242a350 svchost.exe            716    480      7      260      0 False  2012-10-01 14:40:00Z     -
0xfa80024589e0 svchost.exe            768    480     23      535      0 False  2012-10-01 14:40:00Z     -</code></pre>
</div></div>
<div class="paragraph"><p>The interactive shell is the most powerful and flexible interface and so the
remainder of this tutorial will focus on it.</p></div>
<div class="paragraph"><p>At the heart of the interactive interface is the session object. The session is
an object which contains information about the current image analysis.</p></div>
<div class="paragraph"><p>It follows that after running the pslist() plugin for the first time, a number
of new objects are stored in the session, and they can be reused the second time
a pslist() is run. At any time we can view the current session by simply
printing it:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>[1] win7.elf 14:09:09&gt; print session
Rekall Memory Forensics session Started on Sun Jan 31 13:56:55 2016.

Config:
{
  __dummy = False
  autodetect = ['nt_index', 'osx', 'pe', 'windows_kernel_file', 'rsds', 'ntfs', 'linux']
  autodetect_build_local = basic
  autodetect_build_local_tracked = set(['win32k', 'ntdll', 'nt', 'tcpip'])
  autodetect_scan_length = 1000000000
...
  timezone = UTC
  verbose = False
  version = False
}

Cache (&lt;FileCache @ /home/scudette/.rekall_cache/sessions/v1.0/sessions/de814bea95020499e782df54aa4b0d5ce4544823&gt;):
{
  default_address_space = WindowsAMD64PagedMemory@0x00187000 (Kernel AS@0x187000)
  dtb = 1601536
  profile = nt/GUID/F8E2A8B5C9B74BF4A6E4A48F180099942
  profile_obj = &lt;AMD64 profile nt/GUID/F8E2A8B5C9B74BF4A6E4A48F180099942 (Nt)&gt;
  pslist_CSRSS = set([275427705947968, 275427703135024, 275427707404384, 275427696227600, 275427701196688, 2754276960 ...
  pslist_Handles = set([275427705361984, 275427703135024, 275427688164144, 275427696227600, 275427701196688, 2754277015 ...
  pslist_PsActiveProcessHead = set([275427705947968, 275427703135024, 275427701697328, 275427707404384, 275427706255504, 2754277015 ...
  pslist_PspCidTable = set([275427706779456, 275427703135024, 275427688164144, 275427696227600, 275427701196688, 2754277015 ...
  pslist_Sessions = set([275427700679504, 275427705361984, 275427705947968, 275427688984672, 275427701697328, 2754276962 ...
}</code></pre>
</div></div>
<div class="paragraph"><p>We can see that the session contains two parts - a configuration part and a
cache. The cache will store files in the specified directory. The session shows
us the content of the cache.</p></div>
<div class="dlist"><dl>
<dt class="hdlist1">
default_address_space
</dt>
<dd>
<p>
The default_address_space is the address space that will be used to instantiate
new objects from the interactive shell by default. When reading memory we must
always use an address space. For example, we can use the physical address space
(i.e. the raw image) or a virtual address space (for example, the kernel or any
process&#8217;s address space). Many plugins rely on the correct default address space
to be used. This is typically known as the <em>Process Context</em> and can be changed
using the <code>cc</code> plugin. By default the default_address_space is set to the
kernel&#8217;s address space.
</p>
</dd>
</dl></div>
<div class="paragraph"><p>For example, suppose we want to examine the process listing from earlier in more
details. The process list has a column with a name <code>_EPROCESS</code> indicating this
is the address of the kernel&#8217;s _EPROCESS struct. Rekall typically lists the
names and addresses of critical kernel data structures in its tabular output.</p></div>
<div class="paragraph"><p>Suppose we now wish to examine the _EPROCESS object reported by the pslist
module above for pid 768. We read the virtual offset of the process as
0xfa80024589e0 in the default address space. We first create an instance of the
_EPROCESS at the reported offset, and assign it to a variable. We then can
examine all the fields of this struct by using command line completion (double
tab):</p></div>
<div class="listingblock">
<div class="content">
<pre><code>[1] win7.elf 14:15:58&gt; task = session.profile._EPROCESS(0xfa80024589e0)
[1] win7.elf 14:19:57&gt; task.
Display all 180 possibilities? (y or n)
task.AccountingFolded              task.Flags                         task.OtherOperationCount           task.SectionBaseAddress            task.cast
...
[1] win7.elf 14:19:57&gt; task.UniqueProcessId
               Out&lt;19 &gt;  [unsigned int:UniqueProcessId]: 0x00000300
[1] win7.elf 14:20:08&gt; task.Ima
task.ImageFileName    task.ImageNotifyDone  task.ImagePathHash
[1] win7.elf 14:20:08&gt; task.ImageFileName
               Out&lt;20 &gt;  [String:ImageFileName]: 'svchost.exe\x00'</code></pre>
</div></div>
<div class="paragraph"><p>When examining a member in a struct (such as <em>_EPROCESS.ImageFileName</em>) we
receive an instance of a rekall <em>BaseObject</em>. This has both a type
(e.g. <em>String</em>) and a name (e.g. <em>ImageFileName</em>) as well as a human readable
representation (e.g. svchost.exe).</p></div>
<div class="paragraph"><p>For example in the task object we have a type of <em>_EPROCESS</em> (which is a
struct), and it exists at offset 0x81fa5aa0:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>In [13]: task
Out[13]: [_EPROCESS _EPROCESS] @ 0x81FA5AA0</code></pre>
</div></div>
<div class="paragraph"><p>To view the entire object we can print it (you can use the shortcut <em>p</em> as a
shortcut for <em>print</em> - either will work).</p></div>
<div class="listingblock">
<div class="content">
<pre><code>[1] win7.elf 14:20:14&gt; p task
---------------------&gt; p(task)
[_EPROCESS _EPROCESS] @ 0xFA80024589E0 (pid=768)
  0x00 Pcb                          [_KPROCESS Pcb] @ 0xFA80024589E0
  0x160 ProcessLock                  [_EX_PUSH_LOCK ProcessLock] @ 0xFA8002458B40
  0x168 CreateTime                    [WinFileTime:CreateTime]: 0x5069AB40 (2012-10-01 14:40:00Z)
  0x170 ExitTime                      [WinFileTime:ExitTime]: 0x00000000 (-)
  0x178 RundownProtect               [_EX_RUNDOWN_REF RundownProtect] @ 0xFA8002458B58
  0x180 UniqueProcessId               [unsigned int:UniqueProcessId]: 0x00000300
  0x188 ActiveProcessLinks           [_LIST_ENTRY ActiveProcessLinks] @ 0xFA8002458B68
  0x198 ProcessQuotaUsage            &lt;Array 2 x unsigned long long @ 0xFA8002458B78&gt;
  0x1A8 ProcessQuotaPeak             &lt;Array 2 x unsigned long long @ 0xFA8002458B88&gt;
  0x1B8 CommitCharge                  [unsigned long long:CommitCharge]: 0x00000D7F
...</code></pre>
</div></div>
<div class="paragraph"><p>This view shows the layout of the _EPROCESS struct which is overlayed on the
offset 0xFA80024589E0. The first column is the relative offset of each member,
followed by the name of each member and a representation of each member. This
representation consists of a type (e.g. _KPROCESS), a name (e.g. Pcb) and a
human readable representation.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_interactive_plugins">3. Interactive plugins</h2>
<div class="sectionbody">
<div class="paragraph"><p>Rekall is more than just a framework for running plugins. It is a complete
interactive environment for memory analysis. Many of the more interesting
features Rekall provides exist as part of the interactive environment.</p></div>
<div class="sect2">
<h3 id="_the_address_resolver">3.1. The Address Resolver.</h3>
<div class="paragraph"><p>A large part of Memory analysis is about emulating the execution environment of
running code. When code is executed it can access and branch into different
addresses in the Virtual Address Space. It is Rekall&#8217;s job to learn what exists
at different addresses. The address space is divided into parts and Rekall can
keep track of what different addresses mean.</p></div>
<div class="paragraph"><p>The Address Resolver is a special component which keeps track of the memroy
layout in the virtual address space. This service can answer:</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
What is found in a specific address?
</p>
</li>
<li>
<p>
What is the address of a given symbol?
</p>
</li>
</ol></div>
<div class="paragraph"><p>In order to efficiently represent memory addresses Rekall uses a specific
notation:</p></div>
<div class="ulist"><ul>
<li>
<p>
First a module name is specified. This can be the name of a kernel module, or dll.
</p>
</li>
<li>
<p>
Then the ! character is used to separate the module name from the symbol name.
</p>
</li>
<li>
<p>
A symbol name is specified in the module.
</p>
</li>
<li>
<p>
Possible offset from the symbol name.
</p>
</li>
</ul></div>
<div class="paragraph"><p>The following are all valid examples:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>[1] win7.elf 16:47:32&gt; dis "nt!MmLoadSystemImage"      <img alt="1" src="data:image/png;base64,
iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAABjSURBVHja
VY6xDcAwCAS/pPQaLim9QmajdOk2I2SNrMEIlARIoigU8Cek/4e7zdHaWOYOVwaoA6wOCw05Y7FB
gE0tIWQ+sBcwKM8qoD/wB5wGL8hjfdzWrh01GRp1hInGjDoXwHgsFuzBVLQAAABDdEVYdFNvZnR3
YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8wMSBjcmlzdHlAbXlzdGljLmVzLmR1cG9u
dC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUANThhMDcyZTA3MGRhMjJmNjEzNWNiZDNlNDE0NTQ2
ZjloaiHtAAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30AAAAASUVORK5CYII=" />
---------------------&gt; dis("nt!MmLoadSystemImage")
Address      Rel             Op Codes                     Instruction                Comment
------- -------------- -------------------- ---------------------------------------- -------
------ nt!MmLoadSystemImage ------: 0xf80002a75060
  0xf80002a75060            0x0 488bc4               mov rax, rsp
  0xf80002a75063            0x3 48895818             mov qword ptr [rax + 0x18], rbx

[1] win7.elf 17:00:20&gt; dis "_ssl!init_ssl"            <img alt="2" src="data:image/png;base64,
iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAAB7SURBVHja
HY6hFcMwDEQ/NDQsNSwU9Apdo7Cw0CsIBoZmhKzQEQJLDQsFVclHpHu693W429Zr7bu541Pg3kCm
Y0K75u9TEUPhuGgWU4mQDvieEaSQEnsT6zKPeZY0EUNtrHMCXvYUuSUg0PsMjUSvpysUT6OOSil9
izp/VNk1YJ8vf6MAAABDdEVYdFNvZnR3YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8w
MSBjcmlzdHlAbXlzdGljLmVzLmR1cG9udC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUAODBlYWU1
MjljOTRhN2Y0N2RlY2NmYWRhMjhhY2I5ZGblb7ENAAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30A
AAAASUVORK5CYII=" />
---------------------&gt; dis("_ssl!init_ssl")
Address      Rel             Op Codes                     Instruction                Comment
------- -------------- -------------------- ---------------------------------------- -------
------ _ssl!init_ssl ------: 0x10001000
      0x10001000            0x0 a1e4310710           mov eax, dword ptr [0x100731e4]  <img alt="3" src="data:image/png;base64,
iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAAB4SURBVHja
JU6rFcNADBM09BqBhl6ltDCwKxQeDOwKB7tGYGCoYaChK6cmlt7TD1W5uap/sgoVBnEXWBTSoOdx
7gpLDOAVorWC0ABdcBPqwZtx8Muf+DPXJpQ96Nu/LSMYl/n17oCOnplTOrpiwW3sUs4ZJmob5/wA
Ubg1Y/zrjUwAAABDdEVYdFNvZnR3YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8wMSBj
cmlzdHlAbXlzdGljLmVzLmR1cG9udC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUAODBiYmRhMjcy
NmRkYWNlOGFiOGEwMWY1OWRlMmViZGII/Q51AAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30AAAAA
SUVORK5CYII=" />     0x1e1ec4c0 _ssl!init_ssl+0x721e4 -&gt; python27!PyType_Type
      0x10001005            0x5 68f5030000           push 0x3f5
      0x1000100a            0xa 6a00                 push 0
      0x1000100c            0xc 68508d0a10           push 0x100a8d50                          _ssl!+0x10d25
      0x10001011           0x11 68f08c0a10           push 0x100a8cf0                          _ssl!+0x10cc5
      0x10001016           0x16 68fc700910           push 0x100970fc                          _ssl!init_ssl+0x960fc
      0x1000101b           0x1b a3dc890a10           mov dword ptr [0x100a89dc], eax          0x1e1ec4c0 _ssl!+0x109b1 -&gt; python27!PyType_Type
      0x10001020           0x20 ff15c0310710         call dword ptr [0x100731c0]              0x1e007152 _ssl!init_ssl+0x721c0 -&gt; python27!Py_InitModule4
      0x10001026           0x26 83c414               add esp, 0x14
      0x10001029           0x29 85c0                 test eax, eax</code></pre>
</div></div>
<div class="colist arabic"><table>
<tr><td><img alt="1" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAABjSURBVHja
VY6xDcAwCAS/pPQaLim9QmajdOk2I2SNrMEIlARIoigU8Cek/4e7zdHaWOYOVwaoA6wOCw05Y7FB
gE0tIWQ+sBcwKM8qoD/wB5wGL8hjfdzWrh01GRp1hInGjDoXwHgsFuzBVLQAAABDdEVYdFNvZnR3
YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8wMSBjcmlzdHlAbXlzdGljLmVzLmR1cG9u
dC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUANThhMDcyZTA3MGRhMjJmNjEzNWNiZDNlNDE0NTQ2
ZjloaiHtAAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30AAAAASUVORK5CYII=" /></td><td>
Disassembly of a kernel function. The "nt" symbol always refers to the kernel.
</td></tr>
<tr><td><img alt="2" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAAB7SURBVHja
HY6hFcMwDEQ/NDQsNSwU9Apdo7Cw0CsIBoZmhKzQEQJLDQsFVclHpHu693W429Zr7bu541Pg3kCm
Y0K75u9TEUPhuGgWU4mQDvieEaSQEnsT6zKPeZY0EUNtrHMCXvYUuSUg0PsMjUSvpysUT6OOSil9
izp/VNk1YJ8vf6MAAABDdEVYdFNvZnR3YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8w
MSBjcmlzdHlAbXlzdGljLmVzLmR1cG9udC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUAODBlYWU1
MjljOTRhN2Y0N2RlY2NmYWRhMjhhY2I5ZGblb7ENAAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30A
AAAASUVORK5CYII=" /></td><td>
Disassembly of a python extension (a dll). (The cc plugin was run to set the
    process context).
</td></tr>
<tr><td><img alt="3" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAAB4SURBVHja
JU6rFcNADBM09BqBhl6ltDCwKxQeDOwKB7tGYGCoYaChK6cmlt7TD1W5uap/sgoVBnEXWBTSoOdx
7gpLDOAVorWC0ABdcBPqwZtx8Muf+DPXJpQ96Nu/LSMYl/n17oCOnplTOrpiwW3sUs4ZJmob5/wA
Ubg1Y/zrjUwAAABDdEVYdFNvZnR3YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8wMSBj
cmlzdHlAbXlzdGljLmVzLmR1cG9udC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUAODBiYmRhMjcy
NmRkYWNlOGFiOGEwMWY1OWRlMmViZGII/Q51AAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30AAAAA
SUVORK5CYII=" /></td><td>
The Address Resolver is also used inside plugins to resolve addresses where
    needed. For example here, We see a move instruction from the constant
    <em>python27!PyType_Type</em> (i.e. the python Type type). This makes it very easy
    to see how assembly code interacts with the rest of the address space.
</td></tr>
</table></div>
<div class="paragraph"><p>Similarly the <em>dump</em> plugin dumps a hexdump of some memory, but it is able to
annotate information about what resides in each address:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>[1] win7.elf 17:08:46&gt; dump "nt!SeTcbPrivilege"
---------------------&gt; dump("nt!SeTcbPrivilege")
    Offset                                   Data                                                Comment
-------------- ----------------------------------------------------------------- ----------------------------------------
0xf80002b590b8 07 00 00 00 00 00 00 00 44 02 01 00 80 f9 ff ff  ........D....... nt!SeTcbPrivilege, nt!NlsOemToUnicodeData
0xf80002b590c8 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00  ................ nt!VfRandomVerifiedDrivers, nt!TunnelMaxEntries, nt!ExpBootLicensingData
0xf80002b590d8 bc 00 00 00 00 10 00 00 00 00 ff 07 80 f8 ff ff  ................ nt!ExpLicensingDescriptorsCount, nt!CmpStashBufferSize, nt!ExpLicensingView
0xf80002b590e8 e8 f5 00 00 a0 f8 ff ff e8 45 7a 05 a0 f8 ff ff  .........Ez..... nt!CmpHiveListHead
0xf80002b590f8 1c 00 00 00 80 f9 ff ff 16 00 00 00 00 00 00 00  ................ nt!NlsAnsiToUnicodeData, nt!SeSystemEnvironmentPrivilege
0xf80002b59108 3f 00 00 00 a4 01 00 00 00 a0 06 00 a0 f8 ff ff  ?............... nt!OemDefaultChar, nt!CmBootAcceptFirstTime, nt!CmpDiskFullWorkerPopupDisplayed, nt!ExpLastTimeZoneBia</code></pre>
</div></div>
<div class="paragraph"><p>Note the names of symbols residing in nearby memory addresses.</p></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_rekall_session">4. The Rekall Session</h2>
<div class="sectionbody">
<div class="paragraph"><p>Rekall uses a <code>Session</code> to encapsulate the analysis of a single image. The
reason Rekall is so fast is because information is cached in the
session. Normally when running from the interactive console, the session
persists in memory and therefore, the cache remains available for subsequent
modules.</p></div>
<div class="paragraph"><p>For example, when running the <code>pslist</code> module, Rekall caches all the known
processes within the image. This cache is then subsequently used by all plugins
which require process listing information (e.g. those plugins which can be
filtered by process id, process name, etc).</p></div>
<div class="paragraph"><p>You can see this by printing the session object:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>win7.elf 22:57:28&gt; print session
Rekall Memory Forensics session Started on Mon Aug 17 14:25:26 2015.

Config:
{
  __dummy = False
  autodetect = ['nt_index', 'osx', 'pe', 'windows_kernel_file', 'rsds', 'ntfs', 'linux']
  autodetect_build_local = basic
  autodetect_build_local_tracked = set(['win32k', 'ntdll', 'nt', 'tcpip'])
  autodetect_scan_length = 1000000000
  autodetect_threshold = 1.0
  base_filename = win7.elf.E01
  buffer_size = 20971520
  cache = file
  cache_dir = .rekall_cache
  colors = auto
  debug = False
  ept = None
  filename = /home/scudette/images/win7.elf
  format = text
  help = False
  logging_level = DEBUG
  max_collector_cost = 4
  name_resolution_strategies = ['Module', 'Symbol', 'Export']
  notebook_dir = /home/scudette
  output_style = concise
  pagefile = []
  plugin = []
  profile_path = ['/home/scudette/projects/rekall-profiles/']
  quiet = False
  repository_path = []
  session_id = 1
  session_list = [&lt;rekall.session.InteractiveSession object at 0x7fbf7a38c550&gt;]
  session_name = Default session
  timezone = UTC
  verbose = True
}

Cache (&lt;FileCache @ /home/scudette/.rekall_cache/sessions/de814bea95020499e782df54aa4b0d5ce4544823&gt;):
{
  default_address_space = WindowsAMD64PagedMemory@0x17851000 (Kernel AS@0x17851000)
  dtb = 1601536
  image_fingerprint = {'tests': [(41740160L, u'7600.win7_rtm.090713-1255\x00'), (41740416L, u'7600.16385.amd64fre.win7_rtm ...
  profile = nt/GUID/F8E2A8B5C9B74BF4A6E4A48F180099942
  profile_obj = &lt;AMD64 profile nt/GUID/F8E2A8B5C9B74BF4A6E4A48F180099942 (Nt)&gt;
  pslist_CSRSS = set([275427705947968, 275427703135024, 275427707404384, 275427696227600, 275427701196688, 2754276960 ...
  pslist_Handles = set([275427705361984, 275427703135024, 275427688164144, 275427696227600, 275427701196688, 2754277015 ...
  pslist_PsActiveProcessHead = set([275427705947968, 275427703135024, 275427701697328, 275427707404384, 275427706255504, 2754277015 ...
  pslist_PspCidTable = set([275427706779456, 275427703135024, 275427688164144, 275427696227600, 275427701196688, 2754277015 ...
  pslist_Sessions = set([275427700679504, 275427705361984, 275427705947968, 275427688984672, 275427701697328, 2754276962 ...
}</code></pre>
</div></div>
<div class="paragraph"><p>As can be been above, the session state can be divided into the configuration,
and the cache. In the above case the cache is persistent (It is a FileCache) and
stores a number of useful objects (e.g. the various output, the process listing
techniques). Note that the cache will only show objects currently loaded
(i.e. have been used in this run). There may be other objects on disk.</p></div>
<div class="paragraph"><p>If Rekall is analysing a volatile image - such as a memory device, the cache
will not be persistent - instead it will be time based, to allow items to expire
promptly from the cache as the live system evolves. For normal images, the cache
may persist so that even if the user quits and restarts Rekall on the same
image, the cache is considered valid. This significatly speeds up operations in
future on the same image.</p></div>
<div class="paragraph"><p>If you suspect something unusual with the cache (e.g. the cache is out of sync
or was created by an earlier version) it should be quite safe to remove all
files from the cache directory. Otherwise you can force the memory cache to be
used by issuing the <code>--cache memory</code> flag.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img alt="Note" src="data:image/png;base64,
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" />
</td>
<td class="content">The on disk version of the session cache is considered an ephemeral cache of the
session data. We do not consider this a stable interchange format. This means
that we do not guarantee compatibility with future versions of Rekall. At best
the cache files can be deleted and recreated at any time. The content of the
file is also not considered user viewable and should not be edited manually.</td>
</tr></table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_automating_rekall">5. Automating Rekall</h2>
<div class="sectionbody">
<div class="paragraph"><p>One of our main design goals is the automation of Rekall so it can be used from
external programs easily, as well as making it easier to write custom scripts.</p></div>
<div class="paragraph"><p>This section demonstrates how to automate the framework, both by embedding it
completely inside another application, as well as simply automating the analysis
from rekall itself.</p></div>
<div class="sect2">
<h3 id="_example_embedding_rekall_in_an_external_python_program">5.1. Example: Embedding Rekall in an external python program</h3>
<div class="paragraph"><p>In this example we will run the pslist plugin on a sample image, capture the
text table into a string and then print this string (In a real example, this
could be served over a HTTP or whatever).</p></div>
<div class="paragraph"><p>The basic sequence of steps is:</p></div>
<div class="dlist"><dl>
<dt class="hdlist1">
Create a session object
</dt>
<dd>
<p>
 All interactions with the rekall library require a session object. The
 session object keeps information related to the same image. There can be any
 number of session objects valid at the same time - no data is global.
</p>
</dd>
<dt class="hdlist1">
Create an appropriate renderer object
</dt>
<dd>
<p>
 All output is rendered using a renderer. A renderer is an abstraction which is
 able to format the output in some way. For example, the TextRenderer outputs
 tables of text, while the JSONRenderer outputs json blobs.
</p>
</dd>
<dt class="hdlist1">
Instantiate the plugin
</dt>
<dd>
<p>
 The plugin is simply an object which can be instantiated using various
 parameters.
</p>
</dd>
<dt class="hdlist1">
Render the plugin into the renderer
</dt>
<dd>
<p>
 Calling the plugin&#8217;s render method with a valid renderer will cause it to
 execute its analysis and output into this renderer.
</p>
</dd>
</dl></div>
<div class="listingblock">
<div class="title">Example of embedding Rekall in a python application</div>
<div class="content"></div></div>
<div class="colist arabic"><table>
<tr><td><img alt="1" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAABjSURBVHja
VY6xDcAwCAS/pPQaLim9QmajdOk2I2SNrMEIlARIoigU8Cek/4e7zdHaWOYOVwaoA6wOCw05Y7FB
gE0tIWQ+sBcwKM8qoD/wB5wGL8hjfdzWrh01GRp1hInGjDoXwHgsFuzBVLQAAABDdEVYdFNvZnR3
YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8wMSBjcmlzdHlAbXlzdGljLmVzLmR1cG9u
dC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUANThhMDcyZTA3MGRhMjJmNjEzNWNiZDNlNDE0NTQ2
ZjloaiHtAAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30AAAAASUVORK5CYII=" /></td><td>
Importing the plugins is required to make rekall load all the default
    plugins. At this point any third party plugins will need to be imported too.
</td></tr>
<tr><td><img alt="2" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAAB7SURBVHja
HY6hFcMwDEQ/NDQsNSwU9Apdo7Cw0CsIBoZmhKzQEQJLDQsFVclHpHu693W429Zr7bu541Pg3kCm
Y0K75u9TEUPhuGgWU4mQDvieEaSQEnsT6zKPeZY0EUNtrHMCXvYUuSUg0PsMjUSvpysUT6OOSil9
izp/VNk1YJ8vf6MAAABDdEVYdFNvZnR3YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8w
MSBjcmlzdHlAbXlzdGljLmVzLmR1cG9udC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUAODBlYWU1
MjljOTRhN2Y0N2RlY2NmYWRhMjhhY2I5ZGblb7ENAAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30A
AAAASUVORK5CYII=" /></td><td>
The session object is created with initial values for some parameters. It is
    critical that Rekall is able to contact the profile repository at runtime,
    therefore you will need to provide a valid repository address here. If you
    plan to use autodetection (you should) here is where the relevant methods
    should be specified.
</td></tr>
<tr><td><img alt="3" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAAB4SURBVHja
JU6rFcNADBM09BqBhl6ltDCwKxQeDOwKB7tGYGCoYaChK6cmlt7TD1W5uap/sgoVBnEXWBTSoOdx
7gpLDOAVorWC0ABdcBPqwZtx8Muf+DPXJpQ96Nu/LSMYl/n17oCOnplTOrpiwW3sUs4ZJmob5/wA
Ubg1Y/zrjUwAAABDdEVYdFNvZnR3YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8wMSBj
cmlzdHlAbXlzdGljLmVzLmR1cG9udC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUAODBiYmRhMjcy
NmRkYWNlOGFiOGEwMWY1OWRlMmViZGII/Q51AAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30AAAAA
SUVORK5CYII=" /></td><td>
Rekall will only scan some of the image for RSDS signatures, setting this
    limit ensures that we dont waste too much time trying to load an image we
    cant.
</td></tr>
<tr><td><img alt="4" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAABzSURBVHja
HY0hEoUwEEMjkZVYZGVlr1CJxCKRXKPyy28reyVsZeXKsCFi573ZzAQk+x5jaQ6gFQAxIA8XceEN
ZEN3DkOCH/TobUoSVuAYwSSLyzbvaHWVFJxUmmp+PF+twrLkuXzLwPmZ8+OjtH8KS6pGvuoGNo5b
6rzDAAAAQ3RFWHRTb2Z0d2FyZQBAKCMpSW1hZ2VNYWdpY2sgNC4yLjggOTkvMDgvMDEgY3Jpc3R5
QG15c3RpYy5lcy5kdXBvbnQuY29tkbohuAAAACp0RVh0U2lnbmF0dXJlADlmODJmY2FjOWUwMzlj
YmRiNzIzODBhNDU5MTMyNGY1gLv4dgAAAA50RVh0UGFnZQAxMngxMiswKzCEbbt9AAAAAElFTkSu
QmCC" /></td><td>
The plugin is instantiated from the session object. When a plugin instance
    is printed, it renders its output to the console by default.
</td></tr>
</table></div>
<div class="paragraph"><p>Alternatively one can manually render the plugin output. Suppose you want to
capture the output of the plugin into a string for further processing:</p></div>
<div class="listingblock">
<div class="content"></div></div>
<div class="colist arabic"><table>
<tr><td><img alt="1" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAABjSURBVHja
VY6xDcAwCAS/pPQaLim9QmajdOk2I2SNrMEIlARIoigU8Cek/4e7zdHaWOYOVwaoA6wOCw05Y7FB
gE0tIWQ+sBcwKM8qoD/wB5wGL8hjfdzWrh01GRp1hInGjDoXwHgsFuzBVLQAAABDdEVYdFNvZnR3
YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8wMSBjcmlzdHlAbXlzdGljLmVzLmR1cG9u
dC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUANThhMDcyZTA3MGRhMjJmNjEzNWNiZDNlNDE0NTQ2
ZjloaiHtAAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30AAAAASUVORK5CYII=" /></td><td>
Create a custom renderer using any of the renderers provided by Rekall
    (e.g. TextRenderer, DataExportRenderer).
</td></tr>
<tr><td><img alt="2" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAAB7SURBVHja
HY6hFcMwDEQ/NDQsNSwU9Apdo7Cw0CsIBoZmhKzQEQJLDQsFVclHpHu693W429Zr7bu541Pg3kCm
Y0K75u9TEUPhuGgWU4mQDvieEaSQEnsT6zKPeZY0EUNtrHMCXvYUuSUg0PsMjUSvpysUT6OOSil9
izp/VNk1YJ8vf6MAAABDdEVYdFNvZnR3YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8w
MSBjcmlzdHlAbXlzdGljLmVzLmR1cG9udC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUAODBlYWU1
MjljOTRhN2Y0N2RlY2NmYWRhMjhhY2I5ZGblb7ENAAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30A
AAAASUVORK5CYII=" /></td><td>
Start the renderer to receive new input.
</td></tr>
<tr><td><img alt="3" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAAB4SURBVHja
JU6rFcNADBM09BqBhl6ltDCwKxQeDOwKB7tGYGCoYaChK6cmlt7TD1W5uap/sgoVBnEXWBTSoOdx
7gpLDOAVorWC0ABdcBPqwZtx8Muf+DPXJpQ96Nu/LSMYl/n17oCOnplTOrpiwW3sUs4ZJmob5/wA
Ubg1Y/zrjUwAAABDdEVYdFNvZnR3YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8wMSBj
cmlzdHlAbXlzdGljLmVzLmR1cG9udC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUAODBiYmRhMjcy
NmRkYWNlOGFiOGEwMWY1OWRlMmViZGII/Q51AAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30AAAAA
SUVORK5CYII=" /></td><td>
Instantiate the plugin object. This does not actually run the plugin but
    will verify all the arguments are correct. If the plugin is not active for
    this profile (i.e. it is not supported for this image) this will return a
    NoneObject which can be compared to None.
</td></tr>
<tr><td><img alt="4" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAABzSURBVHja
HY0hEoUwEEMjkZVYZGVlr1CJxCKRXKPyy28reyVsZeXKsCFi573ZzAQk+x5jaQ6gFQAxIA8XceEN
ZEN3DkOCH/TobUoSVuAYwSSLyzbvaHWVFJxUmmp+PF+twrLkuXzLwPmZ8+OjtH8KS6pGvuoGNo5b
6rzDAAAAQ3RFWHRTb2Z0d2FyZQBAKCMpSW1hZ2VNYWdpY2sgNC4yLjggOTkvMDgvMDEgY3Jpc3R5
QG15c3RpYy5lcy5kdXBvbnQuY29tkbohuAAAACp0RVh0U2lnbmF0dXJlADlmODJmY2FjOWUwMzlj
YmRiNzIzODBhNDU5MTMyNGY1gLv4dgAAAA50RVh0UGFnZQAxMngxMiswKzCEbbt9AAAAAElFTkSu
QmCC" /></td><td>
Rendering the plugin into the renderer will cause the renderer to collect
    output into its file like object. In this case we use a StringIO (memory
    stream) to collect output. Finally we can access the complete content as a
    string.
</td></tr>
</table></div>
</div>
<div class="sect2">
<h3 id="_receiving_structured_output">5.2. Receiving structured output.</h3>
<div class="paragraph"><p>Most plugins will now return structured output. You can see exactly what will be
returned using the <code>describe</code> plugin (See
<a href="http://rekall-forensic.blogspot.ch/2016/07/searching-memory-with-rekall.html">http://rekall-forensic.blogspot.ch/2016/07/searching-memory-with-rekall.html</a> for
details).</p></div>
<div class="paragraph"><p>In order to receive structured output you do not need a renderer, simply call the <code>collect()</code> method.</p></div>
<div class="listingblock">
<div class="content"></div></div>
<div class="colist arabic"><table>
<tr><td><img alt="1" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAABjSURBVHja
VY6xDcAwCAS/pPQaLim9QmajdOk2I2SNrMEIlARIoigU8Cek/4e7zdHaWOYOVwaoA6wOCw05Y7FB
gE0tIWQ+sBcwKM8qoD/wB5wGL8hjfdzWrh01GRp1hInGjDoXwHgsFuzBVLQAAABDdEVYdFNvZnR3
YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8wMSBjcmlzdHlAbXlzdGljLmVzLmR1cG9u
dC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUANThhMDcyZTA3MGRhMjJmNjEzNWNiZDNlNDE0NTQ2
ZjloaiHtAAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30AAAAASUVORK5CYII=" /></td><td>
Instantiating the plugin object allows us to call its collect() method. This
    returns a dict or a tuple of its results.
</td></tr>
<tr><td><img alt="2" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAAB7SURBVHja
HY6hFcMwDEQ/NDQsNSwU9Apdo7Cw0CsIBoZmhKzQEQJLDQsFVclHpHu693W429Zr7bu541Pg3kCm
Y0K75u9TEUPhuGgWU4mQDvieEaSQEnsT6zKPeZY0EUNtrHMCXvYUuSUg0PsMjUSvpysUT6OOSil9
izp/VNk1YJ8vf6MAAABDdEVYdFNvZnR3YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8w
MSBjcmlzdHlAbXlzdGljLmVzLmR1cG9udC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUAODBlYWU1
MjljOTRhN2Y0N2RlY2NmYWRhMjhhY2I5ZGblb7ENAAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30A
AAAASUVORK5CYII=" /></td><td>
It is possible to use the results directly now by printing it, storing to
    file etc.
</td></tr>
</table></div>
</div>
<div class="sect2">
<h3 id="_example_using_a_custom_address_space">5.3. Example: Using a custom address space</h3>
<div class="paragraph"><p>Sometimes the image files to be analyzed are not directly written to disk. For
example, they may be available as a python file-like object. In this case we
want to provide this "virtual image" to Rekall for analysis, but wrapping it in
a <em>FDAddressSpace</em>.</p></div>
<div class="paragraph"><p>For example consider the following code which provides the image as a python
file-like object (For this example we directly open the file).</p></div>
<div class="listingblock">
<div class="title">Example of embedding Rekall in a python application</div>
<div class="content"></div></div>
<div class="colist arabic"><table>
<tr><td><img alt="1" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAABjSURBVHja
VY6xDcAwCAS/pPQaLim9QmajdOk2I2SNrMEIlARIoigU8Cek/4e7zdHaWOYOVwaoA6wOCw05Y7FB
gE0tIWQ+sBcwKM8qoD/wB5wGL8hjfdzWrh01GRp1hInGjDoXwHgsFuzBVLQAAABDdEVYdFNvZnR3
YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8wMSBjcmlzdHlAbXlzdGljLmVzLmR1cG9u
dC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUANThhMDcyZTA3MGRhMjJmNjEzNWNiZDNlNDE0NTQ2
ZjloaiHtAAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30AAAAASUVORK5CYII=" /></td><td>
We create a session but do not provide a filename.
</td></tr>
<tr><td><img alt="2" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAAB7SURBVHja
HY6hFcMwDEQ/NDQsNSwU9Apdo7Cw0CsIBoZmhKzQEQJLDQsFVclHpHu693W429Zr7bu541Pg3kCm
Y0K75u9TEUPhuGgWU4mQDvieEaSQEnsT6zKPeZY0EUNtrHMCXvYUuSUg0PsMjUSvpysUT6OOSil9
izp/VNk1YJ8vf6MAAABDdEVYdFNvZnR3YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8w
MSBjcmlzdHlAbXlzdGljLmVzLmR1cG9udC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUAODBlYWU1
MjljOTRhN2Y0N2RlY2NmYWRhMjhhY2I5ZGblb7ENAAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30A
AAAASUVORK5CYII=" /></td><td>
We can directly add the FDAddressSpace() as the physical address space to
    the session.
</td></tr>
</table></div>
</div>
<div class="sect2">
<h3 id="_example_automating_the_rekall_console">5.4. Example: Automating the Rekall Console</h3>
<div class="paragraph"><p>Much of the time the Rekall interactive interface is sufficient for most
analysis. Sometimes, however, we need to automate some of this
analysis.</p></div>
<div class="paragraph"><p>In this section, we see how interactive scripts can be written to automate
Rekall. This is similar to Embedding in an external program, except that the
script runs within the interactive session. When the script completes, the
interactive session resumes.</p></div>
<div class="paragraph"><p>For this example, we search for all processes with a name of <em>python.exe</em> and
dump them into the temporary directory with their timestamps. This could be used
for example to dump periodic snapshots of a process from a live system.</p></div>
<div class="paragraph"><p>First we create the following python file named <em>dumper.py</em>:</p></div>
<div class="listingblock">
<div class="title">Example interactive python script.</div>
<div class="content"></div></div>
<div class="paragraph"><p>Now we run this file directly from the interactive shell.</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ rekal -f \\.\pmem
...

In [1]: run -i dumper.py  <img alt="1" src="data:image/png;base64,
iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAABjSURBVHja
VY6xDcAwCAS/pPQaLim9QmajdOk2I2SNrMEIlARIoigU8Cek/4e7zdHaWOYOVwaoA6wOCw05Y7FB
gE0tIWQ+sBcwKM8qoD/wB5wGL8hjfdzWrh01GRp1hInGjDoXwHgsFuzBVLQAAABDdEVYdFNvZnR3
YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8wMSBjcmlzdHlAbXlzdGljLmVzLmR1cG9u
dC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUANThhMDcyZTA3MGRhMjJmNjEzNWNiZDNlNDE0NTQ2
ZjloaiHtAAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30AAAAASUVORK5CYII=" />
In [2]: ls -l

total 300
-rw-r----- 1 user group  57344 2012-08-27 00:28 1346020082.17-4012.exe
....</code></pre>
</div></div>
<div class="colist arabic"><table>
<tr><td><img alt="1" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAABjSURBVHja
VY6xDcAwCAS/pPQaLim9QmajdOk2I2SNrMEIlARIoigU8Cek/4e7zdHaWOYOVwaoA6wOCw05Y7FB
gE0tIWQ+sBcwKM8qoD/wB5wGL8hjfdzWrh01GRp1hInGjDoXwHgsFuzBVLQAAABDdEVYdFNvZnR3
YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8wMSBjcmlzdHlAbXlzdGljLmVzLmR1cG9u
dC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUANThhMDcyZTA3MGRhMjJmNjEzNWNiZDNlNDE0NTQ2
ZjloaiHtAAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30AAAAASUVORK5CYII=" /></td><td>
Running the script with the -i flag ensures that the script receives the
same namespace as the interactive shell. This means that it can use the same
session and we can see all variables defined by the script.
</td></tr>
</table></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img alt="Important" src="data:image/png;base64,
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
EQn3XQAAAABJRU5ErkJggg==" />
</td>
<td class="content">
<div class="paragraph"><p>In the interactive shell IPython will automatically attempt to execute plugins
without requiring the brackets to be present - this is merely a usability
feature. In reality all input is interpreted as python code.</p></div>
<div class="paragraph"><p>This means that while in the interactive shell it is sufficient to just type
<em>pslist</em>, when running an external script, you will need to explicitly call the
function as <em>pslist()</em>.</p></div>
</td>
</tr></table>
</div>
</div>
<div class="sect2">
<h3 id="_extending_rekall">5.5. Extending Rekall</h3>
<div class="paragraph"><p>Extending Rekall is most useful when you want to add additional functionality
which should be reused by other people, or contributed to the core. If you are
just interested in automating a very specific analysis, an interactive shell
script is sufficient usually, and is simple to write.</p></div>
<div class="paragraph"><p>There are a number of different components which can be extended these fall
roughly into these categories:</p></div>
<div class="dlist"><dl>
<dt class="hdlist1">
Address Spaces
</dt>
<dd>
<p>
  Address spaces are the way Rekall implements image reading. Most of the
  time you will want to implement some kind of support for new image files.
</p>
</dd>
<dt class="hdlist1">
Renderers
</dt>
<dd>
<p>
  All output in Rekall is performed through an abstract renderer. For
  specialist output (e.g. HTML or XML), a new renderer should be written. See
  <em>BaseRenderer</em> and <em>TextRenderer</em> as possible examples.
</p>
</dd>
<dt class="hdlist1">
Profiles and specialized parsers
</dt>
<dd>
<p>
  Profiles are used by Rekall to parse data structures. Sometimes plugin
  authors wish to extend the parsing system by providing definitions for new
  types, or additional behaviors via new object classes.
</p>
</dd>
<dt class="hdlist1">
Plugins
</dt>
<dd>
<p>
  A plugin is a reusable component which is available in the interactive
  session. A plugin should only be written if it can be widely useful and/or can
  be reused by other plugins. It is normally not necessary to write a plugin to
  automate Rekall (e.g. search for a specific malware).
</p>
</dd>
</dl></div>
</div>
</div>
</div>
</div>
<div id="footnotes"><hr /></div>
<div id="footer">
<div id="footer-text">
Last updated 2016-11-08 10:45:48 PST
</div>
</div>
<script src="/js/asciidoc.js"></script>

<p>

<nav class="navbar navbar-default plugins" role="navigation">

  <ul class="nav navbar-nav navbar-left">
    <li class="active">
       <a href="/docs/Manual/overview.html">
         <span class="glyphicon glyphicon-arrow-left"></span>
         Rekall Overview
       </a>
    </li>
  </ul>


</nav>


  </div>
</div>
</div>
  <div class="footer">
    <div class="container">
      <p class="text-muted">
        &copy; 2015 Google Inc.
        Rekall is licensed under the The GPL License.
        Pmem is licensed under the Apache license.
        <a href="#" class="pull-right text-muted">Back to top</a>
      </p>
    </div>
  </div>

  <script>
   $(".activate_tooltip").tooltip();
   $("body").scrollspy({
     target: ".bs-docs-sidebar",
     offset: 40
   });
  </script>
  </div>
 </body>
</html>

