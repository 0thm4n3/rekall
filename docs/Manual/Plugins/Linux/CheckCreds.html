
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Rekall Memory Forensic Framework</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Rekall Memory Forensic Framework">

    <link href="/css/bootstrap.min.css" rel="stylesheet">
    <link href="/css/rekall.css" rel="stylesheet">
    <link href="/css/asciidoc.css" rel="stylesheet">
    <link href="/css/font-awesome.css" rel="stylesheet">
    <script src="//code.jquery.com/jquery-1.11.0.min.js"></script>
    <script src="//code.jquery.com/ui/1.10.4/jquery-ui.js"></script>
    <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="//code.jquery.com/ui/1.10.4/themes/smoothness/jquery-ui.css">

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></sc\
ript>
    <![endif]-->
  </head>

  <body>


  <div class="background">
   <header class="header">
    <div class="navbar navbar-fixed-top navbar-inverse">
     <div class="navbar-inner">
      <div class="container">
       <a class="navbar-brand" href="/"
          style="padding-top: 0px; padding-bottom: 0px;"
          >
          <img src="/img/Rekall-small.png" class="small_logo"></img>
       </a>
       <ul class="nav navbar-nav navbar-collapse collapse">

        <li class="divider-vertical"></li>
        
    <li class="">
     <a href="/index.html">
      Home
     </a>
    </li>
    
        <li class="divider-vertical"></li>
        
    <li class="">
     <a href="/about.html">
      About
     </a>
    </li>
    
        <li class="divider-vertical"></li>
        
    <li class=" dropdown">
     <a class="dropdown-toggle"
      id="dropdownMenuReleases"
      data-toggle="dropdown"
      aria-expanded="true">
    Releases
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuReleases">

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/Releases/releases-1.2.1.html">Version 1.2.1 Col de la Croix.</a></li>

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/Releases/releases-1.3.1.html">Version 1.3.1 Dammastock.</a></li>

  </ul>
 </li>

        <li class="divider-vertical"></li>
        
    <li class=" dropdown">
     <a class="dropdown-toggle"
      id="dropdownMenuDocumentation"
      data-toggle="dropdown"
      aria-expanded="true">
    Documentation
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuDocumentation">

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/docs/Manual">Rekall User Manual</a></li>

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/docs/Developers">Developer Documentation.</a></li>

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/docs/GUI">Rekall GUI</a></li>

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/docs/MemoryAnalysis.html">Memory Analysis Course</a></li>

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/docs/References">References</a></li>

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/docs/Tools">The Pmem Memory acquisition suite.</a></li>

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/docs/index.html"></a></li>

  </ul>
 </li>

        <li class="divider-vertical"></li>
        
    <li class=" dropdown">
     <a class="dropdown-toggle"
      id="dropdownMenuDiscuss"
      data-toggle="dropdown"
      aria-expanded="true">
    Discuss
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuDiscuss">

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/Discuss/blog.html">The Rekall Blog</a></li>

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/Discuss/github.html">GitHub</a></li>

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/Discuss/index.html"></a></li>

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/Discuss/issue.html">Issue Tracker</a></li>

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/Discuss/mailinglist.html">Mailing List</a></li>

  </ul>
 </li>

        <li class="divider-vertical"></li>
        
    <li class="">
     <a href="/faq.html">
      FAQ
     </a>
    </li>
    
       <li>
        <a href="https://github.com/google/rekall/edit/gh-pages/docs/Manual/Plugins/Linux/CheckCreds.md?message=Describe%20your%20change..."
           data-toggle="tooltip"
           data-placement="bottom"
           title="Improve this page"
           class="improve-docs activate_tooltip">
         <i class="glyphicon glyphicon-edit"></i>
        </a>
       </ul>

       <form class="navbar-search col-md-3 docs-search" role="search"
             action="/search.html">
       <span class="glyphicon glyphicon-search search-icon"></span>
       <input type="text" name="q" data-i-search-input="true"
         class="search-query"
         placeholder="Site Search">
       </form>
      </div>
     </div>
    </div>
   </header>

<div class="container-fluid page-background container">
<div class="main">
  <div class="col-md-2">
    
 <a href="/docs/Manual/Plugins/index.html" class="btn btn-default btn-lg btn-block">
  <span class="glyphicon glyphicon-arrow-left"></span> Plugins
 </a>

 <a href='/docs/Manual/Plugins/Linux/index.html' class="btn btn-default btn-lg btn-block">
   Linux
 </a>
 <p>

 <ul class='nav nav-pills nav-stacked'><ul class='nav nav-pills nav-stacked'><li>
          <a href='/docs/Manual/Plugins/Linux/LinuxAddressResolver.html' class="category-link">
            address_resolver
          </a>
        </li>
        <li>
          <a href='/docs/Manual/Plugins/Linux/Arp.html' class="category-link">
            arp
          </a>
        </li>
        <li>
          <a href='/docs/Manual/Plugins/Linux/Banner.html' class="category-link">
            banner
          </a>
        </li>
        <li>
          <a href='/docs/Manual/Plugins/Linux/BashHistory.html' class="category-link">
            bash
          </a>
        </li>
        <li>
          <a href='/docs/Manual/Plugins/Linux/CheckAFInfo.html' class="category-link">
            check_afinfo
          </a>
        </li>
        <li class='active'>
          <a href='/docs/Manual/Plugins/Linux/CheckCreds.html' class="category-link">
            check_creds
          </a>
        </li>
        <li>
          <a href='/docs/Manual/Plugins/Linux/CheckIdt.html' class="category-link">
            check_idt
          </a>
        </li>
        <li>
          <a href='/docs/Manual/Plugins/Linux/CheckModules.html' class="category-link">
            check_modules
          </a>
        </li>
        <li>
          <a href='/docs/Manual/Plugins/Linux/CheckProcFops.html' class="category-link">
            check_proc_fops
          </a>
        </li>
        <li>
          <a href='/docs/Manual/Plugins/Linux/CheckSyscall.html' class="category-link">
            check_syscall
          </a>
        </li>
        <li>
          <a href='/docs/Manual/Plugins/Linux/CheckTaskFops.html' class="category-link">
            check_task_fops
          </a>
        </li>
        <li>
          <a href='/docs/Manual/Plugins/Linux/CheckTTY.html' class="category-link">
            check_ttys
          </a>
        </li>
        <li>
          <a href='/docs/Manual/Plugins/Linux/CpuInfo.html' class="category-link">
            cpuinfo
          </a>
        </li>
        <li>
          <a href='/docs/Manual/Plugins/Linux/LinuxDmesg.html' class="category-link">
            dmesg
          </a>
        </li>
        <li>
          <a href='/docs/Manual/Plugins/Linux/LinuxFindDTB.html' class="category-link">
            find_dtb
          </a>
        </li>
        <li>
          <a href='/docs/Manual/Plugins/Linux/LinuxFindKASLR.html' class="category-link">
            find_kaslr
          </a>
        </li>
        <li>
          <a href='/docs/Manual/Plugins/Linux/Hostname.html' class="category-link">
            hostname
          </a>
        </li>
        <li>
          <a href='/docs/Manual/Plugins/Linux/Ifconfig.html' class="category-link">
            ifconfig
          </a>
        </li>
        <li>
          <a href='/docs/Manual/Plugins/Linux/IOmem.html' class="category-link">
            iomem
          </a>
        </li>
        <li>
          <a href='/docs/Manual/Plugins/Linux/Lsmod.html' class="category-link">
            lsmod
          </a>
        </li>
        <li>
          <a href='/docs/Manual/Plugins/Linux/Lsof.html' class="category-link">
            lsof
          </a>
        </li>
        <li>
          <a href='/docs/Manual/Plugins/Linux/ProcMaps.html' class="category-link">
            maps
          </a>
        </li>
        <li>
          <a href='/docs/Manual/Plugins/Linux/Mcat.html' class="category-link">
            mcat
          </a>
        </li>
        <li>
          <a href='/docs/Manual/Plugins/Linux/LinMemDump.html' class="category-link">
            memdump
          </a>
        </li>
        <li>
          <a href='/docs/Manual/Plugins/Linux/LinMemMap.html' class="category-link">
            memmap
          </a>
        </li>
        <li>
          <a href='/docs/Manual/Plugins/Linux/Mfind.html' class="category-link">
            mfind
          </a>
        </li>
        <li>
          <a href='/docs/Manual/Plugins/Linux/Mls.html' class="category-link">
            mls
          </a>
        </li>
        <li>
          <a href='/docs/Manual/Plugins/Linux/Moddump.html' class="category-link">
            moddump
          </a>
        </li>
        <li>
          <a href='/docs/Manual/Plugins/Linux/Mount.html' class="category-link">
            mount
          </a>
        </li>
        <li>
          <a href='/docs/Manual/Plugins/Linux/NotifierChainPlugin.html' class="category-link">
            notifier_chains
          </a>
        </li>
        <li>
          <a href='/docs/Manual/Plugins/Linux/LinPas2Vas.html' class="category-link">
            pas2vas
          </a>
        </li>
        <li>
          <a href='/docs/Manual/Plugins/Linux/PidHashTable.html' class="category-link">
            pidhashtable
          </a>
        </li>
        <li>
          <a href='/docs/Manual/Plugins/Linux/PacketQueues.html' class="category-link">
            pkt_queues
          </a>
        </li>
        <li>
          <a href='/docs/Manual/Plugins/Linux/PSAux.html' class="category-link">
            psaux
          </a>
        </li>
        <li>
          <a href='/docs/Manual/Plugins/Linux/LinuxPsList.html' class="category-link">
            pslist
          </a>
        </li>
        <li>
          <a href='/docs/Manual/Plugins/Linux/LinPSTree.html' class="category-link">
            pstree
          </a>
        </li>
        <li>
          <a href='/docs/Manual/Plugins/Linux/LinuxPsxView.html' class="category-link">
            psxview
          </a>
        </li>
        <li>
          <a href='/docs/Manual/Plugins/Linux/LinVadDump.html' class="category-link">
            vaddump
          </a>
        </li>
        <li>
          <a href='/docs/Manual/Plugins/Linux/LinYaraScan.html' class="category-link">
            yarascan
          </a>
        </li>
        </ul></ul>


  </div>

  <div class="col-md-10">
    

<nav class="navbar navbar-default plugins" role="navigation">

  <ul class="nav navbar-nav navbar-left">
    <li class="active">
       <a href="/docs/Manual/Plugins/Linux/CheckAFInfo.html">
         <span class="glyphicon glyphicon-arrow-left"></span>
         check_afinfo
       </a>
    </li>
  </ul>


  <ul class="nav navbar-nav navbar-right">
    <li class="active">
       <a href="/docs/Manual/Plugins/Linux/CheckIdt.html">
          check_idt
          <span class="glyphicon glyphicon-arrow-right"></span>
       </a>
    </li>
  </ul>

</nav>


<h1>check_creds</h1>

<div class="abstract">
<p>Checks if any processes are sharing credential structures</p>
</div>




<a href="/epydocs/rekall.plugins.linux.check_creds.CheckCreds-class.html">View Source</a>


<p>In order for rootkits to elevate the privileges of a given process, they need
to alter the current effective identifier of a process. Before kernel 2.6, this
was done by setting a couple of integers in the process task to the desired ID.</p>
<p>After 2.6, credentials are handled internally via the <code>task_struct-&gt;cred</code>
member. Likely due to laziness or a poor attempt at remaining stealth, some
rootkits simply reuse the <code>cred</code> member of tasks that have the desired
credentials (most often ID 0: <code>root</code>).</p>
<p>This plugin reports the location of the <code>cred</code> member of each task. When this
structure is being reused, you&rsquo;ll see more than one line of output with the
same <code>cred</code> address.</p>
<h3>Sample output</h3>
<div class="highlight"><pre>Windows7_VMware(Win7x64+Ubuntu686,Ubuntu64)_VBox(XPSP3x86).ram 15:40:12&gt; check_creds
-----------------------------------------------------------------------&gt; check_creds()
     Cred      PID      Command             
-------------- -------- --------------------
0x88003b86c900 966      dbus-daemon         
0x88003c766480 1031     systemd-logind      
0x88003c1a7380 1056     getty               
0x88003c1d2180 1103     irqbalance          
0x88003c1d23c0 1290     kauditd             
0x88003c1a6c00 1058     getty               
0x880036b2e840 1132     atd                 
0x88003b96d080 1055     getty               
0x88003c767440 1335     bash                
0x88003c1a6cc0 1074     sshd                
0x88003c1d2c00 1131     cron                
0x88003cbc0900 1160     login               
0x88003c183140 1081     acpid               
0x88003b9ded80 1042     getty               
0x88003b9dee40 1049     getty               
0x88003c1a78c0 1176     whoopsie            
0x88003c69a480 1486     dnsmasq             
0x88003cbc1440 1199     libvirtd            
</pre></div>

<p>

<nav class="navbar navbar-default plugins" role="navigation">

  <ul class="nav navbar-nav navbar-left">
    <li class="active">
       <a href="/docs/Manual/Plugins/Linux/CheckAFInfo.html">
         <span class="glyphicon glyphicon-arrow-left"></span>
         check_afinfo
       </a>
    </li>
  </ul>


  <ul class="nav navbar-nav navbar-right">
    <li class="active">
       <a href="/docs/Manual/Plugins/Linux/CheckIdt.html">
          check_idt
          <span class="glyphicon glyphicon-arrow-right"></span>
       </a>
    </li>
  </ul>

</nav>


  </div>
</div>
</div>
  <div class="footer">
    <div class="container">
      <p class="text-muted">
        &copy; 2015 Google Inc.
        Rekall is licensed under the The GPL License.
        Pmem is licensed under the Apache license.
        <a href="#" class="pull-right text-muted">Back to top</a>
      </p>
    </div>
  </div>

  <script>
   $(".activate_tooltip").tooltip();
  </script>
  </div>
 </body>
</html>

