
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Rekall Memory Forensic Framework</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Rekall Memory Forensic Framework">

    <link href="/css/bootstrap.min.css" rel="stylesheet">
    <link href="/css/rekall.css" rel="stylesheet">
    <link href="/css/asciidoc.css" rel="stylesheet">
    <link href="/css/font-awesome.css" rel="stylesheet">
    <script src="//code.jquery.com/jquery-1.11.0.min.js"></script>
    <script src="//code.jquery.com/ui/1.10.4/jquery-ui.js"></script>
    <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="//code.jquery.com/ui/1.10.4/themes/smoothness/jquery-ui.css">

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></sc\
ript>
    <![endif]-->
  </head>

  <body>


  <div class="background">
   <header class="header">
    <div class="navbar navbar-fixed-top navbar-inverse">
     <div class="navbar-inner">
      <div class="container">
       <a class="navbar-brand" href="/"
          style="padding-top: 0px; padding-bottom: 0px;"
          >
          <img src="/img/Rekall-small.png" class="small_logo"></img>
       </a>
       <ul class="nav navbar-nav navbar-collapse collapse">

        <li class="divider-vertical"></li>
        
    <li class="">
     <a href="/index.html">
      Home
     </a>
    </li>
    
        <li class="divider-vertical"></li>
        
    <li class="">
     <a href="/about.html">
      About
     </a>
    </li>
    
        <li class="divider-vertical"></li>
        
    <li class=" dropdown">
     <a class="dropdown-toggle"
      id="dropdownMenuReleases"
      data-toggle="dropdown"
      aria-expanded="true">
    Releases
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuReleases">

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/Releases/releases-1.2.1.html">Version 1.2.1 Col de la Croix.</a></li>

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/Releases/releases-1.3.1.html">Version 1.3.2 Dammastock.</a></li>

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/Releases/releases-1.4.0.html">Version 1.4.0 Etzel.</a></li>

  </ul>
 </li>

        <li class="divider-vertical"></li>
        
    <li class=" dropdown">
     <a class="dropdown-toggle"
      id="dropdownMenuDocumentation"
      data-toggle="dropdown"
      aria-expanded="true">
    Documentation
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuDocumentation">

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/docs/Manual">Rekall User Manual</a></li>

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/docs/Developers">Developer Documentation.</a></li>

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/docs/GUI">Rekall GUI</a></li>

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/docs/MemoryAnalysis.html">Memory Analysis Course</a></li>

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/docs/References">References</a></li>

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/docs/Tools">The Pmem Memory acquisition suite.</a></li>

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/docs/index.html"></a></li>

  </ul>
 </li>

        <li class="divider-vertical"></li>
        
    <li class=" dropdown">
     <a class="dropdown-toggle"
      id="dropdownMenuDiscuss"
      data-toggle="dropdown"
      aria-expanded="true">
    Discuss
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuDiscuss">

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/Discuss/blog.html">The Rekall Blog</a></li>

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/Discuss/github.html">GitHub</a></li>

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/Discuss/index.html"></a></li>

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/Discuss/issue.html">Issue Tracker</a></li>

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/Discuss/mailinglist.html">Mailing List</a></li>

  </ul>
 </li>

        <li class="divider-vertical"></li>
        
    <li class="">
     <a href="/faq.html">
      FAQ
     </a>
    </li>
    
       <li>
        <a href="https://github.com/google/rekall/edit/gh-pages/docs/Manual/Plugins/Windows/index.md?message=Describe%20your%20change..."
           data-toggle="tooltip"
           data-placement="bottom"
           title="Improve this page"
           class="improve-docs activate_tooltip">
         <i class="glyphicon glyphicon-edit"></i>
        </a>
       </ul>

       <form class="navbar-search col-md-3 docs-search" role="search"
             action="/search.html">
       <span class="glyphicon glyphicon-search search-icon"></span>
       <input type="text" name="q" data-i-search-input="true"
         class="search-query"
         placeholder="Site Search">
       </form>
      </div>
     </div>
    </div>
   </header>

<div class="container-fluid page-background container">
<div class="main">
  <div class="col-md-2">
    
<ul class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix rekall-side-nav">
 <a href="/docs/Manual/Plugins/index.html" class="btn btn-default btn-lg btn-block">
  <span class="glyphicon glyphicon-arrow-left"></span> Plugins
 </a>

 <a href='/docs/Manual/Plugins/Windows/index.html' class="btn btn-default btn-lg btn-block">
   Windows
 </a>
 <p>

<ul class='nav nav-pills nav-stacked'>
        <li>
          <a href='/docs/Manual/Plugins/Windows/Win32_GUI' class="category-directory-link">
            Win32_GUI
          </a>
        </li>
        
        <li>
          <a href='/docs/Manual/Plugins/Windows/Registry' class="category-directory-link">
            Registry
          </a>
        </li>
        
        <li classes=''>
          <a href='#analyze_struct' class="category-link">
            analyze_struct
          </a>
        </li>
        
        <li classes=''>
          <a href='#callbacks' class="category-link">
            callbacks
          </a>
        </li>
        
        <li classes=''>
          <a href='#cert_vad_scan' class="category-link">
            cert_vad_scan
          </a>
        </li>
        
        <li classes=''>
          <a href='#certscan' class="category-link">
            certscan
          </a>
        </li>
        
        <li classes=''>
          <a href='#check_pehooks' class="category-link">
            check_pehooks
          </a>
        </li>
        
        <li classes=''>
          <a href='#cmdscan' class="category-link">
            cmdscan
          </a>
        </li>
        
        <li classes=''>
          <a href='#connections' class="category-link">
            connections
          </a>
        </li>
        
        <li classes=''>
          <a href='#connscan' class="category-link">
            connscan
          </a>
        </li>
        
        <li classes=''>
          <a href='#consoles' class="category-link">
            consoles
          </a>
        </li>
        
        <li classes=''>
          <a href='#devicetree' class="category-link">
            devicetree
          </a>
        </li>
        
        <li classes=''>
          <a href='#dis' class="category-link">
            dis
          </a>
        </li>
        
        <li classes=''>
          <a href='#dlldump' class="category-link">
            dlldump
          </a>
        </li>
        
        <li classes=''>
          <a href='#dlllist' class="category-link">
            dlllist
          </a>
        </li>
        
        <li classes=''>
          <a href='#driverirp' class="category-link">
            driverirp
          </a>
        </li>
        
        <li classes=''>
          <a href='#driverscan' class="category-link">
            driverscan
          </a>
        </li>
        
        <li classes=''>
          <a href='#dtbscan' class="category-link">
            dtbscan
          </a>
        </li>
        
        <li classes=''>
          <a href='#dtbscan2' class="category-link">
            dtbscan2
          </a>
        </li>
        
        <li classes=''>
          <a href='#dumpfiles' class="category-link">
            dumpfiles
          </a>
        </li>
        
        <li classes=''>
          <a href='#evtlogs' class="category-link">
            evtlogs
          </a>
        </li>
        
        <li classes=''>
          <a href='#filescan' class="category-link">
            filescan
          </a>
        </li>
        
        <li classes=''>
          <a href='#find_dtb' class="category-link">
            find_dtb
          </a>
        </li>
        
        <li classes=''>
          <a href='#fls' class="category-link">
            fls
          </a>
        </li>
        
        <li classes=''>
          <a href='#handles' class="category-link">
            handles
          </a>
        </li>
        
        <li classes=''>
          <a href='#hooks_eat' class="category-link">
            hooks_eat
          </a>
        </li>
        
        <li classes=''>
          <a href='#hooks_iat' class="category-link">
            hooks_iat
          </a>
        </li>
        
        <li classes=''>
          <a href='#hooks_inline' class="category-link">
            hooks_inline
          </a>
        </li>
        
        <li classes=''>
          <a href='#imageinfo' class="category-link">
            imageinfo
          </a>
        </li>
        
        <li classes=''>
          <a href='#impscan' class="category-link">
            impscan
          </a>
        </li>
        
        <li classes=''>
          <a href='#kdbgscan' class="category-link">
            kdbgscan
          </a>
        </li>
        
        <li classes=''>
          <a href='#kpcr' class="category-link">
            kpcr
          </a>
        </li>
        
        <li classes=''>
          <a href='#ldrmodules' class="category-link">
            ldrmodules
          </a>
        </li>
        
        <li classes=''>
          <a href='#malfind' class="category-link">
            malfind
          </a>
        </li>
        
        <li classes=''>
          <a href='#memdump' class="category-link">
            memdump
          </a>
        </li>
        
        <li classes=''>
          <a href='#memmap' class="category-link">
            memmap
          </a>
        </li>
        
        <li classes=''>
          <a href='#moddump' class="category-link">
            moddump
          </a>
        </li>
        
        <li classes=''>
          <a href='#modscan' class="category-link">
            modscan
          </a>
        </li>
        
        <li classes=''>
          <a href='#modules' class="category-link">
            modules
          </a>
        </li>
        
        <li classes=''>
          <a href='#mutantscan' class="category-link">
            mutantscan
          </a>
        </li>
        
        <li classes=''>
          <a href='#netscan' class="category-link">
            netscan
          </a>
        </li>
        
        <li classes=''>
          <a href='#netstat' class="category-link">
            netstat
          </a>
        </li>
        
        <li classes=''>
          <a href='#netstat' class="category-link">
            netstat
          </a>
        </li>
        
        <li classes=''>
          <a href='#object_tree' class="category-link">
            object_tree
          </a>
        </li>
        
        <li classes=''>
          <a href='#object_types' class="category-link">
            object_types
          </a>
        </li>
        
        <li classes=''>
          <a href='#pagefiles' class="category-link">
            pagefiles
          </a>
        </li>
        
        <li classes=''>
          <a href='#pas2vas' class="category-link">
            pas2vas
          </a>
        </li>
        
        <li classes=''>
          <a href='#pedump' class="category-link">
            pedump
          </a>
        </li>
        
        <li classes=''>
          <a href='#peinfo' class="category-link">
            peinfo
          </a>
        </li>
        
        <li classes=''>
          <a href='#pfn' class="category-link">
            pfn
          </a>
        </li>
        
        <li classes=''>
          <a href='#phys_map' class="category-link">
            phys_map
          </a>
        </li>
        
        <li classes=''>
          <a href='#pool_tracker' class="category-link">
            pool_tracker
          </a>
        </li>
        
        <li classes=''>
          <a href='#pools' class="category-link">
            pools
          </a>
        </li>
        
        <li classes=''>
          <a href='#procdump' class="category-link">
            procdump
          </a>
        </li>
        
        <li classes=''>
          <a href='#procinfo' class="category-link">
            procinfo
          </a>
        </li>
        
        <li classes=''>
          <a href='#pslist' class="category-link">
            pslist
          </a>
        </li>
        
        <li classes=''>
          <a href='#psscan' class="category-link">
            psscan
          </a>
        </li>
        
        <li classes=''>
          <a href='#pstree' class="category-link">
            pstree
          </a>
        </li>
        
        <li classes=''>
          <a href='#psxview' class="category-link">
            psxview
          </a>
        </li>
        
        <li classes=''>
          <a href='#ptov' class="category-link">
            ptov
          </a>
        </li>
        
        <li classes=''>
          <a href='#raw2dmp' class="category-link">
            raw2dmp
          </a>
        </li>
        
        <li classes=''>
          <a href='#services' class="category-link">
            services
          </a>
        </li>
        
        <li classes=''>
          <a href='#sockets' class="category-link">
            sockets
          </a>
        </li>
        
        <li classes=''>
          <a href='#ssdt' class="category-link">
            ssdt
          </a>
        </li>
        
        <li classes=''>
          <a href='#svcscan' class="category-link">
            svcscan
          </a>
        </li>
        
        <li classes=''>
          <a href='#symlinkscan' class="category-link">
            symlinkscan
          </a>
        </li>
        
        <li classes=''>
          <a href='#thrdscan' class="category-link">
            thrdscan
          </a>
        </li>
        
        <li classes=''>
          <a href='#threads' class="category-link">
            threads
          </a>
        </li>
        
        <li classes=''>
          <a href='#timers' class="category-link">
            timers
          </a>
        </li>
        
        <li classes=''>
          <a href='#tokens' class="category-link">
            tokens
          </a>
        </li>
        
        <li classes=''>
          <a href='#unloaded_modules' class="category-link">
            unloaded_modules
          </a>
        </li>
        
        <li classes=''>
          <a href='#vacbs' class="category-link">
            vacbs
          </a>
        </li>
        
        <li classes=''>
          <a href='#vad' class="category-link">
            vad
          </a>
        </li>
        
        <li classes=''>
          <a href='#vaddump' class="category-link">
            vaddump
          </a>
        </li>
        
        <li classes=''>
          <a href='#vadinfo' class="category-link">
            vadinfo
          </a>
        </li>
        
        <li classes=''>
          <a href='#vadmap' class="category-link">
            vadmap
          </a>
        </li>
        
        <li classes=''>
          <a href='#vadtree' class="category-link">
            vadtree
          </a>
        </li>
        
        <li classes=''>
          <a href='#vadwalk' class="category-link">
            vadwalk
          </a>
        </li>
        
        <li classes=''>
          <a href='#version_modules' class="category-link">
            version_modules
          </a>
        </li>
        
        <li classes=''>
          <a href='#virt_map' class="category-link">
            virt_map
          </a>
        </li>
        
        <li classes=''>
          <a href='#vtop' class="category-link">
            vtop
          </a>
        </li>
        
        <li classes=''>
          <a href='#win32k_autodetect' class="category-link">
            win32k_autodetect
          </a>
        </li>
        
        <li classes=''>
          <a href='#yarascan' class="category-link">
            yarascan
          </a>
        </li>
        </ul></ul>
  </div>

  <div class="col-md-10">
    
<div class="plugin_doc">
<h1 id="Windows Plugins" class="anchor" >Windows Plugins</h1>

<p>Support for Windows memory analysis.</p>

<h1 id="analyze_struct" class="anchor">analyze_struct</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.interactive.structs.AnalyzeStruct-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>A plugin to analyze a memory location.</h2>
</div>


<h3>Plugin Arguments</h3>
<div class="plugins_args">
<table class='table table-condensed'>
<tbody>
<tr><td><p>offset</p></td><td><p>A virtual address to analyze.</p></td></tr><tr><td><p>search</p></td><td><p>How far back to search for pool tag. (type: IntParser)</p>
<ul>
<li>Default: 256</li>
</ul></td></tr><tr><td><p>size</p></td><td><p>How many elements to identify. (type: IntParser)</p>
<ul>
<li>Default: 256</li>
</ul></td></tr>
</tbody>
</table>
</div>


<p>The Windows kernel allocates memory from &ldquo;pool space&rdquo;. To ease debugging memory
leaks, the kernel uses a unique &ldquo;Pool Tag&rdquo; to tag many allocations. Each kernel
subsystem or driver would use a specific tag to keep track of its allocation.</p>
<p>We can use this fact when we look at some undocumented, or unknown memory
region. This is what the <code>analyze_struct</code> plugin does:</p>
<ol>
<li>It first searched back from the address of interest to determine if this
   address is part of a pool allocation. The plugin will report the pool tag of
   this allocation as well as its size and starting offset.</li>
<li>For each slot in the struct, the plugin assumes it is a pointer to something,
   and checks if whatever it is pointing to is a pool allocation or a known
   address.</li>
</ol>
<p>We can use this to get an idea of what exists at this memory location and its
struct layout.</p>
<p>In the below example, we pick an _EPROCESS from the output of <code>pslist</code> and
search for pointers to it somewhere in kernel memory (There are many pointers!
We just picked one for this example.). We then use the <code>analyze_struct</code> plugin
to discover that the pointer resides in an allocation with the pool tag
&lsquo;ObHd&rsquo;. We can search the kernel disassembly to realize this is an Object
Handle. Note how we use grep to search for the little endian representation of
the _EPROCESS address.</p>
<div class="highlight"><pre>[1] win7.elf 23:14:38&gt; pslist
  _EPROCESS            Name          PID   PPID   Thds    Hnds    Sess  Wow64           Start                     Exit
-------------- -------------------- ----- ------ ------ -------- ------ ------ ------------------------ ------------------------
....
0xfa8002ad0190 cmd.exe               2644   2616      2       66      1 True   2012-10-01 14:40:20Z     -

[1] win7.elf 23:14:55&gt; grep keyword=&quot;\x90\x01\xad\x02\x80\xfa&quot;
....
    Offset                                   Data                                                Comment
-------------- ----------------------------------------------------------------- ----------------------------------------
0xf8a0013d8ad8 60 40 a9 02 80 fa ff ff 01 00 00 00 00 00 00 00  `@..............
0xf8a0013d8ae8 90 01 ad 02 80 fa ff ff 01 00 00 00 00 00 00 00  ................
0xf8a0013d8af8 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
...
[1] win7.elf 23:17:20&gt; analyze_struct 0xf8a0013d8ae8

0xf8a0013d8ae8 is inside pool allocation with tag &#39;ObHd&#39; (0xf8a0013d8a30)  and size 0x100
    Offset     Content
-------------- -------
           0x0 Data:0xfa8002ad0190 Tag:Pro\xe3 @0xfa8002ad0190 (0x530)
           0x8 Data:0x1
          0x10 Data:0x0
          0x18 Data:0x0
          0x20 Data:0x0
          0x28 Data:0x0
          0x30 Data:0xfa80017f9060 Tag:Pro\xe3 @0xfa80017f9060 (0x530)
          0x38 Data:0x1
          0x40 Data:0x730061006c
          0x48 Data:0x744e034d0110
          0x50 Data:0x490053004c
          0x58 Data:0xa4801280702
          0x60 Data:0x981e
          0x68 Data:0x100000000
          0x70 Data:0x0
[1] win7.elf 23:22:25&gt; hex(struct.unpack(&quot;&lt;I&quot;, &#39;ObHd&#39;)[0])
               Out&lt;24&gt; &#39;0x6448624f&#39;
[1] win7.elf 23:22:33&gt; dis &quot;nt!ObpInsertHandleCount&quot;
---------------------&gt; dis(&quot;nt!ObpInsertHandleCount&quot;)
Address      Rel             Op Codes                     Instruction                Comment
------- -------------- -------------------- ---------------------------------------- -------
------ nt!ObpInsertHandleCount ------: 0xf80002976010
  0xf80002976010            0x0 48895c2408           mov qword ptr [rsp + 8], rbx
  0xf80002976015            0x5 48896c2410           mov qword ptr [rsp + 0x10], rbp
....

  0xf80002976089           0x79 41b84f624864         mov r8d, 0x6448624f
  0xf8000297608f           0x7f e83cd3e4ff           call 0xf800027c33d0                      nt!ExAllocatePoolWithTag
  0xf80002976094           0x84 4885c0               test rax, rax
  0xf80002976097           0x87 0f84dacd0400         je 0xf800029c2e77                        nt!ExpProfileCreate+0x9d57
  0xf8000297609d           0x8d 458bc5               mov r8d, r13d
</pre></div>
</div>

<h1 id="callbacks" class="anchor">callbacks</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.malware.callbacks.Callbacks-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Enumerate callback routines.</h2>
<p>This plugin just enumerates installed callback routines from various
sources. It does not scan for them.</p>
<p>This plugin is loosely based on the original Volatility plugin of the same
name but much expanded using new information.</p>
<p>Reference:
<a href="http://www.codemachine.com/notes.html">http://www.codemachine.com/notes.html</a></p>
</div>



<p>The Windows kernel has a facility to register callbacks for certain events. This
is often misused by malware in order to gain persistence. The <code>callbacks</code> plugin
enumerates these callbacks.</p>
<p>Since Rekall has an address resolver, we can often say more about what exists at
each of the callback locations. Normally Rekall only tracks the profile for
certain binaries (such as the kernel).</p>
<p>In the below example the callbacks plugins resolves the address of kernel
symbols precisely since it has the kernel profile loaded. Other symbols are give
approximately as their distance from the module&rsquo;s export table.</p>
<p>Suppose we want to verify what is the callback in the &ldquo;wdf01000&rdquo; driver. We can
instruct the address resolver to download the profile from the Microsoft symbol
server. Once the profile is downloaded, Rekall can determine the exact function
name registered (wdf01000!FxpBugCheckCallback).</p>
<div class="highlight"><pre>[1] win7.elf 00:59:59&gt; callbacks
---------------------&gt; callbacks()
                Type                     Offset        Callback                          Symbol                       Details
------------------------------------ -------------- -------------- -------------------------------------------------- -------
nt!PspLoadImageNotifyRoutine         0xf8000283e4a0 0xf800029acb68 nt!EtwpTraceLoadImage
nt!PspCreateProcessNotifyRoutine     0xf8000283e720 0xf8000265af28 nt!ViCreateProcessCallback
nt!PspCreateProcessNotifyRoutine     0xf8000283e728 0xf88001211330 ksecdd!AcceptSecurityContext+0x230
nt!PspCreateProcessNotifyRoutine     0xf8000283e730 0xf8800112b910 cng!SystemPrng+0x6a0
nt!PspCreateProcessNotifyRoutine     0xf8000283e738 0xf8800164c390 tcpip!CreateProcessNotifyRoutineEx
nt!PspCreateProcessNotifyRoutine     0xf8000283e740 0xf88000d01b94 ci!CiFreePolicyInfo+0xce84
nt!KeBugCheckCallbackListHead        0xfa80019c3ea0 0xf880014548f0 ndis!NdisGetSharedDataAlignment+0x10               Ndis min
nt!KeBugCheckCallbackListHead        0xfa80019a4ea0 0xf880014548f0 ndis!NdisGetSharedDataAlignment+0x10               Ndis min
nt!KeBugCheckCallbackListHead        0xfa80019a1ea0 0xf880014548f0 ndis!NdisGetSharedDataAlignment+0x10               Ndis min
nt!KeBugCheckCallbackListHead        0xf80002c25400 0xf80002c0eef4 hal!HalQueryMaximumProcessorCount+0x54c            ACPI x64
nt!KeBugCheckReasonCallbackListHead  0xfa80026549f8 0xf88000efd054 wdf01000+0x7a054                                   PEAUTH
nt!KeBugCheckReasonCallbackListHead  0xfa8000927f88 0xf88000efd054 wdf01000+0x7a054                                   monitor

[1] win7.elf 02:04:35&gt; address_resolver &quot;wdf01000&quot;
---------------------&gt; address_resolver(&quot;wdf01000&quot;) |
 Trying to fetch http://msdl.microsoft.com/download/symbols/wdf01000.pdb/99521C1B360441A9A1EAECC9E5087A251/wdf01000.pd_
 Trying to fetch http://msdl.microsoft.com/download/symbols/wdf01000.pdb/99521C1B360441A9A1EAECC9E5087A251/wdf01000.pd_
Extracting cabinet: /tmp/tmpnOmJvR/wdf01000.pd_
  extracting Wdf01000.pdb

All done, no errors.
                Out&lt;1&gt; Plugin: address_resolver

1] win7.elf 02:05:08&gt; callbacks
---------------------&gt; callbacks()
                Type                     Offset        Callback                          Symbol                       Details
------------------------------------ -------------- -------------- -------------------------------------------------- -------
nt!PspLoadImageNotifyRoutine         0xf8000283e4a0 0xf800029acb68 nt!EtwpTraceLoadImage
nt!PspCreateProcessNotifyRoutine     0xf8000283e720 0xf8000265af28 nt!ViCreateProcessCallback
nt!PspCreateProcessNotifyRoutine     0xf8000283e728 0xf88001211330 ksecdd!AcceptSecurityContext+0x230
nt!PspCreateProcessNotifyRoutine     0xf8000283e730 0xf8800112b910 cng!SystemPrng+0x6a0
nt!PspCreateProcessNotifyRoutine     0xf8000283e738 0xf8800164c390 tcpip!CreateProcessNotifyRoutineEx
nt!PspCreateProcessNotifyRoutine     0xf8000283e740 0xf88000d01b94 ci!CiFreePolicyInfo+0xce84
nt!KeBugCheckCallbackListHead        0xfa80019c3ea0 0xf880014548f0 ndis!NdisGetSharedDataAlignment+0x10               Ndis min
nt!KeBugCheckCallbackListHead        0xfa80019a4ea0 0xf880014548f0 ndis!NdisGetSharedDataAlignment+0x10               Ndis min
nt!KeBugCheckCallbackListHead        0xfa80019a1ea0 0xf880014548f0 ndis!NdisGetSharedDataAlignment+0x10               Ndis min
nt!KeBugCheckCallbackListHead        0xf80002c25400 0xf80002c0eef4 hal!HalQueryMaximumProcessorCount+0x54c            ACPI x64
nt!KeBugCheckReasonCallbackListHead  0xfa80026549f8 0xf88000efd054 wdf01000!FxpBugCheckCallback                       PEAUTH
nt!KeBugCheckReasonCallbackListHead  0xfa8000927f88 0xf88000efd054 wdf01000!FxpBugCheckCallback                       monitor
nt!KeBugCheckReasonCallbackListHead  0xfa80021f54b0 0xf88003edaf40 mouhid+0x3f40                                      mouhid
</pre></div>
</div>

<h1 id="cert_vad_scan" class="anchor">cert_vad_scan</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.dumpcerts.CertVadScan-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Scan certificates in process Vads.</h2>
</div>


<h3>Plugin Arguments</h3>
<div class="plugins_args">
<table class='table table-condensed'>
<tbody>
<tr><td><p>dump_dir</p></td><td><p>Path suitable for dumping files. (Default: Use current directory)</p></td></tr><tr><td><p>eprocess</p></td><td><p>Kernel addresses of eprocess structs. (type: ArrayIntParser)</p></td></tr><tr><td><p>method</p></td><td><p>Method to list processes. (type: ChoiceArray)</p>
<ul>
<li>
<p>Valid Choices:</p>
<ul>
<li>PsActiveProcessHead</li>
<li>CSRSS</li>
<li>PspCidTable</li>
<li>Sessions</li>
<li>Handles</li>
</ul>
</li>
<li>
<p>Default: PsActiveProcessHead, CSRSS, PspCidTable, Sessions, Handles</p>
</li>
</ul></td></tr><tr><td><p>phys_eprocess</p></td><td><p>Physical addresses of eprocess structs. (type: ArrayIntParser)</p></td></tr><tr><td><p>pid</p></td><td><p>One or more pids of processes to select. (type: ArrayIntParser)</p></td></tr><tr><td><p>proc_regex</p></td><td><p>A regex to select a process by name. (type: RegEx)</p></td></tr>
</tbody>
</table>
</div>


<p>This plugin is similar to the <a href="CertScan.html">certscan</a> plugin. It attempts to detect
DER encoded X509 certificates or RSA private keys in memory. This plugin scans
the process memory of selected processes only. The usualy process selection
arguments are supported in order to restrict the search to some processes only.</p>
<p>Optionally, if a dump directory is provided the DER encoded certificates are
also dumped to files in the specified directory.</p>
<h3>Sample Output</h3>
<p>In the example below we scan the address space of the winpmem acquistion tool to
find certificates used to sign the driver and binary.</p>
<div class="highlight"><pre><span class="n">win8</span><span class="mf">.1</span><span class="p">.</span><span class="n">raw</span> <span class="mi">22</span><span class="o">:</span><span class="mo">07</span><span class="o">:</span><span class="mi">16</span><span class="o">&gt;</span> <span class="n">cert_vad_scan</span> <span class="n">proc_regex</span><span class="o">=</span><span class="s">&quot;winpmem&quot;</span>
<span class="o">-------------------&gt;</span> <span class="n">cert_vad_scan</span><span class="p">(</span><span class="n">proc_regex</span><span class="o">=</span><span class="s">&quot;winpmem&quot;</span><span class="p">)</span>
<span class="n">Pid</span>   <span class="n">Command</span>       <span class="n">Address</span>     <span class="n">Type</span>  <span class="n">Length</span> <span class="n">Description</span>
<span class="o">-----</span> <span class="o">----------</span> <span class="o">--------------</span> <span class="o">-----</span> <span class="o">------</span> <span class="o">-----------</span>
<span class="mi">2628</span>  <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span> <span class="mh">0x00000003c179</span> <span class="n">X509</span>  <span class="mi">1010</span>  <span class="o">/</span><span class="n">C</span><span class="o">=</span><span class="n">US</span><span class="o">/</span><span class="n">O</span><span class="o">=</span><span class="n">Symantec</span> <span class="n">Corporation</span><span class="o">/</span><span class="n">CN</span><span class="o">=</span><span class="n">Symantec</span> <span class="n">Time</span> <span class="n">Stamping</span> <span class="n">Services</span> <span class="n">CA</span> <span class="o">-</span> <span class="n">G2</span>
<span class="mi">2628</span>  <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span> <span class="mh">0x00000003c56b</span> <span class="n">X509</span>  <span class="mi">1191</span>  <span class="o">/</span><span class="n">C</span><span class="o">=</span><span class="n">US</span><span class="o">/</span><span class="n">O</span><span class="o">=</span><span class="n">Symantec</span> <span class="n">Corporation</span><span class="o">/</span><span class="n">CN</span><span class="o">=</span><span class="n">Symantec</span> <span class="n">Time</span> <span class="n">Stamping</span> <span class="n">Services</span> <span class="n">Signer</span> <span class="o">-</span> <span class="n">G4</span>
<span class="mi">2628</span>  <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span> <span class="mh">0x00000003ca12</span> <span class="n">X509</span>  <span class="mi">1343</span>  <span class="o">/</span><span class="n">C</span><span class="o">=</span><span class="n">US</span><span class="o">/</span><span class="n">O</span><span class="o">=</span><span class="n">DigiCert</span> <span class="n">Inc</span><span class="o">/</span><span class="n">OU</span><span class="o">=</span><span class="n">www</span><span class="p">.</span><span class="n">digicert</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">CN</span><span class="o">=</span><span class="n">DigiCert</span> <span class="n">High</span> <span class="n">Assurance</span> <span class="n">EV</span> <span class="n">Root</span> <span class="n">CA</span>
<span class="mi">2628</span>  <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span> <span class="mh">0x00000003cf51</span> <span class="n">X509</span>  <span class="mi">1690</span>  <span class="o">/</span><span class="n">C</span><span class="o">=</span><span class="n">CH</span><span class="o">/</span><span class="n">ST</span><span class="o">=</span><span class="n">Switzerland</span><span class="o">/</span><span class="n">L</span><span class="o">=</span><span class="n">Horgen</span><span class="o">/</span><span class="n">O</span><span class="o">=</span><span class="n">Michael</span> <span class="n">Cohen</span><span class="o">/</span><span class="n">CN</span><span class="o">=</span><span class="n">Michael</span> <span class="n">Cohen</span>
<span class="mi">2628</span>  <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span> <span class="mh">0x00000003d285</span> <span class="n">X509</span>  <span class="mi">443</span>   <span class="o">-</span>
<span class="mi">2628</span>  <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span> <span class="mh">0x00000003d5eb</span> <span class="n">X509</span>  <span class="mi">1734</span>  <span class="o">/</span><span class="n">C</span><span class="o">=</span><span class="n">US</span><span class="o">/</span><span class="n">O</span><span class="o">=</span><span class="n">DigiCert</span> <span class="n">Inc</span><span class="o">/</span><span class="n">OU</span><span class="o">=</span><span class="n">www</span><span class="p">.</span><span class="n">digicert</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">CN</span><span class="o">=</span><span class="n">DigiCert</span> <span class="n">High</span> <span class="n">Assurance</span> <span class="n">Code</span> <span class="n">Signing</span> <span class="n">CA</span><span class="o">-</span><span class="mi">1</span>
<span class="mi">2628</span>  <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span> <span class="mh">0x00000003d87c</span> <span class="n">X509</span>  <span class="mi">442</span>   <span class="o">-</span>
<span class="mi">2628</span>  <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span> <span class="mh">0x000000bd2260</span> <span class="n">X509</span>  <span class="mi">704</span>   <span class="o">/</span><span class="n">O</span><span class="o">=</span><span class="n">VeriSign</span> <span class="n">Trust</span> <span class="n">Network</span><span class="o">/</span><span class="n">OU</span><span class="o">=</span><span class="n">VeriSign</span><span class="p">,</span> <span class="n">Inc</span><span class="p">.</span><span class="o">/</span><span class="n">OU</span><span class="o">=</span><span class="n">VeriSign</span> <span class="n">Time</span> <span class="n">Stamping</span> <span class="n">Service</span> <span class="n">Root</span><span class="o">/</span><span class="n">OU</span><span class="o">=</span><span class="n">NO</span> <span class="n">LIABILITY</span> <span class="n">ACCEPTED</span><span class="p">,</span> <span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="mi">97</span> <span class="n">VeriSign</span><span class="p">,</span> <span class="n">Inc</span><span class="p">.</span>
<span class="mi">2628</span>  <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span> <span class="mh">0x000000bd2720</span> <span class="n">X509</span>  <span class="mi">462</span>   <span class="o">/</span><span class="n">CN</span><span class="o">=</span><span class="n">Root</span> <span class="n">Agency</span>
<span class="mi">2628</span>  <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span> <span class="mh">0x000000c153b0</span> <span class="n">X509</span>  <span class="mi">1491</span>  <span class="o">/</span><span class="n">C</span><span class="o">=</span><span class="n">US</span><span class="o">/</span><span class="n">ST</span><span class="o">=</span><span class="n">Washington</span><span class="o">/</span><span class="n">L</span><span class="o">=</span><span class="n">Redmond</span><span class="o">/</span><span class="n">O</span><span class="o">=</span><span class="n">Microsoft</span> <span class="n">Corporation</span><span class="o">/</span><span class="n">OU</span><span class="o">=</span><span class="n">MOPR</span><span class="o">/</span><span class="n">CN</span><span class="o">=</span><span class="n">Microsoft</span> <span class="n">Update</span>
</pre></div>
</div>

<h1 id="certscan" class="anchor">certscan</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.dumpcerts.CertScan-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Dump RSA private and public SSL keys from the physical address space.</h2>
</div>


<h3>Plugin Arguments</h3>
<div class="plugins_args">
<table class='table table-condensed'>
<tbody>
<tr><td><p>dump_dir</p></td><td><p>Path suitable for dumping files. (Default: Use current directory)</p></td></tr>
</tbody>
</table>
</div>


<p>This plugin is similar to the <a href="CertVadScan.html">cert_vad_scan</a> plugin. It
attempts to detect DER encoded X509 certificates or RSA private keys in physical
memory.</p>
<p>Optionally, if a dump directory is provided the DER encoded certificates are
also dumped to files in the specified directory.</p>
<h3>Sample Output</h3>
<div class="highlight"><pre><span class="n">win8</span><span class="mf">.1</span><span class="p">.</span><span class="n">raw</span> <span class="mi">22</span><span class="o">:</span><span class="mo">07</span><span class="o">:</span><span class="mi">35</span><span class="o">&gt;</span> <span class="n">certscan</span>
<span class="o">-------------------&gt;</span> <span class="n">certscan</span><span class="p">()</span>
   <span class="n">Address</span>     <span class="n">Type</span>       <span class="n">Length</span>     <span class="n">Description</span>
<span class="o">--------------</span> <span class="o">----------</span> <span class="o">----------</span> <span class="o">-----------</span>
<span class="mh">0x000000030c95</span> <span class="n">X509</span>       <span class="mi">1287</span>       <span class="o">/</span><span class="n">C</span><span class="o">=</span><span class="n">US</span><span class="o">/</span><span class="n">ST</span><span class="o">=</span><span class="n">Washington</span><span class="o">/</span><span class="n">L</span><span class="o">=</span><span class="n">Redmond</span><span class="o">/</span><span class="n">O</span><span class="o">=</span><span class="n">Microsoft</span> <span class="n">Corporation</span><span class="o">/</span><span class="n">CN</span><span class="o">=</span><span class="n">Microsoft</span> <span class="n">Windows</span>
<span class="mh">0x00000003119c</span> <span class="n">X509</span>       <span class="mi">1499</span>       <span class="o">/</span><span class="n">C</span><span class="o">=</span><span class="n">US</span><span class="o">/</span><span class="n">ST</span><span class="o">=</span><span class="n">Washington</span><span class="o">/</span><span class="n">L</span><span class="o">=</span><span class="n">Redmond</span><span class="o">/</span><span class="n">O</span><span class="o">=</span><span class="n">Microsoft</span> <span class="n">Corporation</span><span class="o">/</span><span class="n">CN</span><span class="o">=</span><span class="n">Microsoft</span> <span class="n">Windows</span> <span class="n">Production</span> <span class="n">PCA</span> <span class="mi">2011</span>
<span class="mh">0x000000031b94</span> <span class="n">X509</span>       <span class="mi">1653</span>       <span class="o">/</span><span class="n">C</span><span class="o">=</span><span class="n">US</span><span class="o">/</span><span class="n">ST</span><span class="o">=</span><span class="n">Washington</span><span class="o">/</span><span class="n">L</span><span class="o">=</span><span class="n">Redmond</span><span class="o">/</span><span class="n">O</span><span class="o">=</span><span class="n">Microsoft</span> <span class="n">Corporation</span><span class="o">/</span><span class="n">CN</span><span class="o">=</span><span class="n">Microsoft</span> <span class="n">Time</span><span class="o">-</span><span class="n">Stamp</span> <span class="n">PCA</span> <span class="mi">2010</span>
<span class="mh">0x000000032209</span> <span class="n">X509</span>       <span class="mi">1246</span>       <span class="o">/</span><span class="n">C</span><span class="o">=</span><span class="n">US</span><span class="o">/</span><span class="n">ST</span><span class="o">=</span><span class="n">Washington</span><span class="o">/</span><span class="n">L</span><span class="o">=</span><span class="n">Redmond</span><span class="o">/</span><span class="n">O</span><span class="o">=</span><span class="n">Microsoft</span> <span class="n">Corporation</span><span class="o">/</span><span class="n">OU</span><span class="o">=</span><span class="n">MOPR</span><span class="o">/</span><span class="n">OU</span><span class="o">=</span><span class="n">nCipher</span> <span class="n">DSE</span> <span class="n">ESN</span><span class="o">:</span><span class="n">F528</span><span class="o">-</span><span class="mi">3777</span><span class="o">-</span><span class="mi">8</span><span class="n">A76</span><span class="o">/</span><span class="n">CN</span><span class="o">=</span><span class="n">Microsoft</span> <span class="n">Time</span><span class="o">-</span><span class="n">Stamp</span> <span class="n">Service</span>
<span class="mh">0x00000017114e</span> <span class="n">X509</span>       <span class="mi">1499</span>       <span class="o">/</span><span class="n">C</span><span class="o">=</span><span class="n">US</span><span class="o">/</span><span class="n">ST</span><span class="o">=</span><span class="n">Washington</span><span class="o">/</span><span class="n">L</span><span class="o">=</span><span class="n">Redmond</span><span class="o">/</span><span class="n">O</span><span class="o">=</span><span class="n">Microsoft</span> <span class="n">Corporation</span><span class="o">/</span><span class="n">CN</span><span class="o">=</span><span class="n">Microsoft</span> <span class="n">Windows</span> <span class="n">Production</span> <span class="n">PCA</span> <span class="mi">2011</span>
<span class="mh">0x000000171b46</span> <span class="n">X509</span>       <span class="mi">1653</span>       <span class="o">/</span><span class="n">C</span><span class="o">=</span><span class="n">US</span><span class="o">/</span><span class="n">ST</span><span class="o">=</span><span class="n">Washington</span><span class="o">/</span><span class="n">L</span><span class="o">=</span><span class="n">Redmond</span><span class="o">/</span><span class="n">O</span><span class="o">=</span><span class="n">Microsoft</span> <span class="n">Corporation</span><span class="o">/</span><span class="n">CN</span><span class="o">=</span><span class="n">Microsoft</span> <span class="n">Time</span><span class="o">-</span><span class="n">Stamp</span> <span class="n">PCA</span> <span class="mi">2010</span>
</pre></div>
</div>

<h1 id="check_pehooks" class="anchor">check_pehooks</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.malware.apihooks.CheckPEHooks-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Checks a pe file mapped into memory for hooks.</h2>
</div>


<h3>Plugin Arguments</h3>
<div class="plugins_args">
<table class='table table-condensed'>
<tbody>
<tr><td><p>image-base</p></td><td><p>The base address of the pe image in memory.</p>
<ul>
<li>Default: 0</li>
</ul></td></tr><tr><td><p>type</p></td><td><p>Type of hook to display. (type: ChoiceArray)</p>
<ul>
<li>
<p>Valid Choices:</p>
<ul>
<li>all</li>
<li>iat</li>
<li>inline</li>
<li>eat</li>
</ul>
</li>
<li>
<p>Default: all</p>
</li>
</ul></td></tr><tr><td><p>verbosity</p></td><td><p>An integer reflecting the amount of desired output: 0 = quiet, 10 = noisy. (type: IntParser)</p>
<ul>
<li>Default: 1</li>
</ul></td></tr>
</tbody>
</table>
</div>



</div>

<h1 id="cmdscan" class="anchor">cmdscan</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.malware.cmdhistory.CmdScan-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Extract command history by scanning for _COMMAND_HISTORY</h2>
</div>


<h3>Plugin Arguments</h3>
<div class="plugins_args">
<table class='table table-condensed'>
<tbody>
<tr><td><p>max_history</p></td><td><p>Value of history buffer size. See HKEY_CURRENT_USER\Console\HistoryBufferSize for default.</p>
<ul>
<li>Default: 50</li>
</ul></td></tr>
</tbody>
</table>
</div>


<p>The cmdscan plugin searches the memory of csrss.exe on XP/2003/Vista/2008 and
conhost.exe on Windows 7 for commands that attackers entered through a console
shell (cmd.exe). This is one of the most powerful commands you can use to gain
visibility into an attackers actions on a victim system, whether they opened
cmd.exe through an RDP session or proxied input/output to a command shell from a
networked backdoor.</p>
<p>This plugin finds structures known as <strong>COMMAND_HISTORY</strong> by looking for a known
constant value (<strong>MaxHistory</strong>) and then applying sanity checks. It is important
to note that the <strong>MaxHistory</strong> value can be changed by right clicking in the
top left of a cmd.exe window and going to Properties. The value can also be
changed for all consoles opened by a given user by modifying the registry key
HKCU\Console\HistoryBufferSize. The default is 50 on Windows systems, meaning
the most recent 50 commands are saved. You can tweak it if needed by using the
&ndash;max_history=NUMBER parameter.</p>
<p>The structures used by this plugin are not public (i.e. Microsoft does not
produce PDBs for them), thus they&rsquo;re not available in WinDBG or any other
forensic framework. They were reverse engineered by Michael Ligh from the
conhost.exe and winsrv.dll binaries.</p>
<p>In addition to the commands entered into a shell, this plugin shows:</p>
<ul>
<li>
<p>The name of the console host process (csrss.exe or conhost.exe)</p>
</li>
<li>
<p>The name of the application using the console (whatever process is using cmd.exe)</p>
</li>
<li>
<p>The location of the command history buffers, including the current buffer count, last added command, and last displayed command</p>
</li>
<li>
<p>The application process handle</p>
</li>
</ul>
<p>Due to the scanning technique this plugin uses, it has the capability to find
commands from both active and closed consoles.</p>
<h3>Notes</h3>
<p>This plugin is pretty fragile since it relies on reversed structures in
undocumented code. We are working on improving the situation here but there is a
moderate chance that it will produce no results or garbage results.</p>
<h3>Sample Output</h3>
<p>The following showing an operator using the winpmem acquisition tool to analyse
the live memory of a Windows 7 machine.</p>
<div class="highlight"><pre><span class="n">win7</span><span class="p">.</span><span class="n">elf</span> <span class="mi">22</span><span class="o">:</span><span class="mi">15</span><span class="o">:</span><span class="mi">39</span><span class="o">&gt;</span> <span class="n">cmdscan</span>
<span class="o">-----------------&gt;</span> <span class="n">cmdscan</span><span class="p">()</span>
<span class="o">**************************************************</span>
<span class="nl">CommandProcess:</span> <span class="n">conhost</span><span class="p">.</span><span class="n">exe</span> <span class="n">Pid</span><span class="o">:</span> <span class="mi">2652</span>
<span class="nl">CommandHistory:</span> <span class="mh">0x7ea40</span> <span class="n">Application</span><span class="o">:</span> <span class="n">cmd</span><span class="p">.</span><span class="n">exe</span> <span class="n">Flags</span><span class="o">:</span> <span class="n">Allocated</span><span class="p">,</span> <span class="n">Reset</span>
<span class="nl">CommandCount:</span> <span class="mi">3</span> <span class="n">LastAdded</span><span class="o">:</span> <span class="mi">2</span> <span class="n">LastDisplayed</span><span class="o">:</span> <span class="mi">2</span>
<span class="nl">FirstCommand:</span> <span class="mi">0</span> <span class="n">CommandCountMax</span><span class="o">:</span> <span class="mi">50</span>
<span class="nl">ProcessHandle:</span> <span class="mh">0x5c</span>
<span class="n">Cmd</span>    <span class="n">Address</span>     <span class="n">Text</span>
<span class="o">---</span> <span class="o">--------------</span> <span class="o">--------------------------------------------------</span>
  <span class="mi">0</span> <span class="mh">0x00000005ea70</span> <span class="n">cd</span> <span class="err">\</span><span class="n">Users</span><span class="err">\</span><span class="n">a</span><span class="err">\</span><span class="n">Desktop</span>
  <span class="mi">1</span> <span class="mh">0x00000005b920</span> <span class="n">winpmem_1</span><span class="mf">.1</span><span class="o">-</span><span class="n">write</span><span class="p">.</span><span class="n">exe</span> <span class="o">-</span><span class="n">w</span> <span class="o">-</span><span class="n">l</span>
  <span class="mi">2</span> <span class="mh">0x0000000b3e70</span> <span class="n">vol</span><span class="p">.</span><span class="n">exe</span> <span class="o">--</span><span class="n">profile</span> <span class="n">Win7SP1x64</span> <span class="o">--</span><span class="n">file</span> <span class="err">\\</span><span class="p">.</span><span class="err">\</span><span class="n">pmem</span>
 <span class="mi">15</span> <span class="mh">0x000000040158</span>
 <span class="mi">16</span> <span class="mh">0x00000007d3b0</span>

<span class="o">**************************************************</span>
<span class="nl">CommandProcess:</span> <span class="n">conhost</span><span class="p">.</span><span class="n">exe</span> <span class="n">Pid</span><span class="o">:</span> <span class="mi">2652</span>
<span class="nl">CommandHistory:</span> <span class="mh">0xb40c0</span> <span class="n">Application</span><span class="o">:</span> <span class="n">vol</span><span class="p">.</span><span class="n">exe</span> <span class="n">Flags</span><span class="o">:</span> <span class="n">Allocated</span>
<span class="nl">CommandCount:</span> <span class="mi">0</span> <span class="n">LastAdded</span><span class="o">:</span> <span class="o">-</span><span class="mi">1</span> <span class="n">LastDisplayed</span><span class="o">:</span> <span class="o">-</span><span class="mi">1</span>
<span class="nl">FirstCommand:</span> <span class="mi">0</span> <span class="n">CommandCountMax</span><span class="o">:</span> <span class="mi">50</span>
<span class="nl">ProcessHandle:</span> <span class="mh">0xd4</span>
<span class="n">Cmd</span>    <span class="n">Address</span>     <span class="n">Text</span>
<span class="o">---</span> <span class="o">--------------</span> <span class="o">--------------------------------------------------</span>
  <span class="mi">0</span> <span class="mh">0x0000001f77e0</span>
  <span class="mi">3</span> <span class="mh">0x000000060ef0</span>
  <span class="mi">5</span> <span class="mh">0x0000001f77e0</span>
  <span class="mi">8</span> <span class="mh">0x000000060ef0</span>
 <span class="mi">10</span> <span class="mh">0x0000001f77e0</span>
 <span class="mi">13</span> <span class="mh">0x0000ffd96238</span>
 <span class="mi">14</span> <span class="mh">0x00000007ec20</span>
 <span class="mi">15</span> <span class="mh">0x0000001f7720</span>
 <span class="mi">23</span> <span class="mh">0x0000000610a0</span>
 <span class="mi">24</span> <span class="mh">0x0000000974e0</span>
<span class="o">**************************************************</span>
<span class="nl">CommandProcess:</span> <span class="n">conhost</span><span class="p">.</span><span class="n">exe</span> <span class="n">Pid</span><span class="o">:</span> <span class="mi">2652</span>
<span class="nl">CommandHistory:</span> <span class="mh">0xb4410</span> <span class="n">Application</span><span class="o">:</span> <span class="n">vol</span><span class="p">.</span><span class="n">exe</span> <span class="n">Flags</span><span class="o">:</span> <span class="n">Allocated</span>
<span class="nl">CommandCount:</span> <span class="mi">0</span> <span class="n">LastAdded</span><span class="o">:</span> <span class="o">-</span><span class="mi">1</span> <span class="n">LastDisplayed</span><span class="o">:</span> <span class="o">-</span><span class="mi">1</span>
<span class="nl">FirstCommand:</span> <span class="mi">0</span> <span class="n">CommandCountMax</span><span class="o">:</span> <span class="mi">50</span>
<span class="nl">ProcessHandle:</span> <span class="mh">0xd8</span>
<span class="n">Cmd</span>    <span class="n">Address</span>     <span class="n">Text</span>
<span class="o">---</span> <span class="o">--------------</span> <span class="o">--------------------------------------------------</span>
</pre></div>
</div>

<h1 id="connections" class="anchor">connections</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.connections.Connections-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Print list of open connections [Windows XP Only]</h2>
<hr />
<p>This module enumerates the active connections from tcpip.sys.</p>
<p>Note that if you are using a hibernated image this might not work
because Windows closes all sockets before hibernating. You might
find it more effective to do conscan instead.</p>
<p>Active TCP connections are found in a hash table. The Hash table is given by
the _TCBTable symbol. The size of the hash table is found in the
_MaxHashTableSize variable.</p>
</div>


<h3>Plugin Arguments</h3>
<div class="plugins_args">
<table class='table table-condensed'>
<tbody>
<tr><td><p>tcpip_guid</p></td><td><p>Force this profile to be used for tcpip.</p></td></tr>
</tbody>
</table>
</div>


<p>Prior to Windows 7, the windows TCP/IP stack uses objects of type _TCP_OBJECT to
track TCP endpoints. These are the objects parsed by this module, hence this
module will only be available on images from windows XP.</p>
<p>This module walks the _TCP_OBJECT hash tables and displays information related
to the TCP endpoints.</p>
<h3>Notes</h3>
<ol>
<li>
<p>This plugin depends on exported debugging symbols, and therefore requires the
   correct tcpip profile to be loaded from the profile repository. See the
   <a href="/faq.html#profile">FAQ</a> if you need to generate a profile.</p>
</li>
<li>
<p>For later versions of windows use the <a href="Netscan.html">netscan</a> or the
   <a href="Netstat.html">netstat</a> modules.</p>
</li>
</ol>
<h3>Sample output</h3>
<div class="highlight"><pre><span class="n">xp</span><span class="o">-</span><span class="n">laptop</span><span class="o">-</span><span class="mi">2005</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mf">25.</span><span class="n">img</span> <span class="mi">23</span><span class="o">:</span><span class="mo">00</span><span class="o">:</span><span class="mi">24</span><span class="o">&gt;</span> <span class="n">connections</span>
<span class="o">---------------------------------&gt;</span> <span class="n">connections</span><span class="p">()</span>
<span class="n">Offset</span> <span class="p">(</span><span class="n">V</span><span class="p">)</span> <span class="n">Local</span> <span class="n">Address</span>             <span class="n">Remote</span> <span class="n">Address</span>               <span class="n">Pid</span>
<span class="o">----------</span> <span class="o">-------------------------</span> <span class="o">-------------------------</span> <span class="o">------</span>
<span class="mh">0x820869b0</span> <span class="mf">127.0.0.1</span><span class="o">:</span><span class="mi">1055</span>            <span class="mf">127.0.0.1</span><span class="o">:</span><span class="mi">1056</span>              <span class="mi">2160</span>
<span class="mh">0xffa2baf0</span> <span class="mf">127.0.0.1</span><span class="o">:</span><span class="mi">1056</span>            <span class="mf">127.0.0.1</span><span class="o">:</span><span class="mi">1055</span>              <span class="mi">2160</span>
<span class="mh">0x8220c008</span> <span class="mf">192.168.2.7</span><span class="o">:</span><span class="mi">1077</span>          <span class="mf">64.62.243.144</span><span class="o">:</span><span class="mi">80</span>            <span class="mi">2392</span>
<span class="mh">0x81f11e70</span> <span class="mf">192.168.2.7</span><span class="o">:</span><span class="mi">1082</span>          <span class="mf">205.161.7.134</span><span class="o">:</span><span class="mi">80</span>            <span class="mi">2392</span>
<span class="mh">0x8220d6b8</span> <span class="mf">192.168.2.7</span><span class="o">:</span><span class="mi">1066</span>          <span class="mf">199.239.137.200</span><span class="o">:</span><span class="mi">80</span>          <span class="mi">2392</span>
</pre></div>
</div>

<h1 id="connscan" class="anchor">connscan</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.connscan.ConnScan-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Scan Physical memory for _TCPT_OBJECT objects (tcp connections)</h2>
</div>


<h3>Plugin Arguments</h3>
<div class="plugins_args">
<table class='table table-condensed'>
<tbody>
<tr><td><p>scan_in_kernel</p></td><td><p>Scan in the kernel address space (type: Boolean)</p>
<ul>
<li>Default: False</li>
</ul></td></tr><tr><td><p>tcpip_guid</p></td><td><p>Force this profile to be used for tcpip.</p></td></tr>
</tbody>
</table>
</div>


<p>Similar to the <a href="Connections.html">connections</a> plugin, this plugin searches from
_TCP_OBJECT structs. However, it employs pool scanning techniques.</p>
<h3>Notes</h3>
<ol>
<li>
<p>This plugin only works on versions of winsows prior to Win7.</p>
</li>
<li>
<p>Since the plugin may recover freed pool memory, the data may have been
   overwritten. This might produce garbage results for terminated connections.</p>
</li>
</ol>
<h3>Sample output.</h3>
<p>Note the nonsensical connection for local address <em>3.0.48.2</em> and the incorrect
pid number below.</p>
<div class="highlight"><pre><span class="n">xp</span><span class="o">-</span><span class="n">laptop</span><span class="o">-</span><span class="mi">2005</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mf">25.</span><span class="n">img</span> <span class="mi">23</span><span class="o">:</span><span class="mo">00</span><span class="o">:</span><span class="mi">29</span><span class="o">&gt;</span> <span class="n">connscan</span>
<span class="o">---------------------------------&gt;</span> <span class="n">connscan</span><span class="p">()</span>
<span class="n">Offset</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>  <span class="n">Local</span> <span class="n">Address</span>             <span class="n">Remote</span> <span class="n">Address</span>                   <span class="n">Pid</span>
<span class="o">----------</span> <span class="o">-------------------------</span> <span class="o">-------------------------</span> <span class="o">----------</span>
<span class="mh">0x01370e70</span> <span class="mf">192.168.2.7</span><span class="o">:</span><span class="mi">1115</span>          <span class="mf">207.126.123.29</span><span class="o">:</span><span class="mi">80</span>               <span class="mi">1916</span>
<span class="mh">0x01ed1a50</span> <span class="mf">3.0.48.2</span><span class="o">:</span><span class="mi">17985</span>            <span class="mf">66.179.81.245</span><span class="o">:</span><span class="mi">20084</span>       <span class="mi">4287933200</span>
<span class="mh">0x01f0e358</span> <span class="mf">192.168.2.7</span><span class="o">:</span><span class="mi">1164</span>          <span class="mf">66.179.81.247</span><span class="o">:</span><span class="mi">80</span>                 <span class="mi">944</span>
<span class="mh">0x01f11e70</span> <span class="mf">192.168.2.7</span><span class="o">:</span><span class="mi">1082</span>          <span class="mf">205.161.7.134</span><span class="o">:</span><span class="mi">80</span>                <span class="mi">2392</span>
<span class="mh">0x01f35cd0</span> <span class="mf">192.168.2.7</span><span class="o">:</span><span class="mi">1086</span>          <span class="mf">199.239.137.200</span><span class="o">:</span><span class="mi">80</span>              <span class="mi">1916</span>
<span class="mh">0x01f88e70</span> <span class="mf">192.168.2.7</span><span class="o">:</span><span class="mi">1162</span>          <span class="mf">170.224.8.51</span><span class="o">:</span><span class="mi">80</span>                 <span class="mi">1916</span>
<span class="mh">0x020869b0</span> <span class="mf">127.0.0.1</span><span class="o">:</span><span class="mi">1055</span>            <span class="mf">127.0.0.1</span><span class="o">:</span><span class="mi">1056</span>                  <span class="mi">2160</span>
</pre></div>
</div>

<h1 id="consoles" class="anchor">consoles</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.malware.cmdhistory.Consoles-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Enumerate command consoles.</h2>
</div>



<p>Similar to <a href="CmdScan.html">cmdscan</a> the consoles plugin finds commands that
attackers typed into cmd.exe or executed via backdoors. However, instead of
scanning for <strong>COMMAND_HISTORY</strong>, this plugin scans for
<strong>CONSOLE_INFORMATION</strong>. The major advantage to this plugin is it not only
prints the commands attackers typed, but it collects the entire screen buffer
(input and output). For instance, instead of just seeing &ldquo;dir&rdquo;, you&rsquo;ll see
exactly what the attacker saw, including all files and directories listed by the
&ldquo;dir&rdquo; command.</p>
<p>Additionally, this plugin prints the following:</p>
<ul>
<li>The original console window title and current console window title</li>
<li>The name and pid of attached processes (walks a <strong>LIST_ENTRY</strong> to enumerate
  all of them if more than one)</li>
<li>Any aliases associated with the commands executed. For example, attackers can
  register an alias such that typing &ldquo;hello&rdquo; actually executes &ldquo;cd system&rdquo;</li>
<li>The screen coordinates of the cmd.exe console.</li>
</ul>
<h3>Notes</h3>
<p>This plugin is pretty fragile since it relies on reversed structures in
undocumented code. We are working on improving the situation here but there is a
moderate chance that it will produce no results or garbage results.</p>
<h3>Sample Output</h3>
<div class="highlight"><pre><span class="n">win7</span><span class="p">.</span><span class="n">elf</span> <span class="mi">22</span><span class="o">:</span><span class="mi">23</span><span class="o">:</span><span class="mi">10</span><span class="o">&gt;</span> <span class="n">consoles</span>
<span class="o">**************************************************</span>
<span class="nl">ConsoleProcess:</span> <span class="n">conhost</span><span class="p">.</span><span class="n">exe</span> <span class="n">Pid</span><span class="o">:</span> <span class="mi">2652</span>
<span class="nl">Console:</span> <span class="mh">0xffd96200</span> <span class="n">CommandHistorySize</span><span class="o">:</span> <span class="mi">50</span>
<span class="nl">HistoryBufferCount:</span> <span class="mi">4</span> <span class="n">HistoryBufferMax</span><span class="o">:</span> <span class="mi">4</span>
<span class="nl">OriginalTitle:</span> <span class="n">Console2</span> <span class="n">command</span> <span class="n">window</span>
<span class="nl">Title:</span> <span class="n">Administrator</span><span class="o">:</span> <span class="n">Console2</span> <span class="n">command</span> <span class="n">window</span> <span class="o">-</span> <span class="n">vol</span><span class="p">.</span><span class="n">exe</span>  <span class="o">--</span><span class="n">profile</span> <span class="n">Win7SP1x64</span> <span class="o">--</span><span class="n">file</span> <span class="err">\\</span><span class="p">.</span><span class="err">\</span><span class="n">pmem</span>
<span class="nl">AttachedProcess:</span> <span class="n">vol</span><span class="p">.</span><span class="n">exe</span> <span class="n">Pid</span><span class="o">:</span> <span class="mi">2920</span> <span class="n">Handle</span><span class="o">:</span> <span class="mh">0xd8</span>
<span class="nl">AttachedProcess:</span> <span class="n">vol</span><span class="p">.</span><span class="n">exe</span> <span class="n">Pid</span><span class="o">:</span> <span class="mi">2912</span> <span class="n">Handle</span><span class="o">:</span> <span class="mh">0xd4</span>
<span class="nl">AttachedProcess:</span> <span class="n">cmd</span><span class="p">.</span><span class="n">exe</span> <span class="n">Pid</span><span class="o">:</span> <span class="mi">2644</span> <span class="n">Handle</span><span class="o">:</span> <span class="mh">0x5c</span>
<span class="o">----</span>
<span class="nl">CommandHistory:</span> <span class="mh">0xb4410</span> <span class="n">Application</span><span class="o">:</span> <span class="n">vol</span><span class="p">.</span><span class="n">exe</span> <span class="n">Flags</span><span class="o">:</span> <span class="n">Allocated</span>
<span class="nl">CommandCount:</span> <span class="mi">0</span> <span class="n">LastAdded</span><span class="o">:</span> <span class="o">-</span><span class="mi">1</span> <span class="n">LastDisplayed</span><span class="o">:</span> <span class="o">-</span><span class="mi">1</span>
<span class="nl">FirstCommand:</span> <span class="mi">0</span> <span class="n">CommandCountMax</span><span class="o">:</span> <span class="mi">50</span>
<span class="nl">ProcessHandle:</span> <span class="mh">0xd8</span>
<span class="o">----</span>
<span class="nl">CommandHistory:</span> <span class="mh">0xb40c0</span> <span class="n">Application</span><span class="o">:</span> <span class="n">vol</span><span class="p">.</span><span class="n">exe</span> <span class="n">Flags</span><span class="o">:</span> <span class="n">Allocated</span>
<span class="nl">CommandCount:</span> <span class="mi">0</span> <span class="n">LastAdded</span><span class="o">:</span> <span class="o">-</span><span class="mi">1</span> <span class="n">LastDisplayed</span><span class="o">:</span> <span class="o">-</span><span class="mi">1</span>
<span class="nl">FirstCommand:</span> <span class="mi">0</span> <span class="n">CommandCountMax</span><span class="o">:</span> <span class="mi">50</span>
<span class="nl">ProcessHandle:</span> <span class="mh">0xd4</span>
<span class="o">----</span>
<span class="nl">CommandHistory:</span> <span class="mh">0xb3ee0</span> <span class="n">Application</span><span class="o">:</span> <span class="n">winpmem_1</span><span class="mf">.1</span><span class="o">-</span><span class="n">write</span><span class="p">.</span><span class="n">exe</span> <span class="n">Flags</span><span class="o">:</span>
<span class="nl">CommandCount:</span> <span class="mi">0</span> <span class="n">LastAdded</span><span class="o">:</span> <span class="o">-</span><span class="mi">1</span> <span class="n">LastDisplayed</span><span class="o">:</span> <span class="o">-</span><span class="mi">1</span>
<span class="nl">FirstCommand:</span> <span class="mi">0</span> <span class="n">CommandCountMax</span><span class="o">:</span> <span class="mi">50</span>
<span class="nl">ProcessHandle:</span> <span class="mh">0x0</span>
<span class="o">----</span>
<span class="nl">CommandHistory:</span> <span class="mh">0x7ea40</span> <span class="n">Application</span><span class="o">:</span> <span class="n">cmd</span><span class="p">.</span><span class="n">exe</span> <span class="n">Flags</span><span class="o">:</span> <span class="n">Allocated</span><span class="p">,</span> <span class="n">Reset</span>
<span class="nl">CommandCount:</span> <span class="mi">3</span> <span class="n">LastAdded</span><span class="o">:</span> <span class="mi">2</span> <span class="n">LastDisplayed</span><span class="o">:</span> <span class="mi">2</span>
<span class="nl">FirstCommand:</span> <span class="mi">0</span> <span class="n">CommandCountMax</span><span class="o">:</span> <span class="mi">50</span>
<span class="nl">ProcessHandle:</span> <span class="mh">0x5c</span>
<span class="n">Cmd</span> <span class="err">#</span><span class="mi">0</span> <span class="n">at</span> <span class="mh">0x5ea70</span><span class="o">:</span> <span class="n">cd</span> <span class="err">\</span><span class="n">Users</span><span class="err">\</span><span class="n">a</span><span class="err">\</span><span class="n">Desktop</span>
<span class="n">Cmd</span> <span class="err">#</span><span class="mi">1</span> <span class="n">at</span> <span class="mh">0x5b920</span><span class="o">:</span> <span class="n">winpmem_1</span><span class="mf">.1</span><span class="o">-</span><span class="n">write</span><span class="p">.</span><span class="n">exe</span> <span class="o">-</span><span class="n">w</span> <span class="o">-</span><span class="n">l</span>
<span class="n">Cmd</span> <span class="err">#</span><span class="mi">2</span> <span class="n">at</span> <span class="mh">0xb3e70</span><span class="o">:</span> <span class="n">vol</span><span class="p">.</span><span class="n">exe</span> <span class="o">--</span><span class="n">profile</span> <span class="n">Win7SP1x64</span> <span class="o">--</span><span class="n">file</span> <span class="err">\\</span><span class="p">.</span><span class="err">\</span><span class="n">pmem</span>
<span class="o">----</span>
<span class="n">Screen</span> <span class="mh">0x60ef0</span> <span class="n">X</span><span class="o">:</span><span class="mi">117</span> <span class="n">Y</span><span class="o">:</span><span class="mi">500</span>
<span class="nl">Dump:</span>
<span class="n">Microsoft</span> <span class="n">Windows</span> <span class="p">[</span><span class="n">Version</span> <span class="mf">6.1.7600</span><span class="p">]</span>
<span class="n">Copyright</span> <span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="mi">2009</span> <span class="n">Microsoft</span> <span class="n">Corporation</span><span class="p">.</span>  <span class="n">All</span> <span class="n">rights</span> <span class="n">reserved</span><span class="p">.</span>

<span class="nl">C:</span><span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">system32</span><span class="o">&gt;</span><span class="n">cd</span> <span class="err">\</span><span class="n">Users</span><span class="err">\</span><span class="n">a</span><span class="err">\</span><span class="n">Desktop</span>

<span class="nl">C:</span><span class="err">\</span><span class="n">Users</span><span class="err">\</span><span class="n">a</span><span class="err">\</span><span class="n">Desktop</span><span class="o">&gt;</span><span class="n">winpmem_1</span><span class="mf">.1</span><span class="o">-</span><span class="n">write</span><span class="p">.</span><span class="n">exe</span> <span class="o">-</span><span class="n">w</span> <span class="o">-</span><span class="n">l</span>
<span class="n">Will</span> <span class="n">enable</span> <span class="n">write</span> <span class="n">mode</span>
<span class="n">Loaded</span> <span class="n">Driver</span><span class="p">.</span>

<span class="nl">C:</span><span class="err">\</span><span class="n">Users</span><span class="err">\</span><span class="n">a</span><span class="err">\</span><span class="n">Desktop</span><span class="o">&gt;</span><span class="n">vol</span><span class="p">.</span><span class="n">exe</span> <span class="o">--</span><span class="n">profile</span> <span class="n">Win7SP1x64</span> <span class="o">--</span><span class="n">file</span> <span class="err">\\</span><span class="p">.</span><span class="err">\</span><span class="n">pmem</span>
<span class="n">Python</span> <span class="mf">2.7.3</span> <span class="p">(</span><span class="k">default</span><span class="p">,</span> <span class="n">Apr</span> <span class="mi">10</span> <span class="mi">2012</span><span class="p">,</span> <span class="mi">23</span><span class="o">:</span><span class="mi">31</span><span class="o">:</span><span class="mi">26</span><span class="p">)</span> <span class="p">[</span><span class="n">MSC</span> <span class="n">v</span><span class="mf">.1500</span> <span class="mi">32</span> <span class="n">bit</span> <span class="p">(</span><span class="n">Intel</span><span class="p">)]</span>
<span class="n">Type</span> <span class="s">&quot;copyright&quot;</span><span class="p">,</span> <span class="s">&quot;credits&quot;</span> <span class="n">or</span> <span class="s">&quot;license&quot;</span> <span class="k">for</span> <span class="n">more</span> <span class="n">information</span><span class="p">.</span>

<span class="n">IPython</span> <span class="mf">0.12.1</span> <span class="o">--</span> <span class="n">An</span> <span class="n">enhanced</span> <span class="n">Interactive</span> <span class="n">Python</span><span class="p">.</span>
<span class="o">?</span>         <span class="o">-&gt;</span> <span class="n">Introduction</span> <span class="n">and</span> <span class="n">overview</span> <span class="n">of</span> <span class="n">IPython</span><span class="err">&#39;</span><span class="n">s</span> <span class="n">features</span><span class="p">.</span>
<span class="o">%</span><span class="n">quickref</span> <span class="o">-&gt;</span> <span class="n">Quick</span> <span class="n">reference</span><span class="p">.</span>
<span class="n">help</span>      <span class="o">-&gt;</span> <span class="n">Python</span><span class="err">&#39;</span><span class="n">s</span> <span class="n">own</span> <span class="n">help</span> <span class="n">system</span><span class="p">.</span>
<span class="n">object</span><span class="o">?</span>   <span class="o">-&gt;</span> <span class="n">Details</span> <span class="n">about</span> <span class="err">&#39;</span><span class="n">object</span><span class="err">&#39;</span><span class="p">,</span> <span class="n">use</span> <span class="err">&#39;</span><span class="n">object</span><span class="o">??</span><span class="err">&#39;</span> <span class="k">for</span> <span class="n">extra</span> <span class="n">details</span><span class="p">.</span>


<span class="n">The</span> <span class="n">Volatility</span> <span class="n">Memory</span> <span class="n">Forensic</span> <span class="n">Framework</span> <span class="n">technology</span> <span class="n">preview</span> <span class="p">(</span><span class="mf">3.0</span><span class="n">_tp2</span><span class="p">).</span>

<span class="nl">NOTE:</span> <span class="n">This</span> <span class="n">is</span> <span class="n">pre</span><span class="o">-</span><span class="n">release</span> <span class="n">software</span> <span class="n">and</span> <span class="n">is</span> <span class="n">provided</span> <span class="k">for</span> <span class="n">evauation</span> <span class="n">only</span><span class="p">.</span> <span class="n">Please</span>
<span class="n">check</span> <span class="n">at</span> <span class="n">http</span><span class="o">:</span><span class="c1">//volatility.googlecode.com/ for officially supported versions.</span>

<span class="n">This</span> <span class="n">program</span> <span class="n">is</span> <span class="n">free</span> <span class="n">software</span><span class="p">;</span> <span class="n">you</span> <span class="n">can</span> <span class="n">redistribute</span> <span class="n">it</span> <span class="n">and</span><span class="o">/</span><span class="n">or</span> <span class="n">modify</span> <span class="n">it</span> <span class="n">under</span>
<span class="n">the</span> <span class="n">terms</span> <span class="n">of</span> <span class="n">the</span> <span class="n">GNU</span> <span class="n">General</span> <span class="n">Public</span> <span class="n">License</span><span class="p">.</span>
<span class="nl">Win7SP1x64:</span><span class="n">pmem</span> <span class="mo">07</span><span class="o">:</span><span class="mi">41</span><span class="o">:</span><span class="mi">08</span><span class="o">&gt;</span> <span class="n">pslist</span>
<span class="o">------------------------&gt;</span> <span class="n">pslist</span><span class="p">()</span>
  <span class="n">Offset</span> <span class="p">(</span><span class="n">V</span><span class="p">)</span>   <span class="n">Name</span>                    <span class="n">PID</span>   <span class="n">PPID</span>   <span class="n">Thds</span>     <span class="n">Hnds</span>   <span class="n">Sess</span>  <span class="n">Wow64</span> <span class="n">Start</span>                <span class="n">Exit</span>

<span class="o">--------------</span> <span class="o">--------------------</span> <span class="o">------</span> <span class="o">------</span> <span class="o">------</span> <span class="o">--------</span> <span class="o">------</span> <span class="o">------</span> <span class="o">--------------------</span> <span class="o">----------------</span>
<span class="o">----</span>
<span class="mh">0xfa80008959e0</span> <span class="n">System</span>                    <span class="mi">4</span>      <span class="mi">0</span>     <span class="mi">85</span>      <span class="mi">502</span> <span class="o">------</span>  <span class="n">False</span> <span class="mi">2012</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mo">01</span> <span class="mi">21</span><span class="o">:</span><span class="mi">39</span><span class="o">:</span><span class="mi">51</span>  <span class="o">-</span>

<span class="mh">0xfa8001994310</span> <span class="n">smss</span><span class="p">.</span><span class="n">exe</span>                <span class="mi">272</span>      <span class="mi">4</span>      <span class="mi">2</span>       <span class="mi">29</span> <span class="o">------</span>  <span class="n">False</span> <span class="mi">2012</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mo">01</span> <span class="mi">21</span><span class="o">:</span><span class="mi">39</span><span class="o">:</span><span class="mi">51</span>  <span class="o">-</span>
</pre></div>
</div>

<h1 id="devicetree" class="anchor">devicetree</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.malware.devicetree.DeviceTree-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Show device tree.</h2>
</div>


<h3>Plugin Arguments</h3>
<div class="plugins_args">
<table class='table table-condensed'>
<tbody>
<tr><td><p>scan_in_kernel</p></td><td><p>Scan in the kernel address space (type: Boolean)</p>
<ul>
<li>Default: False</li>
</ul></td></tr>
</tbody>
</table>
</div>


<p>Windows uses a layered driver architecture, or driver chain so that multiple
drivers can inspect or respond to an IRP. Rootkits often insert drivers (or
devices) into this chain for filtering purposes (to hide files, hide network
connections, steal keystrokes or mouse movements). The devicetree plugin shows
the relationship of a driver object to its devices (by walking
_DRIVER_OBJECT.DeviceObject.NextDevice) and any attached devices
(_DRIVER_OBJECT.DeviceObject.AttachedDevice).</p>
<h3>Notes</h3>
<p>In the current implementation this plugin uses scanning methods to locate the
driver and device objects. This is an inefficient method which is also
susceptible to false positives and active subversion. We are working on
converting this plugin to use the <a href="ObjectTree.html">object_tree</a> plugin to
directly parse kernel driver structures.</p>
<h3>Sample output</h3>
<div class="highlight"><pre><span class="k">[snip]</span>
<span class="err">DRV</span> <span class="err">0x2bb31060</span> <span class="err">\Driver\winpmem</span>
<span class="err">---|</span> <span class="err">DEV</span> <span class="err">0xfa80019ba060</span> <span class="err">pmem</span> <span class="err">FILE_DEVICE_UNKNOWN</span>
<span class="err">DRV</span> <span class="err">0x2bb36600</span> <span class="err">\Driver\TermDD</span>
<span class="err">---|</span> <span class="err">DEV</span> <span class="err">0xfa80019ff040</span> <span class="err">-</span> <span class="err">FILE_DEVICE_8042_PORT</span>
<span class="err">------|</span> <span class="err">ATT</span> <span class="err">0xfa80019ff980</span> <span class="err">-</span> <span class="err">-</span> <span class="err">\Driver\mouclass</span> <span class="err">FILE_DEVICE_MOUSE</span>
<span class="err">---|</span> <span class="err">DEV</span> <span class="err">0xfa80019e2040</span> <span class="err">-</span> <span class="err">FILE_DEVICE_8042_PORT</span>
<span class="err">------|</span> <span class="err">ATT</span> <span class="err">0xfa80019e2960</span> <span class="err">-</span> <span class="err">-</span> <span class="err">\Driver\kbdclass</span> <span class="err">FILE_DEVICE_KEYBOARD</span>
<span class="k">[snip]</span>
</pre></div>


<p>In the above we can see that the winpmem driver has a device called &ldquo;pmem&rdquo;. We
also can see the mouse and keyboard drivers attached to the terminal services
driver.</p>
</div>

<h1 id="dis" class="anchor">dis</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.tools.disassembler.Disassemble-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Disassemble the given offset.</h2>
</div>


<h3>Plugin Arguments</h3>
<div class="plugins_args">
<table class='table table-condensed'>
<tbody>
<tr><td><p>address_space</p></td><td><p>The address space to use.</p></td></tr><tr><td><p>branch</p></td><td><p>If set we follow all branches to cover all code. (type: Boolean)</p>
<ul>
<li>Default: False</li>
</ul></td></tr><tr><td><p>canonical</p></td><td><p>If set emit canonical instructions. These can be used to develop signatures. (type: Boolean)</p>
<ul>
<li>Default: False</li>
</ul></td></tr><tr><td><p>end</p></td><td><p>The end address to disassemble up to. (type: IntParser)</p></td></tr><tr><td><p>length</p></td><td><p>The number of instructions (lines) to disassemble. (type: IntParser)</p></td></tr><tr><td><p>mode</p></td><td><p>Disassemble Mode (AMD64 or I386). Defaults to &lsquo;auto&rsquo;. (type: Choices)</p>
<ul>
<li>
<p>Valid Choices:</p>
<ul>
<li>auto</li>
<li>I386</li>
<li>AMD64</li>
<li>MIPS</li>
</ul>
</li>
<li>
<p>Default: auto</p>
</li>
</ul></td></tr><tr><td><p>offset</p></td><td><p>An offset to disassemble. This can also be the name of a symbol with an optional offset. For example: tcpip!TcpCovetNetBufferList. (type: SymbolAddress)</p></td></tr><tr><td><p>suppress_headers</p></td><td><p>If set we do not write table headers. (type: Boolean)</p>
<ul>
<li>Default: False</li>
</ul></td></tr>
</tbody>
</table>
</div>


<p>This plugin is used to disassemble memory regions. The offset to disassemble may be given as:</p>
<ul>
<li>
<p>An address in the current default address space (See the
  <a href="SetProcessContext.html">cc</a> plugin for an explaination of the default address
  space).</p>
</li>
<li>
<p>The name of a kernel module with an optional symbol name. The symbol may be an
  experted symbol, or non-exported symbol as defined in the pdb file for that
  kernel module.</p>
</li>
</ul>
<h3>Notes</h3>
<ol>
<li>
<p>When using the interactive console you can complete symbol names by double
   tapping the [tab] key. For example <strong>dis &ldquo;nt!KiSetTi[tab][tab]</strong>.</p>
</li>
<li>
<p>Rekall attempts to resolve addresses in the disassembly back to known symbol
   names. Additionally, for indirect operations, Rekall also prints the current
   value of the memory location. This feature is especially useful for
   understanding where indirect jumps are going - without needing to consider PE
   import tables etc. This works since the IAT is already patched into memory,
   hence Rekall can completely ignore IAT resoltion (unlike a standalone PE
   analyser like IDA).</p>
</li>
</ol>
<h3>Sample output</h3>
<p>Here we disassemble the kernel function <strong>KiSetTimerEx</strong> to observe the DPC
pointer obfuscation that Patch Guard uses on 64 bit Windows 7. We can see the
names of the symbols used and their current values, as well as the name of
internally called functions.</p>
<div class="highlight"><pre><span class="n">win7</span><span class="p">.</span><span class="n">elf</span> <span class="mi">23</span><span class="o">:</span><span class="mi">48</span><span class="o">:</span><span class="mi">14</span><span class="o">&gt;</span> <span class="n">dis</span> <span class="s">&quot;nt!KiSetTimerEx&quot;</span>
<span class="o">-----------------&gt;</span> <span class="n">dis</span><span class="p">(</span><span class="s">&quot;nt!KiSetTimerEx&quot;</span><span class="p">)</span>
   <span class="n">Address</span>      <span class="n">Rel</span> <span class="n">Op</span> <span class="n">Codes</span>             <span class="n">Instruction</span>                    <span class="n">Comment</span>
<span class="o">--------------</span> <span class="o">----</span> <span class="o">--------------------</span> <span class="o">------------------------------</span> <span class="o">-------</span>
<span class="o">------</span> <span class="n">nt</span><span class="o">!</span><span class="n">KiSetTimerEx</span> <span class="o">------</span>
<span class="mh">0xf8000269d4f0</span>    <span class="mi">0</span> <span class="mi">48895</span><span class="n">c2408</span>           <span class="n">MOV</span> <span class="p">[</span><span class="n">RSP</span><span class="o">+</span><span class="mh">0x8</span><span class="p">],</span> <span class="n">RBX</span>
<span class="mh">0xf8000269d4f5</span>    <span class="mi">5</span> <span class="mi">4889542410</span>           <span class="n">MOV</span> <span class="p">[</span><span class="n">RSP</span><span class="o">+</span><span class="mh">0x10</span><span class="p">],</span> <span class="n">RDX</span>
<span class="mh">0xf8000269d4fa</span>    <span class="n">A</span> <span class="mi">55</span>                   <span class="n">PUSH</span> <span class="n">RBP</span>
<span class="mh">0xf8000269d4fb</span>    <span class="n">B</span> <span class="mi">56</span>                   <span class="n">PUSH</span> <span class="n">RSI</span>
<span class="mh">0xf8000269d4fc</span>    <span class="n">C</span> <span class="mi">57</span>                   <span class="n">PUSH</span> <span class="n">RDI</span>
<span class="mh">0xf8000269d4fd</span>    <span class="n">D</span> <span class="mi">4154</span>                 <span class="n">PUSH</span> <span class="n">R12</span>
<span class="mh">0xf8000269d4ff</span>    <span class="n">F</span> <span class="mi">4155</span>                 <span class="n">PUSH</span> <span class="n">R13</span>
<span class="mh">0xf8000269d501</span>   <span class="mi">11</span> <span class="mi">4156</span>                 <span class="n">PUSH</span> <span class="n">R14</span>
<span class="mh">0xf8000269d503</span>   <span class="mi">13</span> <span class="mi">4157</span>                 <span class="n">PUSH</span> <span class="n">R15</span>
<span class="mh">0xf8000269d505</span>   <span class="mi">15</span> <span class="mi">4883</span><span class="n">ec50</span>             <span class="n">SUB</span> <span class="n">RSP</span><span class="p">,</span> <span class="mh">0x50</span>
<span class="mh">0xf8000269d509</span>   <span class="mi">19</span> <span class="mi">488</span><span class="n">b05f09b2200</span>       <span class="n">MOV</span> <span class="n">RAX</span><span class="p">,</span> <span class="p">[</span><span class="n">RIP</span><span class="o">+</span><span class="mh">0x229bf0</span><span class="p">]</span>        <span class="mh">0x6D7CFFA404933FBB</span> <span class="n">nt</span><span class="o">!</span><span class="n">KiWaitNever</span>
<span class="mh">0xf8000269d510</span>   <span class="mi">20</span> <span class="mi">488</span><span class="n">b1dc19c2200</span>       <span class="n">MOV</span> <span class="n">RBX</span><span class="p">,</span> <span class="p">[</span><span class="n">RIP</span><span class="o">+</span><span class="mh">0x229cc1</span><span class="p">]</span>        <span class="mh">0x933DD660CFFF8004</span> <span class="n">nt</span><span class="o">!</span><span class="n">KiWaitAlways</span>
<span class="mh">0xf8000269d517</span>   <span class="mi">27</span> <span class="mi">4</span><span class="n">c8bb424b0000000</span>     <span class="n">MOV</span> <span class="n">R14</span><span class="p">,</span> <span class="p">[</span><span class="n">RSP</span><span class="o">+</span><span class="mh">0xb0</span><span class="p">]</span>
<span class="mh">0xf8000269d51f</span>   <span class="mf">2F</span> <span class="mi">4933</span><span class="n">de</span>               <span class="n">XOR</span> <span class="n">RBX</span><span class="p">,</span> <span class="n">R14</span>
<span class="mh">0xf8000269d522</span>   <span class="mi">32</span> <span class="mi">488</span><span class="n">bf1</span>               <span class="n">MOV</span> <span class="n">RSI</span><span class="p">,</span> <span class="n">RCX</span>
<span class="mh">0xf8000269d525</span>   <span class="mi">35</span> <span class="mf">450f</span><span class="n">b6f9</span>             <span class="n">MOVZX</span> <span class="n">R15D</span><span class="p">,</span> <span class="n">R9B</span>
<span class="mh">0xf8000269d529</span>   <span class="mi">39</span> <span class="mf">480f</span><span class="n">cb</span>               <span class="n">BSWAP</span> <span class="n">RBX</span>
<span class="mh">0xf8000269d52c</span>   <span class="mi">3</span><span class="n">C</span> <span class="mi">418</span><span class="n">bf8</span>               <span class="n">MOV</span> <span class="n">EDI</span><span class="p">,</span> <span class="n">R8D</span>
<span class="mh">0xf8000269d52f</span>   <span class="mf">3F</span> <span class="mi">4833</span><span class="n">d9</span>               <span class="n">XOR</span> <span class="n">RBX</span><span class="p">,</span> <span class="n">RCX</span>
<span class="mh">0xf8000269d532</span>   <span class="mi">42</span> <span class="mi">8</span><span class="n">bc8</span>                 <span class="n">MOV</span> <span class="n">ECX</span><span class="p">,</span> <span class="n">EAX</span>
<span class="mh">0xf8000269d534</span>   <span class="mi">44</span> <span class="mi">48</span><span class="n">d3cb</span>               <span class="n">ROR</span> <span class="n">RBX</span><span class="p">,</span> <span class="n">CL</span>
<span class="mh">0xf8000269d537</span>   <span class="mi">47</span> <span class="mi">4833</span><span class="n">d8</span>               <span class="n">XOR</span> <span class="n">RBX</span><span class="p">,</span> <span class="n">RAX</span>
<span class="mh">0xf8000269d53a</span>   <span class="mi">4</span><span class="n">A</span> <span class="mf">450f</span><span class="mi">20</span><span class="n">c4</span>             <span class="n">MOV</span> <span class="n">R12</span><span class="p">,</span> <span class="n">CR8</span>
<span class="mh">0xf8000269d53e</span>   <span class="mi">4</span><span class="n">E</span> <span class="n">b802000000</span>           <span class="n">MOV</span> <span class="n">EAX</span><span class="p">,</span> <span class="mh">0x2</span>
<span class="mh">0xf8000269d543</span>   <span class="mi">53</span> <span class="mf">440f</span><span class="mi">22</span><span class="n">c0</span>             <span class="n">MOV</span> <span class="n">CR8</span><span class="p">,</span> <span class="n">RAX</span>
<span class="mh">0xf8000269d547</span>   <span class="mi">57</span> <span class="mi">65488</span><span class="n">b2c2520000000</span>   <span class="n">MOV</span> <span class="n">RBP</span><span class="p">,</span> <span class="p">[</span><span class="n">GS</span><span class="o">:</span><span class="mh">0x20</span><span class="p">]</span>
<span class="mh">0xf8000269d550</span>   <span class="mi">60</span> <span class="mi">33</span><span class="n">d2</span>                 <span class="n">XOR</span> <span class="n">EDX</span><span class="p">,</span> <span class="n">EDX</span>
<span class="mh">0xf8000269d552</span>   <span class="mi">62</span> <span class="mi">488</span><span class="n">bce</span>               <span class="n">MOV</span> <span class="n">RCX</span><span class="p">,</span> <span class="n">RSI</span>
<span class="mh">0xf8000269d555</span>   <span class="mi">65</span> <span class="n">e8f6b0ffff</span>           <span class="n">CALL</span> <span class="mh">0xf80002698650</span>            <span class="n">nt</span><span class="o">!</span><span class="n">KiCancelTimer</span>
<span class="mh">0xf8000269d55a</span>   <span class="mi">6</span><span class="n">A</span> <span class="mf">48895e30</span>             <span class="n">MOV</span> <span class="p">[</span><span class="n">RSI</span><span class="o">+</span><span class="mh">0x30</span><span class="p">],</span> <span class="n">RBX</span>
</pre></div>
</div>

<h1 id="dlldump" class="anchor">dlldump</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.procdump.DLLDump-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Dump DLLs from a process address space</h2>
</div>


<h3>Plugin Arguments</h3>
<div class="plugins_args">
<table class='table table-condensed'>
<tbody>
<tr><td><p>dump_dir</p></td><td><p>Path suitable for dumping files. (Default: Use current directory)</p></td></tr><tr><td><p>eprocess</p></td><td><p>Kernel addresses of eprocess structs. (type: ArrayIntParser)</p></td></tr><tr><td><p>method</p></td><td><p>Method to list processes. (type: ChoiceArray)</p>
<ul>
<li>
<p>Valid Choices:</p>
<ul>
<li>PsActiveProcessHead</li>
<li>CSRSS</li>
<li>PspCidTable</li>
<li>Sessions</li>
<li>Handles</li>
</ul>
</li>
<li>
<p>Default: PsActiveProcessHead, CSRSS, PspCidTable, Sessions, Handles</p>
</li>
</ul></td></tr><tr><td><p>out_fd</p></td><td><p>A file like object to write the output.</p></td></tr><tr><td><p>phys_eprocess</p></td><td><p>Physical addresses of eprocess structs. (type: ArrayIntParser)</p></td></tr><tr><td><p>pid</p></td><td><p>One or more pids of processes to select. (type: ArrayIntParser)</p></td></tr><tr><td><p>proc_regex</p></td><td><p>A regex to select a process by name. (type: RegEx)</p></td></tr><tr><td><p>regex</p></td><td><p>A Regular expression for selecting the dlls to dump.</p>
<ul>
<li>Default: .+</li>
</ul></td></tr>
</tbody>
</table>
</div>


<p>To extract a DLL from a process&rsquo;s memory space and dump it to disk for analysis,
use the dlldump command. All the usual process selectors are
supported. Additionally a regular expression can be specified for the DLL name
to dump.</p>
<h3>Note</h3>
<ol>
<li>
<p>In order to dump any PE file from memory we need the PE header to be memory
   resident. Often this is not the case, and the header is flushed out of
   virtual memory. In this case it is still possible to dump parts of the PE
   image using the <a href="VADDump.html">vaddump</a> plugin.</p>
</li>
<li>
<p>When dumping any binary from memory, it is not usually a perfect binary
   (i.e. you can not just run it). This is because the Import Address Table
   (IAT) reflects the patched version in memory and some pages may be
   missing. The resultant binary is probably only useful to analyses using a
   tool like IDA pro.</p>
</li>
</ol>
<h3>Sample output</h3>
<div class="highlight"><pre><span class="n">win8</span><span class="mf">.1</span><span class="p">.</span><span class="n">raw</span> <span class="mi">14</span><span class="o">:</span><span class="mi">51</span><span class="o">:</span><span class="mi">37</span><span class="o">&gt;</span> <span class="n">dlldump</span> <span class="n">proc_regex</span><span class="o">=</span><span class="s">&quot;winpmem&quot;</span><span class="p">,</span> <span class="n">dump_dir</span><span class="o">=</span><span class="s">&quot;/tmp/&quot;</span>
<span class="o">-------------------&gt;</span> <span class="n">dlldump</span><span class="p">(</span><span class="n">proc_regex</span><span class="o">=</span><span class="s">&quot;winpmem&quot;</span><span class="p">,</span> <span class="n">dump_dir</span><span class="o">=</span><span class="s">&quot;/tmp/&quot;</span><span class="p">)</span>
  <span class="n">_EPROCESS</span>    <span class="n">Name</span>                  <span class="n">Base</span>      <span class="n">Module</span>               <span class="n">Dump</span> <span class="n">File</span>
<span class="o">--------------</span> <span class="o">----------------</span> <span class="o">--------------</span> <span class="o">--------------------</span> <span class="o">---------</span>
<span class="mh">0xe0000204a900</span> <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>   <span class="mh">0x000000020000</span> <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span><span class="n">exe</span>    <span class="n">module</span><span class="mf">.2628.3</span><span class="n">d04a900</span><span class="mf">.20000</span><span class="p">.</span><span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span><span class="n">exe</span>
<span class="mh">0xe0000204a900</span> <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>   <span class="mh">0x7ff87f320000</span> <span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span>            <span class="n">module</span><span class="mf">.2628.3</span><span class="n">d04a900</span><span class="mf">.7f</span><span class="n">f87f320000</span><span class="p">.</span><span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span>
<span class="mh">0xe0000204a900</span> <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>   <span class="mh">0x000076f50000</span> <span class="n">wow64</span><span class="p">.</span><span class="n">dll</span>            <span class="n">module</span><span class="mf">.2628.3</span><span class="n">d04a900</span><span class="mf">.76f50000.</span><span class="n">wow64</span><span class="p">.</span><span class="n">dll</span>
<span class="mh">0xe0000204a900</span> <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>   <span class="mh">0x000076fa0000</span> <span class="n">wow64win</span><span class="p">.</span><span class="n">dll</span>         <span class="n">module</span><span class="mf">.2628.3</span><span class="n">d04a900</span><span class="mf">.76f</span><span class="n">a0000</span><span class="p">.</span><span class="n">wow64win</span><span class="p">.</span><span class="n">dll</span>
<span class="mh">0xe0000204a900</span> <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>   <span class="mh">0x000077010000</span> <span class="n">wow64cpu</span><span class="p">.</span><span class="n">dll</span>         <span class="n">module</span><span class="mf">.2628.3</span><span class="n">d04a900</span><span class="mf">.77010000</span><span class="p">.</span><span class="n">wow64cpu</span><span class="p">.</span><span class="n">dll</span>
</pre></div>
</div>

<h1 id="dlllist" class="anchor">dlllist</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.taskmods.WinDllList-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Prints a list of dll modules mapped into each process.</h2>
</div>


<h3>Plugin Arguments</h3>
<div class="plugins_args">
<table class='table table-condensed'>
<tbody>
<tr><td><p>eprocess</p></td><td><p>Kernel addresses of eprocess structs. (type: ArrayIntParser)</p></td></tr><tr><td><p>method</p></td><td><p>Method to list processes. (type: ChoiceArray)</p>
<ul>
<li>
<p>Valid Choices:</p>
<ul>
<li>PsActiveProcessHead</li>
<li>CSRSS</li>
<li>PspCidTable</li>
<li>Sessions</li>
<li>Handles</li>
</ul>
</li>
<li>
<p>Default: PsActiveProcessHead, CSRSS, PspCidTable, Sessions, Handles</p>
</li>
</ul></td></tr><tr><td><p>phys_eprocess</p></td><td><p>Physical addresses of eprocess structs. (type: ArrayIntParser)</p></td></tr><tr><td><p>pid</p></td><td><p>One or more pids of processes to select. (type: ArrayIntParser)</p></td></tr><tr><td><p>proc_regex</p></td><td><p>A regex to select a process by name. (type: RegEx)</p></td></tr>
</tbody>
</table>
</div>


<p>Lists dll modules loaded into a process by following the doubly linked list of
<strong>LDR_DATA_TABLE_ENTRY</strong> stored in in
<strong>_EPROCESS.Peb.Ldr.InLoadOrderModuleList</strong>. DLLs are automatically added to
this list when a process calls <em>LoadLibrary</em> (or some derivative such as
<em>LdrLoadDll</em>) and they aren&rsquo;t removed until <em>FreeLibrary</em> is called and the
reference count reaches zero.</p>
<p>All the usual process selectors are supported.</p>
<h3>Note</h3>
<ol>
<li>
<p>Wow64 processes (i.e. 32 bit binaries running on 64 bit windows) load dlls
   through a different mechanism.</p>
</li>
<li>
<p>Since the <strong>InLoadOrderModuleList</strong> is maintained in the process address
   space, it is simple to manipulate from Ring 3 (without kernel access). This
   means that this plugin may not show all the linked in DLLs.</p>
</li>
<li>
<p>A better plugin to use is the <a href="LdrModules.html">ldrmodules</a> plugin, which
   uses the VAD to enumerate dlls. The VAD is maintained in kernel memory and
   therefore can only be accessed through Ring 0 access.</p>
</li>
</ol>
<h3>Sample output</h3>
<p>Below we see winpmem used to acquire the image of this Windows 8.1 system. Since
winpmem is a 32 bit application, we see the wow64.dll dynamically loaded. Note
that in this case, the 32 bit dlls will not show in the
<strong>InLoadOrderModuleList</strong>. Using the <a href="LdrModules.html">ldrmodules</a> plugin
reveals all the 32 bit dlls loaded.</p>
<div class="highlight"><pre><span class="n">win8</span><span class="mf">.1</span><span class="p">.</span><span class="n">raw</span> <span class="mi">15</span><span class="o">:</span><span class="mi">35</span><span class="o">:</span><span class="mi">10</span><span class="o">&gt;</span> <span class="n">dlllist</span> <span class="n">proc_regex</span><span class="o">=</span><span class="s">&quot;winpmem&quot;</span>
<span class="o">-------------------&gt;</span> <span class="n">dlllist</span><span class="p">(</span><span class="n">proc_regex</span><span class="o">=</span><span class="s">&quot;winpmem&quot;</span><span class="p">)</span>
<span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span> <span class="n">pid</span><span class="o">:</span> <span class="mi">2628</span>
<span class="n">Command</span> <span class="n">line</span> <span class="o">:</span> <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span><span class="n">exe</span>  <span class="o">-</span><span class="mi">2</span> <span class="n">win8</span><span class="mf">.1</span><span class="p">.</span><span class="n">raw</span>
<span class="nl">Note:</span> <span class="n">use</span> <span class="n">ldrmodules</span> <span class="k">for</span> <span class="n">listing</span> <span class="n">DLLs</span> <span class="n">in</span> <span class="n">Wow64</span> <span class="n">processes</span>


     <span class="n">Base</span>           <span class="n">Size</span>      <span class="n">Load</span> <span class="n">Reason</span><span class="o">/</span><span class="n">Count</span>              <span class="n">Path</span>
<span class="o">--------------</span> <span class="o">--------------</span> <span class="o">------------------------------</span> <span class="o">----</span>
<span class="mh">0x000000020000</span>        <span class="mh">0x2d000</span> <span class="n">LoadReasonStaticDependency</span>     <span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">temp</span><span class="err">\</span><span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span><span class="n">exe</span>
<span class="mh">0x7ff87f320000</span>       <span class="mh">0x1a9000</span> <span class="n">LoadReasonStaticDependency</span>     <span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SYSTEM32</span><span class="err">\</span><span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span>
<span class="mh">0x000076f50000</span>        <span class="mh">0x49000</span> <span class="n">LoadReasonDynamicLoad</span>          <span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SYSTEM32</span><span class="err">\</span><span class="n">wow64</span><span class="p">.</span><span class="n">dll</span>
<span class="mh">0x000076fa0000</span>        <span class="mh">0x68000</span> <span class="n">LoadReasonStaticDependency</span>     <span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">system32</span><span class="err">\</span><span class="n">wow64win</span><span class="p">.</span><span class="n">dll</span>
<span class="mh">0x000077010000</span>         <span class="mh">0x9000</span> <span class="n">LoadReasonStaticDependency</span>     <span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">system32</span><span class="err">\</span><span class="n">wow64cpu</span><span class="p">.</span><span class="n">dll</span>
<span class="n">win8</span><span class="mf">.1</span><span class="p">.</span><span class="n">raw</span> <span class="mi">15</span><span class="o">:</span><span class="mi">35</span><span class="o">:</span><span class="mi">51</span><span class="o">&gt;</span> <span class="n">ldrmodules</span> <span class="n">proc_regex</span><span class="o">=</span><span class="s">&quot;winpmem&quot;</span>
<span class="o">-------------------&gt;</span> <span class="n">ldrmodules</span><span class="p">(</span><span class="n">proc_regex</span><span class="o">=</span><span class="s">&quot;winpmem&quot;</span><span class="p">)</span>
<span class="n">Pid</span>      <span class="n">Process</span>                   <span class="n">Base</span>      <span class="n">InLoad</span> <span class="n">InInit</span> <span class="n">InMem</span> <span class="n">MappedPath</span>
<span class="o">--------</span> <span class="o">--------------------</span> <span class="o">--------------</span> <span class="o">------</span> <span class="o">------</span> <span class="o">-----</span> <span class="o">----------</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x0000753b0000</span> <span class="n">False</span> <span class="n">False</span> <span class="n">False</span> <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">KernelBase</span><span class="p">.</span><span class="n">dll</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x000000020000</span> <span class="n">True</span>  <span class="n">False</span> <span class="n">True</span>  <span class="err">\</span><span class="n">temp</span><span class="err">\</span><span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span><span class="n">exe</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x000076c30000</span> <span class="n">False</span> <span class="n">False</span> <span class="n">False</span> <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">kernel32</span><span class="p">.</span><span class="n">dll</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x000074a40000</span> <span class="n">False</span> <span class="n">False</span> <span class="n">False</span> <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">cryptbase</span><span class="p">.</span><span class="n">dll</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x000074a50000</span> <span class="n">False</span> <span class="n">False</span> <span class="n">False</span> <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">sspicli</span><span class="p">.</span><span class="n">dll</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x000077010000</span> <span class="n">True</span>  <span class="n">True</span>  <span class="n">True</span>  <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">wow64cpu</span><span class="p">.</span><span class="n">dll</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x000076f50000</span> <span class="n">True</span>  <span class="n">True</span>  <span class="n">True</span>  <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">wow64</span><span class="p">.</span><span class="n">dll</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x000076fa0000</span> <span class="n">True</span>  <span class="n">True</span>  <span class="n">True</span>  <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">wow64win</span><span class="p">.</span><span class="n">dll</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x000075250000</span> <span class="n">False</span> <span class="n">False</span> <span class="n">False</span> <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">rpcrt4</span><span class="p">.</span><span class="n">dll</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x0ff87f320000</span> <span class="n">False</span> <span class="n">False</span> <span class="n">False</span> <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x000077020000</span> <span class="n">False</span> <span class="n">False</span> <span class="n">False</span> <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x0000749e0000</span> <span class="n">False</span> <span class="n">False</span> <span class="n">False</span> <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">bcryptprimitives</span><span class="p">.</span><span class="n">dll</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x000074ff0000</span> <span class="n">False</span> <span class="n">False</span> <span class="n">False</span> <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">advapi32</span><span class="p">.</span><span class="n">dll</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x000076f10000</span> <span class="n">False</span> <span class="n">False</span> <span class="n">False</span> <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">sechost</span><span class="p">.</span><span class="n">dll</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x000074d80000</span> <span class="n">False</span> <span class="n">False</span> <span class="n">False</span> <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">msvcrt</span><span class="p">.</span><span class="n">dll</span>
</pre></div>
</div>

<h1 id="driverirp" class="anchor">driverirp</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.malware.devicetree.DriverIrp-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Driver IRP hook detection</h2>
</div>


<h3>Plugin Arguments</h3>
<div class="plugins_args">
<table class='table table-condensed'>
<tbody>
<tr><td><p>regex</p></td><td><p>Analyze drivers matching REGEX</p></td></tr><tr><td><p>scan_in_kernel</p></td><td><p>Scan in the kernel address space (type: Boolean)</p>
<ul>
<li>Default: False</li>
</ul></td></tr><tr><td><p>verbosity</p></td><td><p>An integer reflecting the amount of desired output: 0 = quiet, 10 = noisy. (type: IntParser)</p>
<ul>
<li>Default: 1</li>
</ul></td></tr>
</tbody>
</table>
</div>


<p>Windows drivers export a table of functions called the IRP <strong>MajorFunction</strong>
table. In that table, the driver installs function handlers to handle verious
types of requests from userspace. A common way to hook a legitimate driver is to
replace these function pointers with a malicious function.</p>
<p>Many drivers forward their IRP functions to other drivers for legitimate
purposes, so detecting hooked IRP functions based on containing modules is not a
good method. Instead, we print everything and let you be the judge. The command
also checks for Inline hooks of IRP functions and optionally prints a
disassembly of the instructions at the IRP address (pass &ndash;verbosity to enable
this).</p>
<p>This command outputs information for all drivers, unless you specify a regular
expression filter.</p>
<h3>Notes</h3>
<p>In the current implementation this plugin uses scanning methods to locate the
driver and device objects. This is an inefficient method which is also
susceptible to false positives and active subversion. We are working on
converting this plugin to use the <a href="ObjectTree.html">object_tree</a> plugin to
directly parse kernel driver structures.</p>
<h3>Sample output</h3>
<p>In the below we see that the pmem driver handles the <strong>IRP_MJ_CREATE</strong>,
<strong>IRP_MJ_CLOSE</strong>, <strong>IRP_MJ_READ</strong> and <strong>IRP_MJ_DEVICE_CONTROL</strong> IRP types.</p>
<div class="highlight"><pre><span class="n">win8</span><span class="mf">.1</span><span class="p">.</span><span class="n">raw</span> <span class="mi">16</span><span class="o">:</span><span class="mi">15</span><span class="o">:</span><span class="mi">36</span><span class="o">&gt;</span> <span class="n">driverirp</span> <span class="n">regex</span><span class="o">=</span><span class="s">&quot;pmem&quot;</span>
<span class="o">-------------------&gt;</span> <span class="n">driverirp</span><span class="p">(</span><span class="n">regex</span><span class="o">=</span><span class="s">&quot;pmem&quot;</span><span class="p">)</span>
<span class="o">**************************************************</span>
<span class="nl">DriverName:</span> <span class="n">pmem</span>
<span class="nl">DriverStart:</span> <span class="mh">0xf800025ca000</span>
<span class="nl">DriverSize:</span> <span class="mh">0x10000</span>
<span class="nl">DriverStartIo:</span> <span class="mh">0x0</span>
   <span class="o">-</span> <span class="n">Func</span> <span class="n">Name</span>                              <span class="n">Func</span> <span class="n">Addr</span>    <span class="n">Module</span>
<span class="o">----</span> <span class="o">------------------------------------</span> <span class="o">--------------</span> <span class="o">------</span>
   <span class="mi">0</span> <span class="n">IRP_MJ_CREATE</span>                        <span class="mh">0xf800025cb210</span> <span class="err">\</span><span class="o">??</span><span class="err">\</span><span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">Users</span><span class="err">\</span><span class="n">test</span><span class="err">\</span><span class="n">AppData</span><span class="err">\</span><span class="n">Local</span><span class="err">\</span><span class="n">Temp</span><span class="err">\</span><span class="n">pmeA86F</span><span class="p">.</span><span class="n">tmp</span>
   <span class="mi">1</span> <span class="n">IRP_MJ_CREATE_NAMED_PIPE</span>             <span class="mh">0xf802d31131b8</span> <span class="err">\</span><span class="n">SystemRoot</span><span class="err">\</span><span class="n">system32</span><span class="err">\</span><span class="n">ntoskrnl</span><span class="p">.</span><span class="n">exe</span>
   <span class="mi">2</span> <span class="n">IRP_MJ_CLOSE</span>                         <span class="mh">0xf800025cb270</span> <span class="err">\</span><span class="o">??</span><span class="err">\</span><span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">Users</span><span class="err">\</span><span class="n">test</span><span class="err">\</span><span class="n">AppData</span><span class="err">\</span><span class="n">Local</span><span class="err">\</span><span class="n">Temp</span><span class="err">\</span><span class="n">pmeA86F</span><span class="p">.</span><span class="n">tmp</span>
   <span class="mi">3</span> <span class="n">IRP_MJ_READ</span>                          <span class="mh">0xf800025cbfa0</span> <span class="err">\</span><span class="o">??</span><span class="err">\</span><span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">Users</span><span class="err">\</span><span class="n">test</span><span class="err">\</span><span class="n">AppData</span><span class="err">\</span><span class="n">Local</span><span class="err">\</span><span class="n">Temp</span><span class="err">\</span><span class="n">pmeA86F</span><span class="p">.</span><span class="n">tmp</span>
   <span class="mi">4</span> <span class="n">IRP_MJ_WRITE</span>                         <span class="mh">0xf802d31131b8</span> <span class="err">\</span><span class="n">SystemRoot</span><span class="err">\</span><span class="n">system32</span><span class="err">\</span><span class="n">ntoskrnl</span><span class="p">.</span><span class="n">exe</span>
   <span class="mi">5</span> <span class="n">IRP_MJ_QUERY_INFORMATION</span>             <span class="mh">0xf802d31131b8</span> <span class="err">\</span><span class="n">SystemRoot</span><span class="err">\</span><span class="n">system32</span><span class="err">\</span><span class="n">ntoskrnl</span><span class="p">.</span><span class="n">exe</span>
   <span class="mi">6</span> <span class="n">IRP_MJ_SET_INFORMATION</span>               <span class="mh">0xf802d31131b8</span> <span class="err">\</span><span class="n">SystemRoot</span><span class="err">\</span><span class="n">system32</span><span class="err">\</span><span class="n">ntoskrnl</span><span class="p">.</span><span class="n">exe</span>
   <span class="mi">7</span> <span class="n">IRP_MJ_QUERY_EA</span>                      <span class="mh">0xf802d31131b8</span> <span class="err">\</span><span class="n">SystemRoot</span><span class="err">\</span><span class="n">system32</span><span class="err">\</span><span class="n">ntoskrnl</span><span class="p">.</span><span class="n">exe</span>
   <span class="mi">8</span> <span class="n">IRP_MJ_SET_EA</span>                        <span class="mh">0xf802d31131b8</span> <span class="err">\</span><span class="n">SystemRoot</span><span class="err">\</span><span class="n">system32</span><span class="err">\</span><span class="n">ntoskrnl</span><span class="p">.</span><span class="n">exe</span>
   <span class="mi">9</span> <span class="n">IRP_MJ_FLUSH_BUFFERS</span>                 <span class="mh">0xf802d31131b8</span> <span class="err">\</span><span class="n">SystemRoot</span><span class="err">\</span><span class="n">system32</span><span class="err">\</span><span class="n">ntoskrnl</span><span class="p">.</span><span class="n">exe</span>
  <span class="mi">10</span> <span class="n">IRP_MJ_QUERY_VOLUME_INFORMATION</span>      <span class="mh">0xf802d31131b8</span> <span class="err">\</span><span class="n">SystemRoot</span><span class="err">\</span><span class="n">system32</span><span class="err">\</span><span class="n">ntoskrnl</span><span class="p">.</span><span class="n">exe</span>
  <span class="mi">11</span> <span class="n">IRP_MJ_SET_VOLUME_INFORMATION</span>        <span class="mh">0xf802d31131b8</span> <span class="err">\</span><span class="n">SystemRoot</span><span class="err">\</span><span class="n">system32</span><span class="err">\</span><span class="n">ntoskrnl</span><span class="p">.</span><span class="n">exe</span>
  <span class="mi">12</span> <span class="n">IRP_MJ_DIRECTORY_CONTROL</span>             <span class="mh">0xf802d31131b8</span> <span class="err">\</span><span class="n">SystemRoot</span><span class="err">\</span><span class="n">system32</span><span class="err">\</span><span class="n">ntoskrnl</span><span class="p">.</span><span class="n">exe</span>
  <span class="mi">13</span> <span class="n">IRP_MJ_FILE_SYSTEM_CONTROL</span>           <span class="mh">0xf802d31131b8</span> <span class="err">\</span><span class="n">SystemRoot</span><span class="err">\</span><span class="n">system32</span><span class="err">\</span><span class="n">ntoskrnl</span><span class="p">.</span><span class="n">exe</span>
  <span class="mi">14</span> <span class="n">IRP_MJ_DEVICE_CONTROL</span>                <span class="mh">0xf800025cb300</span> <span class="err">\</span><span class="o">??</span><span class="err">\</span><span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">Users</span><span class="err">\</span><span class="n">test</span><span class="err">\</span><span class="n">AppData</span><span class="err">\</span><span class="n">Local</span><span class="err">\</span><span class="n">Temp</span><span class="err">\</span><span class="n">pmeA86F</span><span class="p">.</span><span class="n">tmp</span>
  <span class="mi">15</span> <span class="n">IRP_MJ_INTERNAL_DEVICE_CONTROL</span>       <span class="mh">0xf802d31131b8</span> <span class="err">\</span><span class="n">SystemRoot</span><span class="err">\</span><span class="n">system32</span><span class="err">\</span><span class="n">ntoskrnl</span><span class="p">.</span><span class="n">exe</span>
  <span class="mi">16</span> <span class="n">IRP_MJ_SHUTDOWN</span>                      <span class="mh">0xf802d31131b8</span> <span class="err">\</span><span class="n">SystemRoot</span><span class="err">\</span><span class="n">system32</span><span class="err">\</span><span class="n">ntoskrnl</span><span class="p">.</span><span class="n">exe</span>
  <span class="mi">17</span> <span class="n">IRP_MJ_LOCK_CONTROL</span>                  <span class="mh">0xf802d31131b8</span> <span class="err">\</span><span class="n">SystemRoot</span><span class="err">\</span><span class="n">system32</span><span class="err">\</span><span class="n">ntoskrnl</span><span class="p">.</span><span class="n">exe</span>
  <span class="mi">18</span> <span class="n">IRP_MJ_CLEANUP</span>                       <span class="mh">0xf802d31131b8</span> <span class="err">\</span><span class="n">SystemRoot</span><span class="err">\</span><span class="n">system32</span><span class="err">\</span><span class="n">ntoskrnl</span><span class="p">.</span><span class="n">exe</span>
  <span class="mi">19</span> <span class="n">IRP_MJ_CREATE_MAILSLOT</span>               <span class="mh">0xf802d31131b8</span> <span class="err">\</span><span class="n">SystemRoot</span><span class="err">\</span><span class="n">system32</span><span class="err">\</span><span class="n">ntoskrnl</span><span class="p">.</span><span class="n">exe</span>
  <span class="mi">20</span> <span class="n">IRP_MJ_QUERY_SECURITY</span>                <span class="mh">0xf802d31131b8</span> <span class="err">\</span><span class="n">SystemRoot</span><span class="err">\</span><span class="n">system32</span><span class="err">\</span><span class="n">ntoskrnl</span><span class="p">.</span><span class="n">exe</span>
  <span class="mi">21</span> <span class="n">IRP_MJ_SET_SECURITY</span>                  <span class="mh">0xf802d31131b8</span> <span class="err">\</span><span class="n">SystemRoot</span><span class="err">\</span><span class="n">system32</span><span class="err">\</span><span class="n">ntoskrnl</span><span class="p">.</span><span class="n">exe</span>
  <span class="mi">22</span> <span class="n">IRP_MJ_POWER</span>                         <span class="mh">0xf802d31131b8</span> <span class="err">\</span><span class="n">SystemRoot</span><span class="err">\</span><span class="n">system32</span><span class="err">\</span><span class="n">ntoskrnl</span><span class="p">.</span><span class="n">exe</span>
  <span class="mi">23</span> <span class="n">IRP_MJ_SYSTEM_CONTROL</span>                <span class="mh">0xf802d31131b8</span> <span class="err">\</span><span class="n">SystemRoot</span><span class="err">\</span><span class="n">system32</span><span class="err">\</span><span class="n">ntoskrnl</span><span class="p">.</span><span class="n">exe</span>
  <span class="mi">24</span> <span class="n">IRP_MJ_DEVICE_CHANGE</span>                 <span class="mh">0xf802d31131b8</span> <span class="err">\</span><span class="n">SystemRoot</span><span class="err">\</span><span class="n">system32</span><span class="err">\</span><span class="n">ntoskrnl</span><span class="p">.</span><span class="n">exe</span>
  <span class="mi">25</span> <span class="n">IRP_MJ_QUERY_QUOTA</span>                   <span class="mh">0xf802d31131b8</span> <span class="err">\</span><span class="n">SystemRoot</span><span class="err">\</span><span class="n">system32</span><span class="err">\</span><span class="n">ntoskrnl</span><span class="p">.</span><span class="n">exe</span>
  <span class="mi">26</span> <span class="n">IRP_MJ_SET_QUOTA</span>                     <span class="mh">0xf802d31131b8</span> <span class="err">\</span><span class="n">SystemRoot</span><span class="err">\</span><span class="n">system32</span><span class="err">\</span><span class="n">ntoskrnl</span><span class="p">.</span><span class="n">exe</span>
  <span class="mi">27</span> <span class="n">IRP_MJ_PNP</span>                           <span class="mh">0xf802d31131b8</span> <span class="err">\</span><span class="n">SystemRoot</span><span class="err">\</span><span class="n">system32</span><span class="err">\</span><span class="n">ntoskrnl</span><span class="p">.</span><span class="n">exe</span>
</pre></div>
</div>

<h1 id="driverscan" class="anchor">driverscan</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.filescan.DriverScan-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Scan for driver objects _DRIVER_OBJECT</h2>
</div>


<h3>Plugin Arguments</h3>
<div class="plugins_args">
<table class='table table-condensed'>
<tbody>
<tr><td><p>scan_in_kernel</p></td><td><p>Scan in the kernel address space (type: Boolean)</p>
<ul>
<li>Default: False</li>
</ul></td></tr>
</tbody>
</table>
</div>


<p>To find <strong>_DRIVER_OBJECT</strong>s in physical memory using pool tag scanning, use this
plugin. This is another way to locate kernel modules, although not all kernel
modules have an associated <strong>_DRIVER_OBJECT</strong>.</p>
<p>The usual way for malware to enter Ring 0 is via loading a kernel driver of some
sort. A malicious kernel driver is a strong indication that malware is running
in Ring 0.</p>
<h3>Notes</h3>
<ol>
<li>Like other pool scanning plugins, this plugin may produce false positives
   since it essentially carves <strong>_DRIVER_OBJECT</strong> structures out of memory. On
   the other hand, this plugin may reveal drivers which have been unloaded.</li>
</ol>
<h3>Sample output</h3>
<div class="highlight"><pre><span class="n">win8</span><span class="mf">.1</span><span class="p">.</span><span class="n">raw</span> <span class="mi">16</span><span class="o">:</span><span class="mi">17</span><span class="o">:</span><span class="mi">29</span><span class="o">&gt;</span> <span class="n">driverscan</span>
<span class="o">-------------------&gt;</span> <span class="n">driverscan</span><span class="p">()</span>
    <span class="n">Offset</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>    <span class="err">#</span><span class="n">Ptr</span> <span class="err">#</span><span class="n">Hnd</span>     <span class="n">Start</span>           <span class="n">Size</span>      <span class="n">Service</span> <span class="n">Key</span>          <span class="n">Name</span>         <span class="n">Driver</span> <span class="n">Name</span>
<span class="o">-</span> <span class="o">--------------</span> <span class="o">----</span> <span class="o">----</span> <span class="o">--------------</span> <span class="o">--------------</span> <span class="o">--------------------</span> <span class="o">------------</span> <span class="o">-----------</span>
<span class="p">...</span>
  <span class="mh">0x00003e569c60</span>    <span class="mi">3</span>    <span class="mi">0</span> <span class="mh">0xf80000b14000</span>        <span class="mh">0x10000</span> <span class="n">pcw</span>                  <span class="n">pcw</span>          <span class="err">\</span><span class="n">Driver</span><span class="err">\</span><span class="n">pcw</span>
  <span class="mh">0x00003e569e60</span>    <span class="mi">3</span>    <span class="mi">0</span> <span class="mh">0xf80000aeb000</span>        <span class="mh">0x29000</span> <span class="n">VBoxGuest</span>            <span class="n">VBoxGuest</span>    <span class="err">\</span><span class="n">Driver</span><span class="err">\</span><span class="n">VBoxGuest</span>
  <span class="mh">0x00003e59e590</span>   <span class="mi">17</span>    <span class="mi">0</span> <span class="mh">0xf80000c26000</span>       <span class="mh">0x118000</span> <span class="n">NDIS</span>                 <span class="n">NDIS</span>         <span class="err">\</span><span class="n">Driver</span><span class="err">\</span><span class="n">NDIS</span>
  <span class="mh">0x00003e5a1060</span>    <span class="mi">8</span>    <span class="mi">0</span> <span class="mh">0xf80000ec5000</span>       <span class="mh">0x27f000</span> <span class="n">Tcpip</span>                <span class="n">Tcpip</span>        <span class="err">\</span><span class="n">Driver</span><span class="err">\</span><span class="n">Tcpip</span>
  <span class="mh">0x00003eb8d870</span>    <span class="mi">3</span>    <span class="mi">0</span> <span class="mh">0xf800025ca000</span>        <span class="mh">0x10000</span> <span class="n">pmem</span>                 <span class="n">pmem</span>         <span class="err">\</span><span class="n">Driver</span><span class="err">\</span><span class="n">pmem</span>
  <span class="mh">0x00003f066e60</span>    <span class="mi">3</span>    <span class="mi">0</span> <span class="mh">0xf80001c69000</span>         <span class="mh">0xe000</span> <span class="n">monitor</span>              <span class="n">monitor</span>      <span class="err">\</span><span class="n">Driver</span><span class="err">\</span><span class="n">monitor</span>
<span class="p">....</span>
</pre></div>
</div>

<h1 id="dtbscan" class="anchor">dtbscan</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.pfn.DTBScan-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Scans the physical memory for DTB values.</h2>
<p>This plugin can compare the DTBs found against the list of known processes
to find hidden processes.</p>
</div>


<h3>Plugin Arguments</h3>
<div class="plugins_args">
<table class='table table-condensed'>
<tbody>
<tr><td><p>eprocess</p></td><td><p>Kernel addresses of eprocess structs. (type: ArrayIntParser)</p></td></tr><tr><td><p>limit</p></td><td><p>Stop scanning after this many mb. (type: IntParser)</p>
<ul>
<li>Default: 0</li>
</ul></td></tr><tr><td><p>method</p></td><td><p>Method to list processes. (type: ChoiceArray)</p>
<ul>
<li>
<p>Valid Choices:</p>
<ul>
<li>PsActiveProcessHead</li>
<li>CSRSS</li>
<li>PspCidTable</li>
<li>Sessions</li>
<li>Handles</li>
</ul>
</li>
<li>
<p>Default: PsActiveProcessHead, CSRSS, PspCidTable, Sessions, Handles</p>
</li>
</ul></td></tr><tr><td><p>phys_eprocess</p></td><td><p>Physical addresses of eprocess structs. (type: ArrayIntParser)</p></td></tr><tr><td><p>pid</p></td><td><p>One or more pids of processes to select. (type: ArrayIntParser)</p></td></tr><tr><td><p>proc_regex</p></td><td><p>A regex to select a process by name. (type: RegEx)</p></td></tr>
</tbody>
</table>
</div>


<p>The PFN database can be used to resolve a physical address to its virtual
address in the process address space. Since processes must have unique page
tables, and therefore a unique DTB, we can enumerate all unique page tables on
the system.</p>
<p>Using this technique allows us to locate hidden processes. We simply check each
physical page and locate its DTB (or page table directory base) offset. We then
match the DTB to a known process DTB. If the DTB is not known this is a strong
indication that the process is hidden.</p>
<h3>Sample output</h3>
<div class="highlight"><pre><span class="n">win8</span><span class="mf">.1</span><span class="p">.</span><span class="n">raw</span> <span class="mi">16</span><span class="o">:</span><span class="mi">23</span><span class="o">:</span><span class="mi">50</span><span class="o">&gt;</span> <span class="n">dtbscan</span>
<span class="o">-------------------&gt;</span> <span class="n">dtbscan</span><span class="p">()</span>
     <span class="n">DTB</span>           <span class="n">VAddr</span>        <span class="n">_EPROCESS</span>    <span class="n">Image</span> <span class="n">Name</span>           <span class="n">Known</span>
<span class="o">--------------</span> <span class="o">--------------</span> <span class="o">--------------</span> <span class="o">--------------------</span> <span class="o">-----</span>
<span class="mh">0x0000001a7000</span> <span class="mh">0xf6fb7dbed000</span> <span class="mh">0xe00000074580</span> <span class="n">System</span>               <span class="n">True</span>
<span class="mh">0x0000118a3000</span> <span class="mh">0xf6fb7dbed000</span> <span class="mh">0xe00002073900</span> <span class="n">explorer</span><span class="p">.</span><span class="n">exe</span>         <span class="n">True</span>
<span class="mh">0x00000923e000</span> <span class="mh">0xf6fb7dbed000</span> <span class="mh">0xe000020ea900</span> <span class="n">svchost</span><span class="p">.</span><span class="n">exe</span>          <span class="n">True</span>
<span class="mh">0x000036ea3000</span> <span class="mh">0xf6fb7dbed000</span> <span class="mh">0xe000006208c0</span> <span class="n">taskhost</span><span class="p">.</span><span class="n">exe</span>         <span class="n">True</span>
<span class="mh">0x000004c01000</span> <span class="mh">0xf6fb7dbed000</span> <span class="mh">0xe000000ce080</span> <span class="n">wininit</span><span class="p">.</span><span class="n">exe</span>          <span class="n">True</span>
<span class="mh">0x00000d0a4000</span> <span class="mh">0xf6fb7dbed000</span> <span class="mh">0xe000022c6900</span> <span class="n">MsMpEng</span><span class="p">.</span><span class="n">exe</span>          <span class="n">True</span>
<span class="mh">0x0000093c4000</span> <span class="mh">0xf6fb7dbed000</span> <span class="mh">0xe000020df080</span> <span class="n">svchost</span><span class="p">.</span><span class="n">exe</span>          <span class="n">True</span>
<span class="mh">0x0000348c6000</span> <span class="mh">0xf6fb7dbed000</span> <span class="mh">0xe00001e2f700</span> <span class="n">dwm</span><span class="p">.</span><span class="n">exe</span>              <span class="n">True</span>
<span class="mh">0x000011504000</span> <span class="mh">0xf6fb7dbed000</span> <span class="mh">0xe000007a3080</span> <span class="n">svchost</span><span class="p">.</span><span class="n">exe</span>          <span class="n">True</span>
<span class="mh">0x000007c94000</span> <span class="mh">0xf6fb7dbed000</span> <span class="mh">0xe00001f22080</span> <span class="n">cmd</span><span class="p">.</span><span class="n">exe</span>              <span class="n">True</span>
<span class="mh">0x00002fe03000</span> <span class="mh">0xf6fb7dbed000</span> <span class="mh">0xe00002043900</span> <span class="n">conhost</span><span class="p">.</span><span class="n">exe</span>          <span class="n">True</span>
<span class="mh">0x00002f8ce000</span> <span class="mh">0xf6fb7dbed000</span> <span class="mh">0xe00001299900</span> <span class="n">SearchIndexer</span><span class="p">.</span>       <span class="n">True</span>
<span class="mh">0x0000207b9000</span> <span class="mh">0xf6fb7dbed000</span> <span class="mh">0xe00002645080</span> <span class="n">VBoxTray</span><span class="p">.</span><span class="n">exe</span>         <span class="n">True</span>
</pre></div>
</div>

<h1 id="dtbscan2" class="anchor">dtbscan2</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.pfn.DTBScan2-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>A Fast scanner for hidden DTBs.</h2>
<p>This scanner uses the fact that the virtual address of the DTB is always the
same. We walk over all the physical pages, assume each page is a DTB and try
to resolve the constant to a physical address.</p>
<p>This plugin was written based on ideas and discussion with thomasdullien.</p>
</div>




</div>

<h1 id="dumpfiles" class="anchor">dumpfiles</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.cache.DumpFiles-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Dump files from memory.</h2>
<p>The interface is loosely based on the Volatility plugin of the same name,
although the implementation is quite different.</p>
</div>


<h3>Plugin Arguments</h3>
<div class="plugins_args">
<table class='table table-condensed'>
<tbody>
<tr><td><p>dump_dir</p></td><td><p>Path suitable for dumping files. (Default: Use current directory)</p></td></tr><tr><td><p>eprocess</p></td><td><p>Kernel addresses of eprocess structs. (type: ArrayIntParser)</p></td></tr><tr><td><p>file_objects</p></td><td><p>Kernel addresses of _FILE_OBJECT structs. (type: ArrayIntParser)</p>
<ul>
<li>Default: </li>
</ul></td></tr><tr><td><p>method</p></td><td><p>Method to list processes. (type: ChoiceArray)</p>
<ul>
<li>
<p>Valid Choices:</p>
<ul>
<li>PsActiveProcessHead</li>
<li>CSRSS</li>
<li>PspCidTable</li>
<li>Sessions</li>
<li>Handles</li>
</ul>
</li>
<li>
<p>Default: PsActiveProcessHead, CSRSS, PspCidTable, Sessions, Handles</p>
</li>
</ul></td></tr><tr><td><p>phys_eprocess</p></td><td><p>Physical addresses of eprocess structs. (type: ArrayIntParser)</p></td></tr><tr><td><p>pid</p></td><td><p>One or more pids of processes to select. (type: ArrayIntParser)</p></td></tr><tr><td><p>proc_regex</p></td><td><p>A regex to select a process by name. (type: RegEx)</p></td></tr>
</tbody>
</table>
</div>



</div>

<h1 id="evtlogs" class="anchor">evtlogs</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.registry.evtlogs.EvtLogs-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Extract Windows Event Logs (XP/2003 only)</h2>
</div>


<h3>Plugin Arguments</h3>
<div class="plugins_args">
<table class='table table-condensed'>
<tbody>
<tr><td><p>hive-offsets</p></td><td><p>A list of hive offsets as found by hivelist. If not provided we call hivelist ourselves and list the keys on all hives. (type: ArrayIntParser)</p></td></tr><tr><td><p>hive_regex</p></td><td><p>A regex to filter hive names.If not provided we use all hives.</p></td></tr><tr><td><p>verbosity</p></td><td><p>An integer reflecting the amount of desired output: 0 = quiet, 10 = noisy. (type: IntParser)</p>
<ul>
<li>Default: 1</li>
</ul></td></tr>
</tbody>
</table>
</div>


<p>The evtlogs command extracts and parses binary event logs from memory. Binary
event logs are found on Windows XP and 2003 machines, therefore this plugin only
works on these architectures. These files are extracted from VAD of the
services.exe process, parsed and shown as output.</p>
<h3>Notes</h3>
<ol>
<li>This plugin will only work on Windows XP/2003. Modern windows systems use
   evtx event log format. We are still working on supporting these logs.</li>
</ol>
<h3>Sample output</h3>
<div class="highlight"><pre>xp-laptop-2005-06-25.img 16:43:19&gt; evtlogs
---------------------------------&gt; evtlogs()
TimeWritten Filename Computer Sid Source Event Id Event Type Message
----------- -------- -------- --- ------ -------- ---------- -------
2004-05-05 19:36:55+0000 SecEvent.Evt MOIT-A-PHXMOD2 S-1-5-18 Security 612 Success &#39;-&#39;;&#39;+&#39;;&#39;+&#39;;&#39;+&#39;;&#39;+&#39;;&#39;+&#39;;&#39;-&#39;;&#39;-&#39;;&#39;-&#39;;&#39;-&#39;;&#39;+&#39;;&#39;+&#39;;&#39;+&#39;;&#39;+&#39;;&#39;+&#39;;&#39;+&#39;;&#39;+&#39;;&#39;+&#39;;&#39;MOIT-A-PHXMOD2$&#39;;&#39;BALTIMORE&#39;;&#39;(0x0,0x3E7)&#39;
2004-05-05 19:36:56+0000 SecEvent.Evt MOIT-A-PHXMOD2 S-1-5-18 Security 618 Success &#39;MOIT-A-PHXMOD2$&#39;;&#39;BALTIMORE&#39;;&#39;(0x0,0x3E7)&#39;;&#39;PolEfDat: &lt;binary data&gt; (none);  &#39;
2004-05-05 19:37:03+0000 SecEvent.Evt MOIT-A-PHXMOD2 S-1-5-18 Security 537 Failure &#39;AJ.Morning&#39;;&#39;BALTIMORE&#39;;&#39;11&#39;;&#39;User32  &#39;;&#39;Negotiate&#39;;&#39;MOIT-A-PHXMOD2&#39;;&#39;0xC000005E&#39;;&#39;0x0&#39;
2004-05-05 19:37:03+0000 SecEvent.Evt MOIT-A-PHXMOD2 S-1-5-21-487349131-2095749132-2248483902-19753 Security 528 Success &#39;AJ.Morning&#39;;&#39;BALTIMORE&#39;;&#39;(0x0,0x113AD)&#39;;&#39;2&#39;;&#39;User32  &#39;;&#39;Negotiate&#39;;&#39;MOIT-A-PHXMOD2&#39;;&#39;{5c92d34f-85d3-2f5d-d036-759d7c97bfd7}&#39;
2004-05-05 19:37:32+0000 SecEvent.Evt MOIT-A-PHXMOD2 S-1-5-19 Security 528 Success &#39;LOCAL SERVICE&#39;;&#39;NT AUTHORITY&#39;;&#39;(0x0,0x3E5)&#39;;&#39;5&#39;;&#39;Advapi  &#39;;&#39;Negotiate&#39;;&#39;&#39;;&#39;{00000000-0000-0000-0000-000000000000}&#39;
2004-05-05 19:37:33+0000 SecEvent.Evt MOIT-A-PHXMOD2 S-1-5-21-487349131-2095749132-2248483902-19753 Security 596 Failure &#39;619be804-cde6-484f-aff4-2a5e588d6eef&#39;;&#39;&#39;;&#39;&#39;;&#39;0x57&#39;
</pre></div>
</div>

<h1 id="filescan" class="anchor">filescan</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.filescan.FileScan-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Scan Physical memory for _FILE_OBJECT pool allocations</h2>
</div>


<h3>Plugin Arguments</h3>
<div class="plugins_args">
<table class='table table-condensed'>
<tbody>
<tr><td><p>scan_in_kernel</p></td><td><p>Scan in the kernel address space (type: Boolean)</p>
<ul>
<li>Default: False</li>
</ul></td></tr>
</tbody>
</table>
</div>


<p>To find FILE_OBJECTs in physical memory using pool tag scanning, use the
filescan command. This will find open files even if a rootkit is hiding the
files on disk and if the rootkit hooks some API functions to hide the open
handles on a live system.</p>
<p>The plugin also resolves back the <strong>_FILE_OBJECT</strong> into the ownning
process. This works only if the <strong>_FILE_OBJECT</strong> is actually in use (it does not
work for closed files).</p>
<h3>Notes</h3>
<ol>
<li>
<p>Like other pool scanning plugins, this plugin may produce false positives
   since it essentially carves <strong>_FILE_OBJECT</strong> structures out of memory. On the
   other hand, this plugin may reveal files which have been closed or freed.</p>
</li>
<li>
<p>When inspecting the output, the <strong>#Hnd</strong> column indicates the number of
   handles to this <strong>_FILE_OBJECT</strong>.  Objects in use will have a non zero value
   here and are likely to not be freed.</p>
</li>
<li>
<p>The plugin displays the physical address of the <strong>_FILE_OBJECT</strong> found. It
   may be possible to derive their virtual address using the <a href="PtoV.html">ptov</a>
   plugin. Alternatively, specify the <em>scan_in_kernel</em> option, to ensure
   scanning occurs in the kernel address space.</p>
</li>
</ol>
<h3>Sample output</h3>
<div class="highlight"><pre><span class="n">win8</span><span class="mf">.1</span><span class="p">.</span><span class="n">raw</span> <span class="mi">16</span><span class="o">:</span><span class="mi">55</span><span class="o">:</span><span class="mi">44</span><span class="o">&gt;</span> <span class="n">filescan</span> <span class="n">scan_in_kernel</span><span class="o">=</span><span class="n">True</span>
<span class="o">-------------------&gt;</span> <span class="n">filescan</span><span class="p">(</span><span class="n">scan_in_kernel</span><span class="o">=</span><span class="n">True</span><span class="p">)</span>
      <span class="n">Offset</span>       <span class="err">#</span><span class="n">Ptr</span> <span class="err">#</span><span class="n">Hnd</span> <span class="n">Access</span>     <span class="n">Owner</span>      <span class="n">Owner</span> <span class="n">Pid</span> <span class="n">Owner</span> <span class="n">Name</span>       <span class="n">Name</span>
<span class="o">-</span> <span class="o">--------------</span> <span class="o">------</span> <span class="o">----</span> <span class="o">------</span> <span class="o">--------------</span> <span class="o">---------</span> <span class="o">----------------</span> <span class="o">----</span>
  <span class="mh">0xe000000421e0</span>     <span class="mi">17</span>   <span class="mi">0</span> <span class="n">RW</span><span class="o">-</span><span class="n">rwd</span> <span class="o">--------------</span> <span class="o">----</span> <span class="o">----------------</span> <span class="err">\$</span><span class="n">Directory</span>
  <span class="mh">0xe00000057d70</span>     <span class="mi">14</span>   <span class="mi">0</span> <span class="n">R</span><span class="o">--</span><span class="n">rwd</span> <span class="o">--------------</span> <span class="o">----</span> <span class="o">----------------</span> <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">AuthBroker</span><span class="p">.</span><span class="n">dll</span>
  <span class="mh">0xe000000599d0</span>  <span class="mi">32758</span>   <span class="mi">1</span> <span class="n">R</span><span class="o">--</span><span class="n">rw</span><span class="o">-</span> <span class="mh">0xe00000074580</span>    <span class="mi">4</span> <span class="n">System</span>           <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">CSC</span><span class="err">\</span><span class="n">v2</span><span class="mf">.0.6</span>
  <span class="mh">0xe000000686e0</span>     <span class="mi">19</span>   <span class="mi">0</span> <span class="n">RW</span><span class="o">-</span><span class="n">rwd</span> <span class="o">--------------</span> <span class="o">----</span> <span class="o">----------------</span> <span class="err">\$</span><span class="n">Directory</span>
  <span class="mh">0xe0000006a1f0</span>     <span class="mi">19</span>   <span class="mi">0</span> <span class="n">RW</span><span class="o">-</span><span class="n">rwd</span> <span class="o">--------------</span> <span class="o">----</span> <span class="o">----------------</span> <span class="err">\$</span><span class="n">Directory</span>
  <span class="mh">0xe0000006b5a0</span>     <span class="mi">16</span>   <span class="mi">0</span> <span class="n">R</span><span class="o">--</span><span class="n">r</span><span class="o">-</span><span class="n">d</span> <span class="o">--------------</span> <span class="o">----</span> <span class="o">----------------</span> <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">Fonts</span><span class="err">\</span><span class="n">modern</span><span class="p">.</span><span class="n">fon</span>
  <span class="mh">0xe0000006d8c0</span>      <span class="mi">4</span>   <span class="mi">0</span> <span class="n">R</span><span class="o">--</span><span class="n">r</span><span class="o">-</span><span class="n">d</span> <span class="o">--------------</span> <span class="o">----</span> <span class="o">----------------</span> <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">negoexts</span><span class="p">.</span><span class="n">dll</span>
  <span class="mh">0xe0000006dc40</span>     <span class="mi">16</span>   <span class="mi">0</span> <span class="n">R</span><span class="o">--</span><span class="n">r</span><span class="o">--</span> <span class="o">--------------</span> <span class="o">----</span> <span class="o">----------------</span> <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">Fonts</span><span class="err">\</span><span class="n">meiryob</span><span class="p">.</span><span class="n">ttc</span>
  <span class="mh">0xe0000006e1f0</span>  <span class="mi">29617</span>   <span class="mi">1</span> <span class="o">------</span> <span class="mh">0xe0000204a900</span> <span class="mi">2628</span> <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>   <span class="err">\</span><span class="n">Connect</span>
  <span class="mh">0xe0000006edd0</span>     <span class="mi">16</span>   <span class="mi">0</span> <span class="n">R</span><span class="o">--</span><span class="n">rwd</span> <span class="o">--------------</span> <span class="o">----</span> <span class="o">----------------</span> <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">msctf</span><span class="p">.</span><span class="n">dll</span>
  <span class="mh">0xe00000079270</span>     <span class="mi">16</span>   <span class="mi">0</span> <span class="n">R</span><span class="o">--</span><span class="n">r</span><span class="o">--</span> <span class="o">--------------</span> <span class="o">----</span> <span class="o">----------------</span> <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">Cursors</span><span class="err">\</span><span class="n">aero_up</span><span class="p">.</span><span class="n">cur</span>
  <span class="mh">0xe0000007abc0</span>     <span class="mi">12</span>   <span class="mi">0</span> <span class="n">R</span><span class="o">--</span><span class="n">rwd</span> <span class="o">--------------</span> <span class="o">----</span> <span class="o">----------------</span> <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">puiobj</span><span class="p">.</span><span class="n">dll</span>
  <span class="mh">0xe0000007ba90</span>     <span class="mi">18</span>   <span class="mi">0</span> <span class="n">RW</span><span class="o">-</span><span class="n">rwd</span> <span class="o">--------------</span> <span class="o">----</span> <span class="o">----------------</span> <span class="err">\$</span><span class="n">Directory</span>
  <span class="mh">0xe0000007e070</span>      <span class="mi">3</span>   <span class="mi">0</span> <span class="n">R</span><span class="o">--</span><span class="n">r</span><span class="o">--</span> <span class="o">--------------</span> <span class="o">----</span> <span class="o">----------------</span> <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">Fonts</span><span class="err">\</span><span class="n">segoeui</span><span class="p">.</span><span class="n">ttf</span>
  <span class="mh">0xe0000007e360</span>      <span class="mi">4</span>   <span class="mi">0</span> <span class="n">RW</span><span class="o">-</span><span class="n">rwd</span> <span class="o">--------------</span> <span class="o">----</span> <span class="o">----------------</span> <span class="err">\$</span><span class="n">ConvertToNonresident</span>
  <span class="mh">0xe0000007e890</span>      <span class="mi">7</span>   <span class="mi">0</span> <span class="n">R</span><span class="o">--</span><span class="n">r</span><span class="o">-</span><span class="n">d</span> <span class="o">--------------</span> <span class="o">----</span> <span class="o">----------------</span> <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">usbmon</span><span class="p">.</span><span class="n">dll</span>
  <span class="mh">0xe0000007f360</span>  <span class="mi">32768</span>   <span class="mi">1</span> <span class="n">R</span><span class="o">--</span><span class="n">r</span><span class="o">-</span><span class="n">d</span> <span class="mh">0xe000000ce080</span>  <span class="mi">432</span> <span class="n">wininit</span><span class="p">.</span><span class="n">exe</span>      <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">en</span><span class="o">-</span><span class="n">GB</span><span class="err">\</span><span class="n">user32</span><span class="p">.</span><span class="n">dll</span><span class="p">.</span><span class="n">mui</span>
  <span class="mh">0xe0000007f980</span>      <span class="mi">4</span>   <span class="mi">0</span> <span class="n">R</span><span class="o">--</span><span class="n">r</span><span class="o">-</span><span class="n">d</span> <span class="o">--------------</span> <span class="o">----</span> <span class="o">----------------</span> <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">KBDUK</span><span class="p">.</span><span class="n">DLL</span>
  <span class="mh">0xe000000b1d90</span>     <span class="mi">17</span>   <span class="mi">0</span> <span class="n">RW</span><span class="o">-</span><span class="n">rwd</span> <span class="o">--------------</span> <span class="o">----</span> <span class="o">----------------</span> <span class="err">\$</span><span class="n">Directory</span>
  <span class="mh">0xe000000b1f20</span>      <span class="mi">5</span>   <span class="mi">0</span> <span class="n">R</span><span class="o">--</span><span class="n">r</span><span class="o">-</span><span class="n">d</span> <span class="o">--------------</span> <span class="o">----</span> <span class="o">----------------</span> <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">AppXDeploymentServer</span><span class="p">.</span><span class="n">dll</span>
  <span class="mh">0xe000000b4610</span>     <span class="mi">12</span>   <span class="mi">0</span> <span class="n">R</span><span class="o">--</span><span class="n">rwd</span> <span class="o">--------------</span> <span class="o">----</span> <span class="o">----------------</span> <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">winmmbase</span><span class="p">.</span><span class="n">dll</span>
  <span class="mh">0xe000000b6820</span>      <span class="mi">1</span>   <span class="mi">1</span> <span class="n">RWD</span><span class="o">---</span> <span class="mh">0xe00000074580</span>    <span class="mi">4</span> <span class="n">System</span>           <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">config</span><span class="err">\</span><span class="n">RegBack</span><span class="err">\</span><span class="n">SECURITY</span>
  <span class="mh">0xe000000b6a50</span>  <span class="mi">32766</span>   <span class="mi">1</span> <span class="n">RW</span><span class="o">----</span> <span class="mh">0xe00000074580</span>    <span class="mi">4</span> <span class="n">System</span>           <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">config</span><span class="err">\</span><span class="n">SECURITY</span><span class="p">.</span><span class="n">LOG2</span>
</pre></div>
</div>

<h1 id="find_dtb" class="anchor">find_dtb</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.common.WinFindDTB-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>A plugin to search for the Directory Table Base for windows systems.</h2>
<p>There are a number of ways to find the DTB:</p>
<ul>
<li>
<p>Scanner method: Scans the image for a known kernel process, and read the
  DTB from its Process Environment Block (PEB).</p>
</li>
<li>
<p>Get the DTB from the KPCR structure.</p>
</li>
<li>
<p>Note that the kernel is mapped into every process&rsquo;s address space (with
  the exception of session space which might be different) so using any
  process&rsquo;s DTB from the same session will work to read kernel data
  structures. If this plugin fails, try psscan to find potential DTBs.</p>
</li>
</ul>
</div>


<h3>Plugin Arguments</h3>
<div class="plugins_args">
<table class='table table-condensed'>
<tbody>
<tr><td><p>process_name</p></td><td><p>The name of the process to search for.</p></td></tr>
</tbody>
</table>
</div>


<h3>Notes</h3>
<ol>
<li>This is an internally used plugin for discovering the Directory Table Base
   (DTB) on windows systems. It is unlikely to be useful to a user by itself.</li>
</ol>
</div>

<h1 id="fls" class="anchor">fls</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.filesystems.ntfs.FLS-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2></h2>
</div>


<h3>Plugin Arguments</h3>
<div class="plugins_args">
<table class='table table-condensed'>
<tbody>
<tr><td><p>path</p></td><td><p>Path to print stats for.</p>
<ul>
<li>Default: /</li>
</ul></td></tr>
</tbody>
</table>
</div>



</div>

<h1 id="handles" class="anchor">handles</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.handles.Handles-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Print list of open handles for each process</h2>
</div>


<h3>Plugin Arguments</h3>
<div class="plugins_args">
<table class='table table-condensed'>
<tbody>
<tr><td><p>eprocess</p></td><td><p>Kernel addresses of eprocess structs. (type: ArrayIntParser)</p></td></tr><tr><td><p>method</p></td><td><p>Method to list processes. (type: ChoiceArray)</p>
<ul>
<li>
<p>Valid Choices:</p>
<ul>
<li>PsActiveProcessHead</li>
<li>CSRSS</li>
<li>PspCidTable</li>
<li>Sessions</li>
<li>Handles</li>
</ul>
</li>
<li>
<p>Default: PsActiveProcessHead, CSRSS, PspCidTable, Sessions, Handles</p>
</li>
</ul></td></tr><tr><td><p>named_only</p></td><td><p>Output only handles with a name . (type: Boolean)</p></td></tr><tr><td><p>object_types</p></td><td><p>Types of objects to show. (type: ArrayStringParser)</p></td></tr><tr><td><p>phys_eprocess</p></td><td><p>Physical addresses of eprocess structs. (type: ArrayIntParser)</p></td></tr><tr><td><p>pid</p></td><td><p>One or more pids of processes to select. (type: ArrayIntParser)</p></td></tr><tr><td><p>proc_regex</p></td><td><p>A regex to select a process by name. (type: RegEx)</p></td></tr>
</tbody>
</table>
</div>


<p>This plugin displays the handle table of processes. The handle table in the
process stores securable kernel objects.</p>
<p>When a user mode process obtains a securable kernel object, they receive a
handle to it - i.e. an integer which is the location in the handle table, rather
than the raw kernel level pointer. User processes then use the handle to operate
of the kernel level object. For example, if a process opens a file the
<strong>_FILE_OBJECT</strong> will be stored in the handle table, and the userspace code will
receive the offset into the handle table.</p>
<p>This plugin is especially useful to find all resources that are opened by a user
space program, such as open files, registry keys etc. In fact any of the objects
shown by the <a href="ObjectTypes.html">object_types</a> plugin are stored in the handle
table as can be seen by this module.</p>
<p>All the usual process selectors are supported. Additionally, it is possible to
filter the output by using a comma separated list of handle types (as can be
seen by the <a href="ObjectTypes.html">object_types</a> plugin.</p>
<h3>Sample output</h3>
<p>In the following output we see the winpmem acquisition tool&rsquo;s handle table. Note
that it has an open file to the raw device <em>\Device\pmem</em> and the output file of
<em>\Device\HarddiskVolume2\temp\win8.1.raw</em>.</p>
<div class="highlight"><pre><span class="n">win8</span><span class="mf">.1</span><span class="p">.</span><span class="n">raw</span> <span class="mi">18</span><span class="o">:</span><span class="mo">00</span><span class="o">:</span><span class="mi">43</span><span class="o">&gt;</span> <span class="n">handles</span> <span class="n">proc_regex</span><span class="o">=</span><span class="s">&quot;winpmem&quot;</span>
<span class="o">-------------------&gt;</span> <span class="n">handles</span><span class="p">(</span><span class="n">proc_regex</span><span class="o">=</span><span class="s">&quot;winpmem&quot;</span><span class="p">)</span>
  <span class="n">Offset</span> <span class="p">(</span><span class="n">V</span><span class="p">)</span>      <span class="n">Pid</span>     <span class="n">Handle</span>         <span class="n">Access</span>     <span class="n">Type</span>             <span class="n">Details</span>
<span class="o">--------------</span> <span class="o">------</span> <span class="o">--------------</span> <span class="o">--------------</span> <span class="o">----------------</span> <span class="o">-------</span>
<span class="mh">0xe00001f82f20</span>   <span class="mi">2628</span>            <span class="mh">0x4</span>       <span class="mh">0x12019f</span> <span class="n">File</span>             <span class="err">\</span><span class="n">Device</span><span class="err">\</span><span class="n">ConDrv</span><span class="err">\</span><span class="n">Reference</span>
<span class="mh">0xe00001d17e00</span>   <span class="mi">2628</span>           <span class="mh">0x10</span>       <span class="mh">0x100020</span> <span class="n">File</span>             <span class="err">\</span><span class="n">Device</span><span class="err">\</span><span class="n">HarddiskVolume2</span><span class="err">\</span><span class="n">Windows</span>
<span class="mh">0xe00001f546b0</span>   <span class="mi">2628</span>           <span class="mh">0x18</span>       <span class="mh">0x12019f</span> <span class="n">File</span>             <span class="err">\</span><span class="n">Device</span><span class="err">\</span><span class="n">ConDrv</span><span class="err">\</span><span class="n">Input</span>
<span class="mh">0xe00001eef800</span>   <span class="mi">2628</span>           <span class="mh">0x1c</span>       <span class="mh">0x12019f</span> <span class="n">File</span>             <span class="err">\</span><span class="n">Device</span><span class="err">\</span><span class="n">ConDrv</span><span class="err">\</span><span class="n">Output</span>
<span class="mh">0xe00001eef800</span>   <span class="mi">2628</span>           <span class="mh">0x20</span>       <span class="mh">0x12019f</span> <span class="n">File</span>             <span class="err">\</span><span class="n">Device</span><span class="err">\</span><span class="n">ConDrv</span><span class="err">\</span><span class="n">Output</span>
<span class="mh">0xe00001d0db80</span>   <span class="mi">2628</span>           <span class="mh">0x24</span>       <span class="mh">0x100020</span> <span class="n">File</span>             <span class="err">\</span><span class="n">Device</span><span class="err">\</span><span class="n">HarddiskVolume2</span><span class="err">\</span><span class="n">temp</span>
<span class="mh">0xe0000006e1f0</span>   <span class="mi">2628</span>           <span class="mh">0x28</span>       <span class="mh">0x12019f</span> <span class="n">File</span>             <span class="err">\</span><span class="n">Device</span><span class="err">\</span><span class="n">ConDrv</span><span class="err">\</span><span class="n">Connect</span>
<span class="mh">0xe00000637480</span>   <span class="mi">2628</span>           <span class="mh">0x30</span>       <span class="mh">0x1f0001</span> <span class="n">ALPC</span> <span class="n">Port</span>
<span class="mh">0xe000006bd290</span>   <span class="mi">2628</span>           <span class="mh">0x34</span>       <span class="mh">0x1f0003</span> <span class="n">Event</span>
<span class="mh">0xe00001ed6060</span>   <span class="mi">2628</span>           <span class="mh">0x38</span>            <span class="mh">0x1</span> <span class="n">WaitCompletionPacket</span>
<span class="mh">0xe00001ecd080</span>   <span class="mi">2628</span>           <span class="mh">0x3c</span>       <span class="mh">0x1f0003</span> <span class="n">IoCompletion</span>
<span class="mh">0xe00001ec7060</span>   <span class="mi">2628</span>           <span class="mh">0x40</span>        <span class="mh">0xf00ff</span> <span class="n">TpWorkerFactory</span>
<span class="mh">0xe00000778320</span>   <span class="mi">2628</span>           <span class="mh">0x44</span>       <span class="mh">0x100002</span> <span class="n">IRTimer</span>
<span class="mh">0xe00001ecfb80</span>   <span class="mi">2628</span>           <span class="mh">0x48</span>            <span class="mh">0x1</span> <span class="n">WaitCompletionPacket</span>
<span class="mh">0xe00001a629d0</span>   <span class="mi">2628</span>           <span class="mh">0x4c</span>       <span class="mh">0x100002</span> <span class="n">IRTimer</span>
<span class="mh">0xe00001ec8f90</span>   <span class="mi">2628</span>           <span class="mh">0x50</span>            <span class="mh">0x1</span> <span class="n">WaitCompletionPacket</span>
<span class="mh">0xe00002048970</span>   <span class="mi">2628</span>           <span class="mh">0x54</span>          <span class="mh">0x804</span> <span class="n">EtwRegistration</span>
<span class="mh">0xe0000077dd00</span>   <span class="mi">2628</span>           <span class="mh">0x58</span>       <span class="mh">0x100003</span> <span class="n">Semaphore</span>
<span class="mh">0xe00001d1b340</span>   <span class="mi">2628</span>           <span class="mh">0x5c</span>       <span class="mh">0x100001</span> <span class="n">File</span>             <span class="err">\</span><span class="n">Device</span><span class="err">\</span><span class="n">CNG</span>
<span class="mh">0xe000006b82c0</span>   <span class="mi">2628</span>           <span class="mh">0x60</span>       <span class="mh">0x100003</span> <span class="n">Semaphore</span>
<span class="mh">0xe00001d0c6e0</span>   <span class="mi">2628</span>           <span class="mh">0x64</span>       <span class="mh">0x120196</span> <span class="n">File</span>             <span class="err">\</span><span class="n">Device</span><span class="err">\</span><span class="n">HarddiskVolume2</span><span class="err">\</span><span class="n">temp</span><span class="err">\</span><span class="n">win8</span><span class="mf">.1</span><span class="p">.</span><span class="n">raw</span>
<span class="mh">0xe000007db2f0</span>   <span class="mi">2628</span>           <span class="mh">0x74</span>       <span class="mh">0x1f0003</span> <span class="n">Event</span>
<span class="mh">0xe000023eda60</span>   <span class="mi">2628</span>           <span class="mh">0x78</span>          <span class="mh">0x804</span> <span class="n">EtwRegistration</span>
<span class="mh">0xe000024c56c0</span>   <span class="mi">2628</span>           <span class="mh">0x7c</span>          <span class="mh">0x804</span> <span class="n">EtwRegistration</span>
<span class="mh">0xe00001f803e0</span>   <span class="mi">2628</span>           <span class="mh">0x80</span>          <span class="mh">0x804</span> <span class="n">EtwRegistration</span>
<span class="mh">0xe00000813330</span>   <span class="mi">2628</span>           <span class="mh">0x84</span>       <span class="mh">0x1f0003</span> <span class="n">Event</span>
<span class="mh">0xe00001254440</span>   <span class="mi">2628</span>           <span class="mh">0x88</span>       <span class="mh">0x1fffff</span> <span class="n">Thread</span>           <span class="n">TID</span> <span class="mi">3420</span> <span class="n">PID</span> <span class="mi">2628</span>
<span class="mh">0xe0000061ebb0</span>   <span class="mi">2628</span>           <span class="mh">0x8c</span>       <span class="mh">0x1f0001</span> <span class="n">ALPC</span> <span class="n">Port</span>
<span class="mh">0xe00001d0c340</span>   <span class="mi">2628</span>           <span class="mh">0x90</span>       <span class="mh">0x12019f</span> <span class="n">File</span>             <span class="err">\</span><span class="n">Device</span><span class="err">\</span><span class="n">pmem</span>
</pre></div>
</div>

<h1 id="hooks_eat" class="anchor">hooks_eat</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.malware.apihooks.EATHooks-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Detect EAT hooks in process and kernel memory</h2>
</div>


<h3>Plugin Arguments</h3>
<div class="plugins_args">
<table class='table table-condensed'>
<tbody>
<tr><td><p>eprocess</p></td><td><p>Kernel addresses of eprocess structs. (type: ArrayIntParser)</p></td></tr><tr><td><p>method</p></td><td><p>Method to list processes. (type: ChoiceArray)</p>
<ul>
<li>
<p>Valid Choices:</p>
<ul>
<li>PsActiveProcessHead</li>
<li>CSRSS</li>
<li>PspCidTable</li>
<li>Sessions</li>
<li>Handles</li>
</ul>
</li>
<li>
<p>Default: PsActiveProcessHead, CSRSS, PspCidTable, Sessions, Handles</p>
</li>
</ul></td></tr><tr><td><p>phys_eprocess</p></td><td><p>Physical addresses of eprocess structs. (type: ArrayIntParser)</p></td></tr><tr><td><p>pid</p></td><td><p>One or more pids of processes to select. (type: ArrayIntParser)</p></td></tr><tr><td><p>proc_regex</p></td><td><p>A regex to select a process by name. (type: RegEx)</p></td></tr><tr><td><p>verbosity</p></td><td><p>An integer reflecting the amount of desired output: 0 = quiet, 10 = noisy. (type: IntParser)</p>
<ul>
<li>Default: 1</li>
</ul></td></tr>
</tbody>
</table>
</div>



</div>

<h1 id="hooks_iat" class="anchor">hooks_iat</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.malware.apihooks.IATHooks-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Detect IAT/EAT hooks in process and kernel memory</h2>
</div>


<h3>Plugin Arguments</h3>
<div class="plugins_args">
<table class='table table-condensed'>
<tbody>
<tr><td><p>eprocess</p></td><td><p>Kernel addresses of eprocess structs. (type: ArrayIntParser)</p></td></tr><tr><td><p>method</p></td><td><p>Method to list processes. (type: ChoiceArray)</p>
<ul>
<li>
<p>Valid Choices:</p>
<ul>
<li>PsActiveProcessHead</li>
<li>CSRSS</li>
<li>PspCidTable</li>
<li>Sessions</li>
<li>Handles</li>
</ul>
</li>
<li>
<p>Default: PsActiveProcessHead, CSRSS, PspCidTable, Sessions, Handles</p>
</li>
</ul></td></tr><tr><td><p>phys_eprocess</p></td><td><p>Physical addresses of eprocess structs. (type: ArrayIntParser)</p></td></tr><tr><td><p>pid</p></td><td><p>One or more pids of processes to select. (type: ArrayIntParser)</p></td></tr><tr><td><p>proc_regex</p></td><td><p>A regex to select a process by name. (type: RegEx)</p></td></tr><tr><td><p>verbosity</p></td><td><p>An integer reflecting the amount of desired output: 0 = quiet, 10 = noisy. (type: IntParser)</p>
<ul>
<li>Default: 1</li>
</ul></td></tr>
</tbody>
</table>
</div>



</div>

<h1 id="hooks_inline" class="anchor">hooks_inline</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.malware.apihooks.InlineHooks-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Detect API hooks in process and kernel memory</h2>
</div>


<h3>Plugin Arguments</h3>
<div class="plugins_args">
<table class='table table-condensed'>
<tbody>
<tr><td><p>eprocess</p></td><td><p>Kernel addresses of eprocess structs. (type: ArrayIntParser)</p></td></tr><tr><td><p>method</p></td><td><p>Method to list processes. (type: ChoiceArray)</p>
<ul>
<li>
<p>Valid Choices:</p>
<ul>
<li>PsActiveProcessHead</li>
<li>CSRSS</li>
<li>PspCidTable</li>
<li>Sessions</li>
<li>Handles</li>
</ul>
</li>
<li>
<p>Default: PsActiveProcessHead, CSRSS, PspCidTable, Sessions, Handles</p>
</li>
</ul></td></tr><tr><td><p>phys_eprocess</p></td><td><p>Physical addresses of eprocess structs. (type: ArrayIntParser)</p></td></tr><tr><td><p>pid</p></td><td><p>One or more pids of processes to select. (type: ArrayIntParser)</p></td></tr><tr><td><p>proc_regex</p></td><td><p>A regex to select a process by name. (type: RegEx)</p></td></tr><tr><td><p>verbosity</p></td><td><p>An integer reflecting the amount of desired output: 0 = quiet, 10 = noisy. (type: IntParser)</p>
<ul>
<li>Default: 1</li>
</ul></td></tr>
</tbody>
</table>
</div>



</div>

<h1 id="imageinfo" class="anchor">imageinfo</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.misc.ImageInfo-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>List overview information about this image.</h2>
</div>



<p>This plugin prints an overview of certain parameters of the image.</p>
<h3>Notes</h3>
<ol>
<li>Since Rekall does not require users to select the profiles manually this
   plugin is not required to be run prior to any analysis. In fact the plugin
   itself needs to have accurate profiles loaded. It therefore does not server
   the same purpose as in previous version of the software.</li>
</ol>
<h3>Sample output</h3>
<div class="highlight"><pre><span class="n">win8</span><span class="mf">.1</span><span class="p">.</span><span class="n">raw</span> <span class="mi">18</span><span class="o">:</span><span class="mo">00</span><span class="o">:</span><span class="mi">48</span><span class="o">&gt;</span> <span class="n">imageinfo</span>
<span class="o">-------------------&gt;</span> <span class="n">imageinfo</span><span class="p">()</span>
<span class="n">Fact</span>                 <span class="n">Value</span>
<span class="o">--------------------</span> <span class="o">-----</span>
<span class="n">Kernel</span> <span class="n">DTB</span>           <span class="mh">0x1a7000</span>
<span class="n">NT</span> <span class="n">Build</span>             <span class="mf">9600.</span><span class="n">winblue_gdr</span><span class="mf">.130913</span><span class="o">-</span><span class="mi">2141</span>
<span class="n">NT</span> <span class="n">Build</span> <span class="n">Ex</span>          <span class="mf">9600.16404</span><span class="p">.</span><span class="n">amd64fre</span><span class="p">.</span><span class="n">winblue_gdr</span><span class="mf">.130913</span><span class="o">-</span><span class="mi">2141</span>
<span class="n">Signed</span> <span class="n">Drivers</span>       <span class="o">-</span>
<span class="n">Time</span> <span class="p">(</span><span class="n">UTC</span><span class="p">)</span>           <span class="mi">2014</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">24</span> <span class="mi">21</span><span class="o">:</span><span class="mi">20</span><span class="o">:</span><span class="mo">05</span><span class="o">+</span><span class="mo">0000</span>
<span class="n">Time</span> <span class="p">(</span><span class="n">Local</span><span class="p">)</span>         <span class="mi">2014</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">24</span> <span class="mi">21</span><span class="o">:</span><span class="mi">20</span><span class="o">:</span><span class="mo">05</span><span class="o">+</span><span class="mo">0000</span>
<span class="n">Sec</span> <span class="n">Since</span> <span class="n">Boot</span>       <span class="mf">764.359375</span>
<span class="n">NtSystemRoot</span>         <span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">Windows</span>
<span class="o">****************</span> <span class="n">Physical</span> <span class="n">Layout</span> <span class="o">****************</span>
<span class="n">Physical</span> <span class="n">Start</span>  <span class="n">Physical</span> <span class="n">End</span>  <span class="n">Number</span> <span class="n">of</span> <span class="n">Pages</span>
<span class="o">--------------</span> <span class="o">--------------</span> <span class="o">---------------</span>
<span class="mh">0x000000001000</span> <span class="mh">0x00000009f000</span> <span class="mi">158</span>
<span class="mh">0x000000100000</span> <span class="mh">0x000000102000</span> <span class="mi">2</span>
<span class="mh">0x000000103000</span> <span class="mh">0x00003fff0000</span> <span class="mi">261869</span>
</pre></div>
</div>

<h1 id="impscan" class="anchor">impscan</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.malware.impscan.ImpScan-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Scan for calls to imported functions.</h2>
</div>


<h3>Plugin Arguments</h3>
<div class="plugins_args">
<table class='table table-condensed'>
<tbody>
<tr><td><p>base</p></td><td><p>Base address in process memory if &ndash;pid is supplied, otherwise an address in kernel space (type: IntParser)</p></td></tr><tr><td><p>eprocess</p></td><td><p>Kernel addresses of eprocess structs. (type: ArrayIntParser)</p></td></tr><tr><td><p>kernel</p></td><td><p>Scan in kernel space. (type: Boolean)</p></td></tr><tr><td><p>method</p></td><td><p>Method to list processes. (type: ChoiceArray)</p>
<ul>
<li>
<p>Valid Choices:</p>
<ul>
<li>PsActiveProcessHead</li>
<li>CSRSS</li>
<li>PspCidTable</li>
<li>Sessions</li>
<li>Handles</li>
</ul>
</li>
<li>
<p>Default: PsActiveProcessHead, CSRSS, PspCidTable, Sessions, Handles</p>
</li>
</ul></td></tr><tr><td><p>phys_eprocess</p></td><td><p>Physical addresses of eprocess structs. (type: ArrayIntParser)</p></td></tr><tr><td><p>pid</p></td><td><p>One or more pids of processes to select. (type: ArrayIntParser)</p></td></tr><tr><td><p>proc_regex</p></td><td><p>A regex to select a process by name. (type: RegEx)</p></td></tr><tr><td><p>size</p></td><td><p>Size of memory to scan (type: IntParser)</p></td></tr>
</tbody>
</table>
</div>


<h3>Sample output</h3>
<div class="highlight"><pre><span class="n">win8</span><span class="mf">.1</span><span class="p">.</span><span class="n">raw</span> <span class="mi">18</span><span class="o">:</span><span class="mi">30</span><span class="o">:</span><span class="mi">34</span><span class="o">&gt;</span> <span class="n">impscan</span> <span class="n">proc_regex</span><span class="o">=</span><span class="s">&quot;dwm.exe&quot;</span>
<span class="o">-------------------&gt;</span> <span class="n">impscan</span><span class="p">(</span><span class="n">proc_regex</span><span class="o">=</span><span class="s">&quot;dwm.exe&quot;</span><span class="p">)</span>
<span class="o">**************************************************</span>
<span class="n">Process</span> <span class="n">dwm</span><span class="p">.</span><span class="n">exe</span> <span class="n">PID</span> <span class="mi">692</span>
     <span class="n">IAT</span>            <span class="n">Call</span>      <span class="n">Module</span>               <span class="n">Function</span>
<span class="o">--------------</span> <span class="o">--------------</span> <span class="o">--------------------</span> <span class="o">--------</span>
<span class="mh">0x7ff7474f4000</span> <span class="mh">0x7ff87f2c369c</span> <span class="n">sechost</span><span class="p">.</span><span class="n">dll</span>          <span class="n">ConvertStringSecurityDescriptorToSecurityDescriptorW</span>
<span class="mh">0x7ff7474f4030</span> <span class="mh">0x7ff87b48beb0</span> <span class="n">uxtheme</span><span class="p">.</span><span class="n">dll</span>          <span class="n">CloseThemeData</span>
<span class="mh">0x7ff7474f4038</span> <span class="mh">0x7ff87b4bfc80</span> <span class="n">uxtheme</span><span class="p">.</span><span class="n">dll</span>          <span class="n">OpenThemeData</span>
<span class="mh">0x7ff7474fa020</span> <span class="mh">0x7ff87e4b5d34</span> <span class="n">msvcrt</span><span class="p">.</span><span class="n">dll</span>           <span class="mi">382</span>
<span class="mh">0x7ff7474fa030</span> <span class="mh">0x7ff87e4b5f18</span> <span class="n">msvcrt</span><span class="p">.</span><span class="n">dll</span>           <span class="mi">410</span>
<span class="mh">0x7ff7474fa050</span> <span class="mh">0x7ff87e4b9948</span> <span class="n">msvcrt</span><span class="p">.</span><span class="n">dll</span>           <span class="mi">144</span>
<span class="mh">0x7ff7474fa058</span> <span class="mh">0x7ff87e4babc0</span> <span class="n">msvcrt</span><span class="p">.</span><span class="n">dll</span>           <span class="mi">129</span>
<span class="mh">0x7ff7474fa0e0</span> <span class="mh">0x7ff87e4b468c</span> <span class="n">msvcrt</span><span class="p">.</span><span class="n">dll</span>           <span class="mi">35</span>
<span class="mh">0x7ff7474fa0e8</span> <span class="mh">0x7ff87e4b1cd4</span> <span class="n">msvcrt</span><span class="p">.</span><span class="n">dll</span>           <span class="mi">36</span>
<span class="mh">0x7ff7474fa120</span> <span class="mh">0x7ff87f38f85c</span> <span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span>            <span class="mi">1252</span>
<span class="mh">0x7ff7474fa128</span> <span class="mh">0x7ff87f36e384</span> <span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span>            <span class="mi">1229</span>
<span class="mh">0x7ff7474fa130</span> <span class="mh">0x7ff87c9a3dec</span> <span class="n">KERNELBASE</span><span class="p">.</span><span class="n">dll</span>       <span class="mi">170</span>
<span class="mh">0x7ff7474fa138</span> <span class="mh">0x7ff87f33c31c</span> <span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span>            <span class="mi">815</span>
<span class="mh">0x7ff7474fa148</span> <span class="mh">0x7ff87f383270</span> <span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span>            <span class="n">RtlInitializeCriticalSection</span>
<span class="mh">0x7ff7474fa158</span> <span class="mh">0x7ff87f36d100</span> <span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span>            <span class="n">RtlAcquireSRWLockShared</span>
<span class="mh">0x7ff7474fa168</span> <span class="mh">0x7ff87f36b810</span> <span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span>            <span class="n">RtlLeaveCriticalSection</span>
<span class="mh">0x7ff7474fa170</span> <span class="mh">0x7ff87c9a24f4</span> <span class="n">KERNELBASE</span><span class="p">.</span><span class="n">dll</span>       <span class="mi">157</span>
<span class="mh">0x7ff7474fa180</span> <span class="mh">0x7ff87f36e50c</span> <span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span>            <span class="mi">1228</span>
<span class="mh">0x7ff7474fa188</span> <span class="mh">0x7ff87f35db60</span> <span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span>            <span class="n">RtlAcquireSRWLockExclusive</span>
<span class="mh">0x7ff7474fa190</span> <span class="mh">0x7ff87f36b550</span> <span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span>            <span class="mi">867</span>
<span class="mh">0x7ff7474fa1a0</span> <span class="mh">0x7ff87c9a14a0</span> <span class="n">KERNELBASE</span><span class="p">.</span><span class="n">dll</span>       <span class="mi">635</span>
<span class="mh">0x7ff7474fa1c8</span> <span class="mh">0x7ff87c9a1440</span> <span class="n">KERNELBASE</span><span class="p">.</span><span class="n">dll</span>       <span class="mi">481</span>
<span class="mh">0x7ff7474fa1e8</span> <span class="mh">0x7ff87f37c7c0</span> <span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span>            <span class="n">RtlSetLastWin32Error</span>
<span class="mh">0x7ff7474fa1f8</span> <span class="mh">0x7ff87f366b90</span> <span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span>            <span class="mi">928</span>
<span class="mh">0x7ff7474fa200</span> <span class="mh">0x7ff87f3620d0</span> <span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span>            <span class="n">RtlAllocateHeap</span>
<span class="mh">0x7ff7474fa208</span> <span class="mh">0x7ff87c9ac960</span> <span class="n">KERNELBASE</span><span class="p">.</span><span class="n">dll</span>       <span class="mi">684</span>
<span class="mh">0x7ff7474fa218</span> <span class="mh">0x7ff87c9a14e0</span> <span class="n">KERNELBASE</span><span class="p">.</span><span class="n">dll</span>       <span class="mi">554</span>
<span class="mh">0x7ff7474fa230</span> <span class="mh">0x7ff87edd3184</span> <span class="n">KERNEL32</span><span class="p">.</span><span class="n">DLL</span>         <span class="n">GetStartupInfoW</span>
<span class="mh">0x7ff7474fa238</span> <span class="mh">0x7ff87edd3074</span> <span class="n">KERNEL32</span><span class="p">.</span><span class="n">DLL</span>         <span class="n">SetPriorityClass</span>
</pre></div>
</div>

<h1 id="kdbgscan" class="anchor">kdbgscan</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.kdbgscan.KDBGScan-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Scan for possible _KDDEBUGGER_DATA64 structures.</h2>
<p>The scanner is detailed here:
http://moyix.blogspot.com/2008/04/finding-kernel-global-variables-in.html</p>
<p>The relevant structures are detailed here:
http://doxygen.reactos.org/d3/ddf/include_2psdk_2wdbgexts_8h_source.html</p>
<p>We can see that _KDDEBUGGER_DATA64.Header is:</p>
<p>typedef struct _DBGKD_DEBUG_DATA_HEADER64 {
    LIST_ENTRY64    List;
    ULONG           OwnerTag;
    ULONG           Size;
}</p>
<p>We essentially search for an owner tag of &ldquo;KDBG&rdquo;, then overlay the
_KDDEBUGGER_DATA64 struct on it. We test for validity by reflecting
through the Header.List member.</p>
</div>


<h3>Plugin Arguments</h3>
<div class="plugins_args">
<table class='table table-condensed'>
<tbody>
<tr><td><p>full_scan</p></td><td><p>Scan the full address space. (type: Boolean)</p>
<ul>
<li>Default: False</li>
</ul></td></tr>
</tbody>
</table>
</div>


<p>Windows keeps a store of some useful global variables in a structure called
<strong>_KDDEBUGGER_DATA64</strong>. This information is used by the microsoft kernel
debugger in order to bootstap the analysis of a crash dump.</p>
<p>Rekall no longer uses the Kernel Debugger Block for analysis - instead accurate
global symbol information are fetched from Microsoft PDB files containing
debugging symbols.</p>
<h3>Notes</h3>
<ol>
<li>Previous versions of Rekall used the KDBG heavily for analysis, and by
   extension used this plugin. Currently the KDBG is not used by Rekall at all
   so this plugin is not all that useful.</li>
</ol>
</div>

<h1 id="kpcr" class="anchor">kpcr</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.kpcr.KPCR-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>A plugin to print all KPCR blocks.</h2>
</div>



<p>Windows maintains per-processor information for each physical CPU in the
system. This plugin displays this infomation.</p>
<h3>Sample output</h3>
<div class="highlight"><pre><span class="n">win8</span><span class="mf">.1</span><span class="p">.</span><span class="n">raw</span> <span class="mi">21</span><span class="o">:</span><span class="mi">15</span><span class="o">:</span><span class="mi">09</span><span class="o">&gt;</span> <span class="n">kpcr</span>
<span class="o">-------------------&gt;</span> <span class="n">kpcr</span><span class="p">()</span>
<span class="o">**************************************************</span>
<span class="n">Property</span>                       <span class="n">Value</span>
<span class="o">------------------------------</span> <span class="o">-----</span>
<span class="n">Offset</span> <span class="p">(</span><span class="n">V</span><span class="p">)</span>                     <span class="mh">0xf802d3307000</span>
<span class="n">KdVersionBlock</span>                 <span class="n">Pointer</span> <span class="n">to</span> <span class="o">-</span>
<span class="n">IDT</span>                            <span class="mh">0xf802d4a43080</span>
<span class="n">GDT</span>                            <span class="mh">0xf802d4a43000</span>
<span class="n">CurrentThread</span>                 <span class="o">:</span> <span class="mh">0xe00001254440</span> <span class="n">TID</span> <span class="mi">3420</span> <span class="p">(</span><span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span><span class="o">:</span><span class="mi">2628</span><span class="p">)</span>
<span class="n">IdleThread</span>                    <span class="o">:</span> <span class="mh">0xf802d335fa80</span> <span class="n">TID</span> <span class="mi">0</span> <span class="p">(</span><span class="n">System</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span>
<span class="n">Details</span>                       <span class="o">:</span> <span class="n">CPU</span> <span class="mi">0</span> <span class="p">(</span><span class="n">GenuineIntel</span> <span class="err">@</span> <span class="mi">2517</span> <span class="n">MHz</span><span class="p">)</span>
<span class="n">CR3</span><span class="o">/</span><span class="n">DTB</span>                       <span class="o">:</span> <span class="mh">0x1a7000</span>
</pre></div>
</div>

<h1 id="ldrmodules" class="anchor">ldrmodules</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.malware.malfind.LdrModules-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Detect unlinked DLLs</h2>
</div>


<h3>Plugin Arguments</h3>
<div class="plugins_args">
<table class='table table-condensed'>
<tbody>
<tr><td><p>eprocess</p></td><td><p>Kernel addresses of eprocess structs. (type: ArrayIntParser)</p></td></tr><tr><td><p>method</p></td><td><p>Method to list processes. (type: ChoiceArray)</p>
<ul>
<li>
<p>Valid Choices:</p>
<ul>
<li>PsActiveProcessHead</li>
<li>CSRSS</li>
<li>PspCidTable</li>
<li>Sessions</li>
<li>Handles</li>
</ul>
</li>
<li>
<p>Default: PsActiveProcessHead, CSRSS, PspCidTable, Sessions, Handles</p>
</li>
</ul></td></tr><tr><td><p>phys_eprocess</p></td><td><p>Physical addresses of eprocess structs. (type: ArrayIntParser)</p></td></tr><tr><td><p>pid</p></td><td><p>One or more pids of processes to select. (type: ArrayIntParser)</p></td></tr><tr><td><p>proc_regex</p></td><td><p>A regex to select a process by name. (type: RegEx)</p></td></tr><tr><td><p>verbosity</p></td><td><p>An integer reflecting the amount of desired output: 0 = quiet, 10 = noisy. (type: IntParser)</p>
<ul>
<li>Default: 1</li>
</ul></td></tr>
</tbody>
</table>
</div>


<p>There are many ways to hide a DLL. One of the ways involves unlinking the DLL
from one (or all) of the linked lists in the PEB. However, when this is done,
there is still information contained within the VAD (Virtual Address Descriptor)
which identifies the base address of the DLL and its full path on disk. To
cross-reference this information (known as memory mapped files) with the 3 PEB
lists, use the ldrmodules command.</p>
<p>For each memory mapped PE file, the ldrmodules command prints True or False if
the PE exists in the PEB lists.</p>
<div class="highlight"><pre><span class="n">win8</span><span class="mf">.1</span><span class="p">.</span><span class="n">raw</span> <span class="mi">22</span><span class="o">:</span><span class="mi">17</span><span class="o">:</span><span class="mi">36</span><span class="o">&gt;</span> <span class="n">ldrmodules</span> <span class="n">proc_regex</span><span class="o">=</span><span class="s">&quot;winpmem&quot;</span>
<span class="o">-------------------&gt;</span> <span class="n">ldrmodules</span><span class="p">(</span><span class="n">proc_regex</span><span class="o">=</span><span class="s">&quot;winpmem&quot;</span><span class="p">)</span>
<span class="n">Pid</span>      <span class="n">Process</span>                   <span class="n">Base</span>      <span class="n">InLoad</span> <span class="n">InInit</span> <span class="n">InMem</span> <span class="n">MappedPath</span>
<span class="o">--------</span> <span class="o">--------------------</span> <span class="o">--------------</span> <span class="o">------</span> <span class="o">------</span> <span class="o">-----</span> <span class="o">----------</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x0000753b0000</span> <span class="n">False</span> <span class="n">False</span> <span class="n">False</span> <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">KernelBase</span><span class="p">.</span><span class="n">dll</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x000000020000</span> <span class="n">True</span>  <span class="n">False</span> <span class="n">True</span>  <span class="err">\</span><span class="n">temp</span><span class="err">\</span><span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span><span class="n">exe</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x000076c30000</span> <span class="n">False</span> <span class="n">False</span> <span class="n">False</span> <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">kernel32</span><span class="p">.</span><span class="n">dll</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x000074a40000</span> <span class="n">False</span> <span class="n">False</span> <span class="n">False</span> <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">cryptbase</span><span class="p">.</span><span class="n">dll</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x000074a50000</span> <span class="n">False</span> <span class="n">False</span> <span class="n">False</span> <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">sspicli</span><span class="p">.</span><span class="n">dll</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x000077010000</span> <span class="n">True</span>  <span class="n">True</span>  <span class="n">True</span>  <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">wow64cpu</span><span class="p">.</span><span class="n">dll</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x000076f50000</span> <span class="n">True</span>  <span class="n">True</span>  <span class="n">True</span>  <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">wow64</span><span class="p">.</span><span class="n">dll</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x000076fa0000</span> <span class="n">True</span>  <span class="n">True</span>  <span class="n">True</span>  <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">wow64win</span><span class="p">.</span><span class="n">dll</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x000075250000</span> <span class="n">False</span> <span class="n">False</span> <span class="n">False</span> <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">rpcrt4</span><span class="p">.</span><span class="n">dll</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x7ff87f320000</span> <span class="n">True</span>  <span class="n">True</span>  <span class="n">True</span>  <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x000077020000</span> <span class="n">False</span> <span class="n">False</span> <span class="n">False</span> <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x0000749e0000</span> <span class="n">False</span> <span class="n">False</span> <span class="n">False</span> <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">bcryptprimitives</span><span class="p">.</span><span class="n">dll</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x000074ff0000</span> <span class="n">False</span> <span class="n">False</span> <span class="n">False</span> <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">advapi32</span><span class="p">.</span><span class="n">dll</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x000076f10000</span> <span class="n">False</span> <span class="n">False</span> <span class="n">False</span> <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">sechost</span><span class="p">.</span><span class="n">dll</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x000074d80000</span> <span class="n">False</span> <span class="n">False</span> <span class="n">False</span> <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">msvcrt</span><span class="p">.</span><span class="n">dll</span>
</pre></div>


<p>Since the PEB and the DLL lists that it contains all exist in user mode, its
also possible for malware to hide (or obscure) a DLL by simply overwriting the
path. Tools that only look for unlinked entries may miss the fact that malware
could overwrite <em>C:\bad.dll</em> to show <em>C:\windows\system32\kernel32.dll</em>. So you
can also pass the <em>verbosity=10</em> parameter to ldrmodules to see the full path of
all entries.</p>
<p>For concrete examples, see <a href="http://blogs.mcafee.com/mcafee-labs/zeroaccess-misleads-memory-file-link">ZeroAccess Misleads Memory-File
Link</a>
and <a href="http://mnin.blogspot.com/2012/06/quickpost-flame-volatility.html">QuickPost: Flame &amp;
Volatility</a>.</p>
<div class="highlight"><pre><span class="n">win8</span><span class="mf">.1</span><span class="p">.</span><span class="n">raw</span> <span class="mi">22</span><span class="o">:</span><span class="mi">17</span><span class="o">:</span><span class="mi">41</span><span class="o">&gt;</span> <span class="n">ldrmodules</span> <span class="n">proc_regex</span><span class="o">=</span><span class="s">&quot;winpmem&quot;</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="mi">10</span>
<span class="o">-------------------&gt;</span> <span class="n">ldrmodules</span><span class="p">(</span><span class="n">proc_regex</span><span class="o">=</span><span class="s">&quot;winpmem&quot;</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">Pid</span>      <span class="n">Process</span>                   <span class="n">Base</span>      <span class="n">InLoad</span> <span class="n">InInit</span> <span class="n">InMem</span> <span class="n">MappedPath</span>
<span class="o">--------</span> <span class="o">--------------------</span> <span class="o">--------------</span> <span class="o">------</span> <span class="o">------</span> <span class="o">-----</span> <span class="o">----------</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x0000753b0000</span> <span class="n">False</span> <span class="n">False</span> <span class="n">False</span> <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">KernelBase</span><span class="p">.</span><span class="n">dll</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x000000020000</span> <span class="n">True</span>  <span class="n">False</span> <span class="n">True</span>  <span class="err">\</span><span class="n">temp</span><span class="err">\</span><span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span><span class="n">exe</span>
  <span class="n">Load</span> <span class="n">Path</span><span class="o">:</span> <span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">temp</span><span class="err">\</span><span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span><span class="n">exe</span> <span class="o">:</span> <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span><span class="n">exe</span>
  <span class="n">Mem</span> <span class="n">Path</span><span class="o">:</span> <span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">temp</span><span class="err">\</span><span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span><span class="n">exe</span> <span class="o">:</span> <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span><span class="n">exe</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x000076c30000</span> <span class="n">False</span> <span class="n">False</span> <span class="n">False</span> <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">kernel32</span><span class="p">.</span><span class="n">dll</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x000074a40000</span> <span class="n">False</span> <span class="n">False</span> <span class="n">False</span> <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">cryptbase</span><span class="p">.</span><span class="n">dll</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x000074a50000</span> <span class="n">False</span> <span class="n">False</span> <span class="n">False</span> <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">sspicli</span><span class="p">.</span><span class="n">dll</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x000077010000</span> <span class="n">True</span>  <span class="n">True</span>  <span class="n">True</span>  <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">wow64cpu</span><span class="p">.</span><span class="n">dll</span>
  <span class="n">Load</span> <span class="n">Path</span><span class="o">:</span> <span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">system32</span><span class="err">\</span><span class="n">wow64cpu</span><span class="p">.</span><span class="n">dll</span> <span class="o">:</span> <span class="n">wow64cpu</span><span class="p">.</span><span class="n">dll</span>
  <span class="n">Init</span> <span class="n">Path</span><span class="o">:</span> <span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">system32</span><span class="err">\</span><span class="n">wow64cpu</span><span class="p">.</span><span class="n">dll</span> <span class="o">:</span> <span class="n">wow64cpu</span><span class="p">.</span><span class="n">dll</span>
  <span class="n">Mem</span> <span class="n">Path</span><span class="o">:</span> <span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">system32</span><span class="err">\</span><span class="n">wow64cpu</span><span class="p">.</span><span class="n">dll</span> <span class="o">:</span> <span class="n">wow64cpu</span><span class="p">.</span><span class="n">dll</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x000076f50000</span> <span class="n">True</span>  <span class="n">True</span>  <span class="n">True</span>  <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">wow64</span><span class="p">.</span><span class="n">dll</span>
  <span class="n">Load</span> <span class="n">Path</span><span class="o">:</span> <span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SYSTEM32</span><span class="err">\</span><span class="n">wow64</span><span class="p">.</span><span class="n">dll</span> <span class="o">:</span> <span class="n">wow64</span><span class="p">.</span><span class="n">dll</span>
  <span class="n">Init</span> <span class="n">Path</span><span class="o">:</span> <span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SYSTEM32</span><span class="err">\</span><span class="n">wow64</span><span class="p">.</span><span class="n">dll</span> <span class="o">:</span> <span class="n">wow64</span><span class="p">.</span><span class="n">dll</span>
  <span class="n">Mem</span> <span class="n">Path</span><span class="o">:</span> <span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SYSTEM32</span><span class="err">\</span><span class="n">wow64</span><span class="p">.</span><span class="n">dll</span> <span class="o">:</span> <span class="n">wow64</span><span class="p">.</span><span class="n">dll</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x000076fa0000</span> <span class="n">True</span>  <span class="n">True</span>  <span class="n">True</span>  <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">wow64win</span><span class="p">.</span><span class="n">dll</span>
  <span class="n">Load</span> <span class="n">Path</span><span class="o">:</span> <span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">system32</span><span class="err">\</span><span class="n">wow64win</span><span class="p">.</span><span class="n">dll</span> <span class="o">:</span> <span class="n">wow64win</span><span class="p">.</span><span class="n">dll</span>
  <span class="n">Init</span> <span class="n">Path</span><span class="o">:</span> <span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">system32</span><span class="err">\</span><span class="n">wow64win</span><span class="p">.</span><span class="n">dll</span> <span class="o">:</span> <span class="n">wow64win</span><span class="p">.</span><span class="n">dll</span>
  <span class="n">Mem</span> <span class="n">Path</span><span class="o">:</span> <span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">system32</span><span class="err">\</span><span class="n">wow64win</span><span class="p">.</span><span class="n">dll</span> <span class="o">:</span> <span class="n">wow64win</span><span class="p">.</span><span class="n">dll</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x000075250000</span> <span class="n">False</span> <span class="n">False</span> <span class="n">False</span> <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">rpcrt4</span><span class="p">.</span><span class="n">dll</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x7ff87f320000</span> <span class="n">True</span>  <span class="n">True</span>  <span class="n">True</span>  <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span>
  <span class="n">Load</span> <span class="n">Path</span><span class="o">:</span> <span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SYSTEM32</span><span class="err">\</span><span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span> <span class="o">:</span> <span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span>
  <span class="n">Init</span> <span class="n">Path</span><span class="o">:</span> <span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SYSTEM32</span><span class="err">\</span><span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span> <span class="o">:</span> <span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span>
  <span class="n">Mem</span> <span class="n">Path</span><span class="o">:</span> <span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SYSTEM32</span><span class="err">\</span><span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span> <span class="o">:</span> <span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x000077020000</span> <span class="n">False</span> <span class="n">False</span> <span class="n">False</span> <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x0000749e0000</span> <span class="n">False</span> <span class="n">False</span> <span class="n">False</span> <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">bcryptprimitives</span><span class="p">.</span><span class="n">dll</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x000074ff0000</span> <span class="n">False</span> <span class="n">False</span> <span class="n">False</span> <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">advapi32</span><span class="p">.</span><span class="n">dll</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x000076f10000</span> <span class="n">False</span> <span class="n">False</span> <span class="n">False</span> <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">sechost</span><span class="p">.</span><span class="n">dll</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x000074d80000</span> <span class="n">False</span> <span class="n">False</span> <span class="n">False</span> <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">msvcrt</span><span class="p">.</span><span class="n">dll</span>
</pre></div>


<h3>Notes</h3>
<ol>
<li>Wow64 processes (i.e. 32 bit processes on 64 bit windows) will not show any
   32 bit DLLs in any of the loader lists. This is normal (and you will see the
   Dlls loaded from the \Windows\Wow64 directory.</li>
</ol>
</div>

<h1 id="malfind" class="anchor">malfind</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.malware.malfind.Malfind-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Find hidden and injected code</h2>
</div>


<h3>Plugin Arguments</h3>
<div class="plugins_args">
<table class='table table-condensed'>
<tbody>
<tr><td><p>dump_dir</p></td><td><p>Path suitable for dumping files. (Default: Use current directory)</p></td></tr><tr><td><p>eprocess</p></td><td><p>Kernel addresses of eprocess structs. (type: ArrayIntParser)</p></td></tr><tr><td><p>method</p></td><td><p>Method to list processes. (type: ChoiceArray)</p>
<ul>
<li>
<p>Valid Choices:</p>
<ul>
<li>PsActiveProcessHead</li>
<li>CSRSS</li>
<li>PspCidTable</li>
<li>Sessions</li>
<li>Handles</li>
</ul>
</li>
<li>
<p>Default: PsActiveProcessHead, CSRSS, PspCidTable, Sessions, Handles</p>
</li>
</ul></td></tr><tr><td><p>phys_eprocess</p></td><td><p>Physical addresses of eprocess structs. (type: ArrayIntParser)</p></td></tr><tr><td><p>pid</p></td><td><p>One or more pids of processes to select. (type: ArrayIntParser)</p></td></tr><tr><td><p>proc_regex</p></td><td><p>A regex to select a process by name. (type: RegEx)</p></td></tr>
</tbody>
</table>
</div>


<p>The malfind command helps find hidden or injected code/DLLs in user mode memory,
based on characteristics such as VAD tag and page permissions.</p>
<p>Note: malfind does not detect DLLs injected into a process using
<strong>CreateRemoteThread-&gt;LoadLibrary</strong>. DLLs injected with this technique are not
hidden and thus you can view them with dlllist. The purpose of malfind is to
locate DLLs that standard methods/tools do not see.</p>
<p>Here is an example of using it to detect the presence of Zeus. The first memory
segment (starting at 0x2aa0000) was detected because it is executable, marked as
private (not shared between processes) and has a VadS tag&hellip; which means there
is no memory mapped file already occupying the space. Based on a disassembly of
the data found at this address, it seems to contain some API hook trampoline
stubs.</p>
<p>The second memory segment (starting at 0x3080000) was detected because it contained an executable that isn&rsquo;t listed in the PEB&rsquo;s module lists.</p>
<p>If you want to save extracted copies of the memory segments identified by
malfind, just supply an output directory with the <em>dump_dir</em> parameter. In this
case, an unpacked copy of the Zeus binary that was injected into explorer.exe
would be written to disk.</p>
<div class="highlight"><pre><span class="n">zeus2x4</span><span class="p">.</span><span class="n">vmem</span> <span class="mi">22</span><span class="o">:</span><span class="mi">53</span><span class="o">:</span><span class="mi">43</span><span class="o">&gt;</span> <span class="n">malfind</span> <span class="n">proc_regex</span><span class="o">=</span><span class="s">&quot;explorer&quot;</span>
<span class="o">---------------------&gt;</span> <span class="n">malfind</span><span class="p">(</span><span class="n">proc_regex</span><span class="o">=</span><span class="s">&quot;explorer&quot;</span><span class="p">)</span>
<span class="o">**************************************************</span><span class="n">f</span> <span class="n">pid</span> <span class="mi">1752</span>
<span class="nl">Process:</span> <span class="n">explorer</span><span class="p">.</span><span class="n">exe</span> <span class="n">Pid</span><span class="o">:</span> <span class="mi">1752</span> <span class="n">Address</span><span class="o">:</span> <span class="mh">0x2aa0000</span>
<span class="n">Vad</span> <span class="n">Tag</span><span class="o">:</span> <span class="n">VadS</span> <span class="n">Protection</span><span class="o">:</span> <span class="n">EXECUTE_READWRITE</span>
<span class="nl">Flags:</span> <span class="n">CommitCharge</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">MemCommit</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">PrivateMemory</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Protection</span><span class="o">:</span> <span class="mi">6</span>

 <span class="mh">0x2aa0000</span> <span class="n">b8</span> <span class="mi">35</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span> <span class="n">e9</span> <span class="n">a9</span> <span class="n">d1</span> <span class="n">e6</span> <span class="mi">79</span> <span class="mi">68</span> <span class="mi">6</span><span class="n">c</span> <span class="mo">02</span> <span class="mo">00</span> <span class="mo">00</span> <span class="n">e9</span>  <span class="mf">.5</span><span class="p">.......</span><span class="n">yhl</span><span class="p">....</span>
 <span class="mh">0x2aa0010</span> <span class="n">b4</span> <span class="mi">63</span> <span class="n">e7</span> <span class="mi">79</span> <span class="mi">8</span><span class="n">b</span> <span class="n">ff</span> <span class="mi">55</span> <span class="mi">8</span><span class="n">b</span> <span class="n">ec</span> <span class="n">e9</span> <span class="mi">7</span><span class="n">c</span> <span class="mi">11</span> <span class="n">d7</span> <span class="mi">79</span> <span class="mi">8</span><span class="n">b</span> <span class="n">ff</span>  <span class="p">.</span><span class="n">c</span><span class="p">.</span><span class="n">y</span><span class="p">..</span><span class="n">U</span><span class="p">...</span><span class="o">|</span><span class="p">..</span><span class="n">y</span><span class="p">..</span>
 <span class="mh">0x2aa0020</span> <span class="mi">55</span> <span class="mi">8</span><span class="n">b</span> <span class="n">ec</span> <span class="n">e9</span> <span class="mo">01</span> <span class="mi">32</span> <span class="mi">77</span> <span class="mi">74</span> <span class="mi">8</span><span class="n">b</span> <span class="n">ff</span> <span class="mi">55</span> <span class="mi">8</span><span class="n">b</span> <span class="n">ec</span> <span class="n">e9</span> <span class="mi">7</span><span class="n">c</span> <span class="mi">60</span>  <span class="n">U</span><span class="p">...</span><span class="mf">.2</span><span class="n">wt</span><span class="p">..</span><span class="n">U</span><span class="p">...</span><span class="o">|</span><span class="err">`</span>
 <span class="mh">0x2aa0030</span> <span class="mi">72</span> <span class="mi">74</span> <span class="mi">8</span><span class="n">b</span> <span class="n">ff</span> <span class="mi">55</span> <span class="mi">8</span><span class="n">b</span> <span class="n">ec</span> <span class="n">e9</span> <span class="n">ca</span> <span class="n">e9</span> <span class="mi">72</span> <span class="mi">74</span> <span class="mi">8</span><span class="n">b</span> <span class="n">ff</span> <span class="mi">55</span> <span class="mi">8</span><span class="n">b</span>  <span class="n">rt</span><span class="p">..</span><span class="n">U</span><span class="p">.....</span><span class="n">rt</span><span class="p">..</span><span class="n">U</span><span class="p">.</span>

<span class="mh">0x02aa0000</span>      <span class="n">b835000000</span>           <span class="n">MOV</span> <span class="n">EAX</span><span class="p">,</span> <span class="mh">0x35</span>
<span class="mh">0x02aa0005</span>      <span class="n">e9a9d1e679</span>           <span class="n">JMP</span> <span class="mh">0x7c90d1b3</span>
<span class="mh">0x02aa000a</span>      <span class="mi">686</span><span class="n">c020000</span>           <span class="n">PUSH</span> <span class="n">DWORD</span> <span class="mh">0x26c</span>
<span class="mh">0x02aa000f</span>      <span class="n">e9b463e779</span>           <span class="n">JMP</span> <span class="mh">0x7c9163c8</span>
<span class="mh">0x02aa0014</span>      <span class="mi">8</span><span class="n">bff</span>                 <span class="n">MOV</span> <span class="n">EDI</span><span class="p">,</span> <span class="n">EDI</span>
<span class="mh">0x02aa0016</span>      <span class="mi">55</span>                   <span class="n">PUSH</span> <span class="n">EBP</span>
<span class="mh">0x02aa0017</span>      <span class="mi">8</span><span class="n">bec</span>                 <span class="n">MOV</span> <span class="n">EBP</span><span class="p">,</span> <span class="n">ESP</span>
<span class="mh">0x02aa0019</span>      <span class="n">e97c11d779</span>           <span class="n">JMP</span> <span class="mh">0x7c81119a</span>
<span class="mh">0x02aa001e</span>      <span class="mi">8</span><span class="n">bff</span>                 <span class="n">MOV</span> <span class="n">EDI</span><span class="p">,</span> <span class="n">EDI</span>
<span class="mh">0x02aa0020</span>      <span class="mi">55</span>                   <span class="n">PUSH</span> <span class="n">EBP</span>
<span class="mh">0x02aa0021</span>      <span class="mi">8</span><span class="n">bec</span>                 <span class="n">MOV</span> <span class="n">EBP</span><span class="p">,</span> <span class="n">ESP</span>
<span class="mh">0x02aa0023</span>      <span class="n">e901327774</span>           <span class="n">JMP</span> <span class="mh">0x77213229</span>
<span class="mh">0x02aa0028</span>      <span class="mi">8</span><span class="n">bff</span>                 <span class="n">MOV</span> <span class="n">EDI</span><span class="p">,</span> <span class="n">EDI</span>
<span class="mh">0x02aa002a</span>      <span class="mi">55</span>                   <span class="n">PUSH</span> <span class="n">EBP</span>
<span class="mh">0x02aa002b</span>      <span class="mi">8</span><span class="n">bec</span>                 <span class="n">MOV</span> <span class="n">EBP</span><span class="p">,</span> <span class="n">ESP</span>
<span class="mh">0x02aa002d</span>      <span class="n">e97c607274</span>           <span class="n">JMP</span> <span class="mh">0x771c60ae</span>
<span class="mh">0x02aa0032</span>      <span class="mi">8</span><span class="n">bff</span>                 <span class="n">MOV</span> <span class="n">EDI</span><span class="p">,</span> <span class="n">EDI</span>
<span class="mh">0x02aa0034</span>      <span class="mi">55</span>                   <span class="n">PUSH</span> <span class="n">EBP</span>
<span class="mh">0x02aa0035</span>      <span class="mi">8</span><span class="n">bec</span>                 <span class="n">MOV</span> <span class="n">EBP</span><span class="p">,</span> <span class="n">ESP</span>
<span class="mh">0x02aa0037</span>      <span class="n">e9cae97274</span>           <span class="n">JMP</span> <span class="mh">0x771cea06</span>
<span class="mh">0x02aa003c</span>      <span class="mi">8</span><span class="n">bff</span>                 <span class="n">MOV</span> <span class="n">EDI</span><span class="p">,</span> <span class="n">EDI</span>
<span class="mh">0x02aa003e</span>      <span class="mi">55</span>                   <span class="n">PUSH</span> <span class="n">EBP</span>
<span class="mh">0x02aa003f</span>      <span class="mi">8</span><span class="n">bec</span>                 <span class="n">MOV</span> <span class="n">EBP</span><span class="p">,</span> <span class="n">ESP</span>
<span class="mh">0x02aa0041</span>      <span class="n">e9e8327774</span>           <span class="n">JMP</span> <span class="mh">0x7721332e</span>
<span class="mh">0x02aa0046</span>      <span class="mi">8</span><span class="n">bff</span>                 <span class="n">MOV</span> <span class="n">EDI</span><span class="p">,</span> <span class="n">EDI</span>
<span class="mh">0x02aa0048</span>      <span class="mi">55</span>                   <span class="n">PUSH</span> <span class="n">EBP</span>
<span class="mh">0x02aa0049</span>      <span class="mi">8</span><span class="n">bec</span>                 <span class="n">MOV</span> <span class="n">EBP</span><span class="p">,</span> <span class="n">ESP</span>
<span class="mh">0x02aa004b</span>      <span class="n">e9494d7274</span>           <span class="n">JMP</span> <span class="mh">0x771c4d99</span>
<span class="mh">0x02aa0050</span>      <span class="mi">8</span><span class="n">bff</span>                 <span class="n">MOV</span> <span class="n">EDI</span><span class="p">,</span> <span class="n">EDI</span>
<span class="mh">0x02aa0052</span>      <span class="mi">55</span>                   <span class="n">PUSH</span> <span class="n">EBP</span>
<span class="mh">0x02aa0053</span>      <span class="mi">8</span><span class="n">bec</span>                 <span class="n">MOV</span> <span class="n">EBP</span><span class="p">,</span> <span class="n">ESP</span>
<span class="mh">0x02aa0055</span>      <span class="n">e99d827274</span>           <span class="n">JMP</span> <span class="mh">0x771c82f7</span>
<span class="mh">0x02aa005a</span>      <span class="mi">8</span><span class="n">bff</span>                 <span class="n">MOV</span> <span class="n">EDI</span><span class="p">,</span> <span class="n">EDI</span>
<span class="mh">0x02aa005c</span>      <span class="mi">55</span>                   <span class="n">PUSH</span> <span class="n">EBP</span>
<span class="mh">0x02aa005d</span>      <span class="mi">8</span><span class="n">bec</span>                 <span class="n">MOV</span> <span class="n">EBP</span><span class="p">,</span> <span class="n">ESP</span>
<span class="mh">0x02aa005f</span>      <span class="n">e9ef927574</span>           <span class="n">JMP</span> <span class="mh">0x771f9353</span>
<span class="mh">0x02aa0064</span>      <span class="mi">8</span><span class="n">bff</span>                 <span class="n">MOV</span> <span class="n">EDI</span><span class="p">,</span> <span class="n">EDI</span>
<span class="mh">0x02aa0066</span>      <span class="mi">55</span>                   <span class="n">PUSH</span> <span class="n">EBP</span>
<span class="mh">0x02aa0067</span>      <span class="mi">8</span><span class="n">bec</span>                 <span class="n">MOV</span> <span class="n">EBP</span><span class="p">,</span> <span class="n">ESP</span>
<span class="mh">0x02aa0069</span>      <span class="n">e9fe897374</span>           <span class="n">JMP</span> <span class="mh">0x771d8a6c</span>
<span class="mh">0x02aa006e</span>      <span class="mi">6</span><span class="n">a2c</span>                 <span class="n">PUSH</span> <span class="mh">0x2c</span>
<span class="mh">0x02aa0070</span>      <span class="mi">68187</span><span class="n">b1c77</span>           <span class="n">PUSH</span> <span class="n">DWORD</span> <span class="mh">0x771c7b18</span>
<span class="mh">0x02aa0075</span>      <span class="n">e957797274</span>           <span class="n">JMP</span> <span class="mh">0x771c79d1</span>
<span class="mh">0x02aa007a</span>      <span class="mi">8</span><span class="n">bff</span>                 <span class="n">MOV</span> <span class="n">EDI</span><span class="p">,</span> <span class="n">EDI</span>
<span class="mh">0x02aa007c</span>      <span class="mi">55</span>                   <span class="n">PUSH</span> <span class="n">EBP</span>
<span class="mh">0x02aa007d</span>      <span class="mi">8</span><span class="n">bec</span>                 <span class="n">MOV</span> <span class="n">EBP</span><span class="p">,</span> <span class="n">ESP</span>
<span class="mh">0x02aa007f</span>      <span class="n">e9ac3d016f</span>           <span class="n">JMP</span> <span class="mh">0x71ab3e30</span>
<span class="mh">0x02aa0084</span>      <span class="mi">8</span><span class="n">bff</span>                 <span class="n">MOV</span> <span class="n">EDI</span><span class="p">,</span> <span class="n">EDI</span>
<span class="mh">0x02aa0086</span>      <span class="mi">55</span>                   <span class="n">PUSH</span> <span class="n">EBP</span>
<span class="mh">0x02aa0087</span>      <span class="mi">8</span><span class="n">bec</span>                 <span class="n">MOV</span> <span class="n">EBP</span><span class="p">,</span> <span class="n">ESP</span>
<span class="mh">0x02aa0089</span>      <span class="n">e99e4b016f</span>           <span class="n">JMP</span> <span class="mh">0x71ab4c2c</span>
<span class="mh">0x02aa008e</span>      <span class="mi">8</span><span class="n">bff</span>                 <span class="n">MOV</span> <span class="n">EDI</span><span class="p">,</span> <span class="n">EDI</span>
<span class="mh">0x02aa0090</span>      <span class="mi">55</span>                   <span class="n">PUSH</span> <span class="n">EBP</span>
<span class="mh">0x02aa0091</span>      <span class="mi">8</span><span class="n">bec</span>                 <span class="n">MOV</span> <span class="n">EBP</span><span class="p">,</span> <span class="n">ESP</span>
<span class="mh">0x02aa0093</span>      <span class="n">e96768016f</span>           <span class="n">JMP</span> <span class="mh">0x71ab68ff</span>
<span class="mh">0x02aa0098</span>      <span class="mi">8</span><span class="n">bff</span>                 <span class="n">MOV</span> <span class="n">EDI</span><span class="p">,</span> <span class="n">EDI</span>
<span class="mh">0x02aa009a</span>      <span class="mi">55</span>                   <span class="n">PUSH</span> <span class="n">EBP</span>
<span class="mh">0x02aa009b</span>      <span class="mi">8</span><span class="n">bec</span>                 <span class="n">MOV</span> <span class="n">EBP</span><span class="p">,</span> <span class="n">ESP</span>
<span class="mh">0x02aa009d</span>      <span class="n">e9598b977b</span>           <span class="n">JMP</span> <span class="mh">0x7e418bfb</span>
<span class="mh">0x02aa00a2</span>      <span class="mi">8</span><span class="n">bff</span>                 <span class="n">MOV</span> <span class="n">EDI</span><span class="p">,</span> <span class="n">EDI</span>
<span class="mh">0x02aa00a4</span>      <span class="mi">55</span>                   <span class="n">PUSH</span> <span class="n">EBP</span>
<span class="mh">0x02aa00a5</span>      <span class="mi">8</span><span class="n">bec</span>                 <span class="n">MOV</span> <span class="n">EBP</span><span class="p">,</span> <span class="n">ESP</span>
<span class="mh">0x02aa00a7</span>      <span class="n">e9130d997b</span>           <span class="n">JMP</span> <span class="mh">0x7e430dbf</span>
<span class="mh">0x02aa00ac</span>      <span class="mi">8</span><span class="n">bff</span>                 <span class="n">MOV</span> <span class="n">EDI</span><span class="p">,</span> <span class="n">EDI</span>
<span class="mh">0x02aa00ae</span>      <span class="mi">55</span>                   <span class="n">PUSH</span> <span class="n">EBP</span>
<span class="o">**************************************************</span>
<span class="nl">Process:</span> <span class="n">explorer</span><span class="p">.</span><span class="n">exe</span> <span class="n">Pid</span><span class="o">:</span> <span class="mi">1752</span> <span class="n">Address</span><span class="o">:</span> <span class="mh">0x3080000</span>
<span class="n">Vad</span> <span class="n">Tag</span><span class="o">:</span> <span class="n">VadS</span> <span class="n">Protection</span><span class="o">:</span> <span class="n">EXECUTE_READWRITE</span>
<span class="nl">Flags:</span> <span class="n">CommitCharge</span><span class="o">:</span> <span class="mi">52</span><span class="p">,</span> <span class="n">MemCommit</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">PrivateMemory</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Protection</span><span class="o">:</span> <span class="mi">6</span>

 <span class="mh">0x3080000</span> <span class="mi">4</span><span class="n">d</span> <span class="mi">5</span><span class="n">a</span> <span class="mi">90</span> <span class="mo">00</span> <span class="mo">03</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">04</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span> <span class="n">ff</span> <span class="n">ff</span> <span class="mo">00</span> <span class="mo">00</span>  <span class="n">MZ</span><span class="p">..............</span>
 <span class="mh">0x3080010</span> <span class="n">b8</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mi">40</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span>  <span class="p">........</span><span class="err">@</span><span class="p">.......</span>
 <span class="mh">0x3080020</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span>  <span class="p">................</span>
 <span class="mh">0x3080030</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span> <span class="n">c0</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span>  <span class="p">................</span>

<span class="mh">0x03080000</span>      <span class="mi">4</span><span class="n">d</span>                   <span class="n">DEC</span> <span class="n">EBP</span>
<span class="mh">0x03080001</span>      <span class="mi">5</span><span class="n">a</span>                   <span class="n">POP</span> <span class="n">EDX</span>
<span class="mh">0x03080002</span>      <span class="mi">90</span>                   <span class="n">NOP</span>
<span class="mh">0x03080003</span>      <span class="mo">0003</span>                 <span class="n">ADD</span> <span class="p">[</span><span class="n">EBX</span><span class="p">],</span> <span class="n">AL</span>
<span class="mh">0x03080005</span>      <span class="mo">0000</span>                 <span class="n">ADD</span> <span class="p">[</span><span class="n">EAX</span><span class="p">],</span> <span class="n">AL</span>
<span class="mh">0x03080007</span>      <span class="mo">000400</span>               <span class="n">ADD</span> <span class="p">[</span><span class="n">EAX</span><span class="o">+</span><span class="n">EAX</span><span class="p">],</span> <span class="n">AL</span>
<span class="mh">0x0308000a</span>      <span class="mo">0000</span>                 <span class="n">ADD</span> <span class="p">[</span><span class="n">EAX</span><span class="p">],</span> <span class="n">AL</span>
<span class="mh">0x0308000c</span>      <span class="n">ff</span>                   <span class="n">DB</span> <span class="mh">0xff</span>
<span class="mh">0x0308000d</span>      <span class="n">ff00</span>                 <span class="n">INC</span> <span class="n">DWORD</span> <span class="p">[</span><span class="n">EAX</span><span class="p">]</span>
<span class="mh">0x0308000f</span>      <span class="mo">00</span><span class="n">b800000000</span>         <span class="n">ADD</span> <span class="p">[</span><span class="n">EAX</span><span class="o">+</span><span class="mh">0x0</span><span class="p">],</span> <span class="n">BH</span>
<span class="mh">0x03080015</span>      <span class="mo">0000</span>                 <span class="n">ADD</span> <span class="p">[</span><span class="n">EAX</span><span class="p">],</span> <span class="n">AL</span>
<span class="mh">0x03080017</span>      <span class="mo">004000</span>               <span class="n">ADD</span> <span class="p">[</span><span class="n">EAX</span><span class="o">+</span><span class="mh">0x0</span><span class="p">],</span> <span class="n">AL</span>
<span class="mh">0x0308001a</span>      <span class="mo">0000</span>                 <span class="n">ADD</span> <span class="p">[</span><span class="n">EAX</span><span class="p">],</span> <span class="n">AL</span>
<span class="mh">0x0308001c</span>      <span class="mo">0000</span>                 <span class="n">ADD</span> <span class="p">[</span><span class="n">EAX</span><span class="p">],</span> <span class="n">AL</span>
<span class="mh">0x0308001e</span>      <span class="mo">0000</span>                 <span class="n">ADD</span> <span class="p">[</span><span class="n">EAX</span><span class="p">],</span> <span class="n">AL</span>
</pre></div>
</div>

<h1 id="memdump" class="anchor">memdump</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.taskmods.WinMemDump-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Dump windows processes.</h2>
</div>


<h3>Plugin Arguments</h3>
<div class="plugins_args">
<table class='table table-condensed'>
<tbody>
<tr><td><p>all</p></td><td><p>Use the entire range of address space. (type: Boolean)</p>
<ul>
<li>Default: False</li>
</ul></td></tr><tr><td><p>coalesce</p></td><td><p>Merge contiguous pages into larger ranges. (type: Boolean)</p>
<ul>
<li>Default: False</li>
</ul></td></tr><tr><td><p>dump_dir</p></td><td><p>Path suitable for dumping files. (Default: Use current directory)</p></td></tr><tr><td><p>eprocess</p></td><td><p>Kernel addresses of eprocess structs. (type: ArrayIntParser)</p></td></tr><tr><td><p>method</p></td><td><p>Method to list processes. (type: ChoiceArray)</p>
<ul>
<li>
<p>Valid Choices:</p>
<ul>
<li>PsActiveProcessHead</li>
<li>CSRSS</li>
<li>PspCidTable</li>
<li>Sessions</li>
<li>Handles</li>
</ul>
</li>
<li>
<p>Default: PsActiveProcessHead, CSRSS, PspCidTable, Sessions, Handles</p>
</li>
</ul></td></tr><tr><td><p>phys_eprocess</p></td><td><p>Physical addresses of eprocess structs. (type: ArrayIntParser)</p></td></tr><tr><td><p>pid</p></td><td><p>One or more pids of processes to select. (type: ArrayIntParser)</p></td></tr><tr><td><p>proc_regex</p></td><td><p>A regex to select a process by name. (type: RegEx)</p></td></tr>
</tbody>
</table>
</div>


<p>To dump all addressable memory in a process, use the memdump plugin. This plugin
enumerates the process page tables and writes them out into an external file. An
index file is also created which can be used to find the virtual address of each
byte in the output file.</p>
<p>You would typically use this output file in order to scan for e.g. virus
signatures or other patterns in tools which do not understand virtual memory
mappings.</p>
<p>The plugin accepts all the usual process filtering commands (e.g. by pid,
proc_regex etc). Additionally if no filtering command is specified the plugin
dumps the kernel&rsquo;s address space. (You can dump all processes by providing a
<strong>proc_regex</strong> of &lsquo;.&rsquo;).</p>
<h3>Notes</h3>
<ol>
<li>
<p>This plugin is very similar to the vaddump plugin, except that it dumps the
   page table, and not only the VAD tree. This plugin actually contains all
   memory currently accessible to the process (despite any possible manipulation
   of the VAD tree).</p>
</li>
<li>
<p>The process&rsquo;s virtual address space is typically fragmented and had large,
   unmapped gaps in it. Therefore this plugin does not just zero fill these
   gaps, rather it writes all addressable memory directly to the output
   file. This means that contiguous memory in the output file is not necessarily
   contiguous in memory.</p>
</li>
<li>
<p>To find out where a particular byte in the output file maps in the process
   virtual memory, check the index file (Example below).</p>
</li>
<li>
<p>Note that processes typically alway map the kernel in the upper memory region
   (i.e. above the symbol <code>MmHighestUserAddress</code>. This plugin does not dump the
   kernel portion of the address space, unless the <strong>&ndash;all</strong> parameter is
   specified.</p>
</li>
</ol>
<h3>Sample output</h3>
<div class="highlight"><pre><span class="n">win7</span><span class="p">.</span><span class="n">elf</span> <span class="mo">00</span><span class="o">:</span><span class="mi">30</span><span class="o">:</span><span class="mi">52</span><span class="o">&gt;</span> <span class="n">memdump</span> <span class="n">pid</span><span class="o">=</span><span class="mi">2912</span><span class="p">,</span> <span class="n">dump_dir</span><span class="o">=</span><span class="s">&quot;/tmp/&quot;</span>
<span class="o">-----------------&gt;</span> <span class="n">memdump</span><span class="p">(</span><span class="n">pid</span><span class="o">=</span><span class="mi">2912</span><span class="p">,</span> <span class="n">dump_dir</span><span class="o">=</span><span class="s">&quot;/tmp/&quot;</span><span class="p">)</span>
<span class="o">**************************************************</span>
<span class="n">Writing</span> <span class="n">vol</span><span class="p">.</span><span class="n">exe</span> <span class="mh">0xfa8002193060</span> <span class="n">to</span> <span class="n">vol</span><span class="p">.</span><span class="n">exe_2912</span><span class="p">.</span><span class="n">dmp</span>
<span class="n">win7</span><span class="p">.</span><span class="n">elf</span> <span class="mo">00</span><span class="o">:</span><span class="mi">30</span><span class="o">:</span><span class="mi">55</span><span class="o">&gt;</span> <span class="n">ls</span> <span class="o">-</span><span class="n">l</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">vol</span><span class="p">.</span><span class="n">exe_2912</span><span class="p">.</span><span class="n">dmp</span> <span class="o">-</span><span class="n">h</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">-----</span> <span class="mi">1</span> <span class="n">scudette</span> <span class="n">staff</span> <span class="mf">2.2</span><span class="n">M</span> <span class="n">Jun</span> <span class="mi">18</span> <span class="mo">00</span><span class="o">:</span><span class="mi">30</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">vol</span><span class="p">.</span><span class="n">exe_2912</span><span class="p">.</span><span class="n">dmp</span>
<span class="n">win7</span><span class="p">.</span><span class="n">elf</span> <span class="mo">00</span><span class="o">:</span><span class="mi">30</span><span class="o">:</span><span class="mi">59</span><span class="o">&gt;</span> <span class="n">less</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">vol</span><span class="p">.</span><span class="n">exe_2912</span><span class="p">.</span><span class="n">dmp</span><span class="p">.</span><span class="n">idx</span>
 <span class="n">File</span> <span class="n">Address</span>      <span class="n">Length</span>      <span class="n">Virtual</span> <span class="n">Addr</span>
<span class="o">--------------</span> <span class="o">--------------</span> <span class="o">--------------</span>
<span class="mh">0x000000000000</span> <span class="mh">0x000000001000</span> <span class="mh">0x000000010000</span>
<span class="mh">0x000000001000</span> <span class="mh">0x000000001000</span> <span class="mh">0x000000020000</span>
<span class="mh">0x000000002000</span> <span class="mh">0x000000001000</span> <span class="mh">0x000000021000</span>
<span class="mh">0x000000003000</span> <span class="mh">0x000000001000</span> <span class="mh">0x00000002f000</span>
<span class="mh">0x000000004000</span> <span class="mh">0x000000001000</span> <span class="mh">0x000000040000</span>
<span class="mh">0x000000005000</span> <span class="mh">0x000000001000</span> <span class="mh">0x000000050000</span>
<span class="mh">0x000000006000</span> <span class="mh">0x000000001000</span> <span class="mh">0x000000051000</span>
</pre></div>
</div>

<h1 id="memmap" class="anchor">memmap</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.taskmods.WinMemMap-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Calculates the memory regions mapped by a process.</h2>
</div>


<h3>Plugin Arguments</h3>
<div class="plugins_args">
<table class='table table-condensed'>
<tbody>
<tr><td><p>all</p></td><td><p>Use the entire range of address space. (type: Boolean)</p>
<ul>
<li>Default: False</li>
</ul></td></tr><tr><td><p>coalesce</p></td><td><p>Merge contiguous pages into larger ranges. (type: Boolean)</p>
<ul>
<li>Default: False</li>
</ul></td></tr><tr><td><p>eprocess</p></td><td><p>Kernel addresses of eprocess structs. (type: ArrayIntParser)</p></td></tr><tr><td><p>method</p></td><td><p>Method to list processes. (type: ChoiceArray)</p>
<ul>
<li>
<p>Valid Choices:</p>
<ul>
<li>PsActiveProcessHead</li>
<li>CSRSS</li>
<li>PspCidTable</li>
<li>Sessions</li>
<li>Handles</li>
</ul>
</li>
<li>
<p>Default: PsActiveProcessHead, CSRSS, PspCidTable, Sessions, Handles</p>
</li>
</ul></td></tr><tr><td><p>phys_eprocess</p></td><td><p>Physical addresses of eprocess structs. (type: ArrayIntParser)</p></td></tr><tr><td><p>pid</p></td><td><p>One or more pids of processes to select. (type: ArrayIntParser)</p></td></tr><tr><td><p>proc_regex</p></td><td><p>A regex to select a process by name. (type: RegEx)</p></td></tr>
</tbody>
</table>
</div>


<p>To enumerate the address space of a process use this plugin.</p>
<p>It is not that useful in practice, unless you want to manually translate a
physical address to a virtual address.</p>
<h3>Notes</h3>
<ol>
<li>
<p>It is not often necessary to dump the entire page tables of each
   process. Instead it is possible to first switch to the process context (using
   the <strong>cc</strong> plugin), and then use <em>vtop</em> to translate the virtual address to
   physical address.</p>
</li>
<li>
<p>Similar to the <strong>memdump</strong> plugin, we do not dump the kernel address space
   portion for processes unless the <strong>all</strong> parameter is specified.</p>
</li>
</ol>
<h3>Sample output</h3>
<div class="highlight"><pre><span class="n">win7</span><span class="p">.</span><span class="n">elf</span> <span class="mo">00</span><span class="o">:</span><span class="mi">54</span><span class="o">:</span><span class="mi">22</span><span class="o">&gt;</span> <span class="n">memmap</span> <span class="n">pid</span><span class="o">=</span><span class="mi">2912</span>
<span class="o">-----------------&gt;</span> <span class="n">memmap</span><span class="p">(</span><span class="n">pid</span><span class="o">=</span><span class="mi">2912</span><span class="p">)</span>
<span class="o">**************************************************</span>
<span class="nl">Process:</span> <span class="err">&#39;</span><span class="n">vol</span><span class="p">.</span><span class="n">exe</span><span class="err">&#39;</span> <span class="n">pid</span><span class="o">:</span> <span class="mi">2912</span>

<span class="n">Dumping</span> <span class="n">address</span> <span class="n">space</span> <span class="n">at</span> <span class="n">DTB</span> <span class="mh">0x271ec000</span>

   <span class="n">Virtual</span>        <span class="n">Physical</span>         <span class="n">Size</span>
<span class="o">--------------</span> <span class="o">--------------</span> <span class="o">--------------</span>
<span class="mh">0x000000010000</span> <span class="mh">0x000007c4c000</span>         <span class="mh">0x1000</span>
<span class="mh">0x000000020000</span> <span class="mh">0x00000818f000</span>         <span class="mh">0x1000</span>
<span class="mh">0x000000021000</span> <span class="mh">0x000007e11000</span>         <span class="mh">0x1000</span>
<span class="mh">0x00000002f000</span> <span class="mh">0x000008010000</span>         <span class="mh">0x1000</span>
<span class="mh">0x000000040000</span> <span class="mh">0x00002428e000</span>         <span class="mh">0x1000</span>
<span class="mh">0x000000050000</span> <span class="mh">0x000001e6b000</span>         <span class="mh">0x1000</span>
<span class="mh">0x000000051000</span> <span class="mh">0x000007f49000</span>         <span class="mh">0x1000</span>
</pre></div>
</div>

<h1 id="moddump" class="anchor">moddump</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.procdump.ModDump-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Dump kernel drivers from kernel space.</h2>
</div>


<h3>Plugin Arguments</h3>
<div class="plugins_args">
<table class='table table-condensed'>
<tbody>
<tr><td><p>dump_dir</p></td><td><p>Path suitable for dumping files. (Default: Use current directory)</p></td></tr><tr><td><p>eprocess</p></td><td><p>Kernel addresses of eprocess structs. (type: ArrayIntParser)</p></td></tr><tr><td><p>method</p></td><td><p>Method to list processes. (type: ChoiceArray)</p>
<ul>
<li>
<p>Valid Choices:</p>
<ul>
<li>PsActiveProcessHead</li>
<li>CSRSS</li>
<li>PspCidTable</li>
<li>Sessions</li>
<li>Handles</li>
</ul>
</li>
<li>
<p>Default: PsActiveProcessHead, CSRSS, PspCidTable, Sessions, Handles</p>
</li>
</ul></td></tr><tr><td><p>out_fd</p></td><td><p>A file like object to write the output.</p></td></tr><tr><td><p>phys_eprocess</p></td><td><p>Physical addresses of eprocess structs. (type: ArrayIntParser)</p></td></tr><tr><td><p>pid</p></td><td><p>One or more pids of processes to select. (type: ArrayIntParser)</p></td></tr><tr><td><p>proc_regex</p></td><td><p>A regex to select a process by name. (type: RegEx)</p></td></tr><tr><td><p>regex</p></td><td><p>A Regular expression for selecting the dlls to dump.</p>
<ul>
<li>Default: .+</li>
</ul></td></tr>
</tbody>
</table>
</div>


<p>To extract a kernel module from memory and dump it to disk for analysis, use the
moddump command. A regular expression can be specified for the module name to
dump.</p>
<h3>Note</h3>
<ol>
<li>
<p>In order to dump any PE file from memory we need the PE header to be memory
   resident. Often this is not the case, and the header is flushed out of
   virtual memory.</p>
</li>
<li>
<p>When dumping any binary from memory, it is not usually a perfect binary
   (i.e. you can not just run it). This is because the Import Address Table
   (IAT) reflects the patched version in memory and some pages may be
   missing. The resultant binary is probably only useful to analyses using a
   tool like IDA pro.</p>
</li>
</ol>
<h3>Sample output</h3>
<p>In this example we dump the winpmem driver to disk. The winpmem driver loads
from a temporary file name (You can see it using the <a href="Modules.html">modules</a>
plugin.</p>
<div class="highlight"><pre><span class="n">win8</span><span class="mf">.1</span><span class="p">.</span><span class="n">raw</span> <span class="mi">23</span><span class="o">:</span><span class="mi">27</span><span class="o">:</span><span class="mi">12</span><span class="o">&gt;</span> <span class="n">moddump</span> <span class="n">regex</span><span class="o">=</span><span class="s">&quot;tmp&quot;</span><span class="p">,</span> <span class="n">dump_dir</span><span class="o">=</span><span class="s">&quot;/tmp&quot;</span>
<span class="o">-------------------&gt;</span> <span class="n">moddump</span><span class="p">(</span><span class="n">regex</span><span class="o">=</span><span class="s">&quot;tmp&quot;</span><span class="p">,</span> <span class="n">dump_dir</span><span class="o">=</span><span class="s">&quot;/tmp&quot;</span><span class="p">)</span>
<span class="n">Dumping</span> <span class="n">pmeA86F</span><span class="p">.</span><span class="n">tmp</span><span class="p">,</span> <span class="n">Base</span><span class="o">:</span> <span class="n">f800025ca000</span> <span class="n">output</span><span class="o">:</span> <span class="n">driver</span><span class="p">.</span><span class="n">f800025ca000</span><span class="p">.</span><span class="n">sys</span>
</pre></div>
</div>

<h1 id="modscan" class="anchor">modscan</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.modscan.ModScan-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Scan Physical memory for _LDR_DATA_TABLE_ENTRY objects.</h2>
</div>


<h3>Plugin Arguments</h3>
<div class="plugins_args">
<table class='table table-condensed'>
<tbody>
<tr><td><p>scan_in_kernel</p></td><td><p>Scan in the kernel address space (type: Boolean)</p>
<ul>
<li>Default: False</li>
</ul></td></tr>
</tbody>
</table>
</div>


<p>The modscan command finds LDR_DATA_TABLE_ENTRY structures by scanning physical
memory for pool tags. This can pick up previously unloaded drivers and drivers
that have been hidden/unlinked by rootkits.</p>
<h3>Notes</h3>
<ol>
<li>Like other pool scanning plugins, this plugin may produce false positives
   since it essentially carves <strong>_LDR_DATA_TABLE_ENTRY</strong> structures out of
   memory. On the other hand, this plugin may reveal files which have been
   closed or freed.</li>
</ol>
<h3>Sample output</h3>
<p>In this example we can identify the pmem driver which was loaded from a
temporary location.</p>
<div class="highlight"><pre><span class="n">win8</span><span class="mf">.1</span><span class="p">.</span><span class="n">raw</span> <span class="mi">23</span><span class="o">:</span><span class="mi">27</span><span class="o">:</span><span class="mi">24</span><span class="o">&gt;</span> <span class="n">modscan</span>
<span class="o">-------------------&gt;</span> <span class="n">modscan</span><span class="p">()</span>
  <span class="n">Offset</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>    <span class="n">Name</span>                      <span class="n">Base</span>           <span class="n">Size</span>      <span class="n">File</span>
<span class="o">--------------</span> <span class="o">--------------------</span> <span class="o">--------------</span> <span class="o">--------------</span> <span class="o">----</span>
<span class="mh">0x000001ce507e</span>                      <span class="mh">0x20c483483824</span>     <span class="mh">0xebc08b44</span>
<span class="mh">0x00003ce163b0</span> <span class="n">mrxsmb</span><span class="p">.</span><span class="n">sys</span>           <span class="mh">0xf80002174000</span>        <span class="mh">0x6d000</span> <span class="err">\</span><span class="n">SystemRoot</span><span class="err">\</span><span class="n">system32</span><span class="err">\</span><span class="n">DRIVERS</span><span class="err">\</span><span class="n">mrxsmb</span><span class="p">.</span><span class="n">sys</span>
<span class="mh">0x00003ce17610</span> <span class="n">mrxsmb20</span><span class="p">.</span><span class="n">sys</span>         <span class="mh">0xf80002000000</span>        <span class="mh">0x39000</span> <span class="err">\</span><span class="n">SystemRoot</span><span class="err">\</span><span class="n">system32</span><span class="err">\</span><span class="n">DRIVERS</span><span class="err">\</span><span class="n">mrxsmb20</span><span class="p">.</span><span class="n">sys</span>
<span class="mh">0x00003ce1e830</span> <span class="n">mpsdrv</span><span class="p">.</span><span class="n">sys</span>           <span class="mh">0xf8000215d000</span>        <span class="mh">0x17000</span> <span class="err">\</span><span class="n">SystemRoot</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">drivers</span><span class="err">\</span><span class="n">mpsdrv</span><span class="p">.</span><span class="n">sys</span>
<span class="mh">0x00003ce4cf30</span> <span class="n">Ndu</span><span class="p">.</span><span class="n">sys</span>              <span class="mh">0xf800022cd000</span>        <span class="mh">0x1d000</span> <span class="err">\</span><span class="n">SystemRoot</span><span class="err">\</span><span class="n">system32</span><span class="err">\</span><span class="n">drivers</span><span class="err">\</span><span class="n">Ndu</span><span class="p">.</span><span class="n">sys</span>
<span class="mh">0x00003ce4df20</span> <span class="n">mrxsmb10</span><span class="p">.</span><span class="n">sys</span>         <span class="mh">0xf80002282000</span>        <span class="mh">0x4b000</span> <span class="err">\</span><span class="n">SystemRoot</span><span class="err">\</span><span class="n">system32</span><span class="err">\</span><span class="n">DRIVERS</span><span class="err">\</span><span class="n">mrxsmb10</span><span class="p">.</span><span class="n">sys</span>
<span class="mh">0x00003ce80170</span> <span class="n">peauth</span><span class="p">.</span><span class="n">sys</span>           <span class="mh">0xf800022ea000</span>        <span class="mh">0xa9000</span> <span class="err">\</span><span class="n">SystemRoot</span><span class="err">\</span><span class="n">system32</span><span class="err">\</span><span class="n">drivers</span><span class="err">\</span><span class="n">peauth</span><span class="p">.</span><span class="n">sys</span>
<span class="mh">0x00003ce8b010</span> <span class="n">srvnet</span><span class="p">.</span><span class="n">sys</span>           <span class="mh">0xf8000239e000</span>        <span class="mh">0x43000</span> <span class="err">\</span><span class="n">SystemRoot</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">DRIVERS</span><span class="err">\</span><span class="n">srvnet</span><span class="p">.</span><span class="n">sys</span>
<span class="mh">0x00003ce8bc20</span> <span class="n">secdrv</span><span class="p">.</span><span class="n">SYS</span>           <span class="mh">0xf80002393000</span>         <span class="mh">0xb000</span> <span class="err">\</span><span class="n">SystemRoot</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">Drivers</span><span class="err">\</span><span class="n">secdrv</span><span class="p">.</span><span class="n">SYS</span>
<span class="mh">0x00003ceae280</span> <span class="n">tcpipreg</span><span class="p">.</span><span class="n">sys</span>         <span class="mh">0xf800023e1000</span>        <span class="mh">0x12000</span> <span class="err">\</span><span class="n">SystemRoot</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">drivers</span><span class="err">\</span><span class="n">tcpipreg</span><span class="p">.</span><span class="n">sys</span>
<span class="mh">0x00003ceae520</span> <span class="n">srv2</span><span class="p">.</span><span class="n">sys</span>             <span class="mh">0xf800024ec000</span>        <span class="mh">0xad000</span> <span class="err">\</span><span class="n">SystemRoot</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">DRIVERS</span><span class="err">\</span><span class="n">srv2</span><span class="p">.</span><span class="n">sys</span>
<span class="mh">0x00003cec9ee0</span>                      <span class="mh">0x665602050006</span>            <span class="mh">0x0</span>
<span class="mh">0x00003ceede60</span> <span class="n">srv</span><span class="p">.</span><span class="n">sys</span>              <span class="mh">0xf80002400000</span>        <span class="mh">0x98000</span> <span class="err">\</span><span class="n">SystemRoot</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">DRIVERS</span><span class="err">\</span><span class="n">srv</span><span class="p">.</span><span class="n">sys</span>
<span class="mh">0x00003cf44eb0</span> <span class="n">mslldp</span><span class="p">.</span><span class="n">sys</span>           <span class="mh">0xf80002498000</span>        <span class="mh">0x16000</span> <span class="err">\</span><span class="n">SystemRoot</span><span class="err">\</span><span class="n">system32</span><span class="err">\</span><span class="n">DRIVERS</span><span class="err">\</span><span class="n">mslldp</span><span class="p">.</span><span class="n">sys</span>
<span class="mh">0x00003d144160</span> <span class="n">rspndr</span><span class="p">.</span><span class="n">sys</span>           <span class="mh">0xf80001caf000</span>        <span class="mh">0x18000</span> <span class="err">\</span><span class="n">SystemRoot</span><span class="err">\</span><span class="n">system32</span><span class="err">\</span><span class="n">DRIVERS</span><span class="err">\</span><span class="n">rspndr</span><span class="p">.</span><span class="n">sys</span>
<span class="mh">0x00003d145a50</span> <span class="n">lltdio</span><span class="p">.</span><span class="n">sys</span>           <span class="mh">0xf80001c9b000</span>        <span class="mh">0x14000</span> <span class="err">\</span><span class="n">SystemRoot</span><span class="err">\</span><span class="n">system32</span><span class="err">\</span><span class="n">DRIVERS</span><span class="err">\</span><span class="n">lltdio</span><span class="p">.</span><span class="n">sys</span>
<span class="mh">0x00003d18c850</span> <span class="n">HTTP</span><span class="p">.</span><span class="n">sys</span>             <span class="mh">0xf80002043000</span>        <span class="mh">0xfa000</span> <span class="err">\</span><span class="n">SystemRoot</span><span class="err">\</span><span class="n">system32</span><span class="err">\</span><span class="n">drivers</span><span class="err">\</span><span class="n">HTTP</span><span class="p">.</span><span class="n">sys</span>
<span class="mh">0x00003d29b010</span> <span class="n">pmeA86F</span><span class="p">.</span><span class="n">tmp</span>          <span class="mh">0xf800025ca000</span>        <span class="mh">0x10000</span> <span class="err">\</span><span class="o">??</span><span class="err">\</span><span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">Users</span><span class="err">\</span><span class="n">test</span><span class="err">\</span><span class="n">AppData</span><span class="err">\</span><span class="n">Local</span><span class="err">\</span><span class="n">Temp</span><span class="err">\</span><span class="n">pmeA86F</span><span class="p">.</span><span class="n">tmp</span>
<span class="mh">0x00003d655520</span> <span class="n">HdAudio</span><span class="p">.</span><span class="n">sys</span>          <span class="mh">0xf80001d45000</span>        <span class="mh">0x66000</span> <span class="err">\</span><span class="n">SystemRoot</span><span class="err">\</span><span class="n">system32</span><span class="err">\</span><span class="n">drivers</span><span class="err">\</span><span class="n">HdAudio</span><span class="p">.</span><span class="n">sys</span>
<span class="mh">0x00003d6593e0</span> <span class="n">tunnel</span><span class="p">.</span><span class="n">sys</span>           <span class="mh">0xf800024ae000</span>        <span class="mh">0x2d000</span> <span class="err">\</span><span class="n">SystemRoot</span><span class="err">\</span><span class="n">system32</span><span class="err">\</span><span class="n">DRIVERS</span><span class="err">\</span><span class="n">tunnel</span><span class="p">.</span><span class="n">sys</span>
</pre></div>
</div>

<h1 id="modules" class="anchor">modules</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.modules.Modules-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Print list of loaded kernel modules.</h2>
</div>


<h3>Plugin Arguments</h3>
<div class="plugins_args">
<table class='table table-condensed'>
<tbody>
<tr><td><p>name_regex</p></td><td><p>Filter module names by this regex.</p></td></tr>
</tbody>
</table>
</div>


<p>To view the list of kernel drivers loaded on the system, use the modules
command. This walks the doubly-linked list of <strong>_LDR_DATA_TABLE_ENTRY</strong>
structures pointed to by <strong>PsLoadedModuleList</strong>.</p>
<p>It cannot find hidden/unlinked kernel drivers, however <a href="ModScan.html">modscan</a>
serves that purpose. Also, since this plugin uses list walking techniques, you
typically can assume that the order the modules are displayed in the output is
the order they were loaded on the system.</p>
<h3>Notes</h3>
<ol>
<li>The Base address is the location where the kernel module&rsquo;s PE header is
   mapped. For example you can examine information about the module&rsquo;s IAT/EAT
   using the <a href="PEInfo.html">peinfo</a> plugin, providing the base address.</li>
</ol>
<h3>Sample output</h3>
<div class="highlight"><pre><span class="n">win8</span><span class="mf">.1</span><span class="p">.</span><span class="n">raw</span> <span class="mi">23</span><span class="o">:</span><span class="mi">35</span><span class="o">:</span><span class="mi">19</span><span class="o">&gt;</span> <span class="n">modules</span>
<span class="o">-------------------&gt;</span> <span class="n">modules</span><span class="p">()</span>
  <span class="n">Offset</span> <span class="p">(</span><span class="n">V</span><span class="p">)</span>   <span class="n">Name</span>                      <span class="n">Base</span>           <span class="n">Size</span>      <span class="n">File</span>
<span class="o">--------------</span> <span class="o">--------------------</span> <span class="o">--------------</span> <span class="o">--------------</span> <span class="o">----</span>
<span class="mh">0xe00000057620</span> <span class="n">ntoskrnl</span><span class="p">.</span><span class="n">exe</span>         <span class="mh">0xf802d3019000</span>       <span class="mh">0x781000</span> <span class="err">\</span><span class="n">SystemRoot</span><span class="err">\</span><span class="n">system32</span><span class="err">\</span><span class="n">ntoskrnl</span><span class="p">.</span><span class="n">exe</span>
<span class="mh">0xe00000057530</span> <span class="n">hal</span><span class="p">.</span><span class="n">dll</span>              <span class="mh">0xf802d379a000</span>        <span class="mh">0x6f000</span> <span class="err">\</span><span class="n">SystemRoot</span><span class="err">\</span><span class="n">system32</span><span class="err">\</span><span class="n">hal</span><span class="p">.</span><span class="n">dll</span>
<span class="mh">0xe000000557c0</span> <span class="n">storahci</span><span class="p">.</span><span class="n">sys</span>         <span class="mh">0xf800006d9000</span>        <span class="mh">0x1d000</span> <span class="err">\</span><span class="n">SystemRoot</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">drivers</span><span class="err">\</span><span class="n">storahci</span><span class="p">.</span><span class="n">sys</span>
<span class="mh">0xe0000149ade0</span> <span class="n">mssmbios</span><span class="p">.</span><span class="n">sys</span>         <span class="mh">0xf800018c4000</span>         <span class="mh">0xc000</span> <span class="err">\</span><span class="n">SystemRoot</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">drivers</span><span class="err">\</span><span class="n">mssmbios</span><span class="p">.</span><span class="n">sys</span>
<span class="mh">0xe000013871e0</span> <span class="n">Npfs</span><span class="p">.</span><span class="n">SYS</span>             <span class="mh">0xf800008ba000</span>        <span class="mh">0x14000</span> <span class="err">\</span><span class="n">SystemRoot</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">Drivers</span><span class="err">\</span><span class="n">Npfs</span><span class="p">.</span><span class="n">SYS</span>
<span class="mh">0xe00000055d50</span> <span class="n">volmgrx</span><span class="p">.</span><span class="n">sys</span>          <span class="mh">0xf80000393000</span>        <span class="mh">0x5f000</span> <span class="err">\</span><span class="n">SystemRoot</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">drivers</span><span class="err">\</span><span class="n">volmgrx</span><span class="p">.</span><span class="n">sys</span>
<span class="mh">0xe00002145a50</span> <span class="n">lltdio</span><span class="p">.</span><span class="n">sys</span>           <span class="mh">0xf80001c9b000</span>        <span class="mh">0x14000</span> <span class="err">\</span><span class="n">SystemRoot</span><span class="err">\</span><span class="n">system32</span><span class="err">\</span><span class="n">DRIVERS</span><span class="err">\</span><span class="n">lltdio</span><span class="p">.</span><span class="n">sys</span>
<span class="mh">0xe00000055e40</span> <span class="n">volmgr</span><span class="p">.</span><span class="n">sys</span>           <span class="mh">0xf8000045d000</span>        <span class="mh">0x15000</span> <span class="err">\</span><span class="n">SystemRoot</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">drivers</span><span class="err">\</span><span class="n">volmgr</span><span class="p">.</span><span class="n">sys</span>
<span class="mh">0xe00000054950</span> <span class="n">fwpkclnt</span><span class="p">.</span><span class="n">sys</span>         <span class="mh">0xf80001144000</span>        <span class="mh">0x6c000</span> <span class="err">\</span><span class="n">SystemRoot</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">drivers</span><span class="err">\</span><span class="n">fwpkclnt</span><span class="p">.</span><span class="n">sys</span>
<span class="mh">0xe00000054c60</span> <span class="n">NETIO</span><span class="p">.</span><span class="n">SYS</span>            <span class="mh">0xf80000d3e000</span>        <span class="mh">0x79000</span> <span class="err">\</span><span class="n">SystemRoot</span><span class="err">\</span><span class="n">system32</span><span class="err">\</span><span class="n">drivers</span><span class="err">\</span><span class="n">NETIO</span><span class="p">.</span><span class="n">SYS</span>
<span class="mh">0xe000014b3500</span> <span class="n">kbdclass</span><span class="p">.</span><span class="n">sys</span>         <span class="mh">0xf80001a1f000</span>        <span class="mh">0x10000</span> <span class="err">\</span><span class="n">SystemRoot</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">drivers</span><span class="err">\</span><span class="n">kbdclass</span><span class="p">.</span><span class="n">sys</span>
<span class="mh">0xe00001339b50</span> <span class="n">drmk</span><span class="p">.</span><span class="n">sys</span>             <span class="mh">0xf80001c00000</span>        <span class="mh">0x1c000</span> <span class="err">\</span><span class="n">SystemRoot</span><span class="err">\</span><span class="n">system32</span><span class="err">\</span><span class="n">drivers</span><span class="err">\</span><span class="n">drmk</span><span class="p">.</span><span class="n">sys</span>
<span class="mh">0xe00000054b70</span> <span class="n">ksecpkg</span><span class="p">.</span><span class="n">sys</span>          <span class="mh">0xf80000db7000</span>        <span class="mh">0x34000</span> <span class="err">\</span><span class="n">SystemRoot</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">Drivers</span><span class="err">\</span><span class="n">ksecpkg</span><span class="p">.</span><span class="n">sys</span>
<span class="mh">0xe00000054100</span> <span class="n">CLASSPNP</span><span class="p">.</span><span class="n">SYS</span>         <span class="mh">0xf80000800000</span>        <span class="mh">0x56000</span> <span class="err">\</span><span class="n">SystemRoot</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">drivers</span><span class="err">\</span><span class="n">CLASSPNP</span><span class="p">.</span><span class="n">SYS</span>
</pre></div>
</div>

<h1 id="mutantscan" class="anchor">mutantscan</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.filescan.MutantScan-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Scan for mutant objects _KMUTANT</h2>
</div>


<h3>Plugin Arguments</h3>
<div class="plugins_args">
<table class='table table-condensed'>
<tbody>
<tr><td><p>scan_in_kernel</p></td><td><p>Scan in the kernel address space (type: Boolean)</p>
<ul>
<li>Default: False</li>
</ul></td></tr><tr><td><p>verbosity</p></td><td><p>An integer reflecting the amount of desired output: 0 = quiet, 10 = noisy. (type: IntParser)</p>
<ul>
<li>Default: 1</li>
</ul></td></tr>
</tbody>
</table>
</div>


<p>This plugin uses pool scanning techniques to find <strong>_KMUTANT</strong> objects.</p>
<p>Mutants implement a &ldquo;named semaphore&rdquo; in windows. This is used by malware to
ensure only a single copy of the malware is running at the same time. By
analyzing the name of the Mutant that a specific malware strand is using it is
possible to tell immediately if the malware is running on the machine.</p>
<p>For more information, see Andreas Schuster&rsquo;s <a href="http://computer.forensikblog.de/en/2009/04/searching_for_mutants.html">Searching for Mutants</a>.</p>
<h3>Notes</h3>
<ol>
<li>
<p>Like other pool scanning plugins, this plugin may produce false positives
   since it essentially carves <strong>_KMUTANT</strong> structures out of memory.</p>
</li>
<li>
<p>It is more efficient to search for named mutants using the
   <a href="ObjectTree.html">object_tree</a> plugin - since it does not use pool scanning
   techniques.</p>
</li>
<li>
<p>When inspecting the output, the <strong>#Hnd</strong> column indicates the number of
   handles to this <strong>_KMUTANT</strong>.  Objects in use will have a non zero value here
   and are likely to not be freed.</p>
</li>
</ol>
<h3>Sample output</h3>
<div class="highlight"><pre><span class="n">win8</span><span class="mf">.1</span><span class="p">.</span><span class="n">raw</span> <span class="mi">23</span><span class="o">:</span><span class="mi">46</span><span class="o">:</span><span class="mi">56</span><span class="o">&gt;</span> <span class="n">mutantscan</span> <span class="n">scan_in_kernel</span><span class="o">=</span><span class="mi">1</span>
<span class="o">-------------------&gt;</span> <span class="n">mutantscan</span><span class="p">(</span><span class="n">scan_in_kernel</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">Offset</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>      <span class="err">#</span><span class="n">Ptr</span> <span class="err">#</span><span class="n">Hnd</span> <span class="n">Signal</span>     <span class="n">Thread</span>           <span class="n">CID</span> <span class="n">Name</span>
<span class="o">-</span> <span class="o">--------------</span> <span class="o">------</span> <span class="o">----</span> <span class="o">------</span> <span class="o">--------------</span> <span class="o">---------</span> <span class="o">----</span>
  <span class="mh">0xe0000007f810</span>      <span class="mi">3</span>  <span class="mi">2</span> <span class="mi">1</span>    <span class="mh">0x000000000000</span>           <span class="n">C</span><span class="o">::</span><span class="n">Users</span><span class="o">:</span><span class="n">test</span><span class="o">:</span><span class="n">AppData</span><span class="o">:</span><span class="n">Local</span><span class="o">:</span><span class="n">Microsoft</span><span class="o">:</span><span class="n">Windows</span><span class="o">:</span><span class="n">Explorer</span><span class="o">:</span><span class="n">thumbcache_sr</span><span class="p">.</span><span class="n">db</span><span class="o">!</span><span class="n">dfMaintainer</span>
  <span class="mh">0xe0000007f8d0</span>      <span class="mi">3</span>  <span class="mi">2</span> <span class="mi">1</span>    <span class="mh">0x000000000000</span>           <span class="n">C</span><span class="o">::</span><span class="n">Users</span><span class="o">:</span><span class="n">test</span><span class="o">:</span><span class="n">AppData</span><span class="o">:</span><span class="n">Local</span><span class="o">:</span><span class="n">Microsoft</span><span class="o">:</span><span class="n">Windows</span><span class="o">:</span><span class="n">Explorer</span><span class="o">:</span><span class="n">thumbcache_1600</span><span class="p">.</span><span class="n">db</span><span class="o">!</span><span class="n">dfMaintainer</span>
  <span class="mh">0xe000000b8d00</span>  <span class="mi">32722</span>  <span class="mi">1</span> <span class="mi">1</span>    <span class="mh">0x000000000000</span>           <span class="n">BcdSyncMutant</span>
  <span class="mh">0xe00000624240</span>  <span class="mi">32769</span>  <span class="mi">1</span> <span class="mi">0</span>    <span class="mh">0xe00000624700</span>  <span class="mi">556</span><span class="o">:</span><span class="mi">1396</span> <span class="n">F659A567</span><span class="o">-</span><span class="mi">8</span><span class="n">ACB</span><span class="o">-</span><span class="mf">4E4</span><span class="n">A</span><span class="o">-</span><span class="mi">92</span><span class="n">A7</span><span class="o">-</span><span class="mi">5</span><span class="n">C2DD1884F72</span>
  <span class="mh">0xe000006f4a60</span>  <span class="mi">32768</span>  <span class="mi">1</span> <span class="mi">0</span>    <span class="mh">0xe000006dc080</span> <span class="mi">2332</span><span class="o">:</span><span class="mi">2460</span> <span class="n">Instance2</span><span class="o">:</span>  <span class="n">ESENT</span> <span class="n">Performance</span> <span class="n">Data</span> <span class="n">Schema</span> <span class="n">Version</span> <span class="mi">255</span>
  <span class="mh">0xe00001253080</span>  <span class="mi">32768</span>  <span class="mi">1</span> <span class="mi">0</span>    <span class="mh">0xe000007fd080</span>  <span class="mi">880</span><span class="o">:</span><span class="mi">3144</span> <span class="n">Instance3</span><span class="o">:</span>  <span class="n">ESENT</span> <span class="n">Performance</span> <span class="n">Data</span> <span class="n">Schema</span> <span class="n">Version</span> <span class="mi">255</span>
  <span class="mh">0xe00001262360</span>      <span class="mi">2</span>  <span class="mi">1</span> <span class="mi">1</span>    <span class="mh">0x000000000000</span>           <span class="n">ARC_AppRepSettings_Mutex</span>
  <span class="mh">0xe00001272530</span>      <span class="mi">5</span>  <span class="mi">4</span> <span class="mi">1</span>    <span class="mh">0x000000000000</span>           <span class="n">C</span><span class="o">::</span><span class="n">Users</span><span class="o">:</span><span class="n">test</span><span class="o">:</span><span class="n">AppData</span><span class="o">:</span><span class="n">Local</span><span class="o">:</span><span class="n">Microsoft</span><span class="o">:</span><span class="n">Windows</span><span class="o">:</span><span class="n">Explorer</span><span class="o">:</span><span class="n">iconcache_1024</span><span class="p">.</span><span class="n">db</span><span class="o">!</span><span class="n">dfMaintainer</span>
  <span class="mh">0xe000012725f0</span>      <span class="mi">5</span>  <span class="mi">4</span> <span class="mi">1</span>    <span class="mh">0x000000000000</span>           <span class="n">C</span><span class="o">::</span><span class="n">Users</span><span class="o">:</span><span class="n">test</span><span class="o">:</span><span class="n">AppData</span><span class="o">:</span><span class="n">Local</span><span class="o">:</span><span class="n">Microsoft</span><span class="o">:</span><span class="n">Windows</span><span class="o">:</span><span class="n">Explorer</span><span class="o">:</span><span class="n">iconcache_256</span><span class="p">.</span><span class="n">db</span><span class="o">!</span><span class="n">dfMaintainer</span>
  <span class="mh">0xe000012726b0</span>      <span class="mi">5</span>  <span class="mi">4</span> <span class="mi">1</span>    <span class="mh">0x000000000000</span>           <span class="n">C</span><span class="o">::</span><span class="n">Users</span><span class="o">:</span><span class="n">test</span><span class="o">:</span><span class="n">AppData</span><span class="o">:</span><span class="n">Local</span><span class="o">:</span><span class="n">Microsoft</span><span class="o">:</span><span class="n">Windows</span><span class="o">:</span><span class="n">Explorer</span><span class="o">:</span><span class="n">iconcache_96</span><span class="p">.</span><span class="n">db</span><span class="o">!</span><span class="n">dfMaintainer</span>
  <span class="mh">0xe00001272770</span>      <span class="mi">5</span>  <span class="mi">4</span> <span class="mi">1</span>    <span class="mh">0x000000000000</span>           <span class="n">C</span><span class="o">::</span><span class="n">Users</span><span class="o">:</span><span class="n">test</span><span class="o">:</span><span class="n">AppData</span><span class="o">:</span><span class="n">Local</span><span class="o">:</span><span class="n">Microsoft</span><span class="o">:</span><span class="n">Windows</span><span class="o">:</span><span class="n">Explorer</span><span class="o">:</span><span class="n">iconcache_48</span><span class="p">.</span><span class="n">db</span><span class="o">!</span><span class="n">dfMaintainer</span>
  <span class="mh">0xe00001272ac0</span> <span class="mi">131007</span>  <span class="mi">4</span> <span class="mi">1</span>    <span class="mh">0x000000000000</span>           <span class="n">C</span><span class="o">::</span><span class="n">Users</span><span class="o">:</span><span class="n">test</span><span class="o">:</span><span class="n">AppData</span><span class="o">:</span><span class="n">Local</span><span class="o">:</span><span class="n">Microsoft</span><span class="o">:</span><span class="n">Windows</span><span class="o">:</span><span class="n">Explorer</span><span class="o">:</span><span class="n">iconcache_32</span><span class="p">.</span><span class="n">db</span><span class="o">!</span><span class="n">dfMaintainer</span>
  <span class="mh">0xe0000128e1e0</span> <span class="mi">131005</span>  <span class="mi">4</span> <span class="mi">1</span>    <span class="mh">0x000000000000</span>           <span class="n">C</span><span class="o">::</span><span class="n">Users</span><span class="o">:</span><span class="n">test</span><span class="o">:</span><span class="n">AppData</span><span class="o">:</span><span class="n">Local</span><span class="o">:</span><span class="n">Microsoft</span><span class="o">:</span><span class="n">Windows</span><span class="o">:</span><span class="n">Explorer</span><span class="o">:</span><span class="n">iconcache_16</span><span class="p">.</span><span class="n">db</span><span class="o">!</span><span class="n">dfMaintainer</span>
  <span class="mh">0xe0000129a2c0</span>  <span class="mi">32734</span>  <span class="mi">1</span> <span class="mi">1</span>    <span class="mh">0x000000000000</span>           <span class="n">SmartScreen_AppRepSettings_Mutex</span>
  <span class="mh">0xe000012c7950</span> <span class="mi">131061</span>  <span class="mi">4</span> <span class="mi">1</span>    <span class="mh">0x000000000000</span>           <span class="n">C</span><span class="o">::</span><span class="n">Users</span><span class="o">:</span><span class="n">test</span><span class="o">:</span><span class="n">AppData</span><span class="o">:</span><span class="n">Local</span><span class="o">:</span><span class="n">Microsoft</span><span class="o">:</span><span class="n">Windows</span><span class="o">:</span><span class="n">Explorer</span><span class="o">:</span><span class="n">iconcache_idx</span><span class="p">.</span><span class="n">db</span><span class="o">!</span><span class="n">IconCacheInit</span>
  <span class="mh">0xe000012c7a10</span>      <span class="mi">5</span>  <span class="mi">4</span> <span class="mi">1</span>    <span class="mh">0x000000000000</span>           <span class="n">C</span><span class="o">::</span><span class="n">Users</span><span class="o">:</span><span class="n">test</span><span class="o">:</span><span class="n">AppData</span><span class="o">:</span><span class="n">Local</span><span class="o">:</span><span class="n">Microsoft</span><span class="o">:</span><span class="n">Windows</span><span class="o">:</span><span class="n">Explorer</span><span class="o">:</span><span class="n">iconcache_wide_alternate</span><span class="p">.</span><span class="n">db</span><span class="o">!</span><span class="n">dfMaintainer</span>
  <span class="mh">0xe000012c7ad0</span>      <span class="mi">5</span>  <span class="mi">4</span> <span class="mi">1</span>    <span class="mh">0x000000000000</span>           <span class="n">C</span><span class="o">::</span><span class="n">Users</span><span class="o">:</span><span class="n">test</span><span class="o">:</span><span class="n">AppData</span><span class="o">:</span><span class="n">Local</span><span class="o">:</span><span class="n">Microsoft</span><span class="o">:</span><span class="n">Windows</span><span class="o">:</span><span class="n">Explorer</span><span class="o">:</span><span class="n">iconcache_exif</span><span class="p">.</span><span class="n">db</span><span class="o">!</span><span class="n">dfMaintainer</span>
  <span class="mh">0xe000012c7b90</span>      <span class="mi">5</span>  <span class="mi">4</span> <span class="mi">1</span>    <span class="mh">0x000000000000</span>           <span class="n">C</span><span class="o">::</span><span class="n">Users</span><span class="o">:</span><span class="n">test</span><span class="o">:</span><span class="n">AppData</span><span class="o">:</span><span class="n">Local</span><span class="o">:</span><span class="n">Microsoft</span><span class="o">:</span><span class="n">Windows</span><span class="o">:</span><span class="n">Explorer</span><span class="o">:</span><span class="n">iconcache_wide</span><span class="p">.</span><span class="n">db</span><span class="o">!</span><span class="n">dfMaintainer</span>
  <span class="mh">0xe000012c7c50</span>      <span class="mi">5</span>  <span class="mi">4</span> <span class="mi">1</span>    <span class="mh">0x000000000000</span>           <span class="n">C</span><span class="o">::</span><span class="n">Users</span><span class="o">:</span><span class="n">test</span><span class="o">:</span><span class="n">AppData</span><span class="o">:</span><span class="n">Local</span><span class="o">:</span><span class="n">Microsoft</span><span class="o">:</span><span class="n">Windows</span><span class="o">:</span><span class="n">Explorer</span><span class="o">:</span><span class="n">iconcache_sr</span><span class="p">.</span><span class="n">db</span><span class="o">!</span><span class="n">dfMaintainer</span>
<span class="p">...</span>
</pre></div>
</div>

<h1 id="netscan" class="anchor">netscan</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.netscan.WinNetscan-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Scan a Vista, 2008 or Windows 7 image for connections and sockets</h2>
</div>


<h3>Plugin Arguments</h3>
<div class="plugins_args">
<table class='table table-condensed'>
<tbody>
<tr><td><p>scan_in_kernel</p></td><td><p>Scan in the kernel address space (type: Boolean)</p>
<ul>
<li>Default: False</li>
</ul></td></tr><tr><td><p>tcpip_guid</p></td><td><p>Force this profile to be used for tcpip.</p></td></tr>
</tbody>
</table>
</div>



</div>

<h1 id="netstat" class="anchor">netstat</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.linux.netstat.Netstat-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Print the active network connections.</h2>
</div>




</div>

<h1 id="netstat" class="anchor">netstat</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.network.WinNetstat-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Enumerate image for connections and sockets</h2>
</div>


<h3>Plugin Arguments</h3>
<div class="plugins_args">
<table class='table table-condensed'>
<tbody>
<tr><td><p>tcpip_guid</p></td><td><p>Force this profile to be used for tcpip.</p></td></tr>
</tbody>
</table>
</div>



</div>

<h1 id="object_tree" class="anchor">object_tree</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.misc.ObjectTree-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Visualize the kernel object tree.</h2>
<p>Ref:
http://msdn.microsoft.com/en-us/library/windows/hardware/ff557762(v=vs.85).aspx</p>
</div>


<h3>Plugin Arguments</h3>
<div class="plugins_args">
<table class='table table-condensed'>
<tbody>
<tr><td><p>type_regex</p></td><td><p>Filter the type of objects shown.</p>
<ul>
<li>Default: .</li>
</ul></td></tr>
</tbody>
</table>
</div>


<p>The windows kernel has the notion of a <strong>Kernel Object</strong>. Objects are managed by
the kernel through a dedicated API. Kernel Objects are typically used to manage
resources which the kernel manages on behalf of user space, for example, open
files are managed via the <strong>_FILE_OBJECT</strong> object.</p>
<p>Objects can be named using a directory structure not unlike a
filesystem. Objects are placed inside an <strong>_OBJECT_DIRECTORY</strong> object which
contains other objects, including other directories. This means that named
kernel objects forma tree in memory.</p>
<p>It is possible to discover all currently in-use named objects by following this
object tree in memory, which is what this plugin does. This is an alternative to
the scanning approach employed by plugins like <strong>psscan</strong>, <strong>driverscan</strong> etc.</p>
<h3>Notes</h3>
<ol>
<li>
<p>The object tree only tracks named objects. So for example Process objects are
   typically not tracked here, but Mutants, SymbolicLinks etc are.</p>
</li>
<li>
<p>It is possible to filter objects by types. So for example to enumerate all
   Mutants one would use the <strong>type_regex=&rdquo;Mutant&rdquo;</strong> option.</p>
</li>
<li>
<p><em>SymbolicLinks</em> also contain the timestamp when they were created. Note that
   SymbolicLinks are typically used to provide userspace access to a kernel
   driver (via the <em>CreateFile</em> api), so a timestamp here is a good indication
   of when a driver was loaded.</p>
</li>
</ol>
<h3>Sample output</h3>
<div class="highlight"><pre><span class="cp"># Enumeate all drivers</span>
<span class="n">win7</span><span class="p">.</span><span class="n">elf</span> <span class="mo">01</span><span class="o">:</span><span class="mi">25</span><span class="o">:</span><span class="mi">12</span><span class="o">&gt;</span> <span class="n">object_tree</span> <span class="n">type_regex</span><span class="o">=</span><span class="s">&quot;Driver&quot;</span>
<span class="o">-----------------&gt;</span> <span class="n">object_tree</span><span class="p">(</span><span class="n">type_regex</span><span class="o">=</span><span class="s">&quot;Driver&quot;</span><span class="p">)</span>
<span class="n">_OBJECT_HEADER</span> <span class="n">Type</span>                 <span class="n">Name</span>
<span class="o">--------------</span> <span class="o">--------------------</span> <span class="o">--------------------</span>
<span class="mh">0xfa80025e5d10</span> <span class="n">Driver</span>               <span class="p">.</span> <span class="n">mrxsmb10</span>
<span class="mh">0xfa80025e1190</span> <span class="n">Driver</span>               <span class="p">.</span> <span class="n">mrxsmb</span>
<span class="mh">0xfa8001953940</span> <span class="n">Driver</span>               <span class="p">.</span> <span class="n">mrxsmb20</span>
<span class="p">....</span>

<span class="cp"># We can examine a specific object using the virtual offset.</span>

<span class="n">win7</span><span class="p">.</span><span class="n">elf</span> <span class="mo">01</span><span class="o">:</span><span class="mi">28</span><span class="o">:</span><span class="mi">18</span><span class="o">&gt;</span> <span class="n">x</span><span class="o">=</span><span class="n">profile</span><span class="p">.</span><span class="n">_OBJECT_HEADER</span><span class="p">(</span><span class="mh">0xfa80019fb8d0</span><span class="p">)</span>
<span class="n">win7</span><span class="p">.</span><span class="n">elf</span> <span class="mo">01</span><span class="o">:</span><span class="mi">28</span><span class="o">:</span><span class="mi">34</span><span class="o">&gt;</span> <span class="n">print</span> <span class="n">x</span><span class="p">.</span><span class="n">get_object_type</span><span class="p">()</span>
<span class="n">Driver</span>

<span class="cp"># We can dereference the exact object contained in this header (in this case</span>
<span class="cp">#  _DRIVER_OBJECT.</span>

<span class="n">win7</span><span class="p">.</span><span class="n">elf</span> <span class="mo">01</span><span class="o">:</span><span class="mi">28</span><span class="o">:</span><span class="mi">40</span><span class="o">&gt;</span> <span class="n">print</span> <span class="n">x</span><span class="p">.</span><span class="n">Object</span>
<span class="p">[</span><span class="n">_DRIVER_OBJECT</span> <span class="n">_DRIVER_OBJECT</span><span class="p">]</span> <span class="err">@</span> <span class="mh">0xFA80019FB900</span>
  <span class="mh">0x00</span> <span class="n">Type</span>              <span class="p">[</span><span class="kt">short</span><span class="o">:</span><span class="n">Type</span><span class="p">]</span><span class="o">:</span> <span class="mh">0x00000004</span>
  <span class="mh">0x02</span> <span class="n">Size</span>              <span class="p">[</span><span class="kt">short</span><span class="o">:</span><span class="n">Size</span><span class="p">]</span><span class="o">:</span> <span class="mh">0x00000150</span>
  <span class="mh">0x08</span> <span class="n">DeviceObject</span>     <span class="o">&lt;</span><span class="n">_DEVICE_OBJECT</span> <span class="n">Pointer</span> <span class="n">to</span> <span class="p">[</span><span class="mh">0xFA80019FB550</span><span class="p">]</span> <span class="p">(</span><span class="n">DeviceObject</span><span class="p">)</span><span class="o">&gt;</span>
  <span class="mh">0x10</span> <span class="n">Flags</span>             <span class="p">[</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="o">:</span><span class="n">Flags</span><span class="p">]</span><span class="o">:</span> <span class="mh">0x00000012</span>
  <span class="mh">0x18</span> <span class="n">DriverStart</span>      <span class="o">&lt;</span><span class="n">Void</span> <span class="n">Pointer</span> <span class="n">to</span> <span class="p">[</span><span class="mh">0xF88003B45000</span><span class="p">]</span> <span class="p">(</span><span class="n">DriverStart</span><span class="p">)</span><span class="o">&gt;</span>
  <span class="mh">0x20</span> <span class="n">DriverSize</span>        <span class="p">[</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="o">:</span><span class="n">DriverSize</span><span class="p">]</span><span class="o">:</span> <span class="mh">0x0000B000</span>
  <span class="mh">0x28</span> <span class="n">DriverSection</span>    <span class="o">&lt;</span><span class="n">Void</span> <span class="n">Pointer</span> <span class="n">to</span> <span class="p">[</span><span class="mh">0xFA80019FB7C0</span><span class="p">]</span> <span class="p">(</span><span class="n">DriverSection</span><span class="p">)</span><span class="o">&gt;</span>
  <span class="mh">0x30</span> <span class="n">DriverExtension</span>  <span class="o">&lt;</span><span class="n">_DRIVER_EXTENSION</span> <span class="n">Pointer</span> <span class="n">to</span> <span class="p">[</span><span class="mh">0xFA80019FBA50</span><span class="p">]</span> <span class="p">(</span><span class="n">DriverExtension</span><span class="p">)</span><span class="o">&gt;</span>
  <span class="mh">0x38</span> <span class="n">DriverName</span>       <span class="p">[</span><span class="n">_UNICODE_STRING</span> <span class="n">DriverName</span><span class="p">]</span> <span class="err">@</span> <span class="mh">0xFA80019FB938</span> <span class="p">(</span><span class="err">\</span><span class="n">Driver</span><span class="err">\</span><span class="n">rdpbus</span><span class="p">)</span>
  <span class="mh">0x48</span> <span class="n">HardwareDatabase</span> <span class="o">&lt;</span><span class="n">_UNICODE_STRING</span> <span class="n">Pointer</span> <span class="n">to</span> <span class="p">[</span><span class="mh">0xF80002B59558</span><span class="p">]</span> <span class="p">(</span><span class="n">HardwareDatabase</span><span class="p">)</span><span class="o">&gt;</span>
  <span class="mh">0x50</span> <span class="n">FastIoDispatch</span>   <span class="o">&lt;</span><span class="n">_FAST_IO_DISPATCH</span> <span class="n">Pointer</span> <span class="n">to</span> <span class="p">[</span><span class="mh">0x00000000</span><span class="p">]</span> <span class="p">(</span><span class="n">FastIoDispatch</span><span class="p">)</span><span class="o">&gt;</span>
  <span class="mh">0x58</span> <span class="n">DriverInit</span>       <span class="o">&lt;</span><span class="n">Function</span> <span class="n">Pointer</span> <span class="n">to</span> <span class="p">[</span><span class="mh">0xF88003B4D1B0</span><span class="p">]</span> <span class="p">(</span><span class="n">DriverInit</span><span class="p">)</span><span class="o">&gt;</span>
  <span class="mh">0x60</span> <span class="n">DriverStartIo</span>    <span class="o">&lt;</span><span class="n">Function</span> <span class="n">Pointer</span> <span class="n">to</span> <span class="p">[</span><span class="mh">0x00000000</span><span class="p">]</span> <span class="p">(</span><span class="n">DriverStartIo</span><span class="p">)</span><span class="o">&gt;</span>
  <span class="mh">0x68</span> <span class="n">DriverUnload</span>     <span class="o">&lt;</span><span class="n">Function</span> <span class="n">Pointer</span> <span class="n">to</span> <span class="p">[</span><span class="mh">0xF88003B4B480</span><span class="p">]</span> <span class="p">(</span><span class="n">DriverUnload</span><span class="p">)</span><span class="o">&gt;</span>
  <span class="mh">0x70</span> <span class="n">MajorFunction</span>    <span class="o">&lt;</span><span class="n">IndexedArray</span> <span class="mi">28</span> <span class="n">x</span> <span class="n">Pointer</span> <span class="err">@</span> <span class="mh">0xFA80019FB970</span><span class="o">&gt;</span>
<span class="n">win7</span><span class="p">.</span><span class="n">elf</span> <span class="mo">01</span><span class="o">:</span><span class="mi">29</span><span class="o">:</span><span class="mo">01</span><span class="o">&gt;</span> <span class="n">print</span> <span class="n">x</span><span class="p">.</span><span class="n">Object</span><span class="p">.</span><span class="n">DriverName</span>
<span class="err">\</span><span class="n">Driver</span><span class="err">\</span><span class="n">rdpbus</span>
</pre></div>


<p>In the next example we search for SymbolicLinks for the pmem device and discover
when the pmem driver was loaded.</p>
<div class="highlight"><pre><span class="n">win7</span><span class="p">.</span><span class="n">elf</span> <span class="mo">01</span><span class="o">:</span><span class="mi">38</span><span class="o">:</span><span class="mi">53</span><span class="o">&gt;</span> <span class="n">object_tree</span> <span class="n">type_regex</span><span class="o">=</span><span class="s">&quot;Symbolic&quot;</span>
<span class="mh">0xf8a0003a58a0</span> <span class="n">SymbolicLink</span>         <span class="p">.</span> <span class="n">Root</span><span class="err">#</span><span class="n">MS_PPPOEMINIPORT</span><span class="err">#</span><span class="mo">0000</span><span class="err">#</span><span class="p">{</span><span class="n">cac88484</span><span class="o">-</span><span class="mi">7515</span><span class="o">-</span><span class="mi">4</span><span class="n">c03</span><span class="o">-</span><span class="mf">82e6</span><span class="o">-</span><span class="mi">71</span><span class="n">a87abac361</span><span class="p">}</span><span class="o">-&gt;</span> <span class="err">\</span><span class="n">Device</span><span class="err">\</span><span class="mo">00000034</span> <span class="p">(</span><span class="mi">2012</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mo">01</span> <span class="mi">21</span><span class="o">:</span><span class="mi">39</span><span class="o">:</span><span class="mi">55</span><span class="o">+</span><span class="mo">0000</span><span class="p">)</span>
<span class="mh">0xf8a0003c1030</span> <span class="n">SymbolicLink</span>         <span class="p">.</span> <span class="n">Root</span><span class="err">#</span><span class="o">*</span><span class="n">ISATAP</span><span class="err">#</span><span class="mo">0000</span><span class="err">#</span><span class="p">{</span><span class="n">ad498944</span><span class="o">-</span><span class="mf">762f</span><span class="o">-</span><span class="mi">11</span><span class="n">d0</span><span class="o">-</span><span class="mi">8</span><span class="n">dcb</span><span class="o">-</span><span class="mo">00</span><span class="n">c04fc3358c</span><span class="p">}</span><span class="o">-&gt;</span> <span class="err">\</span><span class="n">Device</span><span class="err">\</span><span class="mo">00000001</span> <span class="p">(</span><span class="mi">2012</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mo">01</span> <span class="mi">21</span><span class="o">:</span><span class="mi">39</span><span class="o">:</span><span class="mi">51</span><span class="o">+</span><span class="mo">0000</span><span class="p">)</span>
<span class="mh">0xf8a00007fda0</span> <span class="n">SymbolicLink</span>         <span class="p">.</span> <span class="n">WMIAdminDevice</span><span class="o">-&gt;</span> <span class="err">\</span><span class="n">Device</span><span class="err">\</span><span class="n">WMIAdminDevice</span> <span class="p">(</span><span class="mi">2012</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mo">01</span> <span class="mi">21</span><span class="o">:</span><span class="mi">39</span><span class="o">:</span><span class="mi">45</span><span class="o">+</span><span class="mo">0000</span><span class="p">)</span>
<span class="mh">0xf8a0056e8dd0</span> <span class="n">SymbolicLink</span>         <span class="p">.</span> <span class="n">pmem</span><span class="o">-&gt;</span> <span class="err">\</span><span class="n">Device</span><span class="err">\</span><span class="n">pmem</span> <span class="p">(</span><span class="mi">2012</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mo">01</span> <span class="mi">14</span><span class="o">:</span><span class="mi">40</span><span class="o">:</span><span class="mi">44</span><span class="o">+</span><span class="mo">0000</span><span class="p">)</span>
<span class="mh">0xf8a0001111c0</span> <span class="n">SymbolicLink</span>         <span class="p">.</span> <span class="n">Root</span><span class="err">#</span><span class="n">MS_NDISWANIP</span><span class="err">#</span><span class="mo">0000</span><span class="err">#</span><span class="p">{</span><span class="n">cac88484</span><span class="o">-</span><span class="mi">7515</span><span class="o">-</span><span class="mi">4</span><span class="n">c03</span><span class="o">-</span><span class="mf">82e6</span><span class="o">-</span><span class="mi">71</span><span class="n">a87abac361</span><span class="p">}</span><span class="o">-&gt;</span> <span class="err">\</span><span class="n">Device</span><span class="err">\</span><span class="mo">00000032</span> <span class="p">(</span><span class="mi">2012</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mo">01</span> <span class="mi">21</span><span class="o">:</span><span class="mi">39</span><span class="o">:</span><span class="mi">55</span><span class="o">+</span><span class="mo">0000</span><span class="p">)</span>
<span class="mh">0xf8a0003bef20</span> <span class="n">SymbolicLink</span>         <span class="p">.</span> <span class="n">Root</span><span class="err">#</span><span class="n">MS_NDISWANBH</span><span class="err">#</span><span class="mo">0000</span><span class="err">#</span><span class="p">{</span><span class="n">cac88484</span><span class="o">-</span><span class="mi">7515</span><span class="o">-</span><span class="mi">4</span><span class="n">c03</span><span class="o">-</span><span class="mf">82e6</span><span class="o">-</span><span class="mi">71</span><span class="n">a87abac361</span><span class="p">}</span><span class="o">-&gt;</span> <span class="err">\</span><span class="n">Device</span><span class="err">\</span><span class="mo">00000031</span> <span class="p">(</span><span class="mi">2012</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mo">01</span> <span class="mi">21</span><span class="o">:</span><span class="mi">39</span><span class="o">:</span><span class="mi">55</span><span class="o">+</span><span class="mo">0000</span><span class="p">)</span>
<span class="mh">0xf8a000006f40</span> <span class="n">SymbolicLink</span>         <span class="p">.</span> <span class="n">Global</span><span class="o">-&gt;</span> <span class="err">\</span><span class="n">GLOBAL</span><span class="o">??</span> <span class="p">(</span><span class="mi">2012</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mo">01</span> <span class="mi">21</span><span class="o">:</span><span class="mi">39</span><span class="o">:</span><span class="mi">45</span><span class="o">+</span><span class="mo">0000</span><span class="p">)</span>
</pre></div>
</div>

<h1 id="object_types" class="anchor">object_types</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.misc.Objects-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Displays all object Types on the system.</h2>
</div>



<p>The windows kernel has the notion of a <strong>Kernel Object</strong>. Objects are managed by
the kernel through a dedicated API. Kernel Objects are typically used to manage
resources which the kernel manages on behalf of user space, for example, open
files are managed via the <strong>_FILE_OBJECT</strong> object.</p>
<p>There is a fixed number of kernel objects, each is described by an
<strong>_OBJECT_TYPE</strong> structure, the address of which can be found at the
<strong>ObpObjectTypes</strong> symbol.</p>
<h3>Notes</h3>
<ol>
<li>
<p>Each time a new object is created by the kernel, the <strong>Number of Objects</strong>
   count increases. For every free&rsquo;s object, this number decreases. The counter
   therefore represents the total number of active instances of this object
   type.</p>
</li>
<li>
<p>The number of kernel objects varies between windows kernel version. In order
   to find the size of the <strong>ObpObjectTypes</strong> array, Rekall uses the reference
   count on the <strong>Type</strong> object type - each kernel object type has a unique
   <strong>_OBJECT_TYPE</strong> structure.</p>
</li>
<li>
<p>The <strong>Number of Objects</strong> count also has forensic significance. For example
   the total number of <strong>Process</strong> objects represents the total number of
   _EPROCESS structures in current use (Note that a process may be terminated
   but the _EPROCESS is still kept in use).</p>
</li>
</ol>
<h3>Sample output</h3>
<p>The below output indicates that there should be 41 processes active, and 548 threads.</p>
<div class="highlight"><pre><span class="n">win7</span><span class="p">.</span><span class="n">elf</span> <span class="mo">01</span><span class="o">:</span><span class="mi">39</span><span class="o">:</span><span class="mi">36</span><span class="o">&gt;</span> <span class="n">object_types</span>
<span class="o">-----------------&gt;</span> <span class="n">object_types</span><span class="p">()</span>
<span class="n">Index</span>  <span class="n">Number</span> <span class="n">Objects</span> <span class="n">PoolType</span>        <span class="n">Name</span>
<span class="o">-----</span> <span class="o">---------------</span> <span class="o">---------------</span> <span class="o">----</span>
    <span class="mi">2</span>              <span class="mi">42</span> <span class="n">NonPagedPool</span>    <span class="n">Type</span>
    <span class="mi">3</span>              <span class="mi">40</span> <span class="n">PagedPool</span>       <span class="n">Directory</span>
    <span class="mi">4</span>             <span class="mi">173</span> <span class="n">PagedPool</span>       <span class="n">SymbolicLink</span>
    <span class="mi">5</span>             <span class="mi">704</span> <span class="n">PagedPool</span>       <span class="n">Token</span>
    <span class="mi">6</span>               <span class="mi">3</span> <span class="n">NonPagedPool</span>    <span class="n">Job</span>
    <span class="mi">7</span>              <span class="mi">41</span> <span class="n">NonPagedPool</span>    <span class="n">Process</span>
    <span class="mi">8</span>             <span class="mi">548</span> <span class="n">NonPagedPool</span>    <span class="n">Thread</span>
    <span class="mi">9</span>               <span class="mi">0</span> <span class="n">NonPagedPool</span>    <span class="n">UserApcReserve</span>
   <span class="mi">10</span>               <span class="mi">1</span> <span class="n">NonPagedPool</span>    <span class="n">IoCompletionReserve</span>
<span class="p">...</span>
</pre></div>
</div>

<h1 id="pagefiles" class="anchor">pagefiles</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.pagefile.Pagefiles-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Report all the active pagefiles.</h2>
</div>




</div>

<h1 id="pas2vas" class="anchor">pas2vas</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.pas2kas.WinPas2Vas-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Resolves a physical address to a virtual addrress in a process.</h2>
</div>


<h3>Plugin Arguments</h3>
<div class="plugins_args">
<table class='table table-condensed'>
<tbody>
<tr><td><p>eprocess</p></td><td><p>Kernel addresses of eprocess structs. (type: ArrayIntParser)</p></td></tr><tr><td><p>method</p></td><td><p>Method to list processes. (type: ChoiceArray)</p>
<ul>
<li>
<p>Valid Choices:</p>
<ul>
<li>PsActiveProcessHead</li>
<li>CSRSS</li>
<li>PspCidTable</li>
<li>Sessions</li>
<li>Handles</li>
</ul>
</li>
<li>
<p>Default: PsActiveProcessHead, CSRSS, PspCidTable, Sessions, Handles</p>
</li>
</ul></td></tr><tr><td><p>offsets</p></td><td><p>A list of physical offsets to resolve. (type: ArrayIntParser)</p></td></tr><tr><td><p>phys_eprocess</p></td><td><p>Physical addresses of eprocess structs. (type: ArrayIntParser)</p></td></tr><tr><td><p>pid</p></td><td><p>One or more pids of processes to select. (type: ArrayIntParser)</p></td></tr><tr><td><p>proc_regex</p></td><td><p>A regex to select a process by name. (type: RegEx)</p></td></tr>
</tbody>
</table>
</div>


<p>In virtual (or protected) mode, the CPU can not access physical memory
directly. Instead each memory access made by the CPU is translated using the MMU
into a relevant physical address. This translation is controlled by page tables
loaded in the memory address controlled by the CR3 register.</p>
<p>Each processes has a unique page table structure, and therefore a unique view of
physical memory. In order to know what physical address is mapped to each
virtual address you can use the <strong>vtop</strong> plugin. However, the reverse mapping is
not so simple - there can be many virtual addresses mapped to the same physical
address.</p>
<p>This plugin enumerates all virtual to physical mappings in one or more
processes. It then builds a large lookup table in memory to be able to reverse
the mapping. i.e. given a physical address, the plugin is able to determine the
virtual address that maps to it, and in which processes it exists.</p>
<p>Forensically this can be used if you find an interesting string in the physical
image (e.g. with a hex editor) and want to know which process has that physical
memory mapped. Another use case is to detect shared memory between multiple
processes.</p>
<h3>Notes</h3>
<ol>
<li>
<p>This plugin only enumerates the userspace portion of the process address
   space (since all processes share the same kernel address space).</p>
</li>
<li>
<p>The plugin may take a while to run while it builds its lookup table. The next
   time you run it it should be very fast. The lookup map is also stored in the
   session cache so you can use the <strong>-s</strong> parameter to store the session for
   next time.</p>
</li>
</ol>
<h3>Sample output</h3>
<p>In the following we see that the process <code>vol.exe</code> is a Wow64 process and maps
<strong>\Windows\SysWOW64\ws2_32.dll</strong>. We want to know who else is using this dll. We
first find the physical address of the mapped dll (note we need to switch to the
correct process context first), then we use the <strong>pas2vas</strong> plugin to determine
which other process has that physical page mapped.</p>
<div class="highlight"><pre><span class="n">win7</span><span class="p">.</span><span class="n">elf</span> <span class="mi">12</span><span class="o">:</span><span class="mi">29</span><span class="o">:</span><span class="mi">35</span><span class="o">&gt;</span> <span class="n">pslist</span>
  <span class="n">Offset</span> <span class="p">(</span><span class="n">V</span><span class="p">)</span>   <span class="n">Name</span>                    <span class="n">PID</span>   <span class="n">PPID</span>   <span class="n">Thds</span>     <span class="n">Hnds</span>   <span class="n">Sess</span>  <span class="n">Wow64</span> <span class="n">Start</span>                    <span class="n">Exit</span>
<span class="o">--------------</span> <span class="o">--------------------</span> <span class="o">------</span> <span class="o">------</span> <span class="o">------</span> <span class="o">--------</span> <span class="o">------</span> <span class="o">------</span> <span class="o">------------------------</span> <span class="o">------------------------</span>
<span class="p">...</span>
<span class="mh">0xfa8002193060</span> <span class="n">vol</span><span class="p">.</span><span class="n">exe</span>                <span class="mi">2912</span>   <span class="mi">2644</span>      <span class="mi">1</span>       <span class="mi">19</span>      <span class="mi">1</span>   <span class="n">True</span> <span class="mi">2012</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mo">01</span> <span class="mi">14</span><span class="o">:</span><span class="mi">41</span><span class="o">:</span><span class="mo">03</span><span class="o">+</span><span class="mo">0000</span> <span class="o">-</span>
<span class="mh">0xfa80017f9060</span> <span class="n">vol</span><span class="p">.</span><span class="n">exe</span>                <span class="mi">2920</span>   <span class="mi">2912</span>      <span class="mi">4</span>      <span class="mi">169</span>      <span class="mi">1</span>   <span class="n">True</span> <span class="mi">2012</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mo">01</span> <span class="mi">14</span><span class="o">:</span><span class="mi">41</span><span class="o">:</span><span class="mo">03</span><span class="o">+</span><span class="mo">0000</span> <span class="o">-</span>
<span class="n">win7</span><span class="p">.</span><span class="n">elf</span> <span class="mi">12</span><span class="o">:</span><span class="mi">29</span><span class="o">:</span><span class="mi">59</span><span class="o">&gt;</span> <span class="n">vad</span> <span class="mi">2912</span>
<span class="o">-----------------&gt;</span> <span class="n">vad</span><span class="p">(</span><span class="mi">2912</span><span class="p">)</span>
<span class="o">**************************************************</span>
<span class="nl">Pid:</span> <span class="mi">2912</span> <span class="n">vol</span><span class="p">.</span><span class="n">exe</span>
     <span class="n">VAD</span>       <span class="n">lev</span>     <span class="n">start</span>           <span class="n">end</span>        <span class="n">com</span> <span class="o">-</span>       <span class="o">-</span>      <span class="n">Protect</span>              <span class="n">Filename</span>
<span class="o">--------------</span> <span class="o">---</span> <span class="o">--------------</span> <span class="o">--------------</span> <span class="o">----</span> <span class="o">-------</span> <span class="o">------</span> <span class="o">--------------------</span> <span class="o">--------</span>
<span class="mh">0xfa80026f9d80</span> <span class="mi">1</span>         <span class="mh">0x74400</span>        <span class="mh">0x7443e</span>    <span class="mi">3</span> <span class="n">Mapped</span>  <span class="n">Exe</span>    <span class="n">EXECUTE_WRITECOPY</span>    <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">wow64</span><span class="p">.</span><span class="n">dll</span>
<span class="p">...</span>
<span class="mh">0xfa80021da200</span> <span class="mi">3</span>         <span class="mh">0x766c0</span>        <span class="mh">0x766f4</span>    <span class="mi">2</span> <span class="n">Mapped</span>  <span class="n">Exe</span>    <span class="n">EXECUTE_WRITECOPY</span>    <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">ws2_32</span><span class="p">.</span><span class="n">dll</span>
<span class="mh">0xfa80026eb5e0</span> <span class="mi">4</span>         <span class="mh">0x75ef0</span>        <span class="mh">0x75fdf</span>    <span class="mi">2</span> <span class="n">Mapped</span>  <span class="n">Exe</span>    <span class="n">EXECUTE_WRITECOPY</span>    <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">rpcrt4</span><span class="p">.</span><span class="n">dll</span>
<span class="p">...</span>
<span class="mh">0xfa80028f59d0</span> <span class="mi">5</span>         <span class="mh">0x7fff0</span>     <span class="mh">0x7fffffef</span>   <span class="o">-</span><span class="mi">1</span> <span class="n">Private</span>        <span class="n">READONLY</span>
<span class="n">win7</span><span class="p">.</span><span class="n">elf</span> <span class="mi">12</span><span class="o">:</span><span class="mi">30</span><span class="o">:</span><span class="mi">08</span><span class="o">&gt;</span> <span class="n">cc</span> <span class="mi">2912</span>
<span class="n">Switching</span> <span class="n">to</span> <span class="n">process</span> <span class="n">context</span><span class="o">:</span> <span class="n">vol</span><span class="p">.</span><span class="n">exe</span> <span class="p">(</span><span class="n">Pid</span> <span class="mi">2912</span><span class="err">@</span><span class="mh">0xfa8002193060</span><span class="p">)</span>

<span class="n">win7</span><span class="p">.</span><span class="n">elf</span> <span class="mi">12</span><span class="o">:</span><span class="mi">32</span><span class="o">:</span><span class="mi">45</span><span class="o">&gt;</span> <span class="n">vtop</span> <span class="mh">0x766c0000</span>
<span class="o">-----------------&gt;</span> <span class="n">vtop</span><span class="p">(</span><span class="mh">0x766c0000</span><span class="p">)</span>
<span class="n">Virtual</span> <span class="mh">0x766c0000</span> <span class="n">Page</span> <span class="n">Directory</span> <span class="mh">0x271ec000</span>
<span class="n">pml4e</span><span class="err">@</span> <span class="mh">0x271ec000</span> <span class="o">=</span> <span class="mh">0x70000008844867</span>
<span class="n">pdpte</span><span class="err">@</span> <span class="mh">0x8844008</span> <span class="o">=</span> <span class="mh">0x80000007845867</span>
<span class="n">pde</span><span class="err">@</span> <span class="mh">0x7845d98</span> <span class="o">=</span> <span class="mh">0x7b55847</span>
<span class="n">pte</span><span class="err">@</span> <span class="mh">0x7b55600</span> <span class="o">=</span> <span class="mh">0x1a58f005</span>
<span class="n">PTE</span> <span class="n">mapped</span><span class="err">@</span> <span class="mh">0x7b55600</span> <span class="o">=</span> <span class="mh">0x1a58f000</span>
<span class="n">Physical</span> <span class="n">Address</span> <span class="mh">0x1a58f000</span>
<span class="n">win7</span><span class="p">.</span><span class="n">elf</span> <span class="mi">12</span><span class="o">:</span><span class="mi">32</span><span class="o">:</span><span class="mi">53</span><span class="o">&gt;</span> <span class="n">pas2vas</span> <span class="mh">0x1a58f000</span>

   <span class="n">Physical</span>       <span class="n">Virtual</span>        <span class="n">Pid</span> <span class="n">Name</span>
<span class="o">--------------</span> <span class="o">--------------</span> <span class="o">------</span> <span class="o">----</span>
<span class="mh">0x00001a58f000</span> <span class="mh">0x0000766c0000</span>   <span class="mi">2616</span> <span class="n">Console</span><span class="p">.</span><span class="n">exe</span>
<span class="mh">0x00001a58f000</span> <span class="mh">0x0000766c0000</span>   <span class="mi">2920</span> <span class="n">vol</span><span class="p">.</span><span class="n">exe</span>
<span class="mh">0x00001a58f000</span> <span class="mh">0x0000766c0000</span>   <span class="mi">2912</span> <span class="n">vol</span><span class="p">.</span><span class="n">exe</span>
</pre></div>


<p>We see that <code>Console.exe</code> also maps the same dll - probably since it is also a
Wow64 process which requires network access.</p>
</div>

<h1 id="pedump" class="anchor">pedump</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.procdump.PEDump-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Dump a PE binary from memory.</h2>
</div>


<h3>Plugin Arguments</h3>
<div class="plugins_args">
<table class='table table-condensed'>
<tbody>
<tr><td><p>address_space</p></td><td><p>The address space to use.</p></td></tr><tr><td><p>image_base</p></td><td><p>The address of the image base (dos header). (type: IntParser)</p>
<ul>
<li>Default: 0</li>
</ul></td></tr><tr><td><p>out_fd</p></td><td><p>A file like object to write the output.</p></td></tr><tr><td><p>out_file</p></td><td><p>The file name to write.</p></td></tr>
</tbody>
</table>
</div>


<p>Windows executable files (PE Files) are mapped into memory from disk. This
plugin can dump arbitrary PE files from memory (whether they are executables,
DLLs, kernel modules etc). All we require is the PE file&rsquo;s mapped base addresses
(i.e. the location in the virtual address space where the MZ header resides.</p>
<p>The image_base offset can be specified using a named address as usual. So for
example, to specify a kernel module it is sufficient to just name it
(e.g. pedump &ldquo;nt&rdquo; - will dump the kernel image).</p>
<p>This plugin is used by the <strong>dlldump</strong>, <strong>moddump</strong>, <strong>procdump</strong> etc plugins.</p>
<h3>Note</h3>
<ol>
<li>
<p>In order to dump any PE file from memory we need the PE header to be memory
   resident. Often this is not the case, and the header is flushed out of
   virtual memory. In this case it is still possible to dump parts of the PE
   image using the <a href="VADDump.html">vaddump</a> plugin.</p>
</li>
<li>
<p>When dumping any binary from memory, it is not usually a perfect binary
   (i.e. you can not just run it). This is because the Import Address Table
   (IAT) reflects the patched version in memory and some pages may be
   missing. The resultant binary is probably only useful to analyses using a
   tool like IDA pro.</p>
</li>
</ol>
</div>

<h1 id="peinfo" class="anchor">peinfo</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.procinfo.PEInfo-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Print information about a PE binary.</h2>
</div>


<h3>Plugin Arguments</h3>
<div class="plugins_args">
<table class='table table-condensed'>
<tbody>
<tr><td><p>address-space</p></td><td><p>The address space to use.</p></td></tr><tr><td><p>executable</p></td><td><p>If provided we create an address space from this file.</p></td></tr><tr><td><p>image-base</p></td><td><p>The base of the image. (type: SymbolAddress)</p></td></tr><tr><td><p>verbosity</p></td><td><p>An integer reflecting the amount of desired output: 0 = quiet, 10 = noisy. (type: IntParser)</p>
<ul>
<li>Default: 1</li>
</ul></td></tr>
</tbody>
</table>
</div>


<p>The <strong>peinfo</strong> plugin examines a PE file mapped into memory and displays a rich
variety of information about it:</p>
<ul>
<li>Metadata about the file (architecture, build date etc)</li>
<li>The PDB guid for the file.</li>
<li>The list of sections and where they are mapped into the virtual address space</li>
<li>The import directory.</li>
<li>The export directory.</li>
<li>A version resource strings that might exist in the executable.</li>
</ul>
<h3>Notes</h3>
<ol>
<li>
<p>This plugin depends on having a valid mapped PE header into memory. Sometimes
   this is not the case, since under memory pressure the kernel will unmapped
   the PE headers (since they are not needed after loading).</p>
</li>
<li>
<p>This plugin also works on disk files (PE executable). Simply pass a filename
   parameter to have it print information about external files.</p>
</li>
</ol>
<h3>Sample output</h3>
<div class="highlight"><pre><span class="n">win8</span><span class="mf">.1</span><span class="p">.</span><span class="n">raw</span> <span class="mi">15</span><span class="o">:</span><span class="mi">11</span><span class="o">:</span><span class="mo">02</span><span class="o">&gt;</span> <span class="n">peinfo</span> <span class="s">&quot;nt&quot;</span>
<span class="o">-------------------&gt;</span> <span class="n">peinfo</span><span class="p">(</span><span class="s">&quot;nt&quot;</span><span class="p">)</span>
<span class="n">Attribute</span>            <span class="n">Value</span>
<span class="o">--------------------</span> <span class="o">-----</span>
<span class="n">Machine</span>              <span class="n">IMAGE_FILE_MACHINE_AMD64</span>
<span class="n">TimeDateStamp</span>        <span class="mi">2013</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">14</span> <span class="mi">08</span><span class="o">:</span><span class="mi">23</span><span class="o">:</span><span class="mi">16</span><span class="o">+</span><span class="mo">0000</span>
<span class="n">Characteristics</span>      <span class="n">IMAGE_FILE_EXECUTABLE_IMAGE</span><span class="p">,</span> <span class="n">IMAGE_FILE_LARGE_ADDRESS_AWARE</span>
<span class="n">GUID</span><span class="o">/</span><span class="n">Age</span>             <span class="n">FD3D00D28EDC4527BB922BCC0509D2851</span>
<span class="n">PDB</span>                  <span class="n">ntkrnlmp</span><span class="p">.</span><span class="n">pdb</span>
<span class="n">MajorOperatingSystemVersion</span> <span class="mi">6</span>
<span class="n">MinorOperatingSystemVersion</span> <span class="mi">3</span>
<span class="n">MajorImageVersion</span>    <span class="mi">6</span>
<span class="n">MinorImageVersion</span>    <span class="mi">3</span>
<span class="n">MajorSubsystemVersion</span> <span class="mi">6</span>
<span class="n">MinorSubsystemVersion</span> <span class="mi">3</span>

<span class="n">Sections</span> <span class="p">(</span><span class="n">Relative</span> <span class="n">to</span> <span class="mh">0xF802D3019000</span><span class="p">)</span><span class="o">:</span>
<span class="n">Perm</span> <span class="n">Name</span>          <span class="n">VMA</span>            <span class="n">Size</span>
<span class="o">----</span> <span class="o">--------</span> <span class="o">--------------</span> <span class="o">--------------</span>
<span class="n">xr</span><span class="o">-</span>  <span class="p">.</span><span class="n">text</span>    <span class="mh">0x000000001000</span> <span class="mh">0x00000028d600</span>
<span class="n">xr</span><span class="o">-</span>  <span class="n">NONPAGED</span> <span class="mh">0x00000028f000</span> <span class="mh">0x000000000200</span>
<span class="n">xr</span><span class="o">-</span>  <span class="n">POOLCODE</span> <span class="mh">0x000000290000</span> <span class="mh">0x000000002800</span>
<span class="o">-</span><span class="n">rw</span>  <span class="p">.</span><span class="n">data</span>    <span class="mh">0x000000293000</span> <span class="mh">0x00000000be00</span>
<span class="o">-</span><span class="n">r</span><span class="o">-</span>  <span class="p">.</span><span class="n">reloc</span>   <span class="mh">0x000000778000</span> <span class="mh">0x000000008e00</span>
<span class="p">...</span>

<span class="n">Data</span> <span class="n">Directories</span><span class="o">:</span>
<span class="o">-</span>                                             <span class="n">VMA</span>            <span class="n">Size</span>
<span class="o">----------------------------------------</span> <span class="o">--------------</span> <span class="o">--------------</span>
<span class="n">IMAGE_DIRECTORY_ENTRY_EXPORT</span>             <span class="mh">0xf802d36ab000</span> <span class="mh">0x0000000135ff</span>
<span class="n">IMAGE_DIRECTORY_ENTRY_IMPORT</span>             <span class="mh">0xf802d335b728</span> <span class="mh">0x00000000012c</span>
<span class="n">IMAGE_DIRECTORY_ENTRY_RESOURCE</span>           <span class="mh">0xf802d375f000</span> <span class="mh">0x000000031d20</span>
<span class="n">IMAGE_DIRECTORY_ENTRY_EXCEPTION</span>          <span class="mh">0xf802d331c000</span> <span class="mh">0x00000003ed6c</span>
<span class="n">IMAGE_DIRECTORY_ENTRY_SECURITY</span>           <span class="mh">0xf802d3725e00</span> <span class="mh">0x000000002158</span>
<span class="n">IMAGE_DIRECTORY_ENTRY_BASERELOC</span>          <span class="mh">0xf802d3791000</span> <span class="mh">0x000000003cd4</span>
<span class="n">IMAGE_DIRECTORY_ENTRY_DEBUG</span>              <span class="mh">0xf802d301a100</span> <span class="mh">0x000000000038</span>
<span class="n">IMAGE_DIRECTORY_ENTRY_COPYRIGHT</span>          <span class="mh">0x000000000000</span> <span class="mh">0x000000000000</span>
<span class="n">IMAGE_DIRECTORY_ENTRY_GLOBALPTR</span>          <span class="mh">0x000000000000</span> <span class="mh">0x000000000000</span>
<span class="n">IMAGE_DIRECTORY_ENTRY_TLS</span>                <span class="mh">0x000000000000</span> <span class="mh">0x000000000000</span>
<span class="n">IMAGE_DIRECTORY_ENTRY_LOAD_CONFIG</span>        <span class="mh">0xf802d3033f20</span> <span class="mh">0x000000000094</span>
<span class="n">IMAGE_DIRECTORY_ENTRY_BOUND_IMPORT</span>       <span class="mh">0x000000000000</span> <span class="mh">0x000000000000</span>
<span class="n">IMAGE_DIRECTORY_ENTRY_IAT</span>                <span class="mh">0xf802d335b000</span> <span class="mh">0x000000000728</span>
<span class="n">IMAGE_DIRECTORY_ENTRY_DELAY_IMPORT</span>       <span class="mh">0x000000000000</span> <span class="mh">0x000000000000</span>
<span class="n">IMAGE_DIRECTORY_ENTRY_COM_DESCRIPTOR</span>     <span class="mh">0x000000000000</span> <span class="mh">0x000000000000</span>
<span class="n">IMAGE_DIRECTORY_ENTRY_RESERVED</span>           <span class="mh">0x000000000000</span> <span class="mh">0x000000000000</span>

<span class="n">Import</span> <span class="n">Directory</span> <span class="p">(</span><span class="n">Original</span><span class="p">)</span><span class="o">:</span>
<span class="n">Name</span>                                               <span class="n">Ord</span>
<span class="o">--------------------------------------------------</span> <span class="o">-----</span>
<span class="n">ext</span><span class="o">-</span><span class="n">ms</span><span class="o">-</span><span class="n">win</span><span class="o">-</span><span class="n">ntos</span><span class="o">-</span><span class="n">werkernel</span><span class="o">-</span><span class="n">l1</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mf">0.</span><span class="n">dll</span><span class="o">!</span><span class="n">WerLiveKernelCloseHandle</span> <span class="mi">1</span>
<span class="n">ext</span><span class="o">-</span><span class="n">ms</span><span class="o">-</span><span class="n">win</span><span class="o">-</span><span class="n">ntos</span><span class="o">-</span><span class="n">werkernel</span><span class="o">-</span><span class="n">l1</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mf">0.</span><span class="n">dll</span><span class="o">!</span><span class="n">WerLiveKernelOpenDumpFile</span> <span class="mi">4</span>
<span class="n">ext</span><span class="o">-</span><span class="n">ms</span><span class="o">-</span><span class="n">win</span><span class="o">-</span><span class="n">ntos</span><span class="o">-</span><span class="n">werkernel</span><span class="o">-</span><span class="n">l1</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mf">0.</span><span class="n">dll</span><span class="o">!</span><span class="n">WerLiveKernelCancelReport</span> <span class="mi">0</span>
<span class="n">ext</span><span class="o">-</span><span class="n">ms</span><span class="o">-</span><span class="n">win</span><span class="o">-</span><span class="n">ntos</span><span class="o">-</span><span class="n">werkernel</span><span class="o">-</span><span class="n">l1</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mf">0.</span><span class="n">dll</span><span class="o">!</span><span class="n">WerLiveKernelInitSystem</span> <span class="mi">3</span>
<span class="p">...</span>
<span class="n">msrpc</span><span class="p">.</span><span class="n">sys</span><span class="o">!</span><span class="n">MesDecodeBufferHandleCreate</span>              <span class="mi">11</span>
<span class="n">msrpc</span><span class="p">.</span><span class="n">sys</span><span class="o">!</span><span class="n">NdrMesTypeDecode3</span>                        <span class="mi">45</span>

<span class="n">Export</span> <span class="n">Directory</span><span class="o">:</span>
    <span class="n">Entry</span>      <span class="n">Stat</span> <span class="n">Ord</span>   <span class="n">Name</span>
<span class="o">--------------</span> <span class="o">----</span> <span class="o">-----</span> <span class="o">--------------------------------------------------</span>
<span class="mh">0xf802d30ed1f4</span> <span class="n">M</span>    <span class="mi">3</span>     <span class="n">ntoskrnl</span><span class="p">.</span><span class="n">exe</span><span class="o">!</span><span class="n">AlpcGetHeaderSize</span> <span class="p">(</span><span class="n">nt</span><span class="o">!</span><span class="n">AlpcGetHeaderSize</span><span class="p">)</span>
<span class="mh">0xf802d30ed080</span> <span class="n">M</span>    <span class="mi">4</span>     <span class="n">ntoskrnl</span><span class="p">.</span><span class="n">exe</span><span class="o">!</span><span class="n">AlpcGetMessageAttribute</span> <span class="p">(</span><span class="n">nt</span><span class="o">!</span><span class="n">AlpcGetMessageAttribute</span><span class="p">)</span>
<span class="mh">0xf802d30ed19c</span> <span class="n">M</span>    <span class="mi">5</span>     <span class="n">ntoskrnl</span><span class="p">.</span><span class="n">exe</span><span class="o">!</span><span class="n">AlpcInitializeMessageAttribute</span> <span class="p">(</span><span class="n">nt</span><span class="o">!</span><span class="n">AlpcInitializeMessageAttribute</span><span class="p">)</span>
<span class="mh">0xf802d36a4004</span> <span class="o">-</span>    <span class="mi">6</span>     <span class="n">ntoskrnl</span><span class="p">.</span><span class="n">exe</span><span class="o">!</span><span class="n">BgkDisplayCharacter</span> <span class="p">(</span><span class="n">nt</span><span class="o">!</span><span class="n">BgkDisplayCharacter</span><span class="p">)</span>
<span class="mh">0xf802d36a40b8</span> <span class="o">-</span>    <span class="mi">7</span>     <span class="n">ntoskrnl</span><span class="p">.</span><span class="n">exe</span><span class="o">!</span><span class="n">BgkGetConsoleState</span> <span class="p">(</span><span class="n">nt</span><span class="o">!</span><span class="n">BgkGetConsoleState</span><span class="p">)</span>
<span class="mh">0xf802d36a40e0</span> <span class="o">-</span>    <span class="mi">8</span>     <span class="n">ntoskrnl</span><span class="p">.</span><span class="n">exe</span><span class="o">!</span><span class="n">BgkGetCursorState</span> <span class="p">(</span><span class="n">nt</span><span class="o">!</span><span class="n">BgkGetCursorState</span><span class="p">)</span>
<span class="mh">0xf802d36a4108</span> <span class="o">-</span>    <span class="mi">9</span>     <span class="n">ntoskrnl</span><span class="p">.</span><span class="n">exe</span><span class="o">!</span><span class="n">BgkSetCursor</span> <span class="p">(</span><span class="n">nt</span><span class="o">!</span><span class="n">BgkSetCursor</span><span class="p">)</span>
<span class="mh">0xf802d31d23c8</span> <span class="n">M</span>    <span class="mi">10</span>    <span class="n">ntoskrnl</span><span class="p">.</span><span class="n">exe</span><span class="o">!</span><span class="n">CcAddDirtyPagesToExternalCache</span> <span class="p">(</span><span class="n">nt</span><span class="o">!</span><span class="n">CcAddDirtyPagesToExternalCache</span><span class="p">)</span>
<span class="mh">0xf802d3106888</span> <span class="n">M</span>    <span class="mi">11</span>    <span class="n">ntoskrnl</span><span class="p">.</span><span class="n">exe</span><span class="o">!</span><span class="n">CcCanIWrite</span> <span class="p">(</span><span class="n">nt</span><span class="o">!</span><span class="n">CcCanIWrite</span><span class="p">)</span>
<span class="p">...</span>
</pre></div>
</div>

<h1 id="pfn" class="anchor">pfn</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.pfn.PFNInfo-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Prints information about an address from the PFN database.</h2>
</div>


<h3>Plugin Arguments</h3>
<div class="plugins_args">
<table class='table table-condensed'>
<tbody>
<tr><td><p>pfn</p></td><td><p>The PFN to examine. (type: IntParser)</p></td></tr>
</tbody>
</table>
</div>



</div>

<h1 id="phys_map" class="anchor">phys_map</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.misc.WinPhysicalMap-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Prints the boot physical memory map.</h2>
</div>



<p>This plugin will simply print the kernels idea of the physical memory layout on
a machine. Typically the physical address space is not contiguous (i.e. does not
have RAM chip mapping all address ranges between 0 and the maximum number). This
is because the BIOS needs to leave gaps for DMA devices to be mapped.</p>
<p>The BIOS sets up an initial mapping and communicates the mapping to the kernel
through a BIOS service call (Or EFI call) which can be done while the kernel
still boots (In real mode). The kernel then keeps this information and returns
it through the <strong>MmGetPhysicalMemoryRanges()</strong> function.</p>
<h3>Notes</h3>
<ol>
<li>It is rather easy to manipulate this information to subvert acquisition. Most
   acquisition tools use this information to determine where it is safe to read
   and to avoid reading from DMA mapped memory.</li>
</ol>
<h3>Sample output</h3>
<div class="highlight"><pre><span class="n">win8</span><span class="mf">.1</span><span class="p">.</span><span class="n">raw</span> <span class="mi">15</span><span class="o">:</span><span class="mi">19</span><span class="o">:</span><span class="mi">26</span><span class="o">&gt;</span> <span class="n">phys_map</span>
<span class="o">-------------------&gt;</span> <span class="n">phys_map</span><span class="p">()</span>
  <span class="n">Phys</span> <span class="n">Start</span>      <span class="n">Phys</span> <span class="n">End</span>    <span class="n">Number</span> <span class="n">of</span> <span class="n">Pages</span>
<span class="o">--------------</span> <span class="o">--------------</span> <span class="o">---------------</span>
<span class="mh">0x000000001000</span> <span class="mh">0x00000009f000</span> <span class="mi">158</span>
<span class="mh">0x000000100000</span> <span class="mh">0x000000102000</span> <span class="mi">2</span>
<span class="mh">0x000000103000</span> <span class="mh">0x00003fff0000</span> <span class="mi">261869</span>
</pre></div>
</div>

<h1 id="pool_tracker" class="anchor">pool_tracker</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.misc.PoolTracker-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Enumerate pool tag usage statistics.</h2>
</div>



<p>The Windows kernel allocates memory from a shared pool. In order to track memory
leaks and to aid in debugging, pool allocations typically have fixed tags
indicating the component which allocated the memory. For example, in windows 8,
allocating an _EPROCESS struct will result in a pool allocation with a tag of
<code>Proc</code>.</p>
<p>To aid in debugging, Windows tracks pool allocation in a special table found by
the symbol <strong>PoolTrackTable</strong>. This table can show the total number of
allocation and deallocations associated with a particular pool tag.</p>
<p>From a forensic point of view, this information can be useful to assess the
number of outstanding allocations. For example we can see how many live
processes we expect to be preset.</p>
<h3>Notes</h3>
<ol>
<li>Just because the process is terminated does not mean the _EPROCESS structure
   is immediately deallocated. Windows might keep these structures alive for
   some time for various reasons. A discrepancy here is at best a hint that
   something does&rsquo;nt add up.</li>
</ol>
<h3>Sample output</h3>
<div class="highlight"><pre><span class="n">win8</span><span class="mf">.1</span><span class="p">.</span><span class="n">raw</span> <span class="mi">15</span><span class="o">:</span><span class="mi">29</span><span class="o">:</span><span class="mo">07</span><span class="o">&gt;</span> <span class="n">pool_tracker</span>
<span class="n">Tag</span>              <span class="n">NP</span> <span class="n">Alloc</span>   <span class="n">NP</span> <span class="n">Bytes</span>              <span class="n">P</span> <span class="n">Alloc</span>    <span class="n">P</span> <span class="n">Bytes</span>
<span class="o">----</span> <span class="o">--------------------</span> <span class="o">----------</span> <span class="o">--------------------</span> <span class="o">----------</span>
 <span class="n">DMV</span>                <span class="mi">1</span> <span class="p">(</span><span class="mi">0</span><span class="p">)</span>          <span class="mi">0</span>                <span class="mi">0</span> <span class="p">(</span><span class="mi">0</span><span class="p">)</span>          <span class="mi">0</span>
<span class="mi">8042</span>                <span class="mi">6</span> <span class="p">(</span><span class="mi">4</span><span class="p">)</span>       <span class="mi">4048</span>               <span class="mi">12</span> <span class="p">(</span><span class="mi">0</span><span class="p">)</span>          <span class="mi">0</span>
<span class="n">ACPI</span>                <span class="mi">4</span> <span class="p">(</span><span class="mi">0</span><span class="p">)</span>          <span class="mi">0</span>                <span class="mi">0</span> <span class="p">(</span><span class="mi">0</span><span class="p">)</span>          <span class="mi">0</span>
<span class="n">AFGp</span>                <span class="mi">1</span> <span class="p">(</span><span class="mi">0</span><span class="p">)</span>          <span class="mi">0</span>                <span class="mi">0</span> <span class="p">(</span><span class="mi">0</span><span class="p">)</span>          <span class="mi">0</span>
<span class="n">ALPC</span>           <span class="mi">3211</span> <span class="p">(</span><span class="mi">770</span><span class="p">)</span>     <span class="mi">434240</span>                <span class="mi">0</span> <span class="p">(</span><span class="mi">0</span><span class="p">)</span>          <span class="mi">0</span>
<span class="n">ARFT</span>                <span class="mi">0</span> <span class="p">(</span><span class="mi">0</span><span class="p">)</span>          <span class="mi">0</span>              <span class="mi">151</span> <span class="p">(</span><span class="mi">3</span><span class="p">)</span>        <span class="mi">192</span>
<span class="n">AcpA</span>                <span class="mi">2</span> <span class="p">(</span><span class="mi">2</span><span class="p">)</span>        <span class="mi">160</span>                <span class="mi">0</span> <span class="p">(</span><span class="mi">0</span><span class="p">)</span>          <span class="mi">0</span>
<span class="n">AcpB</span>                <span class="mi">0</span> <span class="p">(</span><span class="mi">0</span><span class="p">)</span>          <span class="mi">0</span>              <span class="mi">121</span> <span class="p">(</span><span class="mi">0</span><span class="p">)</span>          <span class="mi">0</span>
<span class="p">...</span>
<span class="n">Pprl</span>                <span class="mi">0</span> <span class="p">(</span><span class="mi">0</span><span class="p">)</span>          <span class="mi">0</span>                <span class="mi">3</span> <span class="p">(</span><span class="mi">0</span><span class="p">)</span>          <span class="mi">0</span>
<span class="n">Ppsu</span>                <span class="mi">0</span> <span class="p">(</span><span class="mi">0</span><span class="p">)</span>          <span class="mi">0</span>           <span class="mi">1394</span> <span class="p">(</span><span class="mi">223</span><span class="p">)</span>      <span class="mi">18512</span>
<span class="n">Prcr</span>                <span class="mi">5</span> <span class="p">(</span><span class="mi">4</span><span class="p">)</span>       <span class="mi">5440</span>               <span class="mi">13</span> <span class="p">(</span><span class="mi">0</span><span class="p">)</span>          <span class="mi">0</span>
<span class="n">Proc</span>             <span class="mi">137</span> <span class="p">(</span><span class="mi">48</span><span class="p">)</span>      <span class="mi">91328</span>                <span class="mi">0</span> <span class="p">(</span><span class="mi">0</span><span class="p">)</span>          <span class="mi">0</span>
<span class="n">PsFn</span>              <span class="mi">136</span> <span class="p">(</span><span class="mi">0</span><span class="p">)</span>          <span class="mi">0</span>                <span class="mi">0</span> <span class="p">(</span><span class="mi">0</span><span class="p">)</span>          <span class="mi">0</span>
<span class="p">...</span>

<span class="n">win8</span><span class="mf">.1</span><span class="p">.</span><span class="n">raw</span> <span class="mi">15</span><span class="o">:</span><span class="mi">36</span><span class="o">:</span><span class="mi">40</span><span class="o">&gt;</span> <span class="n">pslist</span>
<span class="o">-------------------&gt;</span> <span class="n">pslist</span><span class="p">()</span>
  <span class="n">Offset</span> <span class="p">(</span><span class="n">V</span><span class="p">)</span>   <span class="n">Name</span>                    <span class="n">PID</span>   <span class="n">PPID</span>   <span class="n">Thds</span>     <span class="n">Hnds</span>   <span class="n">Sess</span>  <span class="n">Wow64</span> <span class="n">Start</span>                    <span class="n">Exit</span>
<span class="o">--------------</span> <span class="o">--------------------</span> <span class="o">------</span> <span class="o">------</span> <span class="o">------</span> <span class="o">--------</span> <span class="o">------</span> <span class="o">------</span> <span class="o">------------------------</span> <span class="o">------------------------</span>
<span class="nl">DEBUG:</span><span class="n">root</span><span class="o">:</span><span class="n">Listed</span> <span class="mi">48</span> <span class="n">processes</span> <span class="n">using</span> <span class="n">PsActiveProcessHead</span>
<span class="nl">DEBUG:</span><span class="n">root</span><span class="o">:</span><span class="n">Listed</span> <span class="mi">43</span> <span class="n">processes</span> <span class="n">using</span> <span class="n">CSRSS</span>
<span class="nl">DEBUG:</span><span class="n">root</span><span class="o">:</span><span class="n">Listed</span> <span class="mi">47</span> <span class="n">processes</span> <span class="n">using</span> <span class="n">PspCidTable</span>
<span class="nl">DEBUG:</span><span class="n">root</span><span class="o">:</span><span class="n">Listed</span> <span class="mi">45</span> <span class="n">processes</span> <span class="n">using</span> <span class="n">Sessions</span>
<span class="nl">DEBUG:</span><span class="n">root</span><span class="o">:</span><span class="n">Listed</span> <span class="mi">45</span> <span class="n">processes</span> <span class="n">using</span> <span class="n">Handles</span>
<span class="p">...</span>
</pre></div>


<p>In the above example we see that there are 48 outstanding <em>_EPROCESS</em> objects
and there are 48 members in the <strong>PsActiveProcessHead</strong> list.</p>
</div>

<h1 id="pools" class="anchor">pools</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.misc.Pools-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Prints information about system pools.</h2>
<p>Ref:
http://illmatics.com/Windows%208%20Heap%20Internals.pdf
https://media.blackhat.com/bh-dc-11/Mandt/BlackHat_DC_2011_Mandt_kernelpool-wp.pdf
https://immunityinc.com/infiltrate/archives/kernelpool_infiltrate2011.pdf
http://gate.upm.ro/os/LABs/Windows_OS_Internals_Curriculum_Resource_Kit-ACADEMIC/WindowsResearchKernel-WRK/WRK-v1.2/base/ntos/ex/pool.c</p>
</div>




</div>

<h1 id="procdump" class="anchor">procdump</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.procdump.ProcExeDump-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Dump a process to an executable file sample</h2>
</div>


<h3>Plugin Arguments</h3>
<div class="plugins_args">
<table class='table table-condensed'>
<tbody>
<tr><td><p>dump_dir</p></td><td><p>Path suitable for dumping files. (Default: Use current directory)</p></td></tr><tr><td><p>eprocess</p></td><td><p>Kernel addresses of eprocess structs. (type: ArrayIntParser)</p></td></tr><tr><td><p>method</p></td><td><p>Method to list processes. (type: ChoiceArray)</p>
<ul>
<li>
<p>Valid Choices:</p>
<ul>
<li>PsActiveProcessHead</li>
<li>CSRSS</li>
<li>PspCidTable</li>
<li>Sessions</li>
<li>Handles</li>
</ul>
</li>
<li>
<p>Default: PsActiveProcessHead, CSRSS, PspCidTable, Sessions, Handles</p>
</li>
</ul></td></tr><tr><td><p>out_fd</p></td><td><p>A file like object to write the output.</p></td></tr><tr><td><p>phys_eprocess</p></td><td><p>Physical addresses of eprocess structs. (type: ArrayIntParser)</p></td></tr><tr><td><p>pid</p></td><td><p>One or more pids of processes to select. (type: ArrayIntParser)</p></td></tr><tr><td><p>proc_regex</p></td><td><p>A regex to select a process by name. (type: RegEx)</p></td></tr>
</tbody>
</table>
</div>


<p>This plugin dumps the mapped PE files associated with a windows process. It is
equivalent to calling <strong>pedump</strong> with an image base corresponding to the VAD
section of the main process executable.</p>
<p>The <strong>procdump</strong> plugin is a thin wrapper around the <strong>pedump</strong> plugin.</p>
<h3>Sample output</h3>
<div class="highlight"><pre><span class="n">win7</span><span class="p">.</span><span class="n">elf</span> <span class="mi">14</span><span class="o">:</span><span class="mi">42</span><span class="o">:</span><span class="mi">55</span><span class="o">&gt;</span> <span class="n">procdump</span> <span class="n">proc_regex</span><span class="o">=</span><span class="s">&quot;csrss&quot;</span><span class="p">,</span> <span class="n">dump_dir</span><span class="o">=</span><span class="s">&quot;/tmp/&quot;</span>
<span class="o">**************************************************</span>
<span class="n">Dumping</span> <span class="n">csrss</span><span class="p">.</span><span class="n">exe</span><span class="p">,</span> <span class="n">pid</span><span class="o">:</span> <span class="mi">348</span>    <span class="n">output</span><span class="o">:</span> <span class="n">executable</span><span class="p">.</span><span class="n">csrss_exe_348</span><span class="p">.</span><span class="n">exe</span>
<span class="o">**************************************************</span>
<span class="n">Dumping</span> <span class="n">csrss</span><span class="p">.</span><span class="n">exe</span><span class="p">,</span> <span class="n">pid</span><span class="o">:</span> <span class="mi">396</span>    <span class="n">output</span><span class="o">:</span> <span class="n">executable</span><span class="p">.</span><span class="n">csrss_exe_396</span><span class="p">.</span><span class="n">exe</span>
</pre></div>
</div>

<h1 id="procinfo" class="anchor">procinfo</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.procinfo.ProcInfo-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Dump detailed information about a running process.</h2>
</div>


<h3>Plugin Arguments</h3>
<div class="plugins_args">
<table class='table table-condensed'>
<tbody>
<tr><td><p>eprocess</p></td><td><p>Kernel addresses of eprocess structs. (type: ArrayIntParser)</p></td></tr><tr><td><p>method</p></td><td><p>Method to list processes. (type: ChoiceArray)</p>
<ul>
<li>
<p>Valid Choices:</p>
<ul>
<li>PsActiveProcessHead</li>
<li>CSRSS</li>
<li>PspCidTable</li>
<li>Sessions</li>
<li>Handles</li>
</ul>
</li>
<li>
<p>Default: PsActiveProcessHead, CSRSS, PspCidTable, Sessions, Handles</p>
</li>
</ul></td></tr><tr><td><p>phys_eprocess</p></td><td><p>Physical addresses of eprocess structs. (type: ArrayIntParser)</p></td></tr><tr><td><p>pid</p></td><td><p>One or more pids of processes to select. (type: ArrayIntParser)</p></td></tr><tr><td><p>proc_regex</p></td><td><p>A regex to select a process by name. (type: RegEx)</p></td></tr>
</tbody>
</table>
</div>


<p>The <strong>procinfo</strong> plugin displays basic information about a process. It takes all
the usual process selectors (e.g. pid, name etc) and prints information about
the PE file (using <strong>peinfo</strong>) as well as the process environment strings.</p>
<h3>Sample output</h3>
<div class="highlight"><pre><span class="n">win7</span><span class="p">.</span><span class="n">elf</span> <span class="mi">14</span><span class="o">:</span><span class="mi">43</span><span class="o">:</span><span class="mi">15</span><span class="o">&gt;</span> <span class="n">procinfo</span> <span class="n">proc_regex</span><span class="o">=</span><span class="s">&quot;csrss&quot;</span>
<span class="o">**************************************************</span>
<span class="nl">Pid:</span> <span class="mi">348</span> <span class="n">csrss</span><span class="p">.</span><span class="n">exe</span>

<span class="n">Process</span> <span class="n">Environment</span>
   <span class="n">ComSpec</span><span class="o">=</span><span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">system32</span><span class="err">\</span><span class="n">cmd</span><span class="p">.</span><span class="n">exe</span>
   <span class="n">FP_NO_HOST_CHECK</span><span class="o">=</span><span class="n">NO</span>
   <span class="n">NUMBER_OF_PROCESSORS</span><span class="o">=</span><span class="mi">1</span>
   <span class="n">OS</span><span class="o">=</span><span class="n">Windows_NT</span>
   <span class="n">Path</span><span class="o">=</span><span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">system32</span><span class="p">;</span><span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">Windows</span><span class="p">;</span><span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">Wbem</span><span class="p">;</span><span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">WindowsPowerShell</span><span class="err">\</span><span class="n">v1</span><span class="mf">.0</span>\
   <span class="n">PATHEXT</span><span class="o">=</span><span class="p">.</span><span class="n">COM</span><span class="p">;.</span><span class="n">EXE</span><span class="p">;.</span><span class="n">BAT</span><span class="p">;.</span><span class="n">CMD</span><span class="p">;.</span><span class="n">VBS</span><span class="p">;.</span><span class="n">VBE</span><span class="p">;.</span><span class="n">JS</span><span class="p">;.</span><span class="n">JSE</span><span class="p">;.</span><span class="n">WSF</span><span class="p">;.</span><span class="n">WSH</span><span class="p">;.</span><span class="n">MSC</span>
   <span class="n">PROCESSOR_ARCHITECTURE</span><span class="o">=</span><span class="n">AMD64</span>
   <span class="n">PROCESSOR_IDENTIFIER</span><span class="o">=</span><span class="n">Intel64</span> <span class="n">Family</span> <span class="mi">6</span> <span class="n">Model</span> <span class="mi">37</span> <span class="n">Stepping</span> <span class="mi">2</span><span class="p">,</span> <span class="n">GenuineIntel</span>
   <span class="n">PROCESSOR_LEVEL</span><span class="o">=</span><span class="mi">6</span>
   <span class="n">PROCESSOR_REVISION</span><span class="o">=</span><span class="mi">2502</span>
   <span class="n">PSModulePath</span><span class="o">=</span><span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">system32</span><span class="err">\</span><span class="n">WindowsPowerShell</span><span class="err">\</span><span class="n">v1</span><span class="mf">.0</span><span class="err">\</span><span class="n">Modules</span>\
   <span class="n">SystemDrive</span><span class="o">=</span><span class="n">C</span><span class="o">:</span>
   <span class="n">SystemRoot</span><span class="o">=</span><span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">Windows</span>
   <span class="n">TEMP</span><span class="o">=</span><span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">TEMP</span>
   <span class="n">TMP</span><span class="o">=</span><span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">TEMP</span>
   <span class="n">USERNAME</span><span class="o">=</span><span class="n">SYSTEM</span>
   <span class="n">windir</span><span class="o">=</span><span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">Windows</span>

<span class="n">PE</span> <span class="n">Infomation</span>
<span class="n">Attribute</span>            <span class="n">Value</span>
<span class="o">--------------------</span> <span class="o">-----</span>
<span class="n">Machine</span>              <span class="n">IMAGE_FILE_MACHINE_AMD64</span>
<span class="n">TimeDateStamp</span>        <span class="mi">2009</span><span class="o">-</span><span class="mo">07</span><span class="o">-</span><span class="mi">13</span> <span class="mi">23</span><span class="o">:</span><span class="mi">19</span><span class="o">:</span><span class="mi">49</span><span class="o">+</span><span class="mo">0000</span>
<span class="n">Characteristics</span>      <span class="n">IMAGE_FILE_EXECUTABLE_IMAGE</span><span class="p">,</span> <span class="n">IMAGE_FILE_LARGE_ADDRESS_AWARE</span>
<span class="n">GUID</span><span class="o">/</span><span class="n">Age</span>             <span class="n">E8979C26A0EE47A69575E54FA6C7F6BE1</span>
<span class="n">PDB</span>                  <span class="n">csrss</span><span class="p">.</span><span class="n">pdb</span>
<span class="n">MajorOperatingSystemVersion</span> <span class="mi">6</span>
<span class="n">MinorOperatingSystemVersion</span> <span class="mi">1</span>
<span class="n">MajorImageVersion</span>    <span class="mi">6</span>
<span class="n">MinorImageVersion</span>    <span class="mi">1</span>
<span class="n">MajorSubsystemVersion</span> <span class="mi">6</span>
<span class="n">MinorSubsystemVersion</span> <span class="mi">1</span>

<span class="n">Sections</span> <span class="p">(</span><span class="n">Relative</span> <span class="n">to</span> <span class="mh">0x497B0000</span><span class="p">)</span><span class="o">:</span>
<span class="n">Perm</span> <span class="n">Name</span>          <span class="n">VMA</span>            <span class="n">Size</span>
<span class="o">----</span> <span class="o">--------</span> <span class="o">--------------</span> <span class="o">--------------</span>
<span class="n">xr</span><span class="o">-</span>  <span class="p">.</span><span class="n">text</span>    <span class="mh">0x000000001000</span> <span class="mh">0x000000000c00</span>
<span class="o">-</span><span class="n">rw</span>  <span class="p">.</span><span class="n">data</span>    <span class="mh">0x000000002000</span> <span class="mh">0x000000000200</span>
<span class="o">-</span><span class="n">r</span><span class="o">-</span>  <span class="p">.</span><span class="n">pdata</span>   <span class="mh">0x000000003000</span> <span class="mh">0x000000000200</span>
<span class="o">-</span><span class="n">r</span><span class="o">-</span>  <span class="p">.</span><span class="n">rsrc</span>    <span class="mh">0x000000004000</span> <span class="mh">0x000000000800</span>
<span class="o">-</span><span class="n">r</span><span class="o">-</span>  <span class="p">.</span><span class="n">reloc</span>   <span class="mh">0x000000005000</span> <span class="mh">0x000000000200</span>

<span class="n">Data</span> <span class="n">Directories</span><span class="o">:</span>
<span class="o">-</span>                                             <span class="n">VMA</span>            <span class="n">Size</span>
<span class="o">----------------------------------------</span> <span class="o">--------------</span> <span class="o">--------------</span>
<span class="n">IMAGE_DIRECTORY_ENTRY_EXPORT</span>             <span class="mh">0x000000000000</span> <span class="mh">0x000000000000</span>
<span class="n">IMAGE_DIRECTORY_ENTRY_IMPORT</span>             <span class="mh">0x0000497b17c4</span> <span class="mh">0x00000000003c</span>
<span class="n">IMAGE_DIRECTORY_ENTRY_RESOURCE</span>           <span class="mh">0x0000497b4000</span> <span class="mh">0x0000000007f8</span>
<span class="n">IMAGE_DIRECTORY_ENTRY_EXCEPTION</span>          <span class="mh">0x0000497b3000</span> <span class="mh">0x00000000003c</span>
<span class="n">IMAGE_DIRECTORY_ENTRY_SECURITY</span>           <span class="mh">0x000000000000</span> <span class="mh">0x000000000000</span>
<span class="n">IMAGE_DIRECTORY_ENTRY_BASERELOC</span>          <span class="mh">0x0000497b5000</span> <span class="mh">0x00000000000c</span>
<span class="n">IMAGE_DIRECTORY_ENTRY_DEBUG</span>              <span class="mh">0x0000497b10a0</span> <span class="mh">0x00000000001c</span>
<span class="n">IMAGE_DIRECTORY_ENTRY_COPYRIGHT</span>          <span class="mh">0x000000000000</span> <span class="mh">0x000000000000</span>
<span class="n">IMAGE_DIRECTORY_ENTRY_GLOBALPTR</span>          <span class="mh">0x000000000000</span> <span class="mh">0x000000000000</span>
<span class="n">IMAGE_DIRECTORY_ENTRY_TLS</span>                <span class="mh">0x000000000000</span> <span class="mh">0x000000000000</span>
<span class="n">IMAGE_DIRECTORY_ENTRY_LOAD_CONFIG</span>        <span class="mh">0x000000000000</span> <span class="mh">0x000000000000</span>
<span class="n">IMAGE_DIRECTORY_ENTRY_BOUND_IMPORT</span>       <span class="mh">0x0000497b02b0</span> <span class="mh">0x000000000030</span>
<span class="n">IMAGE_DIRECTORY_ENTRY_IAT</span>                <span class="mh">0x0000497b1000</span> <span class="mh">0x000000000098</span>
<span class="n">IMAGE_DIRECTORY_ENTRY_DELAY_IMPORT</span>       <span class="mh">0x000000000000</span> <span class="mh">0x000000000000</span>
<span class="n">IMAGE_DIRECTORY_ENTRY_COM_DESCRIPTOR</span>     <span class="mh">0x000000000000</span> <span class="mh">0x000000000000</span>
<span class="n">IMAGE_DIRECTORY_ENTRY_RESERVED</span>           <span class="mh">0x000000000000</span> <span class="mh">0x000000000000</span>

<span class="n">Import</span> <span class="n">Directory</span> <span class="p">(</span><span class="n">Original</span><span class="p">)</span><span class="o">:</span>
<span class="n">Name</span>                                               <span class="n">Ord</span>
<span class="o">--------------------------------------------------</span> <span class="o">-----</span>
<span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span><span class="o">!</span><span class="n">NtSetInformationProcess</span>                  <span class="mi">498</span>
<span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span><span class="o">!</span><span class="n">RtlSetHeapInformation</span>                    <span class="mi">1158</span>
<span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span><span class="o">!</span><span class="n">RtlSetUnhandledExceptionFilter</span>           <span class="mi">1179</span>
<span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span><span class="o">!</span><span class="n">NtTerminateProcess</span>                       <span class="mi">535</span>
<span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span><span class="o">!</span><span class="n">RtlVirtualUnwind</span>                         <span class="mi">1264</span>
<span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span><span class="o">!</span><span class="n">RtlLookupFunctionEntry</span>                   <span class="mi">1025</span>
<span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span><span class="o">!</span><span class="n">RtlCaptureContext</span>                        <span class="mi">635</span>
<span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span><span class="o">!</span><span class="n">NtTerminateThread</span>                        <span class="mi">536</span>
<span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span><span class="o">!</span><span class="n">RtlUnhandledExceptionFilter</span>              <span class="mi">1219</span>
<span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span><span class="o">!</span><span class="n">RtlSetProcessIsCritical</span>                  <span class="mi">1166</span>
<span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span><span class="o">!</span><span class="n">isspace</span>                                  <span class="mi">1900</span>
<span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span><span class="o">!</span><span class="n">RtlUnicodeStringToAnsiString</span>             <span class="mi">1222</span>
<span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span><span class="o">!</span><span class="n">RtlAllocateHeap</span>                          <span class="mi">613</span>
<span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span><span class="o">!</span><span class="n">RtlFreeAnsiString</span>                        <span class="mi">840</span>
<span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span><span class="o">!</span><span class="n">RtlNormalizeProcessParams</span>                <span class="mi">1041</span>
<span class="n">CSRSRV</span><span class="p">.</span><span class="n">dll</span><span class="o">!</span><span class="n">CsrServerInitialization</span>                 <span class="mi">22</span>
<span class="n">CSRSRV</span><span class="p">.</span><span class="n">dll</span><span class="o">!</span><span class="n">CsrUnhandledExceptionFilter</span>             <span class="mi">26</span>

<span class="n">Export</span> <span class="n">Directory</span><span class="o">:</span>
    <span class="n">Entry</span>      <span class="n">Stat</span> <span class="n">Ord</span>   <span class="n">Name</span>
<span class="o">--------------</span> <span class="o">----</span> <span class="o">-----</span> <span class="o">--------------------------------------------------</span>
<span class="n">Version</span> <span class="n">Information</span><span class="o">:</span>
<span class="n">key</span>                  <span class="n">value</span>
<span class="o">--------------------</span> <span class="o">-----</span>
<span class="n">CompanyName</span>          <span class="n">Microsoft</span> <span class="n">Corporation</span>
<span class="n">FileDescription</span>      <span class="n">Client</span> <span class="n">Server</span> <span class="n">Runtime</span> <span class="n">Process</span>
<span class="n">FileVersion</span>          <span class="mf">6.1.7600.16385</span> <span class="p">(</span><span class="n">win7_rtm</span><span class="mf">.090713</span><span class="o">-</span><span class="mi">1255</span><span class="p">)</span>
<span class="n">InternalName</span>         <span class="n">CSRSS</span><span class="p">.</span><span class="n">Exe</span>
<span class="n">LegalCopyright</span>       <span class="n">Microsoft</span> <span class="n">Corporation</span><span class="p">.</span> <span class="n">All</span> <span class="n">rights</span> <span class="n">reserved</span><span class="p">.</span>
<span class="n">OriginalFilename</span>     <span class="n">CSRSS</span><span class="p">.</span><span class="n">Exe</span>
<span class="n">ProductName</span>          <span class="n">Microsoft</span> <span class="n">Windows</span> <span class="n">Operating</span> <span class="n">System</span>
<span class="n">ProductVersion</span>       <span class="mf">6.1.7600.16385</span>
</pre></div>
</div>

<h1 id="pslist" class="anchor">pslist</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.taskmods.WinPsList-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>List processes for windows.</h2>
</div>


<h3>Plugin Arguments</h3>
<div class="plugins_args">
<table class='table table-condensed'>
<tbody>
<tr><td><p>eprocess</p></td><td><p>Kernel addresses of eprocess structs. (type: ArrayIntParser)</p></td></tr><tr><td><p>method</p></td><td><p>Method to list processes. (type: ChoiceArray)</p>
<ul>
<li>
<p>Valid Choices:</p>
<ul>
<li>PsActiveProcessHead</li>
<li>CSRSS</li>
<li>PspCidTable</li>
<li>Sessions</li>
<li>Handles</li>
</ul>
</li>
<li>
<p>Default: PsActiveProcessHead, CSRSS, PspCidTable, Sessions, Handles</p>
</li>
</ul></td></tr><tr><td><p>phys_eprocess</p></td><td><p>Physical addresses of eprocess structs. (type: ArrayIntParser)</p></td></tr><tr><td><p>pid</p></td><td><p>One or more pids of processes to select. (type: ArrayIntParser)</p></td></tr><tr><td><p>proc_regex</p></td><td><p>A regex to select a process by name. (type: RegEx)</p></td></tr>
</tbody>
</table>
</div>


<p>The <strong>pslist</strong> plugin list all the processes on windows using a variety of
methods. Since it is required by all plugins which has process selectors, this
plugin will, by default, list processes using all methods.</p>
<p>The output of this plugin is typically cached in the session, so the first time
it is run there might be a slight delay while all methods are used, but
subsequent invokations should be almost instant.</p>
<p>Currently the following process listing methods are used:</p>
<ul>
<li>
<p>PsActiveProcessHead: This method follows the doubly linked list found by the
  symbol <strong>PsActiveProcessHead</strong>. It is the simplest and fastest method for
  listing processes, but it is easily subverted by simply removing an _EPROCESS
  struct from this list.</p>
</li>
<li>
<p>CSRSS: The client-server runtime service is responsible for monitoring all
  running processes. It therefore maintains open handles to running
  processes. This method locates the <code>csrss.exe</code> process and enumerates its
  handle table finding all handles to processes. Note that this will not
  typically find the csrss.exe proces itself, nor system processes which were
  started before it.</p>
</li>
<li>
<p>PspCidTable: The PspCidTable is a handle table for process and thread client
  IDs <a href="http://uninformed.org/index.cgi?v=3&amp;a=7&amp;p=6">Ref</a>. The process&rsquo;s pid is
  the index into this table. This method enumerates the table in order to find
  all processes. (Note a rootkit can easily remove a process from this table).</p>
</li>
<li>
<p>Sessions: This enumerates all the processes in all windows sessions
  (<strong>SessionProcessLinks</strong> member of <strong>_MM_SESSION_SPACE</strong> struct).</p>
</li>
<li>
<p>Handles: The enumerates all handle tables (Which are found on a list from the
  symbol <strong>HandleTableListHead</strong>) and collects their owning process (The
  <strong>QuotaProcess</strong> member).</p>
</li>
</ul>
<h3>Sample output</h3>
<div class="highlight"><pre>  <span class="n">Offset</span> <span class="p">(</span><span class="n">V</span><span class="p">)</span>   <span class="n">Name</span>                    <span class="n">PID</span>   <span class="n">PPID</span>   <span class="n">Thds</span>     <span class="n">Hnds</span>   <span class="n">Sess</span>  <span class="n">Wow64</span> <span class="n">Start</span>                    <span class="n">Exit</span>
<span class="o">--------------</span> <span class="o">--------------------</span> <span class="o">------</span> <span class="o">------</span> <span class="o">------</span> <span class="o">--------</span> <span class="o">------</span> <span class="o">------</span> <span class="o">------------------------</span> <span class="o">------------------------</span>
<span class="nl">DEBUG:</span><span class="n">root</span><span class="o">:</span><span class="n">Listed</span> <span class="mi">48</span> <span class="n">processes</span> <span class="n">using</span> <span class="n">PsActiveProcessHead</span>
<span class="nl">DEBUG:</span><span class="n">root</span><span class="o">:</span><span class="n">Listed</span> <span class="mi">43</span> <span class="n">processes</span> <span class="n">using</span> <span class="n">CSRSS</span>
<span class="nl">DEBUG:</span><span class="n">root</span><span class="o">:</span><span class="n">Listed</span> <span class="mi">47</span> <span class="n">processes</span> <span class="n">using</span> <span class="n">PspCidTable</span>
<span class="nl">DEBUG:</span><span class="n">root</span><span class="o">:</span><span class="n">Listed</span> <span class="mi">45</span> <span class="n">processes</span> <span class="n">using</span> <span class="n">Sessions</span>
<span class="nl">DEBUG:</span><span class="n">root</span><span class="o">:</span><span class="n">Listed</span> <span class="mi">45</span> <span class="n">processes</span> <span class="n">using</span> <span class="n">Handles</span>
<span class="mh">0xe00000074580</span> <span class="n">System</span>                    <span class="mi">4</span>      <span class="mi">0</span>     <span class="mi">97</span> <span class="o">--------</span> <span class="o">------</span>  <span class="n">False</span> <span class="mi">2014</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">24</span> <span class="mi">22</span><span class="o">:</span><span class="mo">07</span><span class="o">:</span><span class="mi">24</span><span class="o">+</span><span class="mo">0000</span> <span class="o">-</span>
<span class="mh">0xe00001499040</span> <span class="n">smss</span><span class="p">.</span><span class="n">exe</span>                <span class="mi">292</span>      <span class="mi">4</span>      <span class="mi">2</span> <span class="o">--------</span> <span class="o">------</span>  <span class="n">False</span> <span class="mi">2014</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">24</span> <span class="mi">22</span><span class="o">:</span><span class="mo">07</span><span class="o">:</span><span class="mi">24</span><span class="o">+</span><span class="mo">0000</span> <span class="o">-</span>
<span class="mh">0xe0000212c900</span> <span class="n">svchost</span><span class="p">.</span><span class="n">exe</span>             <span class="mi">372</span>    <span class="mi">528</span>     <span class="mi">15</span> <span class="o">--------</span>      <span class="mi">0</span>  <span class="n">False</span> <span class="mi">2014</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">24</span> <span class="mi">21</span><span class="o">:</span><span class="mo">07</span><span class="o">:</span><span class="mi">51</span><span class="o">+</span><span class="mo">0000</span> <span class="o">-</span>
<span class="mh">0xe00001be1280</span> <span class="n">csrss</span><span class="p">.</span><span class="n">exe</span>               <span class="mi">380</span>    <span class="mi">372</span>      <span class="mi">8</span> <span class="o">--------</span>      <span class="mi">0</span>  <span class="n">False</span> <span class="mi">2014</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">24</span> <span class="mi">22</span><span class="o">:</span><span class="mo">07</span><span class="o">:</span><span class="mi">32</span><span class="o">+</span><span class="mo">0000</span> <span class="o">-</span>
<span class="mh">0xe000000ce080</span> <span class="n">wininit</span><span class="p">.</span><span class="n">exe</span>             <span class="mi">432</span>    <span class="mi">372</span>      <span class="mi">1</span> <span class="o">--------</span>      <span class="mi">0</span>  <span class="n">False</span> <span class="mi">2014</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">24</span> <span class="mi">22</span><span class="o">:</span><span class="mo">07</span><span class="o">:</span><span class="mi">32</span><span class="o">+</span><span class="mo">0000</span> <span class="o">-</span>
<span class="mh">0xe000000d9280</span> <span class="n">csrss</span><span class="p">.</span><span class="n">exe</span>               <span class="mi">440</span>    <span class="mi">424</span>      <span class="mi">9</span> <span class="o">--------</span>      <span class="mi">1</span>  <span class="n">False</span> <span class="mi">2014</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">24</span> <span class="mi">22</span><span class="o">:</span><span class="mo">07</span><span class="o">:</span><span class="mi">32</span><span class="o">+</span><span class="mo">0000</span> <span class="o">-</span>
</pre></div>
</div>

<h1 id="psscan" class="anchor">psscan</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.filescan.PSScan-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Scan Physical memory for _EPROCESS pool allocations.</h2>
<p>Status flags:
  E: A known _EPROCESS address from pslist.
  P: A known pid from pslist.</p>
</div>


<h3>Plugin Arguments</h3>
<div class="plugins_args">
<table class='table table-condensed'>
<tbody>
<tr><td><p>scan_in_kernel</p></td><td><p>Scan in the kernel address space (type: Boolean)</p>
<ul>
<li>Default: False</li>
</ul></td></tr>
</tbody>
</table>
</div>


<p>Pool scanning is a technique for discovering kernel data structures based on
signatures. It is essentially the memory forensic equivalent of carving. The
<strong>psscan</strong> plugin carves for <strong>_EPROCESS</strong> structures in memory.</p>
<p>By default the plugin scans in the physical address space. Any hits are resolved
into the virtual address space by following the lists. If <strong>scan_in_kernel</strong> is
specified, the scanning occurs in kernel space.</p>
<h3>Notes</h3>
<ol>
<li>
<p>Like other pool scanning plugins, this plugin may produce false positives
   since it essentially carves <strong>_EPROCESS</strong> structures out of memory. On the
   other hand, this plugin may reveal files which have been closed or freed.</p>
</li>
<li>
<p>The plugin displays the physical address of the <strong>_EPROCESS</strong> found. It
   may be possible to derive their virtual address using the <a href="PtoV.html">ptov</a>
   plugin. Alternatively, specify the <em>scan_in_kernel</em> option, to ensure
   scanning occurs in the kernel address space.</p>
</li>
</ol>
</div>

<h1 id="pstree" class="anchor">pstree</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.pstree.PSTree-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Print process list as a tree</h2>
</div>


<h3>Plugin Arguments</h3>
<div class="plugins_args">
<table class='table table-condensed'>
<tbody>
<tr><td><p>eprocess</p></td><td><p>Kernel addresses of eprocess structs. (type: ArrayIntParser)</p></td></tr><tr><td><p>method</p></td><td><p>Method to list processes. (type: ChoiceArray)</p>
<ul>
<li>
<p>Valid Choices:</p>
<ul>
<li>PsActiveProcessHead</li>
<li>CSRSS</li>
<li>PspCidTable</li>
<li>Sessions</li>
<li>Handles</li>
</ul>
</li>
<li>
<p>Default: PsActiveProcessHead, CSRSS, PspCidTable, Sessions, Handles</p>
</li>
</ul></td></tr><tr><td><p>phys_eprocess</p></td><td><p>Physical addresses of eprocess structs. (type: ArrayIntParser)</p></td></tr><tr><td><p>pid</p></td><td><p>One or more pids of processes to select. (type: ArrayIntParser)</p></td></tr><tr><td><p>proc_regex</p></td><td><p>A regex to select a process by name. (type: RegEx)</p></td></tr><tr><td><p>verbosity</p></td><td><p>An integer reflecting the amount of desired output: 0 = quiet, 10 = noisy. (type: IntParser)</p>
<ul>
<li>Default: 1</li>
</ul></td></tr>
</tbody>
</table>
</div>


<p>This plugin displays all known processes in a tree form (i.e. the process
parents with their children). This is useful to see which process launched
another process.</p>
<h3>Notes</h3>
<ol>
<li>
<p>Sometimes malware will launch a processes called &ldquo;lsass.exe&rdquo; or
   &ldquo;csrss.exe&rdquo;. This plugin helps to highlight discrepencies since these
   processes are normally only launched from known processes.</p>
</li>
<li>
<p>Using the <strong>verbose=1</strong> flag will also print the command lines of each
   process as determined by three methods:</p>
</li>
</ol>
<ul>
<li>cmd: **task.Peb.ProcessParameters.CommandLine</li>
<li>path: **task.Peb.ProcessParameters.ImagePathName</li>
<li>audit: <strong>task.SeAuditProcessCreationInfo.ImageFileName.Name</strong></li>
</ul>
<h3>Sample output</h3>
<div class="highlight"><pre><span class="n">win7</span><span class="p">.</span><span class="n">elf</span> <span class="mi">14</span><span class="o">:</span><span class="mi">55</span><span class="o">:</span><span class="mi">19</span><span class="o">&gt;</span> <span class="n">pstree</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span>
<span class="n">Name</span>                                        <span class="n">Pid</span>   <span class="n">PPid</span>   <span class="n">Thds</span>   <span class="n">Hnds</span> <span class="n">Time</span>
<span class="o">----------------------------------------</span> <span class="o">------</span> <span class="o">------</span> <span class="o">------</span> <span class="o">------</span> <span class="o">------------------------</span>
 <span class="mh">0xFA8002259060</span><span class="o">:</span><span class="n">csrss</span><span class="p">.</span><span class="n">exe</span>                   <span class="mi">348</span>    <span class="mi">340</span>      <span class="mi">9</span>    <span class="mi">436</span> <span class="mi">2012</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mo">01</span> <span class="mi">21</span><span class="o">:</span><span class="mi">39</span><span class="o">:</span><span class="mi">57</span><span class="o">+</span><span class="mo">0000</span>
    <span class="nl">cmd:</span> <span class="o">%</span><span class="n">SystemRoot</span><span class="o">%</span><span class="err">\</span><span class="n">system32</span><span class="err">\</span><span class="n">csrss</span><span class="p">.</span><span class="n">exe</span> <span class="n">ObjectDirectory</span><span class="o">=</span><span class="err">\</span><span class="n">Windows</span> <span class="n">SharedSection</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span><span class="mi">20480</span><span class="p">,</span><span class="mi">768</span> <span class="n">Windows</span><span class="o">=</span><span class="n">On</span> <span class="n">SubSystemType</span><span class="o">=</span><span class="n">Windows</span> <span class="n">ServerDll</span><span class="o">=</span><span class="n">basesrv</span><span class="p">,</span><span class="mi">1</span> <span class="n">ServerDll</span><span class="o">=</span><span class="n">winsrv</span><span class="o">:</span><span class="n">UserServerDllInitialization</span><span class="p">,</span><span class="mi">3</span> <span class="n">ServerDll</span><span class="o">=</span><span class="n">winsrv</span><span class="o">:</span><span class="n">ConServerDllInitialization</span><span class="p">,</span><span class="mi">2</span> <span class="n">ServerDll</span><span class="o">=</span><span class="n">sxssrv</span><span class="p">,</span><span class="mi">4</span> <span class="n">ProfileControl</span><span class="o">=</span><span class="n">Off</span> <span class="n">MaxRequestThreads</span><span class="o">=</span><span class="mi">16</span>
    <span class="nl">path:</span> <span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">system32</span><span class="err">\</span><span class="n">csrss</span><span class="p">.</span><span class="n">exe</span>
    <span class="nl">audit:</span> <span class="err">\</span><span class="n">Device</span><span class="err">\</span><span class="n">HarddiskVolume2</span><span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">csrss</span><span class="p">.</span><span class="n">exe</span>
 <span class="mh">0xFA8000901060</span><span class="o">:</span><span class="n">wininit</span><span class="p">.</span><span class="n">exe</span>                 <span class="mi">384</span>    <span class="mi">340</span>      <span class="mi">3</span>     <span class="mi">75</span> <span class="mi">2012</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mo">01</span> <span class="mi">21</span><span class="o">:</span><span class="mi">39</span><span class="o">:</span><span class="mi">57</span><span class="o">+</span><span class="mo">0000</span>
    <span class="nl">cmd:</span> <span class="n">wininit</span><span class="p">.</span><span class="n">exe</span>
    <span class="nl">path:</span> <span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">system32</span><span class="err">\</span><span class="n">wininit</span><span class="p">.</span><span class="n">exe</span>
    <span class="nl">audit:</span> <span class="err">\</span><span class="n">Device</span><span class="err">\</span><span class="n">HarddiskVolume2</span><span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">wininit</span><span class="p">.</span><span class="n">exe</span>
<span class="p">.</span> <span class="mh">0xFA800206D5F0</span><span class="o">:</span><span class="n">services</span><span class="p">.</span><span class="n">exe</span>               <span class="mi">480</span>    <span class="mi">384</span>     <span class="mi">11</span>    <span class="mi">208</span> <span class="mi">2012</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mo">01</span> <span class="mi">21</span><span class="o">:</span><span class="mi">39</span><span class="o">:</span><span class="mi">58</span><span class="o">+</span><span class="mo">0000</span>
     <span class="nl">cmd:</span> <span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">system32</span><span class="err">\</span><span class="n">services</span><span class="p">.</span><span class="n">exe</span>
     <span class="nl">path:</span> <span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">system32</span><span class="err">\</span><span class="n">services</span><span class="p">.</span><span class="n">exe</span>
     <span class="nl">audit:</span> <span class="err">\</span><span class="n">Device</span><span class="err">\</span><span class="n">HarddiskVolume2</span><span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">services</span><span class="p">.</span><span class="n">exe</span>
<span class="p">..</span> <span class="mh">0xFA80024F85D0</span><span class="o">:</span><span class="n">svchost</span><span class="p">.</span><span class="n">exe</span>               <span class="mi">236</span>    <span class="mi">480</span>     <span class="mi">19</span>    <span class="mi">455</span> <span class="mi">2012</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mo">01</span> <span class="mi">14</span><span class="o">:</span><span class="mi">40</span><span class="o">:</span><span class="mo">01</span><span class="o">+</span><span class="mo">0000</span>
      <span class="nl">cmd:</span> <span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">system32</span><span class="err">\</span><span class="n">svchost</span><span class="p">.</span><span class="n">exe</span> <span class="o">-</span><span class="n">k</span> <span class="n">LocalService</span>
      <span class="nl">path:</span> <span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">system32</span><span class="err">\</span><span class="n">svchost</span><span class="p">.</span><span class="n">exe</span>
      <span class="nl">audit:</span> <span class="err">\</span><span class="n">Device</span><span class="err">\</span><span class="n">HarddiskVolume2</span><span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">svchost</span><span class="p">.</span><span class="n">exe</span>
</pre></div>
</div>

<h1 id="psxview" class="anchor">psxview</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.malware.psxview.WindowsPsxView-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Find hidden processes with various process listings</h2>
</div>


<h3>Plugin Arguments</h3>
<div class="plugins_args">
<table class='table table-condensed'>
<tbody>
<tr><td><p>eprocess</p></td><td><p>Kernel addresses of eprocess structs. (type: ArrayIntParser)</p></td></tr><tr><td><p>method</p></td><td><p>Method to list processes. (type: ChoiceArray)</p>
<ul>
<li>
<p>Valid Choices:</p>
<ul>
<li>PsActiveProcessHead</li>
<li>CSRSS</li>
<li>PspCidTable</li>
<li>Sessions</li>
<li>Handles</li>
<li>PSScan</li>
<li>Thrdproc</li>
</ul>
</li>
<li>
<p>Default: PsActiveProcessHead, CSRSS, PspCidTable, Sessions, Handles, PSScan, Thrdproc</p>
</li>
</ul></td></tr><tr><td><p>phys_eprocess</p></td><td><p>Physical addresses of eprocess structs. (type: ArrayIntParser)</p></td></tr><tr><td><p>pid</p></td><td><p>One or more pids of processes to select. (type: ArrayIntParser)</p></td></tr><tr><td><p>proc_regex</p></td><td><p>A regex to select a process by name. (type: RegEx)</p></td></tr>
</tbody>
</table>
</div>



</div>

<h1 id="ptov" class="anchor">ptov</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.pfn.PtoV-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Converts a physical address to a virtual address.</h2>
</div>


<h3>Plugin Arguments</h3>
<div class="plugins_args">
<table class='table table-condensed'>
<tbody>
<tr><td><p>eprocess</p></td><td><p>Kernel addresses of eprocess structs. (type: ArrayIntParser)</p></td></tr><tr><td><p>method</p></td><td><p>Method to list processes. (type: ChoiceArray)</p>
<ul>
<li>
<p>Valid Choices:</p>
<ul>
<li>PsActiveProcessHead</li>
<li>CSRSS</li>
<li>PspCidTable</li>
<li>Sessions</li>
<li>Handles</li>
</ul>
</li>
<li>
<p>Default: PsActiveProcessHead, CSRSS, PspCidTable, Sessions, Handles</p>
</li>
</ul></td></tr><tr><td><p>phys_eprocess</p></td><td><p>Physical addresses of eprocess structs. (type: ArrayIntParser)</p></td></tr><tr><td><p>physical_address</p></td><td><p>The Virtual Address to examine. (type: IntParser)</p></td></tr><tr><td><p>pid</p></td><td><p>One or more pids of processes to select. (type: ArrayIntParser)</p></td></tr><tr><td><p>proc_regex</p></td><td><p>A regex to select a process by name. (type: RegEx)</p></td></tr>
</tbody>
</table>
</div>


<p>This plugin uses the <strong>PFN Database</strong> to convert a physical page to its virtual
address. It is similar to the <strong>pas2vas</strong> plugin in this regard, but does not
need to enumerate all address spaces prior to running (so it is a bit faster).</p>
<h3>Notes</h3>
<ol>
<li>
<p>The plugin currently only works for kernel addresses and for 4k pages. So for
   example this will not work reliably for pool memory (since Pool is allocated
   in 2mb pages).</p>
</li>
<li>
<p>If this plugin does not work for a certain address, try to use the
   <strong>pas2vas</strong> plugin.</p>
</li>
</ol>
<h3>Sample output</h3>
<div class="highlight"><pre><span class="n">win7</span><span class="p">.</span><span class="n">elf</span> <span class="mi">15</span><span class="o">:</span><span class="mi">22</span><span class="o">:</span><span class="mi">57</span><span class="o">&gt;</span> <span class="n">vtop</span> <span class="mh">0xfa8002635810</span>
<span class="o">-----------------&gt;</span> <span class="n">vtop</span><span class="p">(</span><span class="mh">0xfa8002635810</span><span class="p">)</span>
<span class="n">Virtual</span> <span class="mh">0xfa8002635810</span> <span class="n">Page</span> <span class="n">Directory</span> <span class="mh">0x271ec000</span>
<span class="n">pml4e</span><span class="err">@</span> <span class="mh">0x271ecfa8</span> <span class="o">=</span> <span class="mh">0x4000863</span>
<span class="n">pdpte</span><span class="err">@</span> <span class="mh">0x4000000</span> <span class="o">=</span> <span class="mh">0x4001863</span>
<span class="n">pde</span><span class="err">@</span> <span class="mh">0x4001098</span> <span class="o">=</span> <span class="mh">0x2ac009e3</span>
<span class="n">Large</span> <span class="n">page</span> <span class="n">mapped</span> <span class="mh">0x2ae35810</span>
<span class="n">Physical</span> <span class="n">Address</span> <span class="mh">0x2ac35810</span>
<span class="n">win7</span><span class="p">.</span><span class="n">elf</span> <span class="mi">15</span><span class="o">:</span><span class="mi">23</span><span class="o">:</span><span class="mo">05</span><span class="o">&gt;</span> <span class="n">ptov</span> <span class="mh">0x2ac35810</span>
<span class="o">-----------------&gt;</span> <span class="n">ptov</span><span class="p">(</span><span class="mh">0x2ac35810</span><span class="p">)</span>
<span class="n">Physical</span> <span class="n">Address</span> <span class="mh">0x2ac35810</span> <span class="o">=&gt;</span> <span class="n">Virtual</span> <span class="n">Address</span> <span class="mh">0xf6fd40035810</span>
<span class="n">DTB</span> <span class="err">@</span> <span class="mh">0x187000</span>
<span class="n">PML4E</span> <span class="err">@</span> <span class="mh">0x187f68</span>
<span class="n">PDPTE</span> <span class="err">@</span> <span class="mh">0x187fa8</span>
<span class="n">PDE</span> <span class="err">@</span> <span class="mh">0x4000000</span>
<span class="n">PTE</span> <span class="err">@</span> <span class="mh">0x40011a8</span>
</pre></div>
</div>

<h1 id="raw2dmp" class="anchor">raw2dmp</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.crashinfo.Raw2Dump-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Convert the physical address space to a crash dump.</h2>
<p>The Windows debugger (Windbg) works only with memory dumps stored
in the proprietary &lsquo;crashdump&rsquo; file format. This file format
contains the following features:</p>
<p>1) Physical memory ranges are stored in a sparse way - there is a
   &lsquo;Runs&rsquo; table which specifies the mapping between the physical
   offset and the file offset of each page. This allows the format
   to omit unmapped regions (unlike raw format which must pad them
   with zero to maintain alignment).</p>
<p>2) The crash dump header contains metadata about the
   image. Specifically, the header contain a copy of the Kernel
   Debugger Data Block (AKA the KDBG). This data is used to
   bootstrap the windows debugger by providing critical initial
   hints to the debugger.</p>
<p>Since the KDBG block is created at system boot and never used
(until the crash dump is written) it is trivial for malware to
overwrite it - making it really hard for responders since windbg
will not be able to read the file. In later versions of windows,
the kdbg is also obfuscated (See the function &ldquo;nt!KdCopyDataBlock&rdquo;
which decrypts it.).</p>
<p>Rekall itself does not use the KDBG block any more, although older
memory forensic tools still do use it. Rekall instead relies on
accurate debugging symbols to locate critical kernel data
structures, reducing the level of trust we place on the image
itself (so Rekall is more resilient to manipulation).</p>
<p>In order to ensure that the windows debugger is able to read the
produced crash dump, we recreate the kernel debugger block from
the symbol information we already have.</p>
<p>NOTE: The crashdump file format can be deduced by:</p>
<p>dis &lsquo;nt!IoFillDumpHeader&rsquo;</p>
<p>This is the reference for this plugin.</p>
</div>


<h3>Plugin Arguments</h3>
<div class="plugins_args">
<table class='table table-condensed'>
<tbody>
<tr><td><p>destination</p></td><td><p>The destination path to write the crash dump.</p></td></tr><tr><td><p>rebuild</p></td><td><p>Rebuild the KDBG data block. (type: Boolean)</p>
<ul>
<li>Default: False</li>
</ul></td></tr>
</tbody>
</table>
</div>


<p>The Windows debugger (Windbg) works only with memory dumps stored
in the proprietary &lsquo;crashdump&rsquo; file format. This file format
contains the following features:</p>
<ol>
<li>
<p>Physical memory ranges are stored in a sparse way - there is a
   <code>Runs</code> table which specifies the mapping between the physical
   offset and the file offset of each page. This allows the format
   to omit unmapped regions (unlike raw format which must pad them
   with zero to maintain alignment).</p>
</li>
<li>
<p>The crash dump header contains metadata about the
   image. Specifically, the header contain a copy of the Kernel
   Debugger Data Block (AKA the <strong>KDBG</strong>). This data is used to
   bootstrap the windows debugger by providing critical initial
   hints to the debugger.</p>
</li>
</ol>
<p>Since the <strong>KDBG</strong> block is created at system boot and never used (until the
crash dump is written) it is trivial for malware to overwrite it - making it
really hard for responders since windbg will not be able to read the file. In
later versions of windows, the kdbg is also obfuscated (See the function
<code>nt!KdCopyDataBlock</code> which decrypts it.).</p>
<p>Rekall itself does not use the <strong>KDBG</strong> block any more, although older memory
forensic tools still do use it. Rekall instead relies on accurate debugging
symbols to locate critical kernel data structures, reducing the level of trust
we place on the image itself (so Rekall is more resilient to manipulation).</p>
<p>In order to ensure that the windows debugger is able to read the produced crash
dump, we recreate the kernel debugger block from the symbol information we
already have.</p>
<h3>Notes:</h3>
<ol>
<li>
<p>The crashdump file format can be deduced by:
   <code>dis 'nt!IoFillDumpHeader'</code>
   This is the reference for this plugin.</p>
</li>
<li>
<p>This plugin is really only useful in order to produce an image compatible
   with the windows debugger for the purpose of further investigation by the
   debugger. If you find that the windows debugger has a useful feature that
   Rekall does not have, please let up know so we can implement it in Rekall. We
   intend to replace the use of the windows debugger in digital forensics.</p>
</li>
</ol>
</div>

<h1 id="services" class="anchor">services</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.registry.printkey.Services-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Enumerate all services.</h2>
</div>


<h3>Plugin Arguments</h3>
<div class="plugins_args">
<table class='table table-condensed'>
<tbody>
<tr><td><p>hive-offsets</p></td><td><p>A list of hive offsets as found by hivelist. If not provided we call hivelist ourselves and list the keys on all hives. (type: ArrayIntParser)</p></td></tr><tr><td><p>hive_regex</p></td><td><p>A regex to filter hive names.If not provided we use all hives.</p></td></tr>
</tbody>
</table>
</div>



</div>

<h1 id="sockets" class="anchor">sockets</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.connections.Sockets-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Print list of open sockets. [Windows xp only]</h2>
<hr />
<p>This module enumerates the active sockets from tcpip.sys</p>
<p>Note that if you are using a hibernated image this might not work
because Windows closes all sockets before hibernating.</p>
<p>_ADDRESS_OBJECT are arranged in a hash table found by the _AddrObjTable
symbol. The hash table has a size found by the _AddrObjTableSize symbol.</p>
</div>


<h3>Plugin Arguments</h3>
<div class="plugins_args">
<table class='table table-condensed'>
<tbody>
<tr><td><p>tcpip_guid</p></td><td><p>Force this profile to be used for tcpip.</p></td></tr>
</tbody>
</table>
</div>


<p>This module enumerates the active sockets from tcpip.sys</p>
<p>Note that if you are using a hibernated image this might not work
  because Windows closes all sockets before hibernating.</p>
<p>_ADDRESS_OBJECT are arranged in a hash table found by the _AddrObjTable
  symbol. The hash table has a size found by the _AddrObjTableSize symbol.</p>
<p>epydoc: rekall.plugins.windows.connections.Sockets-class.html
args:
  tcpip_guid: &lsquo;Force this profile to be used for tcpip.&rsquo;</p>
<hr />
</div>

<h1 id="ssdt" class="anchor">ssdt</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.ssdt.WinSSDT-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Enumerate the SSDT.</h2>
</div>



<p>The System Service Descritor Table is the main interface to the kernel from user
space. In the past, malware used to install hook in this SSDT in order to
intercept userspace-&gt;kernel calls. In more recent versions of Windows, Microsoft
has implemented <strong>PatchGuard</strong> specifically to prevent these kinds of
hooks. Therefore, its very rare to see these kinds of hooks any more.</p>
<p>The <strong>ssdt</strong> plugin enumerates the the SSDT table and resolves the addresses
back to the names of the functions. Windows has two SSDTs - one for the kernel
and one for the GUI subsystem (win32k driver).</p>
<p>An intalled ssdt hook will appear as a function in a different module (or an
unknown module).</p>
<h3>Sample output</h3>
<div class="highlight"><pre><span class="n">win7</span><span class="p">.</span><span class="n">elf</span> <span class="mi">15</span><span class="o">:</span><span class="mi">35</span><span class="o">:</span><span class="mi">25</span><span class="o">&gt;</span> <span class="n">ssdt</span>
<span class="o">************</span> <span class="n">Table</span> <span class="mi">0</span> <span class="err">@</span> <span class="mh">0xf80002691b00</span> <span class="o">************</span>
    <span class="n">Entry</span>          <span class="n">Target</span>     <span class="n">Symbol</span>
<span class="o">--------------</span> <span class="o">--------------</span> <span class="o">------</span>
           <span class="mh">0x0</span> <span class="mh">0xf80002aa2190</span> <span class="n">nt</span><span class="o">!</span><span class="n">NtMapUserPhysicalPagesScatter</span>
           <span class="mh">0x1</span> <span class="mh">0xf80002988a00</span> <span class="n">nt</span><span class="o">!</span><span class="n">NtWaitForSingleObject</span>
           <span class="mh">0x2</span> <span class="mh">0xf80002688dd0</span> <span class="n">nt</span><span class="o">!</span><span class="n">NtCallbackReturn</span>
           <span class="mh">0x3</span> <span class="mh">0xf800029abb10</span> <span class="n">nt</span><span class="o">!</span><span class="n">NtReadFile</span>
           <span class="mh">0x4</span> <span class="mh">0xf800029a9bb0</span> <span class="n">nt</span><span class="o">!</span><span class="n">NtDeviceIoControlFile</span>
           <span class="mh">0x5</span> <span class="mh">0xf800029a4ee0</span> <span class="n">nt</span><span class="o">!</span><span class="n">NtWriteFile</span>
           <span class="mh">0x6</span> <span class="mh">0xf8000294adc0</span> <span class="n">nt</span><span class="o">!</span><span class="n">NtRemoveIoCompletion</span>
           <span class="mh">0x7</span> <span class="mh">0xf80002947f10</span> <span class="n">nt</span><span class="o">!</span><span class="n">NtReleaseSemaphore</span>
           <span class="mh">0x8</span> <span class="mh">0xf8000299fda0</span> <span class="n">nt</span><span class="o">!</span><span class="n">NtReplyWaitReceivePort</span>
           <span class="mh">0x9</span> <span class="mh">0xf80002a71e20</span> <span class="n">nt</span><span class="o">!</span><span class="n">NtReplyPort</span>
<span class="p">...</span>
         <span class="mh">0x18c</span> <span class="mh">0xf8000297a92c</span> <span class="n">nt</span><span class="o">!</span><span class="n">NtWaitForKeyedEvent</span>
         <span class="mh">0x18d</span> <span class="mh">0xf800026a1010</span> <span class="n">nt</span><span class="o">!</span><span class="n">NtWaitForWorkViaWorkerFactory</span>
         <span class="mh">0x18e</span> <span class="mh">0xf80002ab0b00</span> <span class="n">nt</span><span class="o">!</span><span class="n">NtWaitHighEventPair</span>
         <span class="mh">0x18f</span> <span class="mh">0xf80002ab0b90</span> <span class="n">nt</span><span class="o">!</span><span class="n">NtWaitLowEventPair</span>
         <span class="mh">0x190</span> <span class="mh">0xf80002678fc4</span> <span class="n">nt</span><span class="o">!</span><span class="n">NtWorkerFactoryWorkerReady</span>
<span class="o">************</span> <span class="n">Table</span> <span class="mi">1</span> <span class="err">@</span> <span class="mh">0xf960001a1c00</span> <span class="o">************</span>
    <span class="n">Entry</span>          <span class="n">Target</span>     <span class="n">Symbol</span>
<span class="o">--------------</span> <span class="o">--------------</span> <span class="o">------</span>
           <span class="mh">0x0</span> <span class="mh">0xf96000195580</span> <span class="n">win32k</span><span class="o">!</span><span class="n">NtUserGetThreadState</span>
           <span class="mh">0x1</span> <span class="mh">0xf96000192630</span> <span class="n">win32k</span><span class="o">!</span><span class="n">NtUserPeekMessage</span>
           <span class="mh">0x2</span> <span class="mh">0xf960001a3c6c</span> <span class="n">win32k</span><span class="o">!</span><span class="n">NtUserCallOneParam</span>
           <span class="mh">0x3</span> <span class="mh">0xf960001b1dd0</span> <span class="n">win32k</span><span class="o">!</span><span class="n">NtUserGetKeyState</span>
           <span class="mh">0x4</span> <span class="mh">0xf960001ab1ac</span> <span class="n">win32k</span><span class="o">!</span><span class="n">NtUserInvalidateRect</span>
           <span class="mh">0x5</span> <span class="mh">0xf960001a3e70</span> <span class="n">win32k</span><span class="o">!</span><span class="n">NtUserCallNoParam</span>
           <span class="mh">0x6</span> <span class="mh">0xf9600019b5a0</span> <span class="n">win32k</span><span class="o">!</span><span class="n">NtUserGetMessage</span>
           <span class="mh">0x7</span> <span class="mh">0xf9600017fbec</span> <span class="n">win32k</span><span class="o">!</span><span class="n">NtUserMessageCall</span>
<span class="p">...</span>
         <span class="mh">0x334</span> <span class="mh">0xf96000153b80</span> <span class="n">win32k</span><span class="o">!</span><span class="n">NtUserValidateHandleSecure</span>
         <span class="mh">0x335</span> <span class="mh">0xf960001acd9c</span> <span class="n">win32k</span><span class="o">!</span><span class="n">NtUserWaitForInputIdle</span>
         <span class="mh">0x336</span> <span class="mh">0xf960001a6304</span> <span class="n">win32k</span><span class="o">!</span><span class="n">NtUserWaitForMsgAndEvent</span>
         <span class="mh">0x337</span> <span class="mh">0xf960001acef0</span> <span class="n">win32k</span><span class="o">!</span><span class="n">NtUserWindowFromPhysicalPoint</span>
         <span class="mh">0x338</span> <span class="mh">0xf960001ae06c</span> <span class="n">win32k</span><span class="o">!</span><span class="n">NtUserYieldTask</span>
         <span class="mh">0x339</span> <span class="mh">0xf960001a6b84</span> <span class="n">win32k</span><span class="o">!</span><span class="n">NtUserSetClassLongPtr</span>
         <span class="mh">0x33a</span> <span class="mh">0xf96000181ca0</span> <span class="n">win32k</span><span class="o">!</span><span class="n">NtUserSetWindowLongPtr</span>
</pre></div>
</div>

<h1 id="svcscan" class="anchor">svcscan</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.malware.svcscan.SvcScan-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Scan for Windows services</h2>
</div>



<p>Windows uses services for long running processes. Serivces are managed by the
&ldquo;services.exe&rdquo; process. The <strong>svcscan</strong> plugin scans the heap memory of the
&ldquo;services.exe&rdquo; process for <strong>_SERVICE_RECORD</strong> records). These records describe
the services which are loaded by the system, and even once the services are
unloaded, we might find <strong>_SERVICE_RECORD</strong> records.</p>
<h3>Notes</h3>
<ol>
<li>
<p>Since loading kernel code is usually done by inserting a kernel driver, and
   kernel drivers are loaded through a service, this plugin will also show
   forensically significant kernel drivers loading.</p>
</li>
<li>
<p>This plugin relies on memory scanning and so it is not all that
   reliable. Often it will not reveal services which we know are
   running. However, it might also reveal services which have been deleted.</p>
</li>
<li>
<p>A better plugin is the <strong>services</strong> plugin which enumerates all services from
   the registry.</p>
</li>
</ol>
<h3>Sample output</h3>
<p>The below example shows a kernel driver being loaded as a service.</p>
<div class="highlight"><pre><span class="n">Offset</span><span class="o">:</span> <span class="mh">0x26f7d6a10</span>
<span class="n">Order</span><span class="o">:</span> <span class="mi">402</span>
<span class="n">Process</span> <span class="n">ID</span><span class="o">:</span> <span class="o">-</span>
<span class="n">Service</span> <span class="n">Name</span><span class="o">:</span> <span class="n">WFPLWFS</span>
<span class="n">Display</span> <span class="n">Name</span><span class="o">:</span> <span class="n">Microsoft</span> <span class="n">Windows</span> <span class="n">Filtering</span> <span class="n">Platform</span>
<span class="n">Service</span> <span class="n">Type</span><span class="o">:</span> <span class="n">SERVICE_KERNEL_DRIVER</span>
<span class="n">Service</span> <span class="n">State</span><span class="o">:</span> <span class="n">SERVICE_RUNNING</span>
<span class="n">Binary</span> <span class="n">Path</span><span class="o">:</span> <span class="o">\</span><span class="n">Driver</span><span class="o">\</span><span class="n">WFPLWFS</span>
</pre></div>
</div>

<h1 id="symlinkscan" class="anchor">symlinkscan</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.filescan.SymLinkScan-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Scan for symbolic link objects</h2>
</div>


<h3>Plugin Arguments</h3>
<div class="plugins_args">
<table class='table table-condensed'>
<tbody>
<tr><td><p>scan_in_kernel</p></td><td><p>Scan in the kernel address space (type: Boolean)</p>
<ul>
<li>Default: False</li>
</ul></td></tr>
</tbody>
</table>
</div>


<p>A symbolic link is a kernel object which maps a device from one name in the
kernel object tree to another name. Often a driver will set up a symbolic link
to a &ldquo;dos device name&rdquo; to allow access to a kernel device from userspace.</p>
<p>For example, the pmem driver makes a symbolic link from <strong>\GLOBAL??\pmem</strong> to
<strong>\Devices\pmem</strong> so that a user space program can use the <strong>CreateFile</strong> API to
open a handle to <strong>\.\pmem</strong>.</p>
<p>This plugin scans for <strong>_OBJECT_SYMBOLIC_LINK</strong> objects using pool scanning techniques.</p>
<h3>Notes</h3>
<ol>
<li>
<p>Like other pool scanning plugins, this plugin may produce false positives
   since it essentially carves <strong>_OBJECT_SYMBOLIC_LINK</strong> structures out of
   memory. On the other hand, this plugin may reveal symlinks which have been
   closed or freed.</p>
</li>
<li>
<p>The interesting thing about a symlink is that it contains the timestamp of
   when it was created. This can be significant when determining when the system
   was compromised.</p>
</li>
<li>
<p>Since the <em>symlinkscan</em> plugin carves out <strong>_OBJECT_SYMBOLIC_LINK</strong> objects
   it has no context of where in the object tree the symlink exists. Hence it is
   unable to show parent object directories. A better plugin to use is the
   <a href="ObjectTree.html">object_tree</a> plugin.</p>
</li>
</ol>
<h3>Sample output</h3>
<p>Here we see the <strong>symlinkscan</strong> plugin detecting the pmem link.</p>
<div class="highlight"><pre>    <span class="n">Offset</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>      <span class="err">#</span><span class="n">Ptr</span>   <span class="err">#</span><span class="n">Hnd</span> <span class="n">Creation</span> <span class="n">time</span>            <span class="n">From</span> <span class="n">To</span>
<span class="o">-</span> <span class="o">--------------</span> <span class="o">------</span> <span class="o">------</span> <span class="o">------------------------</span> <span class="o">----</span> <span class="o">------------------------------------------------------------</span>
  <span class="mh">0x00000010d470</span>      <span class="mi">3</span>      <span class="mi">2</span> <span class="mi">2014</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">24</span> <span class="mi">22</span><span class="o">:</span><span class="mo">07</span><span class="o">:</span><span class="mi">29</span><span class="o">+</span><span class="mo">0000</span> <span class="n">HDAUDIO</span><span class="err">#</span><span class="n">FUNC_01</span><span class="o">&amp;</span><span class="n">VEN_8384</span><span class="o">&amp;</span><span class="n">DEV_7680</span><span class="o">&amp;</span><span class="n">SUBSYS_83847680</span><span class="o">&amp;</span><span class="n">REV_1034</span><span class="err">#</span><span class="mi">4</span><span class="o">&amp;</span><span class="mi">136</span><span class="n">d1aa0</span><span class="o">&amp;</span><span class="mi">0</span><span class="o">&amp;</span><span class="mo">0001</span><span class="err">#</span><span class="p">{</span><span class="mf">65e8773</span><span class="n">e</span><span class="o">-</span><span class="mf">8f</span><span class="mi">56</span><span class="o">-</span><span class="mi">11</span><span class="n">d0</span><span class="o">-</span><span class="n">a3b9</span><span class="o">-</span><span class="mo">00</span><span class="n">a0c9223196</span><span class="p">}</span> <span class="err">\</span><span class="n">Device</span><span class="err">\</span><span class="mo">0000001</span><span class="n">e</span>

  <span class="mh">0x00000040e940</span>      <span class="mi">1</span>      <span class="mi">0</span> <span class="mi">2014</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">24</span> <span class="mi">22</span><span class="o">:</span><span class="mo">07</span><span class="o">:</span><span class="mi">23</span><span class="o">+</span><span class="mo">0000</span> <span class="n">Psched</span> <span class="err">\</span><span class="n">Device</span><span class="err">\</span><span class="n">Psched</span>
  <span class="mh">0x0000004e9490</span>      <span class="mi">2</span>      <span class="mi">1</span> <span class="mi">2014</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">24</span> <span class="mi">22</span><span class="o">:</span><span class="mo">07</span><span class="o">:</span><span class="mi">32</span><span class="o">+</span><span class="mo">0000</span> <span class="n">DISPLAY</span><span class="err">#</span><span class="n">Default_Monitor</span><span class="err">#</span><span class="mi">4</span><span class="o">&amp;</span><span class="n">d9dcf0b</span><span class="o">&amp;</span><span class="mi">0</span><span class="o">&amp;</span><span class="n">UID0</span><span class="err">#</span><span class="p">{</span><span class="n">e6f07b5f</span><span class="o">-</span><span class="n">ee97</span><span class="o">-</span><span class="mi">4</span><span class="n">a90</span><span class="o">-</span><span class="n">b076</span><span class="o">-</span><span class="mf">33f</span><span class="mi">57</span><span class="n">bf4eaa7</span><span class="p">}</span> <span class="err">\</span><span class="n">Device</span><span class="err">\</span><span class="mo">00000021</span>
<span class="p">...</span>
  <span class="mh">0x00002be706f0</span>      <span class="mi">2</span>      <span class="mi">1</span> <span class="mi">2014</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">24</span> <span class="mi">22</span><span class="o">:</span><span class="mo">07</span><span class="o">:</span><span class="mi">32</span><span class="o">+</span><span class="mo">0000</span> <span class="n">AppContainerNamedObjects</span> <span class="err">\</span><span class="n">Sessions</span><span class="err">\</span><span class="mi">1</span><span class="err">\</span><span class="n">AppContainerNamedObjects</span>
  <span class="mh">0x00002bf89f20</span>      <span class="mi">2</span>      <span class="mi">1</span> <span class="mi">2014</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">24</span> <span class="mi">22</span><span class="o">:</span><span class="mo">07</span><span class="o">:</span><span class="mi">32</span><span class="o">+</span><span class="mo">0000</span> <span class="n">Global</span> <span class="err">\</span><span class="n">BaseNamedObjects</span>
  <span class="mh">0x00002c0b8270</span>      <span class="mi">2</span>      <span class="mi">1</span> <span class="mi">2014</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">24</span> <span class="mi">22</span><span class="o">:</span><span class="mo">07</span><span class="o">:</span><span class="mi">32</span><span class="o">+</span><span class="mo">0000</span> <span class="mi">1</span> <span class="err">\</span><span class="n">Sessions</span><span class="err">\</span><span class="mi">1</span><span class="err">\</span><span class="n">BaseNamedObjects</span>
  <span class="mh">0x00002dbdbe00</span>      <span class="mi">1</span>      <span class="mi">0</span> <span class="mi">2014</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">24</span> <span class="mi">21</span><span class="o">:</span><span class="mi">20</span><span class="o">:</span><span class="mo">05</span><span class="o">+</span><span class="mo">0000</span> <span class="n">pmem</span> <span class="err">\</span><span class="n">Device</span><span class="err">\</span><span class="n">pmem</span>
  <span class="mh">0x00002f2b7240</span>      <span class="mi">1</span>      <span class="mi">0</span> <span class="mi">2014</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">24</span> <span class="mi">22</span><span class="o">:</span><span class="mo">07</span><span class="o">:</span><span class="mi">26</span><span class="o">+</span><span class="mo">0000</span> <span class="n">HCD0</span> <span class="err">\</span><span class="n">Device</span><span class="err">\</span><span class="n">USBFDO</span><span class="o">-</span><span class="mi">0</span>
</pre></div>
</div>

<h1 id="thrdscan" class="anchor">thrdscan</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.modscan.ThrdScan-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Scan physical memory for _ETHREAD objects</h2>
</div>


<h3>Plugin Arguments</h3>
<div class="plugins_args">
<table class='table table-condensed'>
<tbody>
<tr><td><p>scan_in_kernel</p></td><td><p>Scan in the kernel address space (type: Boolean)</p>
<ul>
<li>Default: False</li>
</ul></td></tr>
</tbody>
</table>
</div>


<p>Pool scanning is a technique for discovering kernel data structures based on
signatures. It is essentially the memory forensic equivalent of carving. The
<strong>thrdscan</strong> plugin carves for <strong>_KTHREAD</strong> structures in memory.</p>
<p>By default the plugin scans in the physical address space. Any hits are resolved
into the virtual address space by following the lists. If <strong>scan_in_kernel</strong> is
specified, the scanning occurs in kernel space.</p>
<h3>Notes</h3>
<ol>
<li>
<p>Like other pool scanning plugins, this plugin may produce false positives
   since it essentially carves <strong>_KTHREAD</strong> structures out of memory. On the
   other hand, this plugin may reveal files which have been closed or freed.</p>
</li>
<li>
<p>The plugin displays the physical address of the <strong>_KTHREAD</strong> found. It may be
   possible to derive their virtual address using the <a href="PtoV.html">ptov</a>
   plugin. Alternatively, specify the <em>scan_in_kernel</em> option, to ensure
   scanning occurs in the kernel address space.</p>
</li>
<li>
<p>This plugin is the pool scanning variant of the <a href="Threads.html">threads</a> plugin.</p>
</li>
</ol>
<h3>Sample output</h3>
<p>The below is an example of running <strong>thrdscan</strong> over a windows system. Note that
we can still see exited threads. Rekall resolves the start address of the thread
(i.e. the function which started running in this thread). This helps to identify
what the thread is supposed to be doing.</p>
<div class="highlight"><pre><span class="n">win8</span><span class="mf">.1</span><span class="p">.</span><span class="n">raw</span> <span class="mi">18</span><span class="o">:</span><span class="mi">52</span><span class="o">:</span><span class="mi">26</span><span class="o">&gt;</span> <span class="n">thrdscan</span>
  <span class="n">Offset</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>       <span class="n">PID</span>    <span class="n">TID</span> <span class="n">Start</span> <span class="n">Address</span>  <span class="n">Create</span> <span class="n">Time</span>              <span class="n">Exit</span> <span class="n">Time</span>                <span class="n">Process</span>          <span class="n">Symbol</span>
<span class="o">--------------</span> <span class="o">------</span> <span class="o">------</span> <span class="o">--------------</span> <span class="o">------------------------</span> <span class="o">------------------------</span> <span class="o">----------------</span> <span class="o">------</span>
<span class="mh">0x0000001ab080</span>   <span class="mi">2332</span>   <span class="mi">3976</span> <span class="mh">0x7ff87f35b5c0</span> <span class="o">-</span>                        <span class="o">-</span>                        <span class="n">svchost</span><span class="p">.</span><span class="n">exe</span>      <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span><span class="o">!</span><span class="n">TpPostWork</span><span class="o">+</span><span class="mh">0x4a0</span>
<span class="mh">0x000000230880</span>   <span class="mi">2392</span>   <span class="mi">3212</span> <span class="mh">0x7ff6670fd0bc</span> <span class="o">-</span>                        <span class="mi">2014</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">24</span> <span class="mi">21</span><span class="o">:</span><span class="mi">18</span><span class="o">:</span><span class="mi">44</span><span class="o">+</span><span class="mo">0000</span> <span class="n">VBoxTray</span><span class="p">.</span><span class="n">exe</span>     <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">VBoxTray</span><span class="p">.</span><span class="n">exe</span><span class="o">!+</span><span class="mh">0xd0bc</span>
<span class="mh">0x00000025e080</span>   <span class="mi">3644</span>   <span class="mi">1068</span> <span class="mh">0x7ff7a4831070</span> <span class="o">-</span>                        <span class="o">-</span>                        <span class="n">conhost</span><span class="p">.</span><span class="n">exe</span>      <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">conhost</span><span class="p">.</span><span class="n">exe</span><span class="o">!+</span><span class="mh">0x1070</span>
<span class="mh">0x000000261080</span>    <span class="mi">880</span>   <span class="mi">2440</span> <span class="mh">0x7ff866dbaf44</span> <span class="o">-</span>                        <span class="o">-</span>                        <span class="n">svchost</span><span class="p">.</span><span class="n">exe</span>      <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">wuaueng</span><span class="p">.</span><span class="n">dll</span><span class="o">!+</span><span class="mh">0x3af44</span>
<span class="mh">0x000000261880</span>    <span class="mi">880</span>   <span class="mi">3512</span> <span class="mh">0x7ff87f35b5c0</span> <span class="o">-</span>                        <span class="o">-</span>                        <span class="n">svchost</span><span class="p">.</span><span class="n">exe</span>      <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span><span class="o">!</span><span class="n">TpPostWork</span><span class="o">+</span><span class="mh">0x4a0</span>
<span class="mh">0x0000002d6080</span>   <span class="mi">3644</span>   <span class="mi">3688</span> <span class="mh">0x7ff7a4833060</span> <span class="o">-</span>                        <span class="o">-</span>                        <span class="n">conhost</span><span class="p">.</span><span class="n">exe</span>      <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">conhost</span><span class="p">.</span><span class="n">exe</span><span class="o">!+</span><span class="mh">0x3060</span>
<span class="mh">0x0000002e1080</span>    <span class="mi">976</span>   <span class="mi">3932</span> <span class="mh">0x7ff877104924</span> <span class="o">-</span>                        <span class="mi">2014</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">24</span> <span class="mi">21</span><span class="o">:</span><span class="mi">18</span><span class="o">:</span><span class="mi">37</span><span class="o">+</span><span class="mo">0000</span> <span class="n">svchost</span><span class="p">.</span><span class="n">exe</span>      <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">sysmain</span><span class="p">.</span><span class="n">dll</span><span class="o">!+</span><span class="mh">0x94924</span>
<span class="mh">0x0000002e1880</span>    <span class="mi">880</span>   <span class="mi">3324</span> <span class="mh">0x7ff87f35b5c0</span> <span class="o">-</span>                        <span class="o">-</span>                        <span class="n">svchost</span><span class="p">.</span><span class="n">exe</span>      <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span><span class="o">!</span><span class="n">TpPostWork</span><span class="o">+</span><span class="mh">0x4a0</span>
<span class="mh">0x00000035d080</span>    <span class="mi">880</span>   <span class="mi">1752</span> <span class="mh">0x7ff866dbaf44</span> <span class="o">-</span>                        <span class="o">-</span>                        <span class="n">svchost</span><span class="p">.</span><span class="n">exe</span>      <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">wuaueng</span><span class="p">.</span><span class="n">dll</span><span class="o">!+</span><span class="mh">0x3af44</span>
<span class="mh">0x000000558080</span>    <span class="mi">880</span>   <span class="mi">3524</span> <span class="mh">0x7ff87f35b5c0</span> <span class="o">-</span>                        <span class="o">-</span>                        <span class="n">svchost</span><span class="p">.</span><span class="n">exe</span>      <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span><span class="o">!</span><span class="n">TpPostWork</span><span class="o">+</span><span class="mh">0x4a0</span>
<span class="mh">0x000000613080</span>    <span class="mi">880</span>   <span class="mi">3496</span> <span class="mh">0x7ff866dbaf44</span> <span class="o">-</span>                        <span class="o">-</span>                        <span class="n">svchost</span><span class="p">.</span><span class="n">exe</span>      <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">wuaueng</span><span class="p">.</span><span class="n">dll</span><span class="o">!+</span><span class="mh">0x3af44</span>
<span class="mh">0x000000613880</span>   <span class="mi">3400</span>   <span class="mi">3648</span> <span class="mh">0x7ff87f35b5c0</span> <span class="o">-</span>                        <span class="o">-</span>                        <span class="n">MpCmdRun</span><span class="p">.</span><span class="n">exe</span>     <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span><span class="o">!</span><span class="n">TpPostWork</span><span class="o">+</span><span class="mh">0x4a0</span>
<span class="mh">0x000000668080</span>    <span class="mi">880</span>   <span class="mi">3524</span> <span class="mh">0x7ff87f35b5c0</span> <span class="o">-</span>                        <span class="o">-</span>                        <span class="n">svchost</span><span class="p">.</span><span class="n">exe</span>      <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span><span class="o">!</span><span class="n">TpPostWork</span><span class="o">+</span><span class="mh">0x4a0</span>
<span class="mh">0x0000006c0080</span>    <span class="mi">880</span>   <span class="mi">3692</span> <span class="mh">0x7ff8733911b0</span> <span class="o">-</span>                        <span class="o">-</span>                        <span class="n">svchost</span><span class="p">.</span><span class="n">exe</span>      <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">aelupsvc</span><span class="p">.</span><span class="n">dll</span><span class="o">!+</span><span class="mh">0x11b0</span>
<span class="mh">0x0000006ce080</span>    <span class="mi">880</span>   <span class="mi">3180</span> <span class="mh">0x7ff866d81f3c</span> <span class="o">-</span>                        <span class="o">-</span>                        <span class="n">svchost</span><span class="p">.</span><span class="n">exe</span>      <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">wuaueng</span><span class="p">.</span><span class="n">dll</span><span class="o">!+</span><span class="mh">0x1f3c</span>
<span class="mh">0x000002bd2080</span>    <span class="mi">880</span>   <span class="mi">3736</span> <span class="mh">0x7ff866dbaf44</span> <span class="o">-</span>                        <span class="o">-</span>                        <span class="n">svchost</span><span class="p">.</span><span class="n">exe</span>      <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">wuaueng</span><span class="p">.</span><span class="n">dll</span><span class="o">!+</span><span class="mh">0x3af44</span>
<span class="mh">0x00000370a080</span>    <span class="mi">976</span>   <span class="mi">3932</span> <span class="mh">0x7ff877104924</span> <span class="o">-</span>                        <span class="mi">2014</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">24</span> <span class="mi">21</span><span class="o">:</span><span class="mi">18</span><span class="o">:</span><span class="mi">37</span><span class="o">+</span><span class="mo">0000</span> <span class="n">svchost</span><span class="p">.</span><span class="n">exe</span>      <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">sysmain</span><span class="p">.</span><span class="n">dll</span><span class="o">!+</span><span class="mh">0x94924</span>
<span class="mh">0x00000370a880</span>    <span class="mi">880</span>   <span class="mi">3324</span> <span class="mh">0x7ff87f35b5c0</span> <span class="o">-</span>                        <span class="o">-</span>                        <span class="n">svchost</span><span class="p">.</span><span class="n">exe</span>      <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span><span class="o">!</span><span class="n">TpPostWork</span><span class="o">+</span><span class="mh">0x4a0</span>
<span class="mh">0x000004eef080</span>    <span class="mi">880</span>   <span class="mi">3692</span> <span class="mh">0x7ff8733911b0</span> <span class="o">-</span>                        <span class="o">-</span>                        <span class="n">svchost</span><span class="p">.</span><span class="n">exe</span>      <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">aelupsvc</span><span class="p">.</span><span class="n">dll</span><span class="o">!+</span><span class="mh">0x11b0</span>
<span class="mh">0x0000051a4874</span> <span class="mi">2124654</span> <span class="mi">30318413</span> <span class="mh">0xffe800000000</span> <span class="o">-</span>                        <span class="o">-</span>                        <span class="o">----------------</span>
<span class="mh">0x000005d8a080</span>    <span class="mi">880</span>   <span class="mi">3692</span> <span class="mh">0x7ff8733911b0</span> <span class="o">-</span>                        <span class="o">-</span>                        <span class="n">svchost</span><span class="p">.</span><span class="n">exe</span>      <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">aelupsvc</span><span class="p">.</span><span class="n">dll</span><span class="o">!+</span><span class="mh">0x11b0</span>
<span class="mh">0x000009f5d080</span>   <span class="mi">2332</span>   <span class="mi">3928</span> <span class="mh">0x7ff87f35b5c0</span> <span class="o">-</span>                        <span class="o">-</span>                        <span class="n">svchost</span><span class="p">.</span><span class="n">exe</span>      <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span><span class="o">!</span><span class="n">TpPostWork</span><span class="o">+</span><span class="mh">0x4a0</span>
<span class="mh">0x00000cbde080</span>   <span class="mi">2392</span>   <span class="mi">3880</span> <span class="mh">0x7ff6670fd0bc</span> <span class="o">-</span>                        <span class="mi">2014</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">24</span> <span class="mi">21</span><span class="o">:</span><span class="mi">18</span><span class="o">:</span><span class="mi">24</span><span class="o">+</span><span class="mo">0000</span> <span class="n">VBoxTray</span><span class="p">.</span><span class="n">exe</span>     <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">VBoxTray</span><span class="p">.</span><span class="n">exe</span><span class="o">!+</span><span class="mh">0xd0bc</span>
<span class="mh">0x00000dbdb080</span>   <span class="mi">2392</span>   <span class="mi">4084</span> <span class="mh">0x7ff6670fd0bc</span> <span class="o">-</span>                        <span class="mi">2014</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">24</span> <span class="mi">21</span><span class="o">:</span><span class="mi">19</span><span class="o">:</span><span class="mi">27</span><span class="o">+</span><span class="mo">0000</span> <span class="n">VBoxTray</span><span class="p">.</span><span class="n">exe</span>     <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">VBoxTray</span><span class="p">.</span><span class="n">exe</span><span class="o">!+</span><span class="mh">0xd0bc</span>
<span class="mh">0x00000f345080</span>    <span class="mi">880</span>   <span class="mi">1532</span> <span class="mh">0x7ff866dbaf44</span> <span class="o">-</span>                        <span class="o">-</span>                        <span class="n">svchost</span><span class="p">.</span><span class="n">exe</span>      <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">wuaueng</span><span class="p">.</span><span class="n">dll</span><span class="o">!+</span><span class="mh">0x3af44</span>
<span class="mh">0x00000f345880</span>    <span class="mi">880</span>   <span class="mi">2932</span> <span class="mh">0x7ff87f35b5c0</span> <span class="o">-</span>                        <span class="o">-</span>                        <span class="n">svchost</span><span class="p">.</span><span class="n">exe</span>      <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span><span class="o">!</span><span class="n">TpPostWork</span><span class="o">+</span><span class="mh">0x4a0</span>
<span class="mh">0x00000f413080</span>      <span class="mi">4</span>   <span class="mi">3176</span> <span class="mh">0xf802d3613418</span> <span class="o">-</span>                        <span class="o">-</span>                        <span class="n">System</span>           <span class="n">nt</span><span class="o">!</span><span class="n">MiStoreEvictThread</span>
</pre></div>
</div>

<h1 id="threads" class="anchor">threads</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.taskmods.Threads-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Enumerate threads.</h2>
</div>


<h3>Plugin Arguments</h3>
<div class="plugins_args">
<table class='table table-condensed'>
<tbody>
<tr><td><p>eprocess</p></td><td><p>Kernel addresses of eprocess structs. (type: ArrayIntParser)</p></td></tr><tr><td><p>method</p></td><td><p>Method to list processes. (type: ChoiceArray)</p>
<ul>
<li>
<p>Valid Choices:</p>
<ul>
<li>PsActiveProcessHead</li>
<li>CSRSS</li>
<li>PspCidTable</li>
<li>Sessions</li>
<li>Handles</li>
</ul>
</li>
<li>
<p>Default: PsActiveProcessHead, CSRSS, PspCidTable, Sessions, Handles</p>
</li>
</ul></td></tr><tr><td><p>phys_eprocess</p></td><td><p>Physical addresses of eprocess structs. (type: ArrayIntParser)</p></td></tr><tr><td><p>pid</p></td><td><p>One or more pids of processes to select. (type: ArrayIntParser)</p></td></tr><tr><td><p>proc_regex</p></td><td><p>A regex to select a process by name. (type: RegEx)</p></td></tr>
</tbody>
</table>
</div>


<p>The <strong>threads</strong> plugin iterates over all processes and lists all threads in all
processes. This is the list walking version of the <a href="ThrdScan.html">thrdscan</a>
plugin.</p>
<h3>Sample output</h3>
<div class="highlight"><pre>   _ETHREAD       PID    TID Start Address  Process          Symbol
-------------- ------ ------ -------------- ---------------- ------
0xe00000089880      4      8 0xf802d3509ec8 System           nt!Phase1Initialization
0xe0000011f040      4     12 0xf802d3154c04 System           nt!PopIrpWorkerControl
0xe0000011f880      4     16 0xf802d312f868 System           nt!PopIrpWorker
0xe0000011e040      4     20 0xf802d312f868 System           nt!PopIrpWorker
0xe0000011e880      4     24 0xf802d31551c0 System           nt!PopFxEmergencyWorker
0xe0000011d040      4     28 0xf802d3520f14 System           nt!ExpWorkerThreadBalanceManager
0xe0000011d880      4     32 0xf802d30533a8 System           nt!ExpWorkerThread
0xe0000011c880      4     36 0xf802d314cb04 System           nt!ExpWorkerFactoryManagerThread
0xe00000120040      4     40 0xf802d3146fdc System           nt!KiExecuteDpc
0xe00000120880      4     44 0xf802d314f764 System           nt!MiDereferenceSegmentThread
0xe00000124040      4     48 0xf802d3151a8c System           nt!MiModifiedPageWriter
0xe00000124880      4     52 0xf802d314de28 System           nt!KeBalanceSetManager
0xe00000123040      4     56 0xf802d314bc18 System           nt!KeSwapProcessOrStack
0xe00000122040      4     64 0xf802d314cd68 System           nt!CcQueueLazyWriteScanThread
0xe00000122880      4     68 0xf802d3154b9c System           nt!FsRtlWorkerThread
0xe00000121040      4     72 0xf802d3154b9c System           nt!FsRtlWorkerThread
0xe00000133040      4     76 0xf802d3492540 System           nt!EtwpLogger
0xe00000133880      4     80 0xf802d30533a8 System           nt!ExpWorkerThread
<span class="gh">0xe00000137040      4     84 0xf802d314c94c System           nt!MiMappedPageWriter</span>
<span class="gh">....</span>
</pre></div>
</div>

<h1 id="timers" class="anchor">timers</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.malware.timers.Timers-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Print kernel timers and associated module DPCs.</h2>
<p>Ref:
http://computer.forensikblog.de/en/2011/10/timers-and-times.html</p>
</div>



<p>The windows kernel has a mechanism for drivers to schedule Deferred Procedure
Calls (DPCs) wither periodically or in a future time. This mechanism is useful
for malware which wants to remain persistant, but not necessarily run at all
times (This reduces the malware&rsquo;s footprint).</p>
<p>The kernel uses <strong>_KTIMER</strong> objects to keep track of these DPCs. Depending on
the exact OS version, the timers are arranged in slightly different data
structures:</p>
<ul>
<li>
<p>On Window XP there is a symbol <strong>KiTimerTableListHead</strong> which enumerates all
  timer hash tables.</p>
</li>
<li>
<p>On windows 7, the timer list is at <strong>_KPCR.PrcbData.TimerTable.TimerEntries</strong>.</p>
</li>
</ul>
<p>Since Windows 7, PatchGuard was introduced. This uses the timer table to
schedule periodic runs. Microsoft felt it was necessary to protect PatchGuard by
obfuscating all DPC pointers in the timer table. This unfortunately also
obfuscates all other timers, including ones possibly used by malware.</p>
<p>Rekall is able to de-obfuscate these DPC address and resolve them back to their
correct module. Rekall will also indicate when the timer is due to go off.</p>
<h3>Sample output</h3>
<div class="highlight"><pre><span class="n">win8</span><span class="mf">.1</span><span class="p">.</span><span class="n">raw</span> <span class="mi">22</span><span class="o">:</span><span class="mi">25</span><span class="o">:</span><span class="mi">53</span><span class="o">&gt;</span> <span class="n">timers</span>
<span class="n">Table</span>     <span class="n">Offset</span>     <span class="n">DueTime</span><span class="p">(</span><span class="n">H</span><span class="p">)</span> <span class="n">DueTime</span>              <span class="n">Period</span><span class="p">(</span><span class="n">ms</span><span class="p">)</span>   <span class="n">Signaled</span>    <span class="n">Routine</span>     <span class="n">Module</span>
<span class="o">-----</span> <span class="o">--------------</span> <span class="o">----------</span> <span class="o">--------------------</span> <span class="o">----------</span> <span class="o">----------</span> <span class="o">--------------</span> <span class="o">--------------------</span>
<span class="mi">2</span>   <span class="mh">0xe00001a58708</span> <span class="mh">0x0000000001f0df8a92</span> <span class="mi">2014</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">24</span> <span class="mi">21</span><span class="o">:</span><span class="mi">21</span><span class="o">:</span><span class="mi">14</span><span class="o">+</span><span class="mo">0000</span>       <span class="mi">1000</span>        <span class="n">Yes</span> <span class="mh">0xf80000298480</span> <span class="n">wdf01000</span> <span class="o">+</span> <span class="mh">0x8480</span>
<span class="mi">8</span>   <span class="mh">0xf802d32ecd00</span> <span class="mh">0x0000000001c789ad30</span> <span class="mi">2014</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">24</span> <span class="mi">21</span><span class="o">:</span><span class="mi">20</span><span class="o">:</span><span class="mo">05</span><span class="o">+</span><span class="mo">0000</span>          <span class="mi">0</span>          <span class="o">-</span> <span class="mh">0xf802d311b194</span> <span class="n">nt</span><span class="o">!</span><span class="n">CcScanDpc</span>
<span class="mi">9</span>   <span class="mh">0xf802d32bcce0</span> <span class="mh">0x0000010c0d9d767529</span> <span class="mi">2015</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mo">01</span> <span class="mo">00</span><span class="o">:</span><span class="mo">00</span><span class="o">:</span><span class="mo">00</span><span class="o">+</span><span class="mo">0000</span>          <span class="mi">0</span>          <span class="o">-</span> <span class="mh">0xf802d32467b4</span> <span class="n">nt</span><span class="o">!</span><span class="n">ExpNextYearDpcRoutine</span>
<span class="mi">9</span>   <span class="mh">0xf802d32ac920</span> <span class="mh">0x0000000001e478b3c5</span> <span class="mi">2014</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">24</span> <span class="mi">21</span><span class="o">:</span><span class="mi">20</span><span class="o">:</span><span class="mi">53</span><span class="o">+</span><span class="mo">0000</span>          <span class="mi">0</span>          <span class="o">-</span> <span class="mh">0xf802d3116abc</span> <span class="n">nt</span><span class="o">!</span><span class="n">CmpLazyFlushDpcRoutine</span>
<span class="mi">13</span>  <span class="mh">0xf80002146660</span> <span class="mh">0x0000000001f3302411</span> <span class="mi">2014</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">24</span> <span class="mi">21</span><span class="o">:</span><span class="mi">21</span><span class="o">:</span><span class="mi">18</span><span class="o">+</span><span class="mo">0000</span>      <span class="mi">43348</span>        <span class="n">Yes</span> <span class="mh">0xf80002140c44</span> <span class="n">bowser</span> <span class="o">+</span> <span class="mh">0x3c44</span>
<span class="mi">15</span>  <span class="mh">0xf8000072e320</span> <span class="mh">0x00000000c877502ee7</span> <span class="mi">2014</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">25</span> <span class="mi">21</span><span class="o">:</span><span class="mo">02</span><span class="o">:</span><span class="mi">20</span><span class="o">+</span><span class="mo">0000</span>          <span class="mi">0</span>          <span class="o">-</span> <span class="mh">0xf80000719230</span> <span class="n">storport</span> <span class="o">+</span> <span class="mh">0x23230</span>
<span class="mi">17</span>  <span class="mh">0xf800024cbb28</span> <span class="mh">0x0000000001fdfb093c</span> <span class="mi">2014</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">24</span> <span class="mi">21</span><span class="o">:</span><span class="mi">21</span><span class="o">:</span><span class="mi">36</span><span class="o">+</span><span class="mo">0000</span>      <span class="mi">28348</span>        <span class="n">Yes</span> <span class="mh">0xf800024af550</span> <span class="n">tunnel</span> <span class="o">+</span> <span class="mh">0x1550</span>
<span class="mi">18</span>  <span class="mh">0xe0000127ff40</span> <span class="mh">0x0000000002f06baf46</span> <span class="mi">2014</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">24</span> <span class="mi">21</span><span class="o">:</span><span class="mi">28</span><span class="o">:</span><span class="mi">23</span><span class="o">+</span><span class="mo">0000</span>          <span class="mi">0</span>          <span class="o">-</span> <span class="mh">0xf80000b31394</span> <span class="n">volsnap</span> <span class="o">+</span> <span class="mh">0x2394</span>
<span class="mi">21</span>  <span class="mh">0xe0000137bb40</span> <span class="mh">0x0000000001f0df8a92</span> <span class="mi">2014</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">24</span> <span class="mi">21</span><span class="o">:</span><span class="mi">21</span><span class="o">:</span><span class="mi">14</span><span class="o">+</span><span class="mo">0000</span>       <span class="mi">1000</span>        <span class="n">Yes</span> <span class="mh">0xf8000194a860</span> <span class="n">usbport</span> <span class="o">+</span> <span class="mh">0x2860</span>
<span class="mi">24</span>  <span class="mh">0xe00000203b88</span> <span class="mh">0x0000000002534bd8cd</span> <span class="mi">2014</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">24</span> <span class="mi">21</span><span class="o">:</span><span class="mi">23</span><span class="o">:</span><span class="mi">59</span><span class="o">+</span><span class="mo">0000</span>          <span class="mi">0</span>          <span class="o">-</span> <span class="mh">0xf80001a930a4</span> <span class="n">battc</span> <span class="o">+</span> <span class="mh">0x10a4</span>
<span class="mi">38</span>  <span class="mh">0xe00001493278</span> <span class="mh">0x0000000001f1249ec9</span> <span class="mi">2014</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">24</span> <span class="mi">21</span><span class="o">:</span><span class="mi">21</span><span class="o">:</span><span class="mi">14</span><span class="o">+</span><span class="mo">0000</span>          <span class="mi">0</span>          <span class="o">-</span> <span class="mh">0xf80000c2ac30</span> <span class="n">ndis</span> <span class="o">+</span> <span class="mh">0x4c30</span>
<span class="mi">38</span>  <span class="mh">0xe00002327228</span> <span class="mh">0x00000000024c651b42</span> <span class="mi">2014</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">24</span> <span class="mi">21</span><span class="o">:</span><span class="mi">23</span><span class="o">:</span><span class="mi">47</span><span class="o">+</span><span class="mo">0000</span>     <span class="mi">944848</span>          <span class="o">-</span> <span class="mh">0xf8000249cbb4</span> <span class="n">mslldp</span> <span class="o">+</span> <span class="mh">0x4bb4</span>
<span class="mi">38</span>  <span class="mh">0xe000013f7ef8</span> <span class="mh">0x00000000324d602123</span> <span class="mi">2014</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">25</span> <span class="mo">03</span><span class="o">:</span><span class="mo">07</span><span class="o">:</span><span class="mi">25</span><span class="o">+</span><span class="mo">0000</span>   <span class="mi">21600000</span>          <span class="o">-</span> <span class="mh">0xf80001491cf0</span> <span class="n">dxgkrnl</span> <span class="o">+</span> <span class="mh">0x19cf0</span>
<span class="mi">38</span>  <span class="mh">0xf802d32ea250</span> <span class="mh">0x0000000001d163bc04</span> <span class="mi">2014</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">24</span> <span class="mi">21</span><span class="o">:</span><span class="mi">20</span><span class="o">:</span><span class="mi">21</span><span class="o">+</span><span class="mo">0000</span>      <span class="mi">60000</span>        <span class="n">Yes</span> <span class="mh">0xf802d3116bac</span> <span class="n">nt</span><span class="o">!</span><span class="n">IopIrpStackProfilerTimer</span>
<span class="mi">40</span>  <span class="mh">0xf80000e981c0</span> <span class="mh">0x0000000002840a55a8</span> <span class="mi">2014</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">24</span> <span class="mi">21</span><span class="o">:</span><span class="mi">25</span><span class="o">:</span><span class="mi">21</span><span class="o">+</span><span class="mo">0000</span>          <span class="mi">0</span>          <span class="o">-</span> <span class="mh">0xf80000e94c9c</span> <span class="n">mup</span> <span class="o">+</span> <span class="mh">0x1c9c</span>
</pre></div>
</div>

<h1 id="tokens" class="anchor">tokens</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.registry.getsids.GetSIDs-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Print the SIDs owning each process token.</h2>
</div>


<h3>Plugin Arguments</h3>
<div class="plugins_args">
<table class='table table-condensed'>
<tbody>
<tr><td><p>eprocess</p></td><td><p>Kernel addresses of eprocess structs. (type: ArrayIntParser)</p></td></tr><tr><td><p>method</p></td><td><p>Method to list processes. (type: ChoiceArray)</p>
<ul>
<li>
<p>Valid Choices:</p>
<ul>
<li>PsActiveProcessHead</li>
<li>CSRSS</li>
<li>PspCidTable</li>
<li>Sessions</li>
<li>Handles</li>
</ul>
</li>
<li>
<p>Default: PsActiveProcessHead, CSRSS, PspCidTable, Sessions, Handles</p>
</li>
</ul></td></tr><tr><td><p>phys_eprocess</p></td><td><p>Physical addresses of eprocess structs. (type: ArrayIntParser)</p></td></tr><tr><td><p>pid</p></td><td><p>One or more pids of processes to select. (type: ArrayIntParser)</p></td></tr><tr><td><p>proc_regex</p></td><td><p>A regex to select a process by name. (type: RegEx)</p></td></tr>
</tbody>
</table>
</div>


<p>In windows a process runs with a set of <em>Tokens</em>. These tokens are used to
enforce Windows Mandatory ACL system. From a forensic point of view it is
interesting to see what tokens a process is running with.</p>
<p>For non system processes, the process will also possess the token of the user
who started it.</p>
<h3>Sample output</h3>
<p>In the below we can see that this cmd.exe process was started by the user <code>test</code>
with SID <code>S-1-5-21-1077689984-2177008626-1601812314-1001</code>.</p>
<div class="highlight"><pre><span class="n">win8</span><span class="mf">.1</span><span class="p">.</span><span class="n">raw</span> <span class="mi">22</span><span class="o">:</span><span class="mi">41</span><span class="o">:</span><span class="mo">01</span><span class="o">&gt;</span> <span class="n">tokens</span>
<span class="o">-------------------&gt;</span> <span class="n">tokens</span><span class="p">()</span>
<span class="n">Process</span>          <span class="n">Pid</span>   <span class="n">Sid</span>                                                <span class="n">Comment</span>
<span class="o">----------------</span> <span class="o">-----</span> <span class="o">--------------------------------------------------</span> <span class="o">-------</span>
<span class="p">...</span>
<span class="n">cmd</span><span class="p">.</span><span class="n">exe</span>          <span class="mi">888</span>   <span class="n">S</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">5</span><span class="o">-</span><span class="mi">21</span><span class="o">-</span><span class="mi">1077689984</span><span class="o">-</span><span class="mi">2177008626</span><span class="o">-</span><span class="mi">1601812314</span><span class="o">-</span><span class="mi">1001</span>     <span class="n">User</span><span class="o">:</span> <span class="n">test</span>
<span class="n">cmd</span><span class="p">.</span><span class="n">exe</span>          <span class="mi">888</span>   <span class="n">S</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">5</span><span class="o">-</span><span class="mi">21</span><span class="o">-</span><span class="mi">1077689984</span><span class="o">-</span><span class="mi">2177008626</span><span class="o">-</span><span class="mi">1601812314</span><span class="o">-</span><span class="mi">513</span>      <span class="n">Domain</span> <span class="n">Users</span>
<span class="n">cmd</span><span class="p">.</span><span class="n">exe</span>          <span class="mi">888</span>   <span class="n">S</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">0</span>                                            <span class="n">Everyone</span>
<span class="n">cmd</span><span class="p">.</span><span class="n">exe</span>          <span class="mi">888</span>   <span class="n">S</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">5</span><span class="o">-</span><span class="mi">114</span>
<span class="n">cmd</span><span class="p">.</span><span class="n">exe</span>          <span class="mi">888</span>   <span class="n">S</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">5</span><span class="o">-</span><span class="mi">21</span><span class="o">-</span><span class="mi">1077689984</span><span class="o">-</span><span class="mi">2177008626</span><span class="o">-</span><span class="mi">1601812314</span><span class="o">-</span><span class="mi">1002</span>
<span class="n">cmd</span><span class="p">.</span><span class="n">exe</span>          <span class="mi">888</span>   <span class="n">S</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">5</span><span class="o">-</span><span class="mi">32</span><span class="o">-</span><span class="mi">544</span>                                       <span class="n">Administrators</span>
<span class="n">cmd</span><span class="p">.</span><span class="n">exe</span>          <span class="mi">888</span>   <span class="n">S</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">5</span><span class="o">-</span><span class="mi">32</span><span class="o">-</span><span class="mi">545</span>                                       <span class="n">Users</span>
<span class="n">cmd</span><span class="p">.</span><span class="n">exe</span>          <span class="mi">888</span>   <span class="n">S</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">5</span><span class="o">-</span><span class="mi">4</span>                                            <span class="n">Interactive</span>
<span class="n">cmd</span><span class="p">.</span><span class="n">exe</span>          <span class="mi">888</span>   <span class="n">S</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span>                                            <span class="n">Console</span> <span class="n">Logon</span> <span class="p">(</span><span class="n">Users</span> <span class="n">who</span> <span class="n">are</span> <span class="n">logged</span> <span class="n">onto</span> <span class="n">the</span> <span class="n">physical</span> <span class="n">console</span><span class="p">)</span>
<span class="n">cmd</span><span class="p">.</span><span class="n">exe</span>          <span class="mi">888</span>   <span class="n">S</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">5</span><span class="o">-</span><span class="mi">11</span>                                           <span class="n">Authenticated</span> <span class="n">Users</span>
<span class="n">cmd</span><span class="p">.</span><span class="n">exe</span>          <span class="mi">888</span>   <span class="n">S</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">5</span><span class="o">-</span><span class="mi">15</span>                                           <span class="n">This</span> <span class="n">Organization</span>
<span class="n">cmd</span><span class="p">.</span><span class="n">exe</span>          <span class="mi">888</span>   <span class="n">S</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">5</span><span class="o">-</span><span class="mi">113</span>
<span class="n">cmd</span><span class="p">.</span><span class="n">exe</span>          <span class="mi">888</span>   <span class="n">S</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">5</span><span class="o">-</span><span class="mi">5</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">126935</span>                                   <span class="n">Logon</span> <span class="n">Session</span>
<span class="n">cmd</span><span class="p">.</span><span class="n">exe</span>          <span class="mi">888</span>   <span class="n">S</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">2</span><span class="o">-</span><span class="mi">0</span>                                            <span class="n">Local</span> <span class="p">(</span><span class="n">Users</span> <span class="n">with</span> <span class="n">the</span> <span class="n">ability</span> <span class="n">to</span> <span class="n">log</span> <span class="n">in</span> <span class="n">locally</span><span class="p">)</span>
<span class="n">cmd</span><span class="p">.</span><span class="n">exe</span>          <span class="mi">888</span>   <span class="n">S</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">5</span><span class="o">-</span><span class="mi">64</span><span class="o">-</span><span class="mi">10</span>                                        <span class="n">NTLM</span> <span class="n">Authentication</span>
<span class="n">cmd</span><span class="p">.</span><span class="n">exe</span>          <span class="mi">888</span>   <span class="n">S</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">16</span><span class="o">-</span><span class="mi">12288</span>                                       <span class="n">High</span> <span class="n">Mandatory</span> <span class="n">Level</span>
<span class="p">...</span>
</pre></div>
</div>

<h1 id="unloaded_modules" class="anchor">unloaded_modules</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.modules.UnloadedModules-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Print a list of recently unloaded modules.</h2>
<p>Ref:
http://volatility-labs.blogspot.de/2013/05/movp-ii-22-unloaded-windows-kernel_22.html</p>
</div>



<p>For debugging purposes windows keeps a list of the last few kernel modules to
have been unloaded. Sometimes if malware inserts a kernel component, and then
removes it this will leave traces in this list.</p>
<h3>Sample output</h3>
<p>The below sample shows that <code>win32dd</code> was used to acquire this sample, and that
the Honeynet project&rsquo;s <a href="https://projects.honeynet.org/capture-hpc/browser/capture-hpc/branches/dev/capture-client/KernelDrivers/CaptureKernelDrivers">capture
tools</a>
were used.</p>
<div class="highlight"><pre><span class="mi">130115</span><span class="n">b</span><span class="p">.</span><span class="n">w32</span> <span class="mi">22</span><span class="o">:</span><span class="mi">53</span><span class="o">:</span><span class="mi">17</span><span class="o">&gt;</span> <span class="n">unloaded_modules</span>
<span class="nl">INFO:</span><span class="n">root</span><span class="o">:</span><span class="n">Detected</span> <span class="n">kernel</span> <span class="n">base</span> <span class="n">at</span> <span class="mh">0x804D7000</span><span class="o">-</span>
<span class="n">Name</span>                   <span class="n">Start</span>       <span class="n">End</span>     <span class="n">Time</span>
<span class="o">--------------------</span> <span class="o">----------</span> <span class="o">----------</span> <span class="o">----</span>
<span class="n">Sfloppy</span><span class="p">.</span><span class="n">SYS</span>          <span class="mh">0xf8383000</span> <span class="mh">0xf8386000</span> <span class="mi">2013</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">15</span> <span class="mi">22</span><span class="o">:</span><span class="mo">06</span><span class="o">:</span><span class="mo">06</span><span class="o">+</span><span class="mo">0000</span>
<span class="n">Cdaudio</span><span class="p">.</span><span class="n">SYS</span>          <span class="mh">0xf89c2000</span> <span class="mh">0xf89c7000</span> <span class="mi">2013</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">15</span> <span class="mi">22</span><span class="o">:</span><span class="mo">06</span><span class="o">:</span><span class="mo">06</span><span class="o">+</span><span class="mo">0000</span>
<span class="n">processr</span><span class="p">.</span><span class="n">sys</span>         <span class="mh">0xf88aa000</span> <span class="mh">0xf88b3000</span> <span class="mi">2013</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">15</span> <span class="mi">22</span><span class="o">:</span><span class="mo">06</span><span class="o">:</span><span class="mo">06</span><span class="o">+</span><span class="mo">0000</span>
<span class="n">splitter</span><span class="p">.</span><span class="n">sys</span>         <span class="mh">0xf8bc6000</span> <span class="mh">0xf8bc8000</span> <span class="mi">2013</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">15</span> <span class="mi">22</span><span class="o">:</span><span class="mo">06</span><span class="o">:</span><span class="mi">41</span><span class="o">+</span><span class="mo">0000</span>
<span class="n">aec</span><span class="p">.</span><span class="n">sys</span>              <span class="mh">0xb1be6000</span> <span class="mh">0xb1c09000</span> <span class="mi">2013</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">15</span> <span class="mi">22</span><span class="o">:</span><span class="mo">06</span><span class="o">:</span><span class="mi">41</span><span class="o">+</span><span class="mo">0000</span>
<span class="n">swmidi</span><span class="p">.</span><span class="n">sys</span>           <span class="mh">0xb1d06000</span> <span class="mh">0xb1d14000</span> <span class="mi">2013</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">15</span> <span class="mi">22</span><span class="o">:</span><span class="mo">06</span><span class="o">:</span><span class="mi">41</span><span class="o">+</span><span class="mo">0000</span>
<span class="n">DMusic</span><span class="p">.</span><span class="n">sys</span>           <span class="mh">0xb1cf6000</span> <span class="mh">0xb1d03000</span> <span class="mi">2013</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">15</span> <span class="mi">22</span><span class="o">:</span><span class="mo">06</span><span class="o">:</span><span class="mi">41</span><span class="o">+</span><span class="mo">0000</span>
<span class="n">drmkaud</span><span class="p">.</span><span class="n">sys</span>          <span class="mh">0xf8c9f000</span> <span class="mh">0xf8ca0000</span> <span class="mi">2013</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">15</span> <span class="mi">22</span><span class="o">:</span><span class="mo">06</span><span class="o">:</span><span class="mi">41</span><span class="o">+</span><span class="mo">0000</span>
<span class="n">kmixer</span><span class="p">.</span><span class="n">sys</span>           <span class="mh">0xb1b1b000</span> <span class="mh">0xb1b46000</span> <span class="mi">2013</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">15</span> <span class="mi">22</span><span class="o">:</span><span class="mo">06</span><span class="o">:</span><span class="mi">51</span><span class="o">+</span><span class="mo">0000</span>
<span class="n">kmixer</span><span class="p">.</span><span class="n">sys</span>           <span class="mh">0xb14df000</span> <span class="mh">0xb150a000</span> <span class="mi">2013</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">15</span> <span class="mi">22</span><span class="o">:</span><span class="mi">08</span><span class="o">:</span><span class="mo">04</span><span class="o">+</span><span class="mo">0000</span>
<span class="n">kmixer</span><span class="p">.</span><span class="n">sys</span>           <span class="mh">0xb14df000</span> <span class="mh">0xb150a000</span> <span class="mi">2013</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">15</span> <span class="mi">22</span><span class="o">:</span><span class="mi">09</span><span class="o">:</span><span class="mi">21</span><span class="o">+</span><span class="mo">0000</span>
<span class="n">win32dd</span><span class="p">.</span><span class="n">sys</span>          <span class="mh">0xb160a000</span> <span class="mh">0xb1616000</span> <span class="mi">2013</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">15</span> <span class="mi">22</span><span class="o">:</span><span class="mi">27</span><span class="o">:</span><span class="mi">39</span><span class="o">+</span><span class="mo">0000</span>
<span class="n">fastdumpx86</span><span class="p">.</span><span class="n">sys</span>      <span class="mh">0xf8942000</span> <span class="mh">0xf8948000</span> <span class="mi">2013</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">15</span> <span class="mi">22</span><span class="o">:</span><span class="mi">30</span><span class="o">:</span><span class="mi">55</span><span class="o">+</span><span class="mo">0000</span>
<span class="n">CaptureFileMonitor</span><span class="p">.</span><span class="n">sys</span> <span class="mh">0xb1c3a000</span> <span class="mh">0xb1c3d000</span> <span class="mi">2013</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">15</span> <span class="mi">22</span><span class="o">:</span><span class="mi">35</span><span class="o">:</span><span class="mi">48</span><span class="o">+</span><span class="mo">0000</span>
<span class="n">CaptureRegistryMonitor</span><span class="p">.</span><span class="n">sys</span> <span class="mh">0xf8c1e000</span> <span class="mh">0xf8c20000</span> <span class="mi">2013</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">15</span> <span class="mi">22</span><span class="o">:</span><span class="mi">39</span><span class="o">:</span><span class="mi">51</span><span class="o">+</span><span class="mo">0000</span>
<span class="n">CaptureProcessMonitor</span><span class="p">.</span><span class="n">sys</span> <span class="mh">0xf8c0e000</span> <span class="mh">0xf8c10000</span> <span class="mi">2013</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">15</span> <span class="mi">22</span><span class="o">:</span><span class="mi">39</span><span class="o">:</span><span class="mi">52</span><span class="o">+</span><span class="mo">0000</span>
<span class="n">CaptureFileMonitor</span><span class="p">.</span><span class="n">sys</span> <span class="mh">0xb15ba000</span> <span class="mh">0xb15bd000</span> <span class="mi">2013</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">15</span> <span class="mi">22</span><span class="o">:</span><span class="mi">39</span><span class="o">:</span><span class="mi">52</span><span class="o">+</span><span class="mo">0000</span>
</pre></div>
</div>

<h1 id="vacbs" class="anchor">vacbs</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.cache.EnumerateVacbs-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Enumerate all blocks cached in the cache manager.</h2>
</div>




</div>

<h1 id="vad" class="anchor">vad</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.vadinfo.VAD-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Concise dump of the VAD.</h2>
<p>Similar to windbg&rsquo;s !vad.</p>
</div>


<h3>Plugin Arguments</h3>
<div class="plugins_args">
<table class='table table-condensed'>
<tbody>
<tr><td><p>eprocess</p></td><td><p>Kernel addresses of eprocess structs. (type: ArrayIntParser)</p></td></tr><tr><td><p>method</p></td><td><p>Method to list processes. (type: ChoiceArray)</p>
<ul>
<li>
<p>Valid Choices:</p>
<ul>
<li>PsActiveProcessHead</li>
<li>CSRSS</li>
<li>PspCidTable</li>
<li>Sessions</li>
<li>Handles</li>
</ul>
</li>
<li>
<p>Default: PsActiveProcessHead, CSRSS, PspCidTable, Sessions, Handles</p>
</li>
</ul></td></tr><tr><td><p>offset</p></td><td><p>Only print the vad corresponding to this offset. (type: IntParser)</p></td></tr><tr><td><p>phys_eprocess</p></td><td><p>Physical addresses of eprocess structs. (type: ArrayIntParser)</p></td></tr><tr><td><p>pid</p></td><td><p>One or more pids of processes to select. (type: ArrayIntParser)</p></td></tr><tr><td><p>proc_regex</p></td><td><p>A regex to select a process by name. (type: RegEx)</p></td></tr><tr><td><p>regex</p></td><td><p>A regular expression to filter VAD filenames.</p></td></tr>
</tbody>
</table>
</div>


<p>The windows kernel manages process memory using the Virtual Address Descriptor
tree. The VAD is a tree of mapped memory regions into the process address
space. The VAD regions are used to manage the process address space (i.e. its
page tables).</p>
<p>The <strong>vad</strong> plugin displays all the vad regions in the process and their
properties.</p>
<h3>Notes</h3>
<ol>
<li>
<p>The <code>start</code> and <code>end</code> columns refer to the page number of the region. To
   convert from an address to page number simply multiply (or divide) by 0x1000.</p>
</li>
<li>
<p>If a memory region is mapped from a file (e.g. via the <strong>mmap</strong> call) the
   filename will be shown.</p>
</li>
<li>
<p>Most executables (e.g. dlls) are mapped with the EXECUTE_WRITECOPY
   permission. This is so that the executable pages are shared between all
   processes. As soon as a process attempts to write to that region the binary
   will be mapped EXECUTE_READWRITE.</p>
</li>
<li>
<p>When a dll is mapped into the vad, the PE header is placed at the vad&rsquo;s start
   address. This means that you can dump the dll by simply passing the vad&rsquo;s
   start address to <a href="PEDump.html">pedump</a> as the image base.</p>
</li>
</ol>
<h3>Sample output</h3>
<div class="highlight"><pre><span class="n">win7_trial_64bit</span><span class="p">.</span><span class="n">dmp</span><span class="p">.</span><span class="n">E01</span> <span class="mi">23</span><span class="o">:</span><span class="mi">10</span><span class="o">:</span><span class="mi">34</span><span class="o">&gt;</span> <span class="n">vad</span> <span class="mi">1232</span>
<span class="o">**************************************************</span>
<span class="nl">Pid:</span> <span class="mi">1232</span> <span class="n">grrservice</span><span class="p">.</span><span class="n">exe</span>
     <span class="n">VAD</span>       <span class="n">lev</span>     <span class="n">start</span>           <span class="n">end</span>        <span class="n">com</span> <span class="o">-</span>       <span class="o">-</span>      <span class="n">Protect</span>              <span class="n">Filename</span>
<span class="o">--------------</span> <span class="o">---</span> <span class="o">--------------</span> <span class="o">--------------</span> <span class="o">----</span> <span class="o">-------</span> <span class="o">------</span> <span class="o">--------------------</span> <span class="o">--------</span>
<span class="mh">0xfa80020877a0</span> <span class="mi">1</span>         <span class="mh">0x73660</span>        <span class="mh">0x736bb</span>    <span class="mi">6</span> <span class="n">Mapped</span>  <span class="n">Exe</span>    <span class="n">EXECUTE_WRITECOPY</span>    <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">wow64win</span><span class="p">.</span><span class="n">dll</span>
<span class="mh">0xfa8002083a50</span> <span class="mi">2</span>           <span class="mh">0x400</span>          <span class="mh">0x427</span>    <span class="mi">8</span> <span class="n">Mapped</span>  <span class="n">Exe</span>    <span class="n">EXECUTE_WRITECOPY</span>    <span class="err">\</span><span class="n">Python27</span><span class="err">\</span><span class="n">grrservice</span><span class="p">.</span><span class="n">exe</span>
<span class="mh">0xfa800207fd80</span> <span class="mi">3</span>           <span class="mh">0x290</span>          <span class="mh">0x293</span>    <span class="mi">0</span> <span class="n">Mapped</span>         <span class="n">READONLY</span>             <span class="n">Pagefile</span><span class="o">-</span><span class="n">backed</span> <span class="n">section</span>
<span class="mh">0xfa800205a6d0</span> <span class="mi">4</span>            <span class="mh">0x50</span>           <span class="mh">0x8f</span>    <span class="mi">7</span> <span class="n">Private</span>        <span class="n">READWRITE</span>
<span class="mh">0xfa80020848f0</span> <span class="mi">5</span>            <span class="mh">0x40</span>           <span class="mh">0x40</span>    <span class="mi">0</span> <span class="n">Mapped</span>  <span class="n">Exe</span>    <span class="n">EXECUTE_WRITECOPY</span>    <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">apisetschema</span><span class="p">.</span><span class="n">dll</span>
<span class="mh">0xfa800208b590</span> <span class="mi">6</span>            <span class="mh">0x10</span>           <span class="mh">0x1f</span>    <span class="mi">0</span> <span class="n">Mapped</span>         <span class="n">READWRITE</span>            <span class="n">Pagefile</span><span class="o">-</span><span class="n">backed</span> <span class="n">section</span>
<span class="mh">0xfa8002066300</span> <span class="mi">5</span>            <span class="mh">0x90</span>          <span class="mh">0x28f</span>    <span class="mi">3</span> <span class="n">Private</span>        <span class="n">READWRITE</span>
<span class="mh">0xfa800208acd0</span> <span class="mi">4</span>           <span class="mh">0x2b0</span>          <span class="mh">0x316</span>    <span class="mi">0</span> <span class="n">Mapped</span>         <span class="n">READONLY</span>             <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">locale</span><span class="p">.</span><span class="n">nls</span>
<span class="mh">0xfa8002082470</span> <span class="mi">5</span>           <span class="mh">0x2a0</span>          <span class="mh">0x2a0</span>    <span class="mi">1</span> <span class="n">Private</span>        <span class="n">READWRITE</span>
<span class="mh">0xfa80020aaad0</span> <span class="mi">5</span>           <span class="mh">0x360</span>          <span class="mh">0x39f</span>    <span class="mi">7</span> <span class="n">Private</span>        <span class="n">READWRITE</span>
<span class="mh">0xfa80020a0170</span> <span class="mi">6</span>           <span class="mh">0x3a0</span>          <span class="mh">0x3df</span>    <span class="mi">7</span> <span class="n">Private</span>        <span class="n">READWRITE</span>
<span class="mh">0xfa800207e180</span> <span class="mi">3</span>           <span class="mh">0x830</span>          <span class="mh">0x92f</span>   <span class="mi">28</span> <span class="n">Private</span>        <span class="n">READWRITE</span>
<span class="mh">0xfa800208aa30</span> <span class="mi">4</span>           <span class="mh">0x580</span>          <span class="mh">0x58f</span>    <span class="mi">3</span> <span class="n">Private</span>        <span class="n">READWRITE</span>
<span class="mh">0xfa800209f6d0</span> <span class="mi">5</span>           <span class="mh">0x430</span>          <span class="mh">0x4af</span>    <span class="mi">1</span> <span class="n">Private</span>        <span class="n">READWRITE</span>
<span class="mh">0xfa80020590f0</span> <span class="mi">5</span>           <span class="mh">0x5f0</span>          <span class="mh">0x66f</span>    <span class="mi">6</span> <span class="n">Private</span>        <span class="n">READWRITE</span>
<span class="mh">0xfa8001fea860</span> <span class="mi">4</span>         <span class="mh">0x735d0</span>        <span class="mh">0x7361a</span>    <span class="mi">4</span> <span class="n">Mapped</span>  <span class="n">Exe</span>    <span class="n">EXECUTE_WRITECOPY</span>    <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">apphelp</span><span class="p">.</span><span class="n">dll</span>
<span class="mh">0xfa80020a01c0</span> <span class="mi">5</span>           <span class="mh">0xb30</span>          <span class="mh">0xd2f</span>    <span class="mi">3</span> <span class="n">Private</span>        <span class="n">READWRITE</span>
<span class="mh">0xfa800209f680</span> <span class="mi">6</span>           <span class="mh">0xd30</span>          <span class="mh">0xf2f</span>    <span class="mi">3</span> <span class="n">Private</span>        <span class="n">READWRITE</span>
<span class="mh">0xfa8002087f00</span> <span class="mi">5</span>         <span class="mh">0x73650</span>        <span class="mh">0x73657</span>    <span class="mi">2</span> <span class="n">Mapped</span>  <span class="n">Exe</span>    <span class="n">EXECUTE_WRITECOPY</span>    <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">wow64cpu</span><span class="p">.</span><span class="n">dll</span>
<span class="mh">0xfa80020838a0</span> <span class="mi">2</span>         <span class="mh">0x7efb0</span>        <span class="mh">0x7efd2</span>    <span class="mi">0</span> <span class="n">Mapped</span>         <span class="n">READONLY</span>             <span class="n">Pagefile</span><span class="o">-</span><span class="n">backed</span> <span class="n">section</span>
<span class="mh">0xfa8002087c00</span> <span class="mi">3</span>         <span class="mh">0x760a0</span>        <span class="mh">0x7619f</span>    <span class="mi">3</span> <span class="n">Mapped</span>  <span class="n">Exe</span>    <span class="n">EXECUTE_WRITECOPY</span>    <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">kernel32</span><span class="p">.</span><span class="n">dll</span>
<span class="mh">0xfa800208af80</span> <span class="mi">4</span>         <span class="mh">0x74b50</span>        <span class="mh">0x74b95</span>    <span class="mi">3</span> <span class="n">Mapped</span>  <span class="n">Exe</span>    <span class="n">EXECUTE_WRITECOPY</span>    <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">KernelBase</span><span class="p">.</span><span class="n">dll</span>
<span class="mh">0xfa8002087cb0</span> <span class="mi">5</span>         <span class="mh">0x74a70</span>        <span class="mh">0x74a7b</span>    <span class="mi">2</span> <span class="n">Mapped</span>  <span class="n">Exe</span>    <span class="n">EXECUTE_WRITECOPY</span>    <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">cryptbase</span><span class="p">.</span><span class="n">dll</span>
<span class="mh">0xfa8002085e30</span> <span class="mi">6</span>         <span class="mh">0x736c0</span>        <span class="mh">0x736fe</span>    <span class="mi">3</span> <span class="n">Mapped</span>  <span class="n">Exe</span>    <span class="n">EXECUTE_WRITECOPY</span>    <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">wow64</span><span class="p">.</span><span class="n">dll</span>
<span class="mh">0xfa800208a900</span> <span class="mi">6</span>         <span class="mh">0x74a80</span>        <span class="mh">0x74adf</span>    <span class="mi">2</span> <span class="n">Mapped</span>  <span class="n">Exe</span>    <span class="n">EXECUTE_WRITECOPY</span>    <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">sspicli</span><span class="p">.</span><span class="n">dll</span>
<span class="mh">0xfa800208b900</span> <span class="mi">5</span>         <span class="mh">0x76000</span>        <span class="mh">0x7609f</span>    <span class="mi">5</span> <span class="n">Mapped</span>  <span class="n">Exe</span>    <span class="n">EXECUTE_WRITECOPY</span>    <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">advapi32</span><span class="p">.</span><span class="n">dll</span>
<span class="mh">0xfa8002086430</span> <span class="mi">4</span>         <span class="mh">0x76ce0</span>        <span class="mh">0x76dfe</span>    <span class="mi">0</span> <span class="n">Private</span> <span class="n">Exe</span>    <span class="n">EXECUTE_READWRITE</span>
<span class="mh">0xfa80020874f0</span> <span class="mi">5</span>         <span class="mh">0x767b0</span>        <span class="mh">0x7685b</span>    <span class="mi">8</span> <span class="n">Mapped</span>  <span class="n">Exe</span>    <span class="n">EXECUTE_WRITECOPY</span>    <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">msvcrt</span><span class="p">.</span><span class="n">dll</span>
<span class="mh">0xfa800208aaf0</span> <span class="mi">6</span>         <span class="mh">0x763b0</span>        <span class="mh">0x7649f</span>    <span class="mi">2</span> <span class="n">Mapped</span>  <span class="n">Exe</span>    <span class="n">EXECUTE_WRITECOPY</span>    <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">rpcrt4</span><span class="p">.</span><span class="n">dll</span>
<span class="mh">0xfa800208b1d0</span> <span class="mi">6</span>         <span class="mh">0x76860</span>        <span class="mh">0x76878</span>    <span class="mi">4</span> <span class="n">Mapped</span>  <span class="n">Exe</span>    <span class="n">EXECUTE_WRITECOPY</span>    <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">sechost</span><span class="p">.</span><span class="n">dll</span>
<span class="mh">0xfa80020839c0</span> <span class="mi">5</span>         <span class="mh">0x771b0</span>        <span class="mh">0x7735b</span>   <span class="mi">12</span> <span class="n">Mapped</span>  <span class="n">Exe</span>    <span class="n">EXECUTE_WRITECOPY</span>    <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span>
<span class="mh">0xfa8001d47490</span> <span class="mi">6</span>         <span class="mh">0x76f50</span>        <span class="mh">0x77049</span>    <span class="mi">0</span> <span class="n">Private</span> <span class="n">Exe</span>    <span class="n">EXECUTE_READWRITE</span>
<span class="mh">0xfa8002083930</span> <span class="mi">6</span>         <span class="mh">0x77390</span>        <span class="mh">0x7750f</span>    <span class="mi">9</span> <span class="n">Mapped</span>  <span class="n">Exe</span>    <span class="n">EXECUTE_WRITECOPY</span>    <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span>
<span class="mh">0xfa800209f5e0</span> <span class="mi">7</span>         <span class="mh">0x7efad</span>        <span class="mh">0x7efaf</span>    <span class="mi">3</span> <span class="n">Private</span>        <span class="n">READWRITE</span>
<span class="mh">0xfa800204f6b0</span> <span class="mi">3</span>         <span class="mh">0x7f0e0</span>        <span class="mh">0x7ffdf</span>    <span class="mi">0</span> <span class="n">Private</span>        <span class="n">READONLY</span>
<span class="mh">0xfa8002084980</span> <span class="mi">4</span>         <span class="mh">0x7efde</span>        <span class="mh">0x7efde</span>    <span class="mi">1</span> <span class="n">Private</span>        <span class="n">READWRITE</span>
<span class="mh">0xfa8002084350</span> <span class="mi">5</span>         <span class="mh">0x7efdb</span>        <span class="mh">0x7efdd</span>    <span class="mi">3</span> <span class="n">Private</span>        <span class="n">READWRITE</span>
<span class="mh">0xfa800209f9b0</span> <span class="mi">6</span>         <span class="mh">0x7efd5</span>        <span class="mh">0x7efd7</span>    <span class="mi">3</span> <span class="n">Private</span>        <span class="n">READWRITE</span>
<span class="mh">0xfa8002083800</span> <span class="mi">5</span>         <span class="mh">0x7efdf</span>        <span class="mh">0x7efdf</span>    <span class="mi">1</span> <span class="n">Private</span>        <span class="n">READWRITE</span>
<span class="mh">0xfa800208b260</span> <span class="mi">6</span>         <span class="mh">0x7efe0</span>        <span class="mh">0x7f0df</span>    <span class="mi">0</span> <span class="n">Mapped</span>         <span class="n">READONLY</span>             <span class="n">Pagefile</span><span class="o">-</span><span class="n">backed</span> <span class="n">section</span>
<span class="mh">0xfa800207c840</span> <span class="mi">4</span>         <span class="mh">0x7ffe0</span>        <span class="mh">0x7ffef</span>   <span class="o">-</span><span class="mi">1</span> <span class="n">Private</span>        <span class="n">READONLY</span>
<span class="mh">0xfa80020810b0</span> <span class="mi">5</span>         <span class="mh">0x7fff0</span>     <span class="mh">0x7fffffef</span>   <span class="o">-</span><span class="mi">1</span> <span class="n">Private</span>        <span class="n">READONLY</span>
</pre></div>
</div>

<h1 id="vaddump" class="anchor">vaddump</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.vadinfo.VADDump-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Dumps out the vad sections to a file</h2>
</div>


<h3>Plugin Arguments</h3>
<div class="plugins_args">
<table class='table table-condensed'>
<tbody>
<tr><td><p>dump_dir</p></td><td><p>Path suitable for dumping files. (Default: Use current directory)</p></td></tr><tr><td><p>eprocess</p></td><td><p>Kernel addresses of eprocess structs. (type: ArrayIntParser)</p></td></tr><tr><td><p>max_size</p></td><td><p>Maximum file size to dump. (type: IntParser)</p>
<ul>
<li>Default: 104857600</li>
</ul></td></tr><tr><td><p>method</p></td><td><p>Method to list processes. (type: ChoiceArray)</p>
<ul>
<li>
<p>Valid Choices:</p>
<ul>
<li>PsActiveProcessHead</li>
<li>CSRSS</li>
<li>PspCidTable</li>
<li>Sessions</li>
<li>Handles</li>
</ul>
</li>
<li>
<p>Default: PsActiveProcessHead, CSRSS, PspCidTable, Sessions, Handles</p>
</li>
</ul></td></tr><tr><td><p>offset</p></td><td><p>Only print the vad corresponding to this offset. (type: IntParser)</p></td></tr><tr><td><p>phys_eprocess</p></td><td><p>Physical addresses of eprocess structs. (type: ArrayIntParser)</p></td></tr><tr><td><p>pid</p></td><td><p>One or more pids of processes to select. (type: ArrayIntParser)</p></td></tr><tr><td><p>proc_regex</p></td><td><p>A regex to select a process by name. (type: RegEx)</p></td></tr><tr><td><p>regex</p></td><td><p>A regular expression to filter VAD filenames.</p></td></tr>
</tbody>
</table>
</div>


<p>Although you can dump a process executable using the <a href="ProcDump.html">procdump</a>
plugin, this only dumps the main executable. For further analysis of a process
it is useful to dump its entire address space. Since the address space is
discontiguous it is best to dump it out one vad segment at a time.</p>
<h3>Sample output</h3>
<div class="highlight"><pre><span class="n">win7_trial_64bit</span><span class="p">.</span><span class="n">dmp</span><span class="p">.</span><span class="n">E01</span> <span class="mi">23</span><span class="o">:</span><span class="mi">45</span><span class="o">:</span><span class="mo">01</span><span class="o">&gt;</span> <span class="n">vaddump</span> <span class="n">pid</span><span class="o">=</span><span class="mi">1232</span><span class="p">,</span> <span class="n">dump_dir</span><span class="o">=</span><span class="s">&quot;/tmp&quot;</span>
<span class="o">*************</span> <span class="n">grrservice</span><span class="p">.</span><span class="n">exe</span> <span class="p">(</span><span class="mi">1232</span><span class="p">)</span> <span class="o">*************</span>
    <span class="n">Start</span>           <span class="n">End</span>           <span class="n">Length</span>     <span class="n">Filename</span>                                                     <span class="n">Comment</span>
<span class="o">--------------</span> <span class="o">--------------</span> <span class="o">--------------</span> <span class="o">------------------------------------------------------------</span> <span class="o">-------</span>
<span class="mh">0x000073660000</span> <span class="mh">0x0000736bbfff</span>        <span class="mh">0x5bfff</span> <span class="n">grrservice</span><span class="p">.</span><span class="n">exe</span><span class="mf">.2f</span><span class="mi">684</span><span class="n">a70</span><span class="mf">.73660000</span><span class="o">-</span><span class="mi">736</span><span class="n">bbfff</span><span class="p">.</span><span class="n">dmp</span>                <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">wow64win</span><span class="p">.</span><span class="n">dll</span>
<span class="mh">0x000000400000</span> <span class="mh">0x000000427fff</span>        <span class="mh">0x27fff</span> <span class="n">grrservice</span><span class="p">.</span><span class="n">exe</span><span class="mf">.2f</span><span class="mi">684</span><span class="n">a70</span><span class="mf">.00400000</span><span class="o">-</span><span class="mf">00427ff</span><span class="n">f</span><span class="p">.</span><span class="n">dmp</span>                <span class="err">\</span><span class="n">Python27</span><span class="err">\</span><span class="n">grrservice</span><span class="p">.</span><span class="n">exe</span>
<span class="mh">0x000000290000</span> <span class="mh">0x000000293fff</span>         <span class="mh">0x3fff</span> <span class="n">grrservice</span><span class="p">.</span><span class="n">exe</span><span class="mf">.2f</span><span class="mi">684</span><span class="n">a70</span><span class="mf">.00290000</span><span class="o">-</span><span class="mf">00293ff</span><span class="n">f</span><span class="p">.</span><span class="n">dmp</span>                <span class="n">Pagefile</span><span class="o">-</span><span class="n">backed</span> <span class="n">section</span>
<span class="mh">0x000000050000</span> <span class="mh">0x00000008ffff</span>        <span class="mh">0x3ffff</span> <span class="n">grrservice</span><span class="p">.</span><span class="n">exe</span><span class="mf">.2f</span><span class="mi">684</span><span class="n">a70</span><span class="mf">.00050000</span><span class="o">-</span><span class="mf">0008ff</span><span class="n">ff</span><span class="p">.</span><span class="n">dmp</span>
<span class="mh">0x000000040000</span> <span class="mh">0x000000040fff</span>          <span class="mh">0xfff</span> <span class="n">grrservice</span><span class="p">.</span><span class="n">exe</span><span class="mf">.2f</span><span class="mi">684</span><span class="n">a70</span><span class="mf">.00040000</span><span class="o">-</span><span class="mf">00040ff</span><span class="n">f</span><span class="p">.</span><span class="n">dmp</span>                <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">apisetschema</span><span class="p">.</span><span class="n">dll</span>
<span class="mh">0x000000010000</span> <span class="mh">0x00000001ffff</span>         <span class="mh">0xffff</span> <span class="n">grrservice</span><span class="p">.</span><span class="n">exe</span><span class="mf">.2f</span><span class="mi">684</span><span class="n">a70</span><span class="mf">.00010000</span><span class="o">-</span><span class="mf">0001ff</span><span class="n">ff</span><span class="p">.</span><span class="n">dmp</span>                <span class="n">Pagefile</span><span class="o">-</span><span class="n">backed</span> <span class="n">section</span>
<span class="mh">0x000000090000</span> <span class="mh">0x00000028ffff</span>       <span class="mh">0x1fffff</span> <span class="n">grrservice</span><span class="p">.</span><span class="n">exe</span><span class="mf">.2f</span><span class="mi">684</span><span class="n">a70</span><span class="mf">.00090000</span><span class="o">-</span><span class="mf">0028ff</span><span class="n">ff</span><span class="p">.</span><span class="n">dmp</span>
<span class="mh">0x0000002b0000</span> <span class="mh">0x000000316fff</span>        <span class="mh">0x66fff</span> <span class="n">grrservice</span><span class="p">.</span><span class="n">exe</span><span class="mf">.2f</span><span class="mi">684</span><span class="n">a70</span><span class="mf">.002</span><span class="n">b0000</span><span class="o">-</span><span class="mf">00316ff</span><span class="n">f</span><span class="p">.</span><span class="n">dmp</span>                <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">locale</span><span class="p">.</span><span class="n">nls</span>
<span class="mh">0x0000002a0000</span> <span class="mh">0x0000002a0fff</span>          <span class="mh">0xfff</span> <span class="n">grrservice</span><span class="p">.</span><span class="n">exe</span><span class="mf">.2f</span><span class="mi">684</span><span class="n">a70</span><span class="mf">.002</span><span class="n">a0000</span><span class="o">-</span><span class="mo">002</span><span class="n">a0fff</span><span class="p">.</span><span class="n">dmp</span>
<span class="mh">0x000000360000</span> <span class="mh">0x00000039ffff</span>        <span class="mh">0x3ffff</span> <span class="n">grrservice</span><span class="p">.</span><span class="n">exe</span><span class="mf">.2f</span><span class="mi">684</span><span class="n">a70</span><span class="mf">.00360000</span><span class="o">-</span><span class="mf">0039ff</span><span class="n">ff</span><span class="p">.</span><span class="n">dmp</span>
<span class="mh">0x0000003a0000</span> <span class="mh">0x0000003dffff</span>        <span class="mh">0x3ffff</span> <span class="n">grrservice</span><span class="p">.</span><span class="n">exe</span><span class="mf">.2f</span><span class="mi">684</span><span class="n">a70</span><span class="mf">.003</span><span class="n">a0000</span><span class="o">-</span><span class="mo">003</span><span class="n">dffff</span><span class="p">.</span><span class="n">dmp</span>
<span class="mh">0x000000830000</span> <span class="mh">0x00000092ffff</span>        <span class="mh">0xfffff</span> <span class="n">grrservice</span><span class="p">.</span><span class="n">exe</span><span class="mf">.2f</span><span class="mi">684</span><span class="n">a70</span><span class="mf">.00830000</span><span class="o">-</span><span class="mf">0092ff</span><span class="n">ff</span><span class="p">.</span><span class="n">dmp</span>
<span class="mh">0x000000580000</span> <span class="mh">0x00000058ffff</span>         <span class="mh">0xffff</span> <span class="n">grrservice</span><span class="p">.</span><span class="n">exe</span><span class="mf">.2f</span><span class="mi">684</span><span class="n">a70</span><span class="mf">.00580000</span><span class="o">-</span><span class="mf">0058ff</span><span class="n">ff</span><span class="p">.</span><span class="n">dmp</span>
<span class="mh">0x000000430000</span> <span class="mh">0x0000004affff</span>        <span class="mh">0x7ffff</span> <span class="n">grrservice</span><span class="p">.</span><span class="n">exe</span><span class="mf">.2f</span><span class="mi">684</span><span class="n">a70</span><span class="mf">.00430000</span><span class="o">-</span><span class="mo">004</span><span class="n">affff</span><span class="p">.</span><span class="n">dmp</span>
<span class="mh">0x0000005f0000</span> <span class="mh">0x00000066ffff</span>        <span class="mh">0x7ffff</span> <span class="n">grrservice</span><span class="p">.</span><span class="n">exe</span><span class="mf">.2f</span><span class="mi">684</span><span class="n">a70</span><span class="mf">.005f</span><span class="mo">0000</span><span class="o">-</span><span class="mf">0066ff</span><span class="n">ff</span><span class="p">.</span><span class="n">dmp</span>
<span class="mh">0x0000735d0000</span> <span class="mh">0x00007361afff</span>        <span class="mh">0x4afff</span> <span class="n">grrservice</span><span class="p">.</span><span class="n">exe</span><span class="mf">.2f</span><span class="mi">684</span><span class="n">a70</span><span class="mf">.735</span><span class="n">d0000</span><span class="o">-</span><span class="mi">7361</span><span class="n">afff</span><span class="p">.</span><span class="n">dmp</span>                <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">apphelp</span><span class="p">.</span><span class="n">dll</span>
<span class="mh">0x000000b30000</span> <span class="mh">0x000000d2ffff</span>       <span class="mh">0x1fffff</span> <span class="n">grrservice</span><span class="p">.</span><span class="n">exe</span><span class="mf">.2f</span><span class="mi">684</span><span class="n">a70</span><span class="mf">.00</span><span class="n">b30000</span><span class="o">-</span><span class="mo">00</span><span class="n">d2ffff</span><span class="p">.</span><span class="n">dmp</span>
<span class="mh">0x000000d30000</span> <span class="mh">0x000000f2ffff</span>       <span class="mh">0x1fffff</span> <span class="n">grrservice</span><span class="p">.</span><span class="n">exe</span><span class="mf">.2f</span><span class="mi">684</span><span class="n">a70</span><span class="mf">.00</span><span class="n">d30000</span><span class="o">-</span><span class="mf">00f2ff</span><span class="n">ff</span><span class="p">.</span><span class="n">dmp</span>
<span class="mh">0x000073650000</span> <span class="mh">0x000073657fff</span>         <span class="mh">0x7fff</span> <span class="n">grrservice</span><span class="p">.</span><span class="n">exe</span><span class="mf">.2f</span><span class="mi">684</span><span class="n">a70</span><span class="mf">.73650000</span><span class="o">-</span><span class="mf">73657ff</span><span class="n">f</span><span class="p">.</span><span class="n">dmp</span>                <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">wow64cpu</span><span class="p">.</span><span class="n">dll</span>
<span class="mh">0x00007efb0000</span> <span class="mh">0x00007efd2fff</span>        <span class="mh">0x22fff</span> <span class="n">grrservice</span><span class="p">.</span><span class="n">exe</span><span class="mf">.2f</span><span class="mi">684</span><span class="n">a70</span><span class="mf">.7</span><span class="n">efb0000</span><span class="o">-</span><span class="mi">7</span><span class="n">efd2fff</span><span class="p">.</span><span class="n">dmp</span>                <span class="n">Pagefile</span><span class="o">-</span><span class="n">backed</span> <span class="n">section</span>
<span class="mh">0x0000760a0000</span> <span class="mh">0x00007619ffff</span>        <span class="mh">0xfffff</span> <span class="n">grrservice</span><span class="p">.</span><span class="n">exe</span><span class="mf">.2f</span><span class="mi">684</span><span class="n">a70</span><span class="mf">.760</span><span class="n">a0000</span><span class="o">-</span><span class="mf">7619ff</span><span class="n">ff</span><span class="p">.</span><span class="n">dmp</span>                <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">kernel32</span><span class="p">.</span><span class="n">dll</span>
<span class="mh">0x000074b50000</span> <span class="mh">0x000074b95fff</span>        <span class="mh">0x45fff</span> <span class="n">grrservice</span><span class="p">.</span><span class="n">exe</span><span class="mf">.2f</span><span class="mi">684</span><span class="n">a70</span><span class="mf">.74</span><span class="n">b50000</span><span class="o">-</span><span class="mi">74</span><span class="n">b95fff</span><span class="p">.</span><span class="n">dmp</span>                <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">KernelBase</span><span class="p">.</span><span class="n">dll</span>
<span class="mh">0x000074a70000</span> <span class="mh">0x000074a7bfff</span>         <span class="mh">0xbfff</span> <span class="n">grrservice</span><span class="p">.</span><span class="n">exe</span><span class="mf">.2f</span><span class="mi">684</span><span class="n">a70</span><span class="mf">.74</span><span class="n">a70000</span><span class="o">-</span><span class="mi">74</span><span class="n">a7bfff</span><span class="p">.</span><span class="n">dmp</span>                <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">cryptbase</span><span class="p">.</span><span class="n">dll</span>
<span class="mh">0x0000736c0000</span> <span class="mh">0x0000736fefff</span>        <span class="mh">0x3efff</span> <span class="n">grrservice</span><span class="p">.</span><span class="n">exe</span><span class="mf">.2f</span><span class="mi">684</span><span class="n">a70</span><span class="mf">.736</span><span class="n">c0000</span><span class="o">-</span><span class="mf">736f</span><span class="n">efff</span><span class="p">.</span><span class="n">dmp</span>                <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">wow64</span><span class="p">.</span><span class="n">dll</span>
<span class="mh">0x000074a80000</span> <span class="mh">0x000074adffff</span>        <span class="mh">0x5ffff</span> <span class="n">grrservice</span><span class="p">.</span><span class="n">exe</span><span class="mf">.2f</span><span class="mi">684</span><span class="n">a70</span><span class="mf">.74</span><span class="n">a80000</span><span class="o">-</span><span class="mi">74</span><span class="n">adffff</span><span class="p">.</span><span class="n">dmp</span>                <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">sspicli</span><span class="p">.</span><span class="n">dll</span>
<span class="mh">0x000076000000</span> <span class="mh">0x00007609ffff</span>        <span class="mh">0x9ffff</span> <span class="n">grrservice</span><span class="p">.</span><span class="n">exe</span><span class="mf">.2f</span><span class="mi">684</span><span class="n">a70</span><span class="mf">.76000000</span><span class="o">-</span><span class="mf">7609ff</span><span class="n">ff</span><span class="p">.</span><span class="n">dmp</span>                <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">advapi32</span><span class="p">.</span><span class="n">dll</span>
<span class="mh">0x000076ce0000</span> <span class="mh">0x000076dfefff</span>       <span class="mh">0x11efff</span> <span class="n">grrservice</span><span class="p">.</span><span class="n">exe</span><span class="mf">.2f</span><span class="mi">684</span><span class="n">a70</span><span class="mf">.76</span><span class="n">ce0000</span><span class="o">-</span><span class="mi">76</span><span class="n">dfefff</span><span class="p">.</span><span class="n">dmp</span>
<span class="mh">0x0000767b0000</span> <span class="mh">0x00007685bfff</span>        <span class="mh">0xabfff</span> <span class="n">grrservice</span><span class="p">.</span><span class="n">exe</span><span class="mf">.2f</span><span class="mi">684</span><span class="n">a70</span><span class="mf">.767</span><span class="n">b0000</span><span class="o">-</span><span class="mi">7685</span><span class="n">bfff</span><span class="p">.</span><span class="n">dmp</span>                <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">msvcrt</span><span class="p">.</span><span class="n">dll</span>
<span class="mh">0x0000763b0000</span> <span class="mh">0x00007649ffff</span>        <span class="mh">0xeffff</span> <span class="n">grrservice</span><span class="p">.</span><span class="n">exe</span><span class="mf">.2f</span><span class="mi">684</span><span class="n">a70</span><span class="mf">.763</span><span class="n">b0000</span><span class="o">-</span><span class="mf">7649ff</span><span class="n">ff</span><span class="p">.</span><span class="n">dmp</span>                <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">rpcrt4</span><span class="p">.</span><span class="n">dll</span>
<span class="mh">0x000076860000</span> <span class="mh">0x000076878fff</span>        <span class="mh">0x18fff</span> <span class="n">grrservice</span><span class="p">.</span><span class="n">exe</span><span class="mf">.2f</span><span class="mi">684</span><span class="n">a70</span><span class="mf">.76860000</span><span class="o">-</span><span class="mf">76878ff</span><span class="n">f</span><span class="p">.</span><span class="n">dmp</span>                <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">sechost</span><span class="p">.</span><span class="n">dll</span>
<span class="mh">0x0000771b0000</span> <span class="mh">0x00007735bfff</span>       <span class="mh">0x1abfff</span> <span class="n">grrservice</span><span class="p">.</span><span class="n">exe</span><span class="mf">.2f</span><span class="mi">684</span><span class="n">a70</span><span class="mf">.771</span><span class="n">b0000</span><span class="o">-</span><span class="mi">7735</span><span class="n">bfff</span><span class="p">.</span><span class="n">dmp</span>                <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span>
<span class="mh">0x000076f50000</span> <span class="mh">0x000077049fff</span>        <span class="mh">0xf9fff</span> <span class="n">grrservice</span><span class="p">.</span><span class="n">exe</span><span class="mf">.2f</span><span class="mi">684</span><span class="n">a70</span><span class="mf">.76f</span><span class="mi">50000</span><span class="o">-</span><span class="mf">77049ff</span><span class="n">f</span><span class="p">.</span><span class="n">dmp</span>
<span class="mh">0x000077390000</span> <span class="mh">0x00007750ffff</span>       <span class="mh">0x17ffff</span> <span class="n">grrservice</span><span class="p">.</span><span class="n">exe</span><span class="mf">.2f</span><span class="mi">684</span><span class="n">a70</span><span class="mf">.77390000</span><span class="o">-</span><span class="mf">7750ff</span><span class="n">ff</span><span class="p">.</span><span class="n">dmp</span>                <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span>
<span class="mh">0x00007efad000</span> <span class="mh">0x00007efaffff</span>         <span class="mh">0x2fff</span> <span class="n">grrservice</span><span class="p">.</span><span class="n">exe</span><span class="mf">.2f</span><span class="mi">684</span><span class="n">a70</span><span class="mf">.7</span><span class="n">efad000</span><span class="o">-</span><span class="mi">7</span><span class="n">efaffff</span><span class="p">.</span><span class="n">dmp</span>
<span class="mh">0x00007f0e0000</span> <span class="mh">0x00007ffdffff</span>       <span class="mh">0xefffff</span> <span class="n">grrservice</span><span class="p">.</span><span class="n">exe</span><span class="mf">.2f</span><span class="mi">684</span><span class="n">a70</span><span class="mf">.7f0e0000</span><span class="o">-</span><span class="mf">7ff</span><span class="n">dffff</span><span class="p">.</span><span class="n">dmp</span>
<span class="mh">0x00007efde000</span> <span class="mh">0x00007efdefff</span>          <span class="mh">0xfff</span> <span class="n">grrservice</span><span class="p">.</span><span class="n">exe</span><span class="mf">.2f</span><span class="mi">684</span><span class="n">a70</span><span class="mf">.7</span><span class="n">efde000</span><span class="o">-</span><span class="mi">7</span><span class="n">efdefff</span><span class="p">.</span><span class="n">dmp</span>
<span class="mh">0x00007efdb000</span> <span class="mh">0x00007efddfff</span>         <span class="mh">0x2fff</span> <span class="n">grrservice</span><span class="p">.</span><span class="n">exe</span><span class="mf">.2f</span><span class="mi">684</span><span class="n">a70</span><span class="mf">.7</span><span class="n">efdb000</span><span class="o">-</span><span class="mi">7</span><span class="n">efddfff</span><span class="p">.</span><span class="n">dmp</span>
<span class="mh">0x00007efd5000</span> <span class="mh">0x00007efd7fff</span>         <span class="mh">0x2fff</span> <span class="n">grrservice</span><span class="p">.</span><span class="n">exe</span><span class="mf">.2f</span><span class="mi">684</span><span class="n">a70</span><span class="mf">.7</span><span class="n">efd5000</span><span class="o">-</span><span class="mi">7</span><span class="n">efd7fff</span><span class="p">.</span><span class="n">dmp</span>
<span class="mh">0x00007efdf000</span> <span class="mh">0x00007efdffff</span>          <span class="mh">0xfff</span> <span class="n">grrservice</span><span class="p">.</span><span class="n">exe</span><span class="mf">.2f</span><span class="mi">684</span><span class="n">a70</span><span class="mf">.7</span><span class="n">efdf000</span><span class="o">-</span><span class="mi">7</span><span class="n">efdffff</span><span class="p">.</span><span class="n">dmp</span>
<span class="mh">0x00007efe0000</span> <span class="mh">0x00007f0dffff</span>        <span class="mh">0xfffff</span> <span class="n">grrservice</span><span class="p">.</span><span class="n">exe</span><span class="mf">.2f</span><span class="mi">684</span><span class="n">a70</span><span class="mf">.7</span><span class="n">efe0000</span><span class="o">-</span><span class="mf">7f</span><span class="mi">0</span><span class="n">dffff</span><span class="p">.</span><span class="n">dmp</span>                <span class="n">Pagefile</span><span class="o">-</span><span class="n">backed</span> <span class="n">section</span>
<span class="mh">0x00007ffe0000</span> <span class="mh">0x00007ffeffff</span>         <span class="mh">0xffff</span> <span class="n">grrservice</span><span class="p">.</span><span class="n">exe</span><span class="mf">.2f</span><span class="mi">684</span><span class="n">a70</span><span class="mf">.7f</span><span class="n">fe0000</span><span class="o">-</span><span class="mf">7ff</span><span class="n">effff</span><span class="p">.</span><span class="n">dmp</span>
<span class="mh">0x00007fff0000</span> <span class="mh">0x07fffffeffff</span>  <span class="mh">0x7ff7fffffff</span> <span class="n">grrservice</span><span class="p">.</span><span class="n">exe</span><span class="mf">.2f</span><span class="mi">684</span><span class="n">a70</span><span class="mf">.7f</span><span class="n">ff0000</span><span class="o">-</span><span class="mf">7ff</span><span class="n">fffeffff</span><span class="p">.</span><span class="n">dmp</span>
<span class="p">...</span>
<span class="n">win7_trial_64bit</span><span class="p">.</span><span class="n">dmp</span><span class="p">.</span><span class="n">E01</span> <span class="mi">23</span><span class="o">:</span><span class="mi">45</span><span class="o">:</span><span class="mi">13</span><span class="o">&gt;</span> <span class="n">peinfo</span> <span class="n">executable</span><span class="o">=</span><span class="s">&quot;/tmp/grrservice.exe.2f684a70.760a0000-7619ffff.dmp&quot;</span>
<span class="n">Attribute</span>            <span class="n">Value</span>
<span class="o">--------------------</span> <span class="o">-----</span>
<span class="n">Machine</span>              <span class="n">IMAGE_FILE_MACHINE_I386</span>
<span class="n">TimeDateStamp</span>        <span class="mi">2011</span><span class="o">-</span><span class="mo">07</span><span class="o">-</span><span class="mi">16</span> <span class="mo">04</span><span class="o">:</span><span class="mi">33</span><span class="o">:</span><span class="mi">08</span><span class="o">+</span><span class="mo">0000</span>
<span class="n">Characteristics</span>      <span class="n">IMAGE_FILE_32BIT_MACHINE</span><span class="p">,</span> <span class="n">IMAGE_FILE_DLL</span><span class="p">,</span>
                     <span class="n">IMAGE_FILE_EXECUTABLE_IMAGE</span>
<span class="n">GUID</span><span class="o">/</span><span class="n">Age</span>             <span class="mi">0</span><span class="n">EB73428EC4E430FB8EDD94C5946855B2</span>
<span class="n">PDB</span>                  <span class="n">wkernel32</span><span class="p">.</span><span class="n">pdb</span>
<span class="n">MajorOperatingSystemVersion</span> <span class="mi">6</span>
<span class="n">MinorOperatingSystemVersion</span> <span class="mi">1</span>
<span class="n">MajorImageVersion</span>    <span class="mi">6</span>
<span class="n">MinorImageVersion</span>    <span class="mi">1</span>
<span class="n">MajorSubsystemVersion</span> <span class="mi">6</span>
<span class="n">MinorSubsystemVersion</span> <span class="mi">1</span>

<span class="n">Sections</span> <span class="p">(</span><span class="n">Relative</span> <span class="n">to</span> <span class="mh">0x760A0000</span><span class="p">)</span><span class="o">:</span>
<span class="n">Perm</span> <span class="n">Name</span>          <span class="n">VMA</span>            <span class="n">Size</span>
<span class="o">----</span> <span class="o">--------</span> <span class="o">--------------</span> <span class="o">--------------</span>
<span class="n">xr</span><span class="o">-</span>  <span class="p">.</span><span class="n">text</span>    <span class="mh">0x000000010000</span> <span class="mh">0x0000000c0000</span>
<span class="o">-</span><span class="n">rw</span>  <span class="p">.</span><span class="n">data</span>    <span class="mh">0x0000000d0000</span> <span class="mh">0x000000010000</span>
<span class="o">-</span><span class="n">r</span><span class="o">-</span>  <span class="p">.</span><span class="n">rsrc</span>    <span class="mh">0x0000000e0000</span> <span class="mh">0x000000010000</span>
<span class="o">-</span><span class="n">r</span><span class="o">-</span>  <span class="p">.</span><span class="n">reloc</span>   <span class="mh">0x0000000f0000</span> <span class="mh">0x000000010000</span>

<span class="n">Data</span> <span class="n">Directories</span><span class="o">:</span>
<span class="o">-</span>                                             <span class="n">VMA</span>            <span class="n">Size</span>
<span class="o">----------------------------------------</span> <span class="o">--------------</span> <span class="o">--------------</span>
<span class="n">IMAGE_DIRECTORY_ENTRY_EXPORT</span>             <span class="mh">0x00007615f728</span> <span class="mh">0x00000000aa1a</span>
<span class="n">IMAGE_DIRECTORY_ENTRY_IMPORT</span>             <span class="mh">0x00007616a144</span> <span class="mh">0x0000000001f4</span>
<span class="n">IMAGE_DIRECTORY_ENTRY_RESOURCE</span>           <span class="mh">0x000076180000</span> <span class="mh">0x000000000520</span>
<span class="n">IMAGE_DIRECTORY_ENTRY_EXCEPTION</span>          <span class="mh">0x000000000000</span> <span class="mh">0x000000000000</span>
<span class="n">IMAGE_DIRECTORY_ENTRY_SECURITY</span>           <span class="mh">0x000000000000</span> <span class="mh">0x000000000000</span>
<span class="n">IMAGE_DIRECTORY_ENTRY_BASERELOC</span>          <span class="mh">0x000076190000</span> <span class="mh">0x00000000ad3c</span>
<span class="n">IMAGE_DIRECTORY_ENTRY_DEBUG</span>              <span class="mh">0x00007616feb8</span> <span class="mh">0x000000000038</span>
<span class="n">IMAGE_DIRECTORY_ENTRY_COPYRIGHT</span>          <span class="mh">0x000000000000</span> <span class="mh">0x000000000000</span>
<span class="n">IMAGE_DIRECTORY_ENTRY_GLOBALPTR</span>          <span class="mh">0x000000000000</span> <span class="mh">0x000000000000</span>
<span class="n">IMAGE_DIRECTORY_ENTRY_TLS</span>                <span class="mh">0x000000000000</span> <span class="mh">0x000000000000</span>
<span class="n">IMAGE_DIRECTORY_ENTRY_LOAD_CONFIG</span>        <span class="mh">0x000076123330</span> <span class="mh">0x000000000040</span>
<span class="n">IMAGE_DIRECTORY_ENTRY_BOUND_IMPORT</span>       <span class="mh">0x000000000000</span> <span class="mh">0x000000000000</span>
<span class="n">IMAGE_DIRECTORY_ENTRY_IAT</span>                <span class="mh">0x0000760b0000</span> <span class="mh">0x000000000ddc</span>
<span class="n">IMAGE_DIRECTORY_ENTRY_DELAY_IMPORT</span>       <span class="mh">0x000000000000</span> <span class="mh">0x000000000000</span>
<span class="n">IMAGE_DIRECTORY_ENTRY_COM_DESCRIPTOR</span>     <span class="mh">0x000000000000</span> <span class="mh">0x000000000000</span>
<span class="n">IMAGE_DIRECTORY_ENTRY_RESERVED</span>           <span class="mh">0x000000000000</span> <span class="mh">0x000000000000</span>

<span class="n">Import</span> <span class="n">Directory</span> <span class="p">(</span><span class="n">Original</span><span class="p">)</span><span class="o">:</span>
<span class="n">Name</span>                                               <span class="n">Ord</span>
<span class="o">--------------------------------------------------</span> <span class="o">-----</span>
<span class="n">API</span><span class="o">-</span><span class="n">MS</span><span class="o">-</span><span class="n">Win</span><span class="o">-</span><span class="n">Core</span><span class="o">-</span><span class="n">RtlSupport</span><span class="o">-</span><span class="n">L1</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mf">0.</span><span class="n">dll</span><span class="o">!</span><span class="n">RtlUnwind</span>    <span class="mi">3</span>
<span class="n">API</span><span class="o">-</span><span class="n">MS</span><span class="o">-</span><span class="n">Win</span><span class="o">-</span><span class="n">Core</span><span class="o">-</span><span class="n">RtlSupport</span><span class="o">-</span><span class="n">L1</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mf">0.</span><span class="n">dll</span><span class="o">!</span><span class="n">RtlCaptureContext</span> <span class="mi">0</span>
<span class="n">API</span><span class="o">-</span><span class="n">MS</span><span class="o">-</span><span class="n">Win</span><span class="o">-</span><span class="n">Core</span><span class="o">-</span><span class="n">RtlSupport</span><span class="o">-</span><span class="n">L1</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mf">0.</span><span class="n">dll</span><span class="o">!</span><span class="n">RtlCaptureStackBackTrace</span> <span class="mi">1</span>
<span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span><span class="o">!</span><span class="n">NtCreateEvent</span>                            <span class="mi">227</span>
<span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span><span class="o">!</span><span class="n">NtDuplicateObject</span>                        <span class="mi">275</span>
<span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span><span class="o">!</span><span class="n">RtlConvertSidToUnicodeString</span>             <span class="mi">686</span>
<span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span><span class="o">!</span><span class="n">NtNotifyChangeKey</span>                        <span class="mi">337</span>
<span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span><span class="o">!</span><span class="n">RtlRunOnceInitialize</span>                     <span class="mi">1151</span>
</pre></div>
</div>

<h1 id="vadinfo" class="anchor">vadinfo</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.vadinfo.VADInfo-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Dump the VAD info</h2>
</div>


<h3>Plugin Arguments</h3>
<div class="plugins_args">
<table class='table table-condensed'>
<tbody>
<tr><td><p>eprocess</p></td><td><p>Kernel addresses of eprocess structs. (type: ArrayIntParser)</p></td></tr><tr><td><p>method</p></td><td><p>Method to list processes. (type: ChoiceArray)</p>
<ul>
<li>
<p>Valid Choices:</p>
<ul>
<li>PsActiveProcessHead</li>
<li>CSRSS</li>
<li>PspCidTable</li>
<li>Sessions</li>
<li>Handles</li>
</ul>
</li>
<li>
<p>Default: PsActiveProcessHead, CSRSS, PspCidTable, Sessions, Handles</p>
</li>
</ul></td></tr><tr><td><p>phys_eprocess</p></td><td><p>Physical addresses of eprocess structs. (type: ArrayIntParser)</p></td></tr><tr><td><p>pid</p></td><td><p>One or more pids of processes to select. (type: ArrayIntParser)</p></td></tr><tr><td><p>proc_regex</p></td><td><p>A regex to select a process by name. (type: RegEx)</p></td></tr>
</tbody>
</table>
</div>



</div>

<h1 id="vadmap" class="anchor">vadmap</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.vadinfo.VADMap-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Inspect each page in the VAD and report its status.</h2>
<p>This allows us to see the address translation status of each page in the
VAD.</p>
</div>


<h3>Plugin Arguments</h3>
<div class="plugins_args">
<table class='table table-condensed'>
<tbody>
<tr><td><p>end</p></td><td><p>Stop reading at this offset. (type: IntParser)</p>
<ul>
<li>Default: 9223372036854775808</li>
</ul></td></tr><tr><td><p>eprocess</p></td><td><p>Kernel addresses of eprocess structs. (type: ArrayIntParser)</p></td></tr><tr><td><p>method</p></td><td><p>Method to list processes. (type: ChoiceArray)</p>
<ul>
<li>
<p>Valid Choices:</p>
<ul>
<li>PsActiveProcessHead</li>
<li>CSRSS</li>
<li>PspCidTable</li>
<li>Sessions</li>
<li>Handles</li>
</ul>
</li>
<li>
<p>Default: PsActiveProcessHead, CSRSS, PspCidTable, Sessions, Handles</p>
</li>
</ul></td></tr><tr><td><p>phys_eprocess</p></td><td><p>Physical addresses of eprocess structs. (type: ArrayIntParser)</p></td></tr><tr><td><p>pid</p></td><td><p>One or more pids of processes to select. (type: ArrayIntParser)</p></td></tr><tr><td><p>proc_regex</p></td><td><p>A regex to select a process by name. (type: RegEx)</p></td></tr><tr><td><p>start</p></td><td><p>Start reading from this page. (type: IntParser)</p>
<ul>
<li>Default: 0</li>
</ul></td></tr><tr><td><p>verbosity</p></td><td><p>An integer reflecting the amount of desired output: 0 = quiet, 10 = noisy. (type: IntParser)</p>
<ul>
<li>Default: 1</li>
</ul></td></tr>
</tbody>
</table>
</div>



</div>

<h1 id="vadtree" class="anchor">vadtree</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.vadinfo.VADTree-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Walk the VAD tree and display in tree format</h2>
</div>


<h3>Plugin Arguments</h3>
<div class="plugins_args">
<table class='table table-condensed'>
<tbody>
<tr><td><p>eprocess</p></td><td><p>Kernel addresses of eprocess structs. (type: ArrayIntParser)</p></td></tr><tr><td><p>method</p></td><td><p>Method to list processes. (type: ChoiceArray)</p>
<ul>
<li>
<p>Valid Choices:</p>
<ul>
<li>PsActiveProcessHead</li>
<li>CSRSS</li>
<li>PspCidTable</li>
<li>Sessions</li>
<li>Handles</li>
</ul>
</li>
<li>
<p>Default: PsActiveProcessHead, CSRSS, PspCidTable, Sessions, Handles</p>
</li>
</ul></td></tr><tr><td><p>phys_eprocess</p></td><td><p>Physical addresses of eprocess structs. (type: ArrayIntParser)</p></td></tr><tr><td><p>pid</p></td><td><p>One or more pids of processes to select. (type: ArrayIntParser)</p></td></tr><tr><td><p>proc_regex</p></td><td><p>A regex to select a process by name. (type: RegEx)</p></td></tr>
</tbody>
</table>
</div>



</div>

<h1 id="vadwalk" class="anchor">vadwalk</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.vadinfo.VADWalk-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Walk the VAD tree</h2>
</div>


<h3>Plugin Arguments</h3>
<div class="plugins_args">
<table class='table table-condensed'>
<tbody>
<tr><td><p>eprocess</p></td><td><p>Kernel addresses of eprocess structs. (type: ArrayIntParser)</p></td></tr><tr><td><p>method</p></td><td><p>Method to list processes. (type: ChoiceArray)</p>
<ul>
<li>
<p>Valid Choices:</p>
<ul>
<li>PsActiveProcessHead</li>
<li>CSRSS</li>
<li>PspCidTable</li>
<li>Sessions</li>
<li>Handles</li>
</ul>
</li>
<li>
<p>Default: PsActiveProcessHead, CSRSS, PspCidTable, Sessions, Handles</p>
</li>
</ul></td></tr><tr><td><p>phys_eprocess</p></td><td><p>Physical addresses of eprocess structs. (type: ArrayIntParser)</p></td></tr><tr><td><p>pid</p></td><td><p>One or more pids of processes to select. (type: ArrayIntParser)</p></td></tr><tr><td><p>proc_regex</p></td><td><p>A regex to select a process by name. (type: RegEx)</p></td></tr>
</tbody>
</table>
</div>



</div>

<h1 id="version_modules" class="anchor">version_modules</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.modules.ModVersions-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Try to determine the versions for all kernel drivers.</h2>
</div>


<h3>Plugin Arguments</h3>
<div class="plugins_args">
<table class='table table-condensed'>
<tbody>
<tr><td><p>name_regex</p></td><td><p>Filter module names by this regex.</p></td></tr>
</tbody>
</table>
</div>


<p>Each time a windows binary is built using the Microsoft Visual Studio compiler
suite a new unique GUID is generated for this file. The GUID is used to link the
executable and the pdb file (which contains debugging symbols).</p>
<p>The GUID is embedded in the executable in an <code>RSDS</code> record (i.e. the record has
a signature starting with the letters <code>RSDS</code>). Rekall can scan for this
signature in order to identify the executable version.</p>
<p>This plugin scans for the version string for each loaded kernel module. Use the
<a href="VersionScan.html">version_scan</a> module to search for RSDS signatures in
physical memory.</p>
<h3>Sample output</h3>
<div class="highlight"><pre><span class="n">win7_trial_64bit</span><span class="p">.</span><span class="n">dmp</span><span class="p">.</span><span class="n">E01</span> <span class="mi">23</span><span class="o">:</span><span class="mi">48</span><span class="o">:</span><span class="mi">26</span><span class="o">&gt;</span> <span class="n">version_modules</span>
  <span class="n">Offset</span> <span class="p">(</span><span class="n">V</span><span class="p">)</span>   <span class="n">Name</span>                 <span class="n">GUID</span><span class="o">/</span><span class="n">Version</span>                     <span class="n">PDB</span>
<span class="o">--------------</span> <span class="o">--------------------</span> <span class="o">--------------------------------</span> <span class="o">------------------------------</span>
<span class="mh">0xf800027f4b0c</span> <span class="n">ntoskrnl</span><span class="p">.</span><span class="n">exe</span>         <span class="n">C07170995AA8441B952E3B9AE3F3754B2</span> <span class="n">ntkrnlmp</span><span class="p">.</span><span class="n">pdb</span>
<span class="mh">0xf8000262deb4</span> <span class="n">hal</span><span class="p">.</span><span class="n">dll</span>              <span class="mi">0</span><span class="n">C72B43B8AC64E22AB88B564E69330372</span> <span class="n">hal</span><span class="p">.</span><span class="n">pdb</span>
<span class="mh">0xf88002d34af4</span> <span class="n">wanarp</span><span class="p">.</span><span class="n">sys</span>           <span class="mi">7</span><span class="n">BA2309F029F4DE7878AED80636C2D132</span> <span class="n">wanarp</span><span class="p">.</span><span class="n">pdb</span>
<span class="mh">0xf8800183eed4</span> <span class="n">TDI</span><span class="p">.</span><span class="n">SYS</span>              <span class="n">C519554437F04B63BC39FF4E69578DC42</span> <span class="n">tdi</span><span class="p">.</span><span class="n">pdb</span>
<span class="mh">0xf88000d95b24</span> <span class="n">volmgrx</span><span class="p">.</span><span class="n">sys</span>          <span class="n">C047BA32ABCB4A948CBB8930F352B1032</span> <span class="n">volmgrx</span><span class="p">.</span><span class="n">pdb</span>
<span class="mh">0xf88003de7c60</span> <span class="n">dump_dumpfve</span><span class="p">.</span><span class="n">sys</span>     <span class="n">A2CC4DFB86424750871BCB8E1E841E3C1</span> <span class="n">dumpfve</span><span class="p">.</span><span class="n">pdb</span>
<span class="mh">0xf880019d4e00</span> <span class="n">watchdog</span><span class="p">.</span><span class="n">sys</span>         <span class="mi">79</span><span class="n">ACBD31D1BD428A8311AD9D5DCDEAA61</span> <span class="n">watchdog</span><span class="p">.</span><span class="n">pdb</span>
<span class="mh">0xf8800111004c</span> <span class="n">cng</span><span class="p">.</span><span class="n">sys</span>              <span class="n">F0AA00E320D4468A9D3F7078E2AE2BF52</span> <span class="n">cng</span><span class="p">.</span><span class="n">pdb</span>
<span class="mh">0xf88002c2e648</span> <span class="n">csc</span><span class="p">.</span><span class="n">sys</span>              <span class="mi">56</span><span class="n">B7C3B9040B47D9821E6A57E6A5AE4A1</span> <span class="n">csc</span><span class="p">.</span><span class="n">pdb</span>
<span class="mh">0xf88000c02f48</span> <span class="n">CI</span><span class="p">.</span><span class="n">dll</span>               <span class="mf">5F</span><span class="mi">1</span><span class="n">BDC2205AC402CB0F09FC7CF17A3701</span> <span class="n">ci</span><span class="p">.</span><span class="n">pdb</span>
<span class="mh">0xf88003c3f2dc</span> <span class="n">USBD</span><span class="p">.</span><span class="n">SYS</span>             <span class="n">BE6200B21204452DADDF85CED51A5BDE1</span> <span class="n">usbd</span><span class="p">.</span><span class="n">pdb</span>
<span class="mh">0xf88002d0a1fc</span> <span class="n">netbios</span><span class="p">.</span><span class="n">sys</span>          <span class="mi">084</span><span class="n">EB51DBDE844CF9EAD3B5FDFABDC721</span> <span class="n">netbios</span><span class="p">.</span><span class="n">pdb</span>
<span class="mh">0xf88000cc80a0</span> <span class="n">mcupdate</span><span class="p">.</span><span class="n">dll</span>         <span class="mi">8</span><span class="n">C7A27566CD54FB9A00AF26B5BF941651</span> <span class="n">mcupdate_GenuineIntel</span><span class="p">.</span><span class="n">pdb</span>
<span class="mh">0xf8800145c920</span> <span class="n">ndis</span><span class="p">.</span><span class="n">sys</span>             <span class="mi">40</span><span class="n">D6C85AC9F74887A652601839A1F56D2</span> <span class="n">ndis</span><span class="p">.</span><span class="n">pdb</span>
<span class="mh">0xf880019eb04c</span> <span class="n">rdpencdd</span><span class="p">.</span><span class="n">sys</span>         <span class="n">C299649119AC4CC888F37C32A216781A1</span> <span class="n">RDPENCDD</span><span class="p">.</span><span class="n">pdb</span>
<span class="mh">0xf88003814d08</span> <span class="n">srv</span><span class="p">.</span><span class="n">sys</span>              <span class="mi">20</span><span class="n">C4A475BE954C10997EAD2C623E40C32</span> <span class="n">srv</span><span class="p">.</span><span class="n">pdb</span>
<span class="mh">0xf88003a52c10</span> <span class="n">raspptp</span><span class="p">.</span><span class="n">sys</span>          <span class="n">C9106AFB80474EFCAF9384DA26CC35622</span> <span class="n">raspptp</span><span class="p">.</span><span class="n">pdb</span>
<span class="mh">0xf880019b42ec</span> <span class="n">VIDEOPRT</span><span class="p">.</span><span class="n">SYS</span>         <span class="mi">1</span><span class="n">B0FC2CC31FE41CEBEAC4ABB7375EA481</span> <span class="n">videoprt</span><span class="p">.</span><span class="n">pdb</span>
<span class="mh">0xf88000fda340</span> <span class="n">PCIIDEX</span><span class="p">.</span><span class="n">SYS</span>          <span class="mi">2</span><span class="n">C4F146DA2774ACEA1D5499284DDDB271</span> <span class="n">pciidex</span><span class="p">.</span><span class="n">pdb</span>
<span class="mh">0xf88003c2962c</span> <span class="n">HIDCLASS</span><span class="p">.</span><span class="n">SYS</span>         <span class="mi">1815</span><span class="n">DD7E268B4BB9BCD5226204CFEC9C1</span> <span class="n">hidclass</span><span class="p">.</span><span class="n">pdb</span>
<span class="mh">0xf88000fd105c</span> <span class="n">intelide</span><span class="p">.</span><span class="n">sys</span>         <span class="n">B72598DF61A84806B7AC593BA128300C1</span> <span class="n">intelide</span><span class="p">.</span><span class="n">pdb</span>
<span class="mh">0xf88003a37320</span> <span class="n">raspppoe</span><span class="p">.</span><span class="n">sys</span>         <span class="mi">39</span><span class="n">B224364B9042649CA0CDB8270762931</span> <span class="n">raspppoe</span><span class="p">.</span><span class="n">pdb</span>
<span class="mh">0xf88000e040ec</span> <span class="n">atapi</span><span class="p">.</span><span class="n">sys</span>            <span class="mf">4E82</span><span class="n">D8C0AB5A41799B979539D280167D1</span> <span class="n">atapi</span><span class="p">.</span><span class="n">pdb</span>
<span class="mh">0xf88002cba464</span> <span class="n">netbt</span><span class="p">.</span><span class="n">sys</span>            <span class="mi">840</span><span class="n">D3E3C828C4D60A905DC82D8CBF8FA2</span> <span class="n">netbt</span><span class="p">.</span><span class="n">pdb</span>
<span class="mh">0xf880011f647c</span> <span class="n">kbdclass</span><span class="p">.</span><span class="n">sys</span>         <span class="n">D5F7E088FAF44B60A3774197A9ADEEC01</span> <span class="n">kbdclass</span><span class="p">.</span><span class="n">pdb</span>
<span class="mh">0xf88000e361f0</span> <span class="n">amdxata</span><span class="p">.</span><span class="n">sys</span>          <span class="mi">8</span><span class="n">D1A5FFBAEEA4D388F8B7B3B9378C3671</span> <span class="n">amdxata</span><span class="p">.</span><span class="n">pdb</span>
<span class="mh">0xf880031abb04</span> <span class="n">srvnet</span><span class="p">.</span><span class="n">sys</span>           <span class="mi">608</span><span class="n">D364BC5524794BD70C89773BD51EF2</span> <span class="n">srvnet</span><span class="p">.</span><span class="n">pdb</span>
<span class="mh">0xf880028fa614</span> <span class="n">bowser</span><span class="p">.</span><span class="n">sys</span>           <span class="mf">26F</span><span class="n">AC99A52F8439E9A5B8B4B37F90D5B1</span> <span class="n">bowser</span><span class="p">.</span><span class="n">pdb</span>
<span class="mh">0xf88002ddb6f4</span> <span class="n">dfsc</span><span class="p">.</span><span class="n">sys</span>             <span class="mf">827F</span><span class="mi">5</span><span class="n">D478C94478299C7FEC7FEE4DAFA1</span> <span class="n">dfsc</span><span class="p">.</span><span class="n">pdb</span>
<span class="mh">0xf880011bf9dc</span> <span class="n">fvevol</span><span class="p">.</span><span class="n">sys</span>           <span class="mf">2F</span><span class="n">BEA7856251499B87C65A29FC51E6191</span> <span class="n">fvevol</span><span class="p">.</span><span class="n">pdb</span>
<span class="mh">0xf80000bc13b0</span> <span class="n">kdcom</span><span class="p">.</span><span class="n">dll</span>            <span class="n">ACC6A823A2844D22B68CD5D48D42381F2</span> <span class="n">kdcom</span><span class="p">.</span><span class="n">pdb</span>
<span class="mh">0xf88000fbe5a4</span> <span class="n">volmgr</span><span class="p">.</span><span class="n">sys</span>           <span class="mf">39E92</span><span class="n">F60716140C38C723CDF21B956CD2</span> <span class="n">volmgr</span><span class="p">.</span><span class="n">pdb</span>
<span class="mh">0xf88000f5c108</span> <span class="n">msisadrv</span><span class="p">.</span><span class="n">sys</span>         <span class="mi">09</span><span class="n">A612E6691847ED98E4F36F3CC9EE641</span> <span class="n">msisadrv</span><span class="p">.</span><span class="n">pdb</span>
<span class="mh">0xf8800183127c</span> <span class="n">tdx</span><span class="p">.</span><span class="n">sys</span>              <span class="n">FB912A34EB1A44EC9F65E250879944B52</span> <span class="n">tdx</span><span class="p">.</span><span class="n">pdb</span>
<span class="mh">0xf8800119f10c</span> <span class="n">rdyboost</span><span class="p">.</span><span class="n">sys</span>         <span class="mf">20E6</span><span class="n">E50C6F9B42589E18D96AD84608DB1</span> <span class="n">rdyboost</span><span class="p">.</span><span class="n">pdb</span>
</pre></div>
</div>

<h1 id="virt_map" class="anchor">virt_map</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.misc.WinVirtualMap-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Prints the Windows Kernel Virtual Address Map.</h2>
<p>On 32 bit windows, the kernel virtual address space can be managed
dynamically. This plugin shows each region and what it is used for.</p>
<p>Note that on 64 bit windows the address space is large enough to not worry
about it. In that case, the offsets and regions are hard coded.</p>
<p>http://www.woodmann.com/forum/entry.php?219-Using-nt!_MiSystemVaType-to-navigate-dynamic-kernel-address-space-in-Windows7</p>
</div>




</div>

<h1 id="vtop" class="anchor">vtop</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.pfn.VtoP-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Prints information about the virtual to physical translation.</h2>
</div>


<h3>Plugin Arguments</h3>
<div class="plugins_args">
<table class='table table-condensed'>
<tbody>
<tr><td><p>eprocess</p></td><td><p>Kernel addresses of eprocess structs. (type: ArrayIntParser)</p></td></tr><tr><td><p>method</p></td><td><p>Method to list processes. (type: ChoiceArray)</p>
<ul>
<li>
<p>Valid Choices:</p>
<ul>
<li>PsActiveProcessHead</li>
<li>CSRSS</li>
<li>PspCidTable</li>
<li>Sessions</li>
<li>Handles</li>
</ul>
</li>
<li>
<p>Default: PsActiveProcessHead, CSRSS, PspCidTable, Sessions, Handles</p>
</li>
</ul></td></tr><tr><td><p>phys_eprocess</p></td><td><p>Physical addresses of eprocess structs. (type: ArrayIntParser)</p></td></tr><tr><td><p>pid</p></td><td><p>One or more pids of processes to select. (type: ArrayIntParser)</p></td></tr><tr><td><p>proc_regex</p></td><td><p>A regex to select a process by name. (type: RegEx)</p></td></tr><tr><td><p>virtual_address</p></td><td><p>The Virtual Address to examine. (type: SymbolAddress)</p></td></tr>
</tbody>
</table>
</div>


<p>This plugin displays all the page translation steps needed to resolve a virtual
address to a physical address.</p>
<h3>Notes</h3>
<ol>
<li>The plugin uses the current default address space to calculate the
   mapping. If you want to resolve the virtual address in a process space you
   will need to switch the process context first (i.e. use the
   <a href="SetProcessContext.html">cc</a> plugin.</li>
</ol>
<h3>Sample output</h3>
<div class="highlight"><pre><span class="n">win7_trial_64bit</span><span class="p">.</span><span class="n">dmp</span><span class="p">.</span><span class="n">E01</span> <span class="mi">23</span><span class="o">:</span><span class="mi">52</span><span class="o">:</span><span class="mi">53</span><span class="o">&gt;</span> <span class="n">vtop</span> <span class="mh">0xfa8000a2d060</span>
<span class="n">Virtual</span> <span class="mh">0xfa8000a2d060</span> <span class="n">Page</span> <span class="n">Directory</span> <span class="mh">0x00187000</span>
<span class="n">pml4e</span><span class="err">@</span> <span class="mh">0x187fa8</span> <span class="o">=</span> <span class="mh">0x3c00863</span>
<span class="n">pdpte</span><span class="err">@</span> <span class="mh">0x3c00000</span> <span class="o">=</span> <span class="mh">0x3c01863</span>
<span class="n">pde</span><span class="err">@</span> <span class="mh">0x3c01028</span> <span class="o">=</span> <span class="mh">0x30c009e3</span>
<span class="n">Large</span> <span class="n">page</span> <span class="n">mapped</span> <span class="mh">0x30e2d060</span>
<span class="n">Physical</span> <span class="n">Address</span> <span class="mh">0x30c2d060</span>
</pre></div>
</div>

<h1 id="win32k_autodetect" class="anchor">win32k_autodetect</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.gui.autodetect.Win32kAutodetect-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Automatically detect win32k struct layout.</h2>
</div>




</div>

<h1 id="yarascan" class="anchor">yarascan</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.malware.yarascan.WinYaraScan-class.html">View Source</a>


<div class="plugin_description">
<div class="abstract">
<h2>Scan using yara signatures.</h2>
</div>


<h3>Plugin Arguments</h3>
<div class="plugins_args">
<table class='table table-condensed'>
<tbody>
<tr><td><p>binary_string</p></td><td><p>A binary string (encoded as hex) to search for. e.g. 000102[1-200]0506</p></td></tr><tr><td><p>context</p></td><td><p>Context to print after the hit. (type: IntParser)</p>
<ul>
<li>Default: 64</li>
</ul></td></tr><tr><td><p>eprocess</p></td><td><p>Kernel addresses of eprocess structs. (type: ArrayIntParser)</p></td></tr><tr><td><p>hits</p></td><td><p>Quit after finding this many hits. (type: IntParser)</p>
<ul>
<li>Default: 100000000.0</li>
</ul></td></tr><tr><td><p>limit</p></td><td><p>The length of data to search.</p>
<ul>
<li>Default: 18446744073709551616</li>
</ul></td></tr><tr><td><p>method</p></td><td><p>Method to list processes. (type: ChoiceArray)</p>
<ul>
<li>
<p>Valid Choices:</p>
<ul>
<li>PsActiveProcessHead</li>
<li>CSRSS</li>
<li>PspCidTable</li>
<li>Sessions</li>
<li>Handles</li>
</ul>
</li>
<li>
<p>Default: PsActiveProcessHead, CSRSS, PspCidTable, Sessions, Handles</p>
</li>
</ul></td></tr><tr><td><p>phys_eprocess</p></td><td><p>Physical addresses of eprocess structs. (type: ArrayIntParser)</p></td></tr><tr><td><p>pid</p></td><td><p>One or more pids of processes to select. (type: ArrayIntParser)</p></td></tr><tr><td><p>pre_context</p></td><td><p>Context to print before the hit. (type: IntParser)</p>
<ul>
<li>Default: 0</li>
</ul></td></tr><tr><td><p>proc_regex</p></td><td><p>A regex to select a process by name. (type: RegEx)</p></td></tr><tr><td><p>scan_physical</p></td><td><p>If specified we scan the physcial address space. Note that by default we scan the address space of the specified processes (or if no process selectors are specified, the default AS). (type: Boolean)</p>
<ul>
<li>Default: False</li>
</ul></td></tr><tr><td><p>start</p></td><td><p>Start searching from this offset. (type: IntParser)</p>
<ul>
<li>Default: 0</li>
</ul></td></tr><tr><td><p>string</p></td><td><p>A verbatim string to search for.</p></td></tr><tr><td><p>yara_expression</p></td><td><p>If provided we scan for this yara expression.</p></td></tr><tr><td><p>yara_file</p></td><td><p>The yara signature file to read.</p></td></tr>
</tbody>
</table>
</div>



</div>

  </div>
</div>
</div>
  <div class="footer">
    <div class="container">
      <p class="text-muted">
        &copy; 2015 Google Inc.
        Rekall is licensed under the The GPL License.
        Pmem is licensed under the Apache license.
        <a href="#" class="pull-right text-muted">Back to top</a>
      </p>
    </div>
  </div>

  <script>
   $(".activate_tooltip").tooltip();
   $("body").scrollspy({
     target: ".bs-docs-sidebar",
     offset: 40
   });
  </script>
  </div>
 </body>
</html>

