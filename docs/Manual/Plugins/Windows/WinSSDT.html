
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Rekall Memory Forensic Framework</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Rekall Memory Forensic Framework">

    <link href="/css/bootstrap.min.css" rel="stylesheet">
    <link href="/css/rekall.css" rel="stylesheet">
    <link href="/css/asciidoc.css" rel="stylesheet">
    <link href="/css/font-awesome.css" rel="stylesheet">
    <script src="//code.jquery.com/jquery-1.11.0.min.js"></script>
    <script src="//code.jquery.com/ui/1.10.4/jquery-ui.js"></script>
    <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="//code.jquery.com/ui/1.10.4/themes/smoothness/jquery-ui.css">

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></sc\
ript>
    <![endif]-->
  </head>

  <body>


  <div class="background">
   <header class="header">
    <div class="navbar navbar-fixed-top navbar-inverse">
     <div class="navbar-inner">
      <div class="container">
       <a class="navbar-brand" href="/"
          style="padding-top: 0px; padding-bottom: 0px;"
          >
          <img src="/img/Rekall-small.png" class="small_logo"></img>
       </a>
       <ul class="nav navbar-nav navbar-collapse collapse">

        <li class="divider-vertical"></li>
        
    <li class="">
     <a href="/index.html">
      Home
     </a>
    </li>
    
        <li class="divider-vertical"></li>
        
    <li class="">
     <a href="/about.html">
      About
     </a>
    </li>
    
        <li class="divider-vertical"></li>
        
    <li class=" dropdown">
     <a class="dropdown-toggle"
      id="dropdownMenuReleases"
      data-toggle="dropdown"
      aria-expanded="true">
    Releases
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuReleases">

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/Releases/releases-1.2.1.html">Version 1.2.1 Col de la Croix.</a></li>

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/Releases/releases-1.3.1.html">Version 1.3.2 Dammastock.</a></li>

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/Releases/releases-1.4.0.html">Version 1.4.0 Etzel.</a></li>

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/Releases/releases-1.5.2.html">Version 1.5.2 Furka..</a></li>

  </ul>
 </li>

        <li class="divider-vertical"></li>
        
    <li class=" dropdown">
     <a class="dropdown-toggle"
      id="dropdownMenuDocumentation"
      data-toggle="dropdown"
      aria-expanded="true">
    Documentation
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuDocumentation">

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/docs/Manual">Rekall User Manual</a></li>

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/docs/Developers">Developer Documentation.</a></li>

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/docs/GUI">Rekall GUI</a></li>

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/docs/MemoryAnalysis.html">Memory Analysis Course</a></li>

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/docs/References">References</a></li>

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/docs/Tools">The Pmem Memory acquisition suite.</a></li>

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/docs/index.html"></a></li>

  </ul>
 </li>

        <li class="divider-vertical"></li>
        
    <li class=" dropdown">
     <a class="dropdown-toggle"
      id="dropdownMenuDiscuss"
      data-toggle="dropdown"
      aria-expanded="true">
    Discuss
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuDiscuss">

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/Discuss/blog.html">The Rekall Blog</a></li>

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/Discuss/github.html">GitHub</a></li>

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/Discuss/index.html"></a></li>

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/Discuss/issue.html">Issue Tracker</a></li>

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/Discuss/mailinglist.html">Mailing List</a></li>

  </ul>
 </li>

        <li class="divider-vertical"></li>
        
    <li class="">
     <a href="/faq.html">
      FAQ
     </a>
    </li>
    
       <li>
        <a href="https://github.com/google/rekall/edit/gh-pages/docs/Manual/Plugins/Windows/WinSSDT.md?message=Describe%20your%20change..."
           data-toggle="tooltip"
           data-placement="bottom"
           title="Improve this page"
           class="improve-docs activate_tooltip">
         <i class="glyphicon glyphicon-edit"></i>
        </a>
       </ul>

       <form class="navbar-search col-md-3 docs-search" role="search"
             action="/search.html">
       <span class="glyphicon glyphicon-search search-icon"></span>
       <input type="text" name="q" data-i-search-input="true"
         class="search-query"
         placeholder="Site Search">
       </form>
      </div>
     </div>
    </div>
   </header>

<div class="container-fluid page-background container">
<div class="main">
  <div class="col-md-2">
    
<ul class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix rekall-side-nav">
 <a href="/docs/Manual/Plugins/index.html" class="btn btn-default btn-lg btn-block">
  <span class="glyphicon glyphicon-arrow-left"></span> Plugins
 </a>

 <a href='/docs/Manual/Plugins/Windows/index.html' class="btn btn-default btn-lg btn-block">
   Windows
 </a>
 <p>

<ul class='nav nav-pills nav-stacked'>
        <li>
          <a href='/docs/Manual/Plugins/Windows/Win32_GUI' class="category-directory-link">
            Win32_GUI
          </a>
        </li>
        
        <li>
          <a href='/docs/Manual/Plugins/Windows/Registry' class="category-directory-link">
            Registry
          </a>
        </li>
        
        <li classes=''>
          <a href='#analyze_struct' class="category-link">
            analyze_struct
          </a>
        </li>
        
        <li classes=''>
          <a href='#callbacks' class="category-link">
            callbacks
          </a>
        </li>
        
        <li classes=''>
          <a href='#check_pehooks' class="category-link">
            check_pehooks
          </a>
        </li>
        
        <li classes=''>
          <a href='#cmdscan' class="category-link">
            cmdscan
          </a>
        </li>
        
        <li classes=''>
          <a href='#connections' class="category-link">
            connections
          </a>
        </li>
        
        <li classes=''>
          <a href='#connscan' class="category-link">
            connscan
          </a>
        </li>
        
        <li classes=''>
          <a href='#consoles' class="category-link">
            consoles
          </a>
        </li>
        
        <li classes=''>
          <a href='#devicetree' class="category-link">
            devicetree
          </a>
        </li>
        
        <li classes=''>
          <a href='#dis' class="category-link">
            dis
          </a>
        </li>
        
        <li classes=''>
          <a href='#dlldump' class="category-link">
            dlldump
          </a>
        </li>
        
        <li classes=''>
          <a href='#dlllist' class="category-link">
            dlllist
          </a>
        </li>
        
        <li classes=''>
          <a href='#driverirp' class="category-link">
            driverirp
          </a>
        </li>
        
        <li classes=''>
          <a href='#driverscan' class="category-link">
            driverscan
          </a>
        </li>
        
        <li classes=''>
          <a href='#dtbscan' class="category-link">
            dtbscan
          </a>
        </li>
        
        <li classes=''>
          <a href='#dumpfiles' class="category-link">
            dumpfiles
          </a>
        </li>
        
        <li classes=''>
          <a href='#evtlogs' class="category-link">
            evtlogs
          </a>
        </li>
        
        <li classes=''>
          <a href='#filescan' class="category-link">
            filescan
          </a>
        </li>
        
        <li classes=''>
          <a href='#find_dtb' class="category-link">
            find_dtb
          </a>
        </li>
        
        <li classes=''>
          <a href='#fls' class="category-link">
            fls
          </a>
        </li>
        
        <li classes=''>
          <a href='#handles' class="category-link">
            handles
          </a>
        </li>
        
        <li classes=''>
          <a href='#hooks_eat' class="category-link">
            hooks_eat
          </a>
        </li>
        
        <li classes=''>
          <a href='#hooks_iat' class="category-link">
            hooks_iat
          </a>
        </li>
        
        <li classes=''>
          <a href='#hooks_inline' class="category-link">
            hooks_inline
          </a>
        </li>
        
        <li classes=''>
          <a href='#imageinfo' class="category-link">
            imageinfo
          </a>
        </li>
        
        <li classes=''>
          <a href='#impscan' class="category-link">
            impscan
          </a>
        </li>
        
        <li classes=''>
          <a href='#kdbgscan' class="category-link">
            kdbgscan
          </a>
        </li>
        
        <li classes=''>
          <a href='#kpcr' class="category-link">
            kpcr
          </a>
        </li>
        
        <li classes=''>
          <a href='#ldrmodules' class="category-link">
            ldrmodules
          </a>
        </li>
        
        <li classes=''>
          <a href='#malfind' class="category-link">
            malfind
          </a>
        </li>
        
        <li classes=''>
          <a href='#memdump' class="category-link">
            memdump
          </a>
        </li>
        
        <li classes=''>
          <a href='#memmap' class="category-link">
            memmap
          </a>
        </li>
        
        <li classes=''>
          <a href='#moddump' class="category-link">
            moddump
          </a>
        </li>
        
        <li classes=''>
          <a href='#modscan' class="category-link">
            modscan
          </a>
        </li>
        
        <li classes=''>
          <a href='#modules' class="category-link">
            modules
          </a>
        </li>
        
        <li classes=''>
          <a href='#mutantscan' class="category-link">
            mutantscan
          </a>
        </li>
        
        <li classes=''>
          <a href='#netscan' class="category-link">
            netscan
          </a>
        </li>
        
        <li classes=''>
          <a href='#netstat' class="category-link">
            netstat
          </a>
        </li>
        
        <li classes=''>
          <a href='#netstat' class="category-link">
            netstat
          </a>
        </li>
        
        <li classes=''>
          <a href='#object_tree' class="category-link">
            object_tree
          </a>
        </li>
        
        <li classes=''>
          <a href='#object_types' class="category-link">
            object_types
          </a>
        </li>
        
        <li classes=''>
          <a href='#pagefiles' class="category-link">
            pagefiles
          </a>
        </li>
        
        <li classes=''>
          <a href='#pas2vas' class="category-link">
            pas2vas
          </a>
        </li>
        
        <li classes=''>
          <a href='#pedump' class="category-link">
            pedump
          </a>
        </li>
        
        <li classes=''>
          <a href='#peinfo' class="category-link">
            peinfo
          </a>
        </li>
        
        <li classes=''>
          <a href='#pfn' class="category-link">
            pfn
          </a>
        </li>
        
        <li classes=''>
          <a href='#phys_map' class="category-link">
            phys_map
          </a>
        </li>
        
        <li classes=''>
          <a href='#pool_tracker' class="category-link">
            pool_tracker
          </a>
        </li>
        
        <li classes=''>
          <a href='#pools' class="category-link">
            pools
          </a>
        </li>
        
        <li classes=''>
          <a href='#procdump' class="category-link">
            procdump
          </a>
        </li>
        
        <li classes=''>
          <a href='#procinfo' class="category-link">
            procinfo
          </a>
        </li>
        
        <li classes=''>
          <a href='#pslist' class="category-link">
            pslist
          </a>
        </li>
        
        <li classes=''>
          <a href='#psscan' class="category-link">
            psscan
          </a>
        </li>
        
        <li classes=''>
          <a href='#pstree' class="category-link">
            pstree
          </a>
        </li>
        
        <li classes=''>
          <a href='#psxview' class="category-link">
            psxview
          </a>
        </li>
        
        <li classes=''>
          <a href='#ptov' class="category-link">
            ptov
          </a>
        </li>
        
        <li classes=''>
          <a href='#raw2dmp' class="category-link">
            raw2dmp
          </a>
        </li>
        
        <li classes=''>
          <a href='#services' class="category-link">
            services
          </a>
        </li>
        
        <li classes=''>
          <a href='#simple_certscan' class="category-link">
            simple_certscan
          </a>
        </li>
        
        <li classes=''>
          <a href='#sockets' class="category-link">
            sockets
          </a>
        </li>
        
        <li classes='active'>
          <a href='#ssdt' class="category-link">
            ssdt
          </a>
        </li>
        
        <li classes=''>
          <a href='#svcscan' class="category-link">
            svcscan
          </a>
        </li>
        
        <li classes=''>
          <a href='#symlinkscan' class="category-link">
            symlinkscan
          </a>
        </li>
        
        <li classes=''>
          <a href='#thrdscan' class="category-link">
            thrdscan
          </a>
        </li>
        
        <li classes=''>
          <a href='#threads' class="category-link">
            threads
          </a>
        </li>
        
        <li classes=''>
          <a href='#timers' class="category-link">
            timers
          </a>
        </li>
        
        <li classes=''>
          <a href='#tokens' class="category-link">
            tokens
          </a>
        </li>
        
        <li classes=''>
          <a href='#unloaded_modules' class="category-link">
            unloaded_modules
          </a>
        </li>
        
        <li classes=''>
          <a href='#vacbs' class="category-link">
            vacbs
          </a>
        </li>
        
        <li classes=''>
          <a href='#vad' class="category-link">
            vad
          </a>
        </li>
        
        <li classes=''>
          <a href='#vaddump' class="category-link">
            vaddump
          </a>
        </li>
        
        <li classes=''>
          <a href='#vadmap' class="category-link">
            vadmap
          </a>
        </li>
        
        <li classes=''>
          <a href='#version_modules' class="category-link">
            version_modules
          </a>
        </li>
        
        <li classes=''>
          <a href='#virt_map' class="category-link">
            virt_map
          </a>
        </li>
        
        <li classes=''>
          <a href='#vtop' class="category-link">
            vtop
          </a>
        </li>
        
        <li classes=''>
          <a href='#win32k_autodetect' class="category-link">
            win32k_autodetect
          </a>
        </li>
        
        <li classes=''>
          <a href='#yarascan' class="category-link">
            yarascan
          </a>
        </li>
        </ul></ul>
  </div>

  <div class="col-md-10">
    

<nav class="navbar navbar-default plugins" role="navigation">

  <ul class="nav navbar-nav navbar-left">
    <li class="active">
       <a href="/docs/Manual/Plugins/Windows/Sockets.html">
         <span class="glyphicon glyphicon-arrow-left"></span>
         sockets
       </a>
    </li>
  </ul>


  <ul class="nav navbar-nav navbar-right">
    <li class="active">
       <a href="/docs/Manual/Plugins/Windows/SvcScan.html">
          svcscan
          <span class="glyphicon glyphicon-arrow-right"></span>
       </a>
    </li>
  </ul>

</nav>


<h1 id="#ssdt" class="anchor" >ssdt</h1>

<a class="btn btn-default epydoc_link"
   href="/epydocs/rekall.plugins.windows.ssdt.WinSSDT-class.html">View Source</a>


<div class="abstract">
<h2>Enumerate the SSDT.</h2>
</div>



<p>The System Service Descritor Table is the main interface to the kernel from user
space. In the past, malware used to install hook in this SSDT in order to
intercept userspace-&gt;kernel calls. In more recent versions of Windows, Microsoft
has implemented <strong>PatchGuard</strong> specifically to prevent these kinds of
hooks. Therefore, its very rare to see these kinds of hooks any more.</p>
<p>The <strong>ssdt</strong> plugin enumerates the the SSDT table and resolves the addresses
back to the names of the functions. Windows has two SSDTs - one for the kernel
and one for the GUI subsystem (win32k driver).</p>
<p>An intalled ssdt hook will appear as a function in a different module (or an
unknown module).</p>
<h3>Sample output</h3>
<pre class="highlight"><code>win7.elf 15:35:25&gt; ssdt
************ Table 0 @ 0xf80002691b00 ************
    Entry          Target     Symbol
-------------- -------------- ------
           0x0 0xf80002aa2190 nt!NtMapUserPhysicalPagesScatter
           0x1 0xf80002988a00 nt!NtWaitForSingleObject
           0x2 0xf80002688dd0 nt!NtCallbackReturn
           0x3 0xf800029abb10 nt!NtReadFile
           0x4 0xf800029a9bb0 nt!NtDeviceIoControlFile
           0x5 0xf800029a4ee0 nt!NtWriteFile
           0x6 0xf8000294adc0 nt!NtRemoveIoCompletion
           0x7 0xf80002947f10 nt!NtReleaseSemaphore
           0x8 0xf8000299fda0 nt!NtReplyWaitReceivePort
           0x9 0xf80002a71e20 nt!NtReplyPort
...
         0x18c 0xf8000297a92c nt!NtWaitForKeyedEvent
         0x18d 0xf800026a1010 nt!NtWaitForWorkViaWorkerFactory
         0x18e 0xf80002ab0b00 nt!NtWaitHighEventPair
         0x18f 0xf80002ab0b90 nt!NtWaitLowEventPair
         0x190 0xf80002678fc4 nt!NtWorkerFactoryWorkerReady
************ Table 1 @ 0xf960001a1c00 ************
    Entry          Target     Symbol
-------------- -------------- ------
           0x0 0xf96000195580 win32k!NtUserGetThreadState
           0x1 0xf96000192630 win32k!NtUserPeekMessage
           0x2 0xf960001a3c6c win32k!NtUserCallOneParam
           0x3 0xf960001b1dd0 win32k!NtUserGetKeyState
           0x4 0xf960001ab1ac win32k!NtUserInvalidateRect
           0x5 0xf960001a3e70 win32k!NtUserCallNoParam
           0x6 0xf9600019b5a0 win32k!NtUserGetMessage
           0x7 0xf9600017fbec win32k!NtUserMessageCall
...
         0x334 0xf96000153b80 win32k!NtUserValidateHandleSecure
         0x335 0xf960001acd9c win32k!NtUserWaitForInputIdle
         0x336 0xf960001a6304 win32k!NtUserWaitForMsgAndEvent
         0x337 0xf960001acef0 win32k!NtUserWindowFromPhysicalPoint
         0x338 0xf960001ae06c win32k!NtUserYieldTask
         0x339 0xf960001a6b84 win32k!NtUserSetClassLongPtr
         0x33a 0xf96000181ca0 win32k!NtUserSetWindowLongPtr</code></pre>

<p>

<nav class="navbar navbar-default plugins" role="navigation">

  <ul class="nav navbar-nav navbar-left">
    <li class="active">
       <a href="/docs/Manual/Plugins/Windows/Sockets.html">
         <span class="glyphicon glyphicon-arrow-left"></span>
         sockets
       </a>
    </li>
  </ul>


  <ul class="nav navbar-nav navbar-right">
    <li class="active">
       <a href="/docs/Manual/Plugins/Windows/SvcScan.html">
          svcscan
          <span class="glyphicon glyphicon-arrow-right"></span>
       </a>
    </li>
  </ul>

</nav>


  </div>
</div>
</div>
  <div class="footer">
    <div class="container">
      <p class="text-muted">
        &copy; 2015 Google Inc.
        Rekall is licensed under the The GPL License.
        Pmem is licensed under the Apache license.
        <a href="#" class="pull-right text-muted">Back to top</a>
      </p>
    </div>
  </div>

  <script>
   $(".activate_tooltip").tooltip();
   $("body").scrollspy({
     target: ".bs-docs-sidebar",
     offset: 40
   });
  </script>
  </div>
 </body>
</html>

