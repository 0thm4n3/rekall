
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Rekall Memory Forensic Framework</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Rekall Memory Forensic Framework">

    <link href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px;
      }
    </style>
    <link href="/css/rekall.css" rel="stylesheet">
    <link href="/css/asciidoc.css" rel="stylesheet">
    <link href="/css/treeview.css" rel="stylesheet">
    <script src="//code.jquery.com/jquery-1.11.0.min.js"></script>
    <script src="//code.jquery.com/ui/1.10.4/jquery-ui.js"></script>
    <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="//code.jquery.com/ui/1.10.4/themes/smoothness/jquery-ui.css">

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></sc\
ript>
    <![endif]-->
  </head>

  <body>



   <nav class="navbar navbar-inverse navbar-fixed-top"
     role="navigation">
     <div class="container-fluid">
       <div class="navbar-header">
         <a class="navbar-brand" href="#">Rekall Memory Forensic Framework</a>
       </div>

       <div class="navbar-collapse collapse">
         <ul class="nav navbar-nav">

        <li>
          <a class="" href="/index.html">
            Home
          </a>
        </li>

        <li>
          <a class="" href="/about.html">
            About
          </a>
        </li>

        <li>
          <a class="" href="/blog.html">
            Blog
          </a>
        </li>

        <li>
          <a class="" href="/docs.html">
            Documentation
          </a>
        </li>

        <li>
          <a class="" href="/downloads.html">
            Downloads
          </a>
        </li>

        <li>
          <a class="" href="/faq.html">
            FAQ
          </a>
        </li>

         </ul>
         <form class="navbar-form navbar-right" role="search" action="/search.html">
           <div class="form-group">
             <input type="text" name="q" class="form-control" placeholder="Site Search">
           </div>
           <button type="submit" class="btn btn-default">
             <span class="glyphicon glyphicon-search"></span>
           </button>
         </form>
       </div> <!-- navbar-collapse -->
     </div> <!-- container-fluid -->
   </nav>

<div class="container-fluid">
<div class="row">
  <div class="col-md-2">
    
 <a href="/docs/Manual/Plugins/index.html" class="btn btn-default btn-lg btn-block">
  <span class="glyphicon glyphicon-arrow-left"></span> Plugins
 </a>

 <a href='/docs/Manual/Plugins/Windows/index.html' class="btn btn-default btn-lg btn-block">
   Windows
 </a>
 <p>
 <div class='css-treeview'>
   <ul class='nav nav-stacked'>
<li>
  <input type="checkbox" id="item-/Registry" />
  <label for="item-/Registry" class="category">
    Registry
  </label>
<ul class='nav nav-stacked'>
<li>
   <a href='/docs/Manual/Plugins/Windows/Registry/GetServiceSids.html' class="tree-link "  title="getservicesids">
      getservicesids
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/Registry/HashDump.html' class="tree-link "  title="hashdump">
      hashdump
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/Registry/HiveDump.html' class="tree-link "  title="hivedump">
      hivedump
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/Registry/Hives.html' class="tree-link "  title="hives">
      hives
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/Registry/LSADump.html' class="tree-link "  title="lsadump">
      lsadump
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/Registry/PrintKey.html' class="tree-link "  title="printkey">
      printkey
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/Registry/RegDump.html' class="tree-link "  title="regdump">
      regdump
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/Registry/UserAssist.html' class="tree-link "  title="userassist">
      userassist
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/Registry/Users.html' class="tree-link "  title="users">
      users
   </a>
</li>
</ul></li>
<li>
  <input type="checkbox" id="item-/Win32_GUI" />
  <label for="item-/Win32_GUI" class="category">
    Win32_GUI
  </label>
<ul class='nav nav-stacked'>
<li>
   <a href='/docs/Manual/Plugins/Windows/Win32_GUI/Atoms.html' class="tree-link "  title="atoms">
      atoms
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/Win32_GUI/AtomScan.html' class="tree-link "  title="atomscan">
      atomscan
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/Win32_GUI/WinDesktops.html' class="tree-link "  title="desktops">
      desktops
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/Win32_GUI/WinEventHooks.html' class="tree-link "  title="eventhooks">
      eventhooks
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/Win32_GUI/Gahti.html' class="tree-link "  title="gahti">
      gahti
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/Win32_GUI/WinMessageHooks.html' class="tree-link "  title="messagehooks">
      messagehooks
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/Win32_GUI/Sessions.html' class="tree-link "  title="sessions">
      sessions
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/Win32_GUI/UserHandles.html' class="tree-link "  title="userhandles">
      userhandles
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/Win32_GUI/WindowsStations.html' class="tree-link activate_tooltip"  title="windows_stations">
      windows_station ...
   </a>
</li>
</ul></li>
<li>
   <a href='/docs/Manual/Plugins/Windows/Callbacks.html' class="tree-link "  title="callbacks">
      callbacks
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/SetProcessContext.html' class="tree-link "  title="cc">
      cc
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/CertVadScan.html' class="tree-link "  title="cert_vad_scan">
      cert_vad_scan
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/CertScan.html' class="tree-link "  title="certscan">
      certscan
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/CmdScan.html' class="tree-link "  title="cmdscan">
      cmdscan
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/Connections.html' class="tree-link "  title="connections">
      connections
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/ConnScan.html' class="tree-link "  title="connscan">
      connscan
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/Consoles.html' class="tree-link "  title="consoles">
      consoles
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/DeviceTree.html' class="tree-link "  title="devicetree">
      devicetree
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/Disassemble.html' class="tree-link "  title="dis">
      dis
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/DLLDump.html' class="tree-link "  title="dlldump">
      dlldump
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/WinDllList.html' class="tree-link "  title="dlllist">
      dlllist
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/DriverIrp.html' class="tree-link "  title="driverirp">
      driverirp
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/DriverScan.html' class="tree-link "  title="driverscan">
      driverscan
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/DTBScan.html' class="tree-link "  title="dtbscan">
      dtbscan
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/DTBScan2.html' class="tree-link "  title="dtbscan2">
      dtbscan2
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/EvtLogs.html' class="tree-link "  title="evtlogs">
      evtlogs
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/FileScan.html' class="tree-link "  title="filescan">
      filescan
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/WinFindDTB.html' class="tree-link "  title="find_dtb">
      find_dtb
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/Handles.html' class="tree-link "  title="handles">
      handles
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/ImageInfo.html' class="tree-link "  title="imageinfo">
      imageinfo
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/ImpScan.html' class="tree-link "  title="impscan">
      impscan
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/KDBGScan.html' class="tree-link "  title="kdbgscan">
      kdbgscan
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/KPCR.html' class="tree-link "  title="kpcr">
      kpcr
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/LdrModules.html' class="tree-link "  title="ldrmodules">
      ldrmodules
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/Malfind.html' class="tree-link "  title="malfind">
      malfind
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/WinMemDump.html' class="tree-link "  title="memdump">
      memdump
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/WinMemMap.html' class="tree-link "  title="memmap">
      memmap
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/ModDump.html' class="tree-link "  title="moddump">
      moddump
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/ModScan.html' class="tree-link "  title="modscan">
      modscan
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/Modules.html' class="tree-link "  title="modules">
      modules
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/MutantScan.html' class="tree-link "  title="mutantscan">
      mutantscan
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/WinNetscan.html' class="tree-link "  title="netscan">
      netscan
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/Netstat.html' class="tree-link "  title="netstat">
      netstat
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/WinNetstat.html' class="tree-link "  title="netstat">
      netstat
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/ObjectTree.html' class="tree-link "  title="object_tree">
      object_tree
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/Objects.html' class="tree-link "  title="object_types">
      object_types
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/WinPas2Vas.html' class="tree-link "  title="pas2vas">
      pas2vas
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/PEDump.html' class="tree-link "  title="pedump">
      pedump
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/PEInfo.html' class="tree-link "  title="peinfo">
      peinfo
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/PFNInfo.html' class="tree-link "  title="pfn">
      pfn
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/WinPhysicalMap.html' class="tree-link "  title="phys_map">
      phys_map
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/PoolTracker.html' class="tree-link "  title="pool_tracker">
      pool_tracker
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/Pools.html' class="tree-link "  title="pools">
      pools
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/ProcExeDump.html' class="tree-link "  title="procdump">
      procdump
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/ProcInfo.html' class="tree-link "  title="procinfo">
      procinfo
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/WinPsList.html' class="tree-link "  title="pslist">
      pslist
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/PSScan.html' class="tree-link "  title="psscan">
      psscan
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/PSTree.html' class="tree-link "  title="pstree">
      pstree
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/PsXview.html' class="tree-link "  title="psxview">
      psxview
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/PTE.html' class="tree-link "  title="pte">
      pte
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/PtoV.html' class="tree-link "  title="ptov">
      ptov
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/Raw2Dump.html' class="tree-link "  title="raw2dmp">
      raw2dmp
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/Sockets.html' class="tree-link "  title="sockets">
      sockets
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/WinSSDT.html' class="tree-link "  title="ssdt">
      ssdt
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/SvcScan.html' class="tree-link "  title="svcscan">
      svcscan
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/SymLinkScan.html' class="tree-link "  title="symlinkscan">
      symlinkscan
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/ThrdScan.html' class="tree-link "  title="thrdscan">
      thrdscan
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/Threads.html' class="tree-link "  title="threads">
      threads
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/Timers.html' class="tree-link "  title="timers">
      timers
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/GetSIDs.html' class="tree-link "  title="tokens">
      tokens
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/UnloadedModules.html' class="tree-link activate_tooltip"  title="unloaded_modules">
      unloaded_module ...
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/VAD.html' class="tree-link "  title="vad">
      vad
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/VADDump.html' class="tree-link "  title="vaddump">
      vaddump
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/VADInfo.html' class="tree-link "  title="vadinfo">
      vadinfo
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/VADTree.html' class="tree-link "  title="vadtree">
      vadtree
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/VADWalk.html' class="tree-link "  title="vadwalk">
      vadwalk
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/ModVersions.html' class="tree-link "  title="version_modules">
      version_modules
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/WinVirtualMap.html' class="tree-link "  title="virt_map">
      virt_map
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/VtoP.html' class="tree-link "  title="vtop">
      vtop
   </a>
</li>

<li>
   <a href='/docs/Manual/Plugins/Windows/YaraScan.html' class="tree-link "  title="yarascan">
      yarascan
   </a>
</li>
</ul>
 </div>

  </div>

  <div class="col-md-8">
    

<nav class="navbar navbar-default" role="navigation">

  <ul class="nav navbar-nav navbar-left">
    <li class="active">
       <a href="/docs/Manual/Plugins/Windows/KPCR.html">
         <span class="glyphicon glyphicon-arrow-left"></span>
         kpcr
       </a>
    </li>
  </ul>


  <ul class="nav navbar-nav navbar-right">
    <li class="active">
       <a href="/docs/Manual/Plugins/Windows/Malfind.html">
          malfind
          <span class="glyphicon glyphicon-arrow-right"></span>
       </a>
    </li>
  </ul>

</nav>


<h1>ldrmodules</h1>

<div class="abstract">
<p>Detect unlinked DLLs</p>
</div>


<h3>Plugin Arguments</h3>
<table class='table table-striped table-bordered table-hover'>
<tbody>
<tr><td>verbose</td><td>Enable more detailed output.</td></tr><tr><td>pid</td><td>One or more pids of processes to select.</td></tr><tr><td>eprocess</td><td>Kernel addresses of eprocess structs.</td></tr><tr><td>phys_eprocess</td><td>Physical addresses of eprocess structs.</td></tr><tr><td>proc_regex</td><td>A regex to select a process by name.</td></tr><tr><td>method</td><td>Method to list processes (Default uses all methods).</td></tr>
</tbody>
</table>



<a href="/epydocs/rekall.plugins.windows.malware.malfind.LdrModules-class.html">View Source</a>


<p>There are many ways to hide a DLL. One of the ways involves unlinking the DLL
from one (or all) of the linked lists in the PEB. However, when this is done,
there is still information contained within the VAD (Virtual Address Descriptor)
which identifies the base address of the DLL and its full path on disk. To
cross-reference this information (known as memory mapped files) with the 3 PEB
lists, use the ldrmodules command.</p>
<p>For each memory mapped PE file, the ldrmodules command prints True or False if
the PE exists in the PEB lists.</p>
<div class="highlight"><pre><span class="n">win8</span><span class="mf">.1</span><span class="p">.</span><span class="n">raw</span> <span class="mi">22</span><span class="o">:</span><span class="mi">17</span><span class="o">:</span><span class="mi">36</span><span class="o">&gt;</span> <span class="n">ldrmodules</span> <span class="n">proc_regex</span><span class="o">=</span><span class="s">&quot;winpmem&quot;</span>
<span class="o">-------------------&gt;</span> <span class="n">ldrmodules</span><span class="p">(</span><span class="n">proc_regex</span><span class="o">=</span><span class="s">&quot;winpmem&quot;</span><span class="p">)</span>
<span class="n">Pid</span>      <span class="n">Process</span>                   <span class="n">Base</span>      <span class="n">InLoad</span> <span class="n">InInit</span> <span class="n">InMem</span> <span class="n">MappedPath</span>
<span class="o">--------</span> <span class="o">--------------------</span> <span class="o">--------------</span> <span class="o">------</span> <span class="o">------</span> <span class="o">-----</span> <span class="o">----------</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x0000753b0000</span> <span class="n">False</span> <span class="n">False</span> <span class="n">False</span> <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">KernelBase</span><span class="p">.</span><span class="n">dll</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x000000020000</span> <span class="n">True</span>  <span class="n">False</span> <span class="n">True</span>  <span class="err">\</span><span class="n">temp</span><span class="err">\</span><span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span><span class="n">exe</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x000076c30000</span> <span class="n">False</span> <span class="n">False</span> <span class="n">False</span> <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">kernel32</span><span class="p">.</span><span class="n">dll</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x000074a40000</span> <span class="n">False</span> <span class="n">False</span> <span class="n">False</span> <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">cryptbase</span><span class="p">.</span><span class="n">dll</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x000074a50000</span> <span class="n">False</span> <span class="n">False</span> <span class="n">False</span> <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">sspicli</span><span class="p">.</span><span class="n">dll</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x000077010000</span> <span class="n">True</span>  <span class="n">True</span>  <span class="n">True</span>  <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">wow64cpu</span><span class="p">.</span><span class="n">dll</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x000076f50000</span> <span class="n">True</span>  <span class="n">True</span>  <span class="n">True</span>  <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">wow64</span><span class="p">.</span><span class="n">dll</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x000076fa0000</span> <span class="n">True</span>  <span class="n">True</span>  <span class="n">True</span>  <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">wow64win</span><span class="p">.</span><span class="n">dll</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x000075250000</span> <span class="n">False</span> <span class="n">False</span> <span class="n">False</span> <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">rpcrt4</span><span class="p">.</span><span class="n">dll</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x7ff87f320000</span> <span class="n">True</span>  <span class="n">True</span>  <span class="n">True</span>  <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x000077020000</span> <span class="n">False</span> <span class="n">False</span> <span class="n">False</span> <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x0000749e0000</span> <span class="n">False</span> <span class="n">False</span> <span class="n">False</span> <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">bcryptprimitives</span><span class="p">.</span><span class="n">dll</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x000074ff0000</span> <span class="n">False</span> <span class="n">False</span> <span class="n">False</span> <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">advapi32</span><span class="p">.</span><span class="n">dll</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x000076f10000</span> <span class="n">False</span> <span class="n">False</span> <span class="n">False</span> <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">sechost</span><span class="p">.</span><span class="n">dll</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x000074d80000</span> <span class="n">False</span> <span class="n">False</span> <span class="n">False</span> <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">msvcrt</span><span class="p">.</span><span class="n">dll</span>
</pre></div>


<p>Since the PEB and the DLL lists that it contains all exist in user mode, its
also possible for malware to hide (or obscure) a DLL by simply overwriting the
path. Tools that only look for unlinked entries may miss the fact that malware
could overwrite <em>C:\bad.dll</em> to show <em>C:\windows\system32\kernel32.dll</em>. So you
can also pass the <em>verbosity=10</em> parameter to ldrmodules to see the full path of
all entries.</p>
<p>For concrete examples, see <a href="http://blogs.mcafee.com/mcafee-labs/zeroaccess-misleads-memory-file-link">ZeroAccess Misleads Memory-File
Link</a>
and <a href="http://mnin.blogspot.com/2012/06/quickpost-flame-volatility.html">QuickPost: Flame &amp;
Volatility</a>.</p>
<div class="highlight"><pre><span class="n">win8</span><span class="mf">.1</span><span class="p">.</span><span class="n">raw</span> <span class="mi">22</span><span class="o">:</span><span class="mi">17</span><span class="o">:</span><span class="mi">41</span><span class="o">&gt;</span> <span class="n">ldrmodules</span> <span class="n">proc_regex</span><span class="o">=</span><span class="s">&quot;winpmem&quot;</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="mi">10</span>
<span class="o">-------------------&gt;</span> <span class="n">ldrmodules</span><span class="p">(</span><span class="n">proc_regex</span><span class="o">=</span><span class="s">&quot;winpmem&quot;</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">Pid</span>      <span class="n">Process</span>                   <span class="n">Base</span>      <span class="n">InLoad</span> <span class="n">InInit</span> <span class="n">InMem</span> <span class="n">MappedPath</span>
<span class="o">--------</span> <span class="o">--------------------</span> <span class="o">--------------</span> <span class="o">------</span> <span class="o">------</span> <span class="o">-----</span> <span class="o">----------</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x0000753b0000</span> <span class="n">False</span> <span class="n">False</span> <span class="n">False</span> <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">KernelBase</span><span class="p">.</span><span class="n">dll</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x000000020000</span> <span class="n">True</span>  <span class="n">False</span> <span class="n">True</span>  <span class="err">\</span><span class="n">temp</span><span class="err">\</span><span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span><span class="n">exe</span>
  <span class="n">Load</span> <span class="n">Path</span><span class="o">:</span> <span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">temp</span><span class="err">\</span><span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span><span class="n">exe</span> <span class="o">:</span> <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span><span class="n">exe</span>
  <span class="n">Mem</span> <span class="n">Path</span><span class="o">:</span> <span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">temp</span><span class="err">\</span><span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span><span class="n">exe</span> <span class="o">:</span> <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span><span class="n">exe</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x000076c30000</span> <span class="n">False</span> <span class="n">False</span> <span class="n">False</span> <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">kernel32</span><span class="p">.</span><span class="n">dll</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x000074a40000</span> <span class="n">False</span> <span class="n">False</span> <span class="n">False</span> <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">cryptbase</span><span class="p">.</span><span class="n">dll</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x000074a50000</span> <span class="n">False</span> <span class="n">False</span> <span class="n">False</span> <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">sspicli</span><span class="p">.</span><span class="n">dll</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x000077010000</span> <span class="n">True</span>  <span class="n">True</span>  <span class="n">True</span>  <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">wow64cpu</span><span class="p">.</span><span class="n">dll</span>
  <span class="n">Load</span> <span class="n">Path</span><span class="o">:</span> <span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">system32</span><span class="err">\</span><span class="n">wow64cpu</span><span class="p">.</span><span class="n">dll</span> <span class="o">:</span> <span class="n">wow64cpu</span><span class="p">.</span><span class="n">dll</span>
  <span class="n">Init</span> <span class="n">Path</span><span class="o">:</span> <span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">system32</span><span class="err">\</span><span class="n">wow64cpu</span><span class="p">.</span><span class="n">dll</span> <span class="o">:</span> <span class="n">wow64cpu</span><span class="p">.</span><span class="n">dll</span>
  <span class="n">Mem</span> <span class="n">Path</span><span class="o">:</span> <span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">system32</span><span class="err">\</span><span class="n">wow64cpu</span><span class="p">.</span><span class="n">dll</span> <span class="o">:</span> <span class="n">wow64cpu</span><span class="p">.</span><span class="n">dll</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x000076f50000</span> <span class="n">True</span>  <span class="n">True</span>  <span class="n">True</span>  <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">wow64</span><span class="p">.</span><span class="n">dll</span>
  <span class="n">Load</span> <span class="n">Path</span><span class="o">:</span> <span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SYSTEM32</span><span class="err">\</span><span class="n">wow64</span><span class="p">.</span><span class="n">dll</span> <span class="o">:</span> <span class="n">wow64</span><span class="p">.</span><span class="n">dll</span>
  <span class="n">Init</span> <span class="n">Path</span><span class="o">:</span> <span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SYSTEM32</span><span class="err">\</span><span class="n">wow64</span><span class="p">.</span><span class="n">dll</span> <span class="o">:</span> <span class="n">wow64</span><span class="p">.</span><span class="n">dll</span>
  <span class="n">Mem</span> <span class="n">Path</span><span class="o">:</span> <span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SYSTEM32</span><span class="err">\</span><span class="n">wow64</span><span class="p">.</span><span class="n">dll</span> <span class="o">:</span> <span class="n">wow64</span><span class="p">.</span><span class="n">dll</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x000076fa0000</span> <span class="n">True</span>  <span class="n">True</span>  <span class="n">True</span>  <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">wow64win</span><span class="p">.</span><span class="n">dll</span>
  <span class="n">Load</span> <span class="n">Path</span><span class="o">:</span> <span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">system32</span><span class="err">\</span><span class="n">wow64win</span><span class="p">.</span><span class="n">dll</span> <span class="o">:</span> <span class="n">wow64win</span><span class="p">.</span><span class="n">dll</span>
  <span class="n">Init</span> <span class="n">Path</span><span class="o">:</span> <span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">system32</span><span class="err">\</span><span class="n">wow64win</span><span class="p">.</span><span class="n">dll</span> <span class="o">:</span> <span class="n">wow64win</span><span class="p">.</span><span class="n">dll</span>
  <span class="n">Mem</span> <span class="n">Path</span><span class="o">:</span> <span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">system32</span><span class="err">\</span><span class="n">wow64win</span><span class="p">.</span><span class="n">dll</span> <span class="o">:</span> <span class="n">wow64win</span><span class="p">.</span><span class="n">dll</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x000075250000</span> <span class="n">False</span> <span class="n">False</span> <span class="n">False</span> <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">rpcrt4</span><span class="p">.</span><span class="n">dll</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x7ff87f320000</span> <span class="n">True</span>  <span class="n">True</span>  <span class="n">True</span>  <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span>
  <span class="n">Load</span> <span class="n">Path</span><span class="o">:</span> <span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SYSTEM32</span><span class="err">\</span><span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span> <span class="o">:</span> <span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span>
  <span class="n">Init</span> <span class="n">Path</span><span class="o">:</span> <span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SYSTEM32</span><span class="err">\</span><span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span> <span class="o">:</span> <span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span>
  <span class="n">Mem</span> <span class="n">Path</span><span class="o">:</span> <span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SYSTEM32</span><span class="err">\</span><span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span> <span class="o">:</span> <span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x000077020000</span> <span class="n">False</span> <span class="n">False</span> <span class="n">False</span> <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">ntdll</span><span class="p">.</span><span class="n">dll</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x0000749e0000</span> <span class="n">False</span> <span class="n">False</span> <span class="n">False</span> <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">bcryptprimitives</span><span class="p">.</span><span class="n">dll</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x000074ff0000</span> <span class="n">False</span> <span class="n">False</span> <span class="n">False</span> <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">advapi32</span><span class="p">.</span><span class="n">dll</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x000076f10000</span> <span class="n">False</span> <span class="n">False</span> <span class="n">False</span> <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">sechost</span><span class="p">.</span><span class="n">dll</span>
<span class="mi">2628</span>     <span class="n">winpmem_1</span><span class="mf">.5.2</span><span class="p">.</span>       <span class="mh">0x000074d80000</span> <span class="n">False</span> <span class="n">False</span> <span class="n">False</span> <span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">SysWOW64</span><span class="err">\</span><span class="n">msvcrt</span><span class="p">.</span><span class="n">dll</span>
</pre></div>


<h3>Notes</h3>
<ol>
<li>Wow64 processes (i.e. 32 bit processes on 64 bit windows) will not show any
   32 bit DLLs in any of the loader lists. This is normal (and you will see the
   Dlls loaded from the \Windows\Wow64 directory.</li>
</ol>

<p>

<nav class="navbar navbar-default" role="navigation">

  <ul class="nav navbar-nav navbar-left">
    <li class="active">
       <a href="/docs/Manual/Plugins/Windows/KPCR.html">
         <span class="glyphicon glyphicon-arrow-left"></span>
         kpcr
       </a>
    </li>
  </ul>


  <ul class="nav navbar-nav navbar-right">
    <li class="active">
       <a href="/docs/Manual/Plugins/Windows/Malfind.html">
          malfind
          <span class="glyphicon glyphicon-arrow-right"></span>
       </a>
    </li>
  </ul>

</nav>


  </div>
  <div class="col-md-2 sidebar">
    <img src="/img/Rekall.png" class="logo"></img>


  </div>
</div>
</div>
  <script>
   $(".activate_tooltip").tooltip();
  </script>
  </body>
</html>

