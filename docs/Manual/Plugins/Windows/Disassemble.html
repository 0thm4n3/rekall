
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Rekall Memory Forensic Framework</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Rekall Memory Forensic Framework">

    <link href="/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px;
      }
    </style>
    <link href="/css/bootstrap-responsive.css" rel="stylesheet">
    <link href="/css/asciidoc.css" rel="stylesheet">
    <link href="/css/treeview.css" rel="stylesheet">
    <script src="//code.jquery.com/jquery-1.11.0.min.js"></script>
    <script src="//code.jquery.com/ui/1.10.4/jquery-ui.js"></script>
    <link rel="stylesheet" href="//code.jquery.com/ui/1.10.4/themes/smoothness/jquery-ui.css">

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></sc\
ript>
    <![endif]-->
  </head>

  <body>


    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="brand" href="#">Rekall Memory Forensic Framework</a>
          <div class="nav-collapse collapse">
            <ul class="nav">

        <li>
          <a class="" href="/index.html">
            Home
          </a>
        </li>

        <li>
          <a class="" href="/about.html">
            About
          </a>
        </li>

        <li>
          <a class="" href="/blog.html">
            Blog
          </a>
        </li>

        <li>
          <a class="" href="/docs.html">
            Documentation
          </a>
        </li>

        <li>
          <a class="" href="/downloads.html">
            Downloads
          </a>
        </li>

        <li>
          <a class="" href="/faq.html">
            FAQ
          </a>
        </li>

            </ul>
          </div>
        </div>
      </div>
    </div>

<div class="container-fluid">
<div class="row-fluid">
  <div class="span2">
    <a href='/docs/Manual/Plugins/index.html'><i class='icon-hand-up'></i></a><h3><a href='/docs/Manual/Plugins/Windows/index.html'>Windows</a></h3><div class='css-treeview'><ul class='nav nav-list'>
<li>
  <input type="checkbox" id="item-/Registry" />
  <label for="item-/Registry">
    Registry
  </label>
<ul class='nav nav-list'>
<li>
   <a href='/docs/Manual/Plugins/Windows/Registry/GetServiceSids.html' class="tree-link">getservicesids</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/Registry/HashDump.html' class="tree-link">hashdump</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/Registry/HiveDump.html' class="tree-link">hivedump</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/Registry/Hives.html' class="tree-link">hives</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/Registry/LSADump.html' class="tree-link">lsadump</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/Registry/PrintKey.html' class="tree-link">printkey</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/Registry/RegDump.html' class="tree-link">regdump</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/Registry/UserAssist.html' class="tree-link">userassist</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/Registry/Users.html' class="tree-link">users</a>
</ul></li>
<li>
  <input type="checkbox" id="item-/Win32_GUI" />
  <label for="item-/Win32_GUI">
    Win32_GUI
  </label>
<ul class='nav nav-list'>
<li>
   <a href='/docs/Manual/Plugins/Windows/Win32_GUI/Atoms.html' class="tree-link">atoms</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/Win32_GUI/AtomScan.html' class="tree-link">atomscan</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/Win32_GUI/SetProcessContext.html' class="tree-link">cc</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/Win32_GUI/WinDesktops.html' class="tree-link">desktops</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/Win32_GUI/WinEventHooks.html' class="tree-link">eventhooks</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/Win32_GUI/Gahti.html' class="tree-link">gahti</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/Win32_GUI/WinMessageHooks.html' class="tree-link">messagehooks</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/Win32_GUI/Sessions.html' class="tree-link">sessions</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/Win32_GUI/UserHandles.html' class="tree-link">userhandles</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/Win32_GUI/WindowsStations.html' class="tree-link">windows_stations</a>
</ul></li>
<li>
   <a href='/docs/Manual/Plugins/Windows/Callbacks.html' class="tree-link">callbacks</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/CertVadScan.html' class="tree-link">cert_vad_scan</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/CertScan.html' class="tree-link">certscan</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/CmdScan.html' class="tree-link">cmdscan</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/Connections.html' class="tree-link">connections</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/ConnScan.html' class="tree-link">connscan</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/Consoles.html' class="tree-link">consoles</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/DeviceTree.html' class="tree-link">devicetree</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/Disassemble.html' class="tree-link">dis</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/DLLDump.html' class="tree-link">dlldump</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/WinDllList.html' class="tree-link">dlllist</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/DriverIrp.html' class="tree-link">driverirp</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/DriverScan.html' class="tree-link">driverscan</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/DTBScan.html' class="tree-link">dtbscan</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/DTBScan2.html' class="tree-link">dtbscan2</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/EvtLogs.html' class="tree-link">evtlogs</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/FileScan.html' class="tree-link">filescan</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/WinFindDTB.html' class="tree-link">find_dtb</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/Handles.html' class="tree-link">handles</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/ImageInfo.html' class="tree-link">imageinfo</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/ImpScan.html' class="tree-link">impscan</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/KDBGScan.html' class="tree-link">kdbgscan</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/KPCR.html' class="tree-link">kpcr</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/LdrModules.html' class="tree-link">ldrmodules</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/Malfind.html' class="tree-link">malfind</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/WinMemDump.html' class="tree-link">memdump</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/WinMemMap.html' class="tree-link">memmap</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/ModDump.html' class="tree-link">moddump</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/ModScan.html' class="tree-link">modscan</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/Modules.html' class="tree-link">modules</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/MutantScan.html' class="tree-link">mutantscan</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/WinNetscan.html' class="tree-link">netscan</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/Netstat.html' class="tree-link">netstat</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/WinNetstat.html' class="tree-link">netstat</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/ObjectTree.html' class="tree-link">object_tree</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/Objects.html' class="tree-link">object_types</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/WinPas2Vas.html' class="tree-link">pas2vas</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/PEDump.html' class="tree-link">pedump</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/PEInfo.html' class="tree-link">peinfo</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/PFNInfo.html' class="tree-link">pfn</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/WinPhysicalMap.html' class="tree-link">phys_map</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/PoolTracker.html' class="tree-link">pool_tracker</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/Pools.html' class="tree-link">pools</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/ProcExeDump.html' class="tree-link">procdump</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/ProcInfo.html' class="tree-link">procinfo</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/PSAux.html' class="tree-link">psaux</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/WinPsList.html' class="tree-link">pslist</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/PSScan.html' class="tree-link">psscan</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/PSTree.html' class="tree-link">pstree</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/PsXview.html' class="tree-link">psxview</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/PTE.html' class="tree-link">pte</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/PtoV.html' class="tree-link">ptov</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/Raw2Dump.html' class="tree-link">raw2dmp</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/Sockets.html' class="tree-link">sockets</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/WinSSDT.html' class="tree-link">ssdt</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/SvcScan.html' class="tree-link">svcscan</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/SymLinkScan.html' class="tree-link">symlinkscan</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/ThrdScan.html' class="tree-link">thrdscan</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/Threads.html' class="tree-link">threads</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/Timers.html' class="tree-link">timers</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/GetSIDs.html' class="tree-link">tokens</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/UnloadedModules.html' class="tree-link">unloaded_modules</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/VAD.html' class="tree-link">vad</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/VADDump.html' class="tree-link">vaddump</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/VADInfo.html' class="tree-link">vadinfo</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/VADTree.html' class="tree-link">vadtree</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/VADWalk.html' class="tree-link">vadwalk</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/ModVersions.html' class="tree-link">version_modules</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/WinVirtualMap.html' class="tree-link">virt_map</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/VtoP.html' class="tree-link">vtop</a>

<li>
   <a href='/docs/Manual/Plugins/Windows/YaraScan.html' class="tree-link">yarascan</a>
</ul></div>
  </div>

  <div class="span8">
    
<h1>dis</h1>

<div class="abstract">
<p>Disassemble the given address space.</p>
</div>


<h3>Plugin Arguments</h3>
<table class='table table-striped table-bordered table-hover'>
<tbody>
<tr><td>offset</td><td>An offset to disassemble. This can also be the name of a symbol with an optional offset. For example: tcpip!TcpCovetNetBufferList.</td></tr><tr><td>address_space</td><td>The address space to use.</td></tr><tr><td>length</td><td>The number of instructions (lines) to disassemble.</td></tr><tr><td>end</td><td>The end address to disassemble up to.</td></tr><tr><td>mode</td><td>Disassemble Mode (AMD64 or I386). Defaults to profile arch.</td></tr><tr><td>suppress_headers</td><td>If set we do not write table headers.</td></tr>
</tbody>
</table>



<a href="/epydocs/rekall.plugins.windows.disassembler.Disassemble-class.html">View Source</a>


<p>This plugin is used to disassemble memory regions. The offset to disassemble may be given as:</p>
<ul>
<li>
<p>An address in the current default address space (See the
  <a href="SetProcessContext.html">cc</a> plugin for an explaination of the default address
  space).</p>
</li>
<li>
<p>The name of a kernel module with an optional symbol name. The symbol may be an
  experted symbol, or non-exported symbol as defined in the pdb file for that
  kernel module.</p>
</li>
</ul>
<h3>Notes</h3>
<ol>
<li>
<p>When using the interactive console you can complete symbol names by double
   tapping the [tab] key. For example <strong>dis &ldquo;nt!KiSetTi[tab][tab]</strong>.</p>
</li>
<li>
<p>Rekall attempts to resolve addresses in the disassembly back to known symbol
   names. Additionally, for indirect operations, Rekall also prints the current
   value of the memory location. This feature is especially useful for
   understanding where indirect jumps are going - without needing to consider PE
   import tables etc. This works since the IAT is already patched into memory,
   hence Rekall can completely ignore IAT resoltion (unlike a standalone PE
   analyser like IDA).</p>
</li>
</ol>
<h3>Sample output</h3>
<p>Here we disassemble the kernel function <strong>KiSetTimerEx</strong> to observe the DPC
pointer obfuscation that Patch Guard uses on 64 bit Windows 7. We can see the
names of the symbols used and their current values, as well as the name of
internally called functions.</p>
<div class="highlight"><pre><span class="n">win7</span><span class="p">.</span><span class="n">elf</span> <span class="mi">23</span><span class="o">:</span><span class="mi">48</span><span class="o">:</span><span class="mi">14</span><span class="o">&gt;</span> <span class="n">dis</span> <span class="s">&quot;nt!KiSetTimerEx&quot;</span>
<span class="o">-----------------&gt;</span> <span class="n">dis</span><span class="p">(</span><span class="s">&quot;nt!KiSetTimerEx&quot;</span><span class="p">)</span>
   <span class="n">Address</span>      <span class="n">Rel</span> <span class="n">Op</span> <span class="n">Codes</span>             <span class="n">Instruction</span>                    <span class="n">Comment</span>
<span class="o">--------------</span> <span class="o">----</span> <span class="o">--------------------</span> <span class="o">------------------------------</span> <span class="o">-------</span>
<span class="o">------</span> <span class="n">nt</span><span class="o">!</span><span class="n">KiSetTimerEx</span> <span class="o">------</span>
<span class="mh">0xf8000269d4f0</span>    <span class="mi">0</span> <span class="mi">48895</span><span class="n">c2408</span>           <span class="n">MOV</span> <span class="p">[</span><span class="n">RSP</span><span class="o">+</span><span class="mh">0x8</span><span class="p">],</span> <span class="n">RBX</span>
<span class="mh">0xf8000269d4f5</span>    <span class="mi">5</span> <span class="mi">4889542410</span>           <span class="n">MOV</span> <span class="p">[</span><span class="n">RSP</span><span class="o">+</span><span class="mh">0x10</span><span class="p">],</span> <span class="n">RDX</span>
<span class="mh">0xf8000269d4fa</span>    <span class="n">A</span> <span class="mi">55</span>                   <span class="n">PUSH</span> <span class="n">RBP</span>
<span class="mh">0xf8000269d4fb</span>    <span class="n">B</span> <span class="mi">56</span>                   <span class="n">PUSH</span> <span class="n">RSI</span>
<span class="mh">0xf8000269d4fc</span>    <span class="n">C</span> <span class="mi">57</span>                   <span class="n">PUSH</span> <span class="n">RDI</span>
<span class="mh">0xf8000269d4fd</span>    <span class="n">D</span> <span class="mi">4154</span>                 <span class="n">PUSH</span> <span class="n">R12</span>
<span class="mh">0xf8000269d4ff</span>    <span class="n">F</span> <span class="mi">4155</span>                 <span class="n">PUSH</span> <span class="n">R13</span>
<span class="mh">0xf8000269d501</span>   <span class="mi">11</span> <span class="mi">4156</span>                 <span class="n">PUSH</span> <span class="n">R14</span>
<span class="mh">0xf8000269d503</span>   <span class="mi">13</span> <span class="mi">4157</span>                 <span class="n">PUSH</span> <span class="n">R15</span>
<span class="mh">0xf8000269d505</span>   <span class="mi">15</span> <span class="mi">4883</span><span class="n">ec50</span>             <span class="n">SUB</span> <span class="n">RSP</span><span class="p">,</span> <span class="mh">0x50</span>
<span class="mh">0xf8000269d509</span>   <span class="mi">19</span> <span class="mi">488</span><span class="n">b05f09b2200</span>       <span class="n">MOV</span> <span class="n">RAX</span><span class="p">,</span> <span class="p">[</span><span class="n">RIP</span><span class="o">+</span><span class="mh">0x229bf0</span><span class="p">]</span>        <span class="mh">0x6D7CFFA404933FBB</span> <span class="n">nt</span><span class="o">!</span><span class="n">KiWaitNever</span>
<span class="mh">0xf8000269d510</span>   <span class="mi">20</span> <span class="mi">488</span><span class="n">b1dc19c2200</span>       <span class="n">MOV</span> <span class="n">RBX</span><span class="p">,</span> <span class="p">[</span><span class="n">RIP</span><span class="o">+</span><span class="mh">0x229cc1</span><span class="p">]</span>        <span class="mh">0x933DD660CFFF8004</span> <span class="n">nt</span><span class="o">!</span><span class="n">KiWaitAlways</span>
<span class="mh">0xf8000269d517</span>   <span class="mi">27</span> <span class="mi">4</span><span class="n">c8bb424b0000000</span>     <span class="n">MOV</span> <span class="n">R14</span><span class="p">,</span> <span class="p">[</span><span class="n">RSP</span><span class="o">+</span><span class="mh">0xb0</span><span class="p">]</span>
<span class="mh">0xf8000269d51f</span>   <span class="mf">2F</span> <span class="mi">4933</span><span class="n">de</span>               <span class="n">XOR</span> <span class="n">RBX</span><span class="p">,</span> <span class="n">R14</span>
<span class="mh">0xf8000269d522</span>   <span class="mi">32</span> <span class="mi">488</span><span class="n">bf1</span>               <span class="n">MOV</span> <span class="n">RSI</span><span class="p">,</span> <span class="n">RCX</span>
<span class="mh">0xf8000269d525</span>   <span class="mi">35</span> <span class="mf">450f</span><span class="n">b6f9</span>             <span class="n">MOVZX</span> <span class="n">R15D</span><span class="p">,</span> <span class="n">R9B</span>
<span class="mh">0xf8000269d529</span>   <span class="mi">39</span> <span class="mf">480f</span><span class="n">cb</span>               <span class="n">BSWAP</span> <span class="n">RBX</span>
<span class="mh">0xf8000269d52c</span>   <span class="mi">3</span><span class="n">C</span> <span class="mi">418</span><span class="n">bf8</span>               <span class="n">MOV</span> <span class="n">EDI</span><span class="p">,</span> <span class="n">R8D</span>
<span class="mh">0xf8000269d52f</span>   <span class="mf">3F</span> <span class="mi">4833</span><span class="n">d9</span>               <span class="n">XOR</span> <span class="n">RBX</span><span class="p">,</span> <span class="n">RCX</span>
<span class="mh">0xf8000269d532</span>   <span class="mi">42</span> <span class="mi">8</span><span class="n">bc8</span>                 <span class="n">MOV</span> <span class="n">ECX</span><span class="p">,</span> <span class="n">EAX</span>
<span class="mh">0xf8000269d534</span>   <span class="mi">44</span> <span class="mi">48</span><span class="n">d3cb</span>               <span class="n">ROR</span> <span class="n">RBX</span><span class="p">,</span> <span class="n">CL</span>
<span class="mh">0xf8000269d537</span>   <span class="mi">47</span> <span class="mi">4833</span><span class="n">d8</span>               <span class="n">XOR</span> <span class="n">RBX</span><span class="p">,</span> <span class="n">RAX</span>
<span class="mh">0xf8000269d53a</span>   <span class="mi">4</span><span class="n">A</span> <span class="mf">450f</span><span class="mi">20</span><span class="n">c4</span>             <span class="n">MOV</span> <span class="n">R12</span><span class="p">,</span> <span class="n">CR8</span>
<span class="mh">0xf8000269d53e</span>   <span class="mi">4</span><span class="n">E</span> <span class="n">b802000000</span>           <span class="n">MOV</span> <span class="n">EAX</span><span class="p">,</span> <span class="mh">0x2</span>
<span class="mh">0xf8000269d543</span>   <span class="mi">53</span> <span class="mf">440f</span><span class="mi">22</span><span class="n">c0</span>             <span class="n">MOV</span> <span class="n">CR8</span><span class="p">,</span> <span class="n">RAX</span>
<span class="mh">0xf8000269d547</span>   <span class="mi">57</span> <span class="mi">65488</span><span class="n">b2c2520000000</span>   <span class="n">MOV</span> <span class="n">RBP</span><span class="p">,</span> <span class="p">[</span><span class="n">GS</span><span class="o">:</span><span class="mh">0x20</span><span class="p">]</span>
<span class="mh">0xf8000269d550</span>   <span class="mi">60</span> <span class="mi">33</span><span class="n">d2</span>                 <span class="n">XOR</span> <span class="n">EDX</span><span class="p">,</span> <span class="n">EDX</span>
<span class="mh">0xf8000269d552</span>   <span class="mi">62</span> <span class="mi">488</span><span class="n">bce</span>               <span class="n">MOV</span> <span class="n">RCX</span><span class="p">,</span> <span class="n">RSI</span>
<span class="mh">0xf8000269d555</span>   <span class="mi">65</span> <span class="n">e8f6b0ffff</span>           <span class="n">CALL</span> <span class="mh">0xf80002698650</span>            <span class="n">nt</span><span class="o">!</span><span class="n">KiCancelTimer</span>
<span class="mh">0xf8000269d55a</span>   <span class="mi">6</span><span class="n">A</span> <span class="mf">48895e30</span>             <span class="n">MOV</span> <span class="p">[</span><span class="n">RSI</span><span class="o">+</span><span class="mh">0x30</span><span class="p">],</span> <span class="n">RBX</span>
</pre></div>

  </div>
  <div class="span2 sidebar">
    <img src="/img/Rekall.png"></img>

  </div>
</div>
</div>
  </body>
</html>

