
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Rekall Memory Forensic Framework</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Rekall Memory Forensic Framework">

    <link href="/css/bootstrap.min.css" rel="stylesheet">
    <link href="/css/rekall.css" rel="stylesheet">
    <link href="/css/asciidoc.css" rel="stylesheet">
    <link href="/css/font-awesome.css" rel="stylesheet">
    <script src="//code.jquery.com/jquery-1.11.0.min.js"></script>
    <script src="//code.jquery.com/ui/1.10.4/jquery-ui.js"></script>
    <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="//code.jquery.com/ui/1.10.4/themes/smoothness/jquery-ui.css">

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></sc\
ript>
    <![endif]-->
  </head>

  <body>


  <div class="background">
   <header class="header">
    <div class="navbar navbar-fixed-top navbar-inverse">
     <div class="navbar-inner">
      <div class="container">
       <a class="navbar-brand" href="/"
          style="padding-top: 0px; padding-bottom: 0px;"
          >
          <img src="/img/Rekall-small.png" class="small_logo"></img>
       </a>
       <ul class="nav navbar-nav navbar-collapse collapse">

        <li class="divider-vertical"></li>
        
    <li class="">
     <a href="/index.html">
      Home
     </a>
    </li>
    
        <li class="divider-vertical"></li>
        
    <li class="">
     <a href="/about.html">
      About
     </a>
    </li>
    
        <li class="divider-vertical"></li>
        
    <li class="">
     <a href="/releases.html">
      Releases
     </a>
    </li>
    
        <li class="divider-vertical"></li>
        
    <li class=" dropdown">
     <a class="dropdown-toggle"
      id="dropdownMenuDocumentation"
      data-toggle="dropdown"
      aria-expanded="true">
    Documentation
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuDocumentation">

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/docs/Manual">Manual</a></li>

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/docs/Developers">Developers</a></li>

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/docs/GUI">GUI</a></li>

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/docs/References">References</a></li>

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/docs/Tools">Tools</a></li>

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/docs/index.html"></a></li>

  </ul>
 </li>

        <li class="divider-vertical"></li>
        
    <li class=" dropdown">
     <a class="dropdown-toggle"
      id="dropdownMenuDiscuss"
      data-toggle="dropdown"
      aria-expanded="true">
    Discuss
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuDiscuss">

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/Discuss/blog.html">The Rekall Blog</a></li>

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/Discuss/github.html">GitHub</a></li>

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/Discuss/index.html"></a></li>

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/Discuss/issue.html">Issue Tracker</a></li>

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/Discuss/mailinglist.html">Mailing List</a></li>

  </ul>
 </li>

        <li class="divider-vertical"></li>
        
    <li class=" dropdown">
     <a class="dropdown-toggle"
      id="dropdownMenuDownloads"
      data-toggle="dropdown"
      aria-expanded="true">
    Downloads
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuDownloads">

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/downloads/Linux">Linux</a></li>

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/downloads/OSXPmem">OSXPmem</a></li>

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/downloads/Rekall">Rekall</a></li>

    <li role="presentation"><a role="menuitem" tabindex="-1" href="/downloads/WinPMEM">WinPMEM</a></li>

  </ul>
 </li>

        <li class="divider-vertical"></li>
        
    <li class="">
     <a href="/faq.html">
      FAQ
     </a>
    </li>
    
       <li>
        <a href="https://github.com/google/rekall/edit/gh-pages/docs/Developers/development.adoc?message=Describe%20your%20change..."
           data-toggle="tooltip"
           data-placement="bottom"
           title="Improve this page"
           class="improve-docs activate_tooltip">
         <i class="glyphicon glyphicon-edit"></i>
        </a>
       </ul>

       <form class="navbar-search col-md-3 docs-search" role="search"
             action="/search.html">
       <span class="glyphicon glyphicon-search search-icon"></span>
       <input type="text" name="q" data-i-search-input="true"
         class="search-query"
         placeholder="Site Search">
       </form>
      </div>
     </div>
    </div>
   </header>

<div class="container-fluid page-background container">
<div class="main">
  <div class="col-md-2">
    
 <a href="/docs/index.html" class="btn btn-default btn-lg btn-block">
  <span class="glyphicon glyphicon-arrow-left"></span> docs
 </a>

 <a href='/docs/Developers/index.html' class="btn btn-default btn-lg btn-block">
   Developers
 </a>
 <p>

 <ul class='nav nav-pills nav-stacked'><ul class='nav nav-pills nav-stacked'><li>
          <a href='/docs/Developers/how_to_contribute.html' class="category-link">
            Code review workflow for Rekall.
          </a>
        </li>
        <li>
          <a href='/docs/Developers/epydocs.html' class="category-link">
            Generated API Docs.
          </a>
        </li>
        <li class='active'>
          <a href='/docs/Developers/development.html' class="category-link">
            The Rekall Memory Forensic Framework API.
          </a>
        </li>
        <li>
          <a href='/docs/Developers/renderers.html' class="category-link">
            The Rekall Rendering framework.
          </a>
        </li>
        </ul></ul>


  </div>

  <div class="col-md-10">
    

<nav class="navbar navbar-default plugins" role="navigation">

  <ul class="nav navbar-nav navbar-left">
    <li class="active">
       <a href="/docs/Developers/epydocs.html">
         <span class="glyphicon glyphicon-arrow-left"></span>
         Generated API Docs.
       </a>
    </li>
  </ul>


  <ul class="nav navbar-nav navbar-right">
    <li class="active">
       <a href="/docs/Developers/renderers.html">
          The Rekall Rendering framework.
          <span class="glyphicon glyphicon-arrow-right"></span>
       </a>
    </li>
  </ul>

</nav>


<h1>The Rekall Memory Forensic Framework API.</h1>

<div class="abstract">

</div>






<div id="header">
<div id="toc">
  <div id="toctitle">Table of Contents</div>
  <noscript><p><b>JavaScript must be enabled in your browser to display the table of contents.</b></p></noscript>
</div>
</div>
<div id="content">
<div class="paragraph"><p>Rekall is a powerful framework with many components. It is not necessary to be
intimately familiar with all components to be able to contribute. This document
attempts to cover as much internal API information as possible, but if you
already have a good idea of what you wish to accomplish, the
<a href="#overview">Overview</a> section will direct new users to the most relevant
section.</p></div>
<div class="sect1">
<h2 id="overview">1. Overview</h2>
<div class="sectionbody">
<div class="paragraph"><p>The following usage examples are typical areas where people would like to
contribute:</p></div>
<div class="dlist"><dl>
<dt class="hdlist1">
Adding support to a new image format
</dt>
<dd>
<p>
 You will probably want to add a new address space by reading
 <a href="#as">Address Spaces</a>.
</p>
</dd>
<dt class="hdlist1">
Using rekall as a library
</dt>
<dd>
<p>
 You will want to read the section <a href="#library">Using Rekall as a Libarary</a>.
</p>
</dd>
<dt class="hdlist1">
I want to add new functionality
</dt>
<dd>
<p>
 If your code will be useful to all Rekall users and you would like to
 contribute it upstream you might want to read <a href="#commands">Command Plugins</a>, else
 you might want to write a standalone script and read <a href="#library">Using Rekall  as a Library</a>.
</p>
</dd>
</dl></div>
</div>
</div>
<div class="sect1">
<h2 id="commands">2. Plugins and Commands.</h2>
<div class="sectionbody">
<div class="paragraph"><p>Rekall is a modular framework. This means that most of the functionality of
the framework is implemented by plugins, enabling the framework to support
multiple operating systems. Even when using rekall as a library it is easy
to extend the library from within your own code (i.e. plugins do not need to be
embedded in the library itself).</p></div>
<div class="paragraph"><p>A plugin is simply a piece of python code which declares a class extending one
of the special classes providing some kind of functionality. For example to
create a new address space, one simply defines a class extending
BaseAddressSpace. Once that happens, the framework automatically knows about
this new class and can use it e.g. in address space voting (there is no need to
call any initialization functions).</p></div>
<div class="paragraph"><p>Plugins auto-register to the baseclass by means of a python metaclass. This
places a reference to all plugins of the same class in a class variable called
<em>classes</em>. This mechanism provides a simple way for one plugin to access another
plugin without needing to explicitly import its module.</p></div>
<div class="sect2">
<h3 id="_command_plugin">2.1. Command Plugin</h3>
<div class="paragraph"><p>A command is a reusable plugin which implements a user runnable command. For
example, when the user issues the <em>pslist</em> command, the WinPSList plugin is
run. Therefore in order to be accessible to the user, a command plugin must
extend the plugin.Command class.</p></div>
<div class="paragraph"><p>However it is not sufficient to simply extend the plugin.Command class, the
class must also declare what the name of the command it implements is. For
example the WinPSList class implements the <em>pslist</em> command.</p></div>
<div class="paragraph"><p>At any given moment there can be a number of command plugins which define a
particular user command. For example, LinPSList, WinPSList and MacPSList all
define a command called <em>pslist</em>. The correct class to run is chosen based on
the profile.</p></div>
<div class="paragraph"><p>Here is the base minimum that should be defined for a new command plugin:</p></div>
<div class="dlist"><dl>
<dt class="hdlist1">
<code>args(cls, parser)</code>
</dt>
<dd>
<p>
  This is a classmethod called in order to construct the command line
  options. See below.
</p>
</dd>
<dt class="hdlist1">
<code>__init__(**args)</code>
</dt>
<dd>
<p>
  This is the constructor which should take any parameters you wish to
  accept. If you also want the user to be able to provide these parameters
  through the command line you will need to add them to the parser provided in
  args() above.
</p>
</dd>
<dt class="hdlist1">
<code>is_active(cls, session)</code>
</dt>
<dd>
<p>
  This method will be called with the session to check if this specific class is
  active. This mechanism allows multiple implementations to all share the same
  name, as long as only one is actually active. For example, we can have a
  linux, windows and mac version of plugins with the same "pslist" name.
</p>
</dd>
<dt class="hdlist1">
<code>render(renderer)</code>
</dt>
<dd>
<p>
  This is the main entry point for the command when called from the Rekall
  UI. The plugin should render any output using the renderer (see
  <a href="#renderer">Rendering Output</a>).
</p>
</dd>
</dl></div>
<div class="paragraph"><p>In addition to these methods the plugin should define any other methods that can
be reusable by other components.</p></div>
<div class="paragraph"><p>Many of the existing command plugins implement some of these methods via
inheritance. For example, plugins which can only operate on a Linux image may
extend the <code>rekall.plugins.linux.common.LinuxPlugin</code> class which already
implements the correct <code>is_active()</code> method.</p></div>
<div class="paragraph"><p>Similarly plugins which operate on processes may extend the
<code>rekall.plugins.linux.common.LinuxProcessFilter</code> plugin. This will give the new
plugin the <code>args()</code> method defining all the commandline options which allow the
user to select processes (i.e. by pid, by task address etc). In this way the
commands which operate on processes can present a consistent user interface
easily with the same filtering options.</p></div>
</div>
<div class="sect2">
<h3 id="_command_line_invocation">2.2. Command line Invocation</h3>
<div class="paragraph"><p>So what happens when a user invokes rekall from the command line? Assume the
following command is issued:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>    <img alt="1" src="data:image/png;base64,
iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAABjSURBVHja
VY6xDcAwCAS/pPQaLim9QmajdOk2I2SNrMEIlARIoigU8Cek/4e7zdHaWOYOVwaoA6wOCw05Y7FB
gE0tIWQ+sBcwKM8qoD/wB5wGL8hjfdzWrh01GRp1hInGjDoXwHgsFuzBVLQAAABDdEVYdFNvZnR3
YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8wMSBjcmlzdHlAbXlzdGljLmVzLmR1cG9u
dC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUANThhMDcyZTA3MGRhMjJmNjEzNWNiZDNlNDE0NTQ2
ZjloaiHtAAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30AAAAASUVORK5CYII=" />        <img alt="2" src="data:image/png;base64,
iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAAB7SURBVHja
HY6hFcMwDEQ/NDQsNSwU9Apdo7Cw0CsIBoZmhKzQEQJLDQsFVclHpHu693W429Zr7bu541Pg3kCm
Y0K75u9TEUPhuGgWU4mQDvieEaSQEnsT6zKPeZY0EUNtrHMCXvYUuSUg0PsMjUSvpysUT6OOSil9
izp/VNk1YJ8vf6MAAABDdEVYdFNvZnR3YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8w
MSBjcmlzdHlAbXlzdGljLmVzLmR1cG9udC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUAODBlYWU1
MjljOTRhN2Y0N2RlY2NmYWRhMjhhY2I5ZGblb7ENAAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30A
AAAASUVORK5CYII=" />                                                 <img alt="3" src="data:image/png;base64,
iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAAB4SURBVHja
JU6rFcNADBM09BqBhl6ltDCwKxQeDOwKB7tGYGCoYaChK6cmlt7TD1W5uap/sgoVBnEXWBTSoOdx
7gpLDOAVorWC0ABdcBPqwZtx8Muf+DPXJpQ96Nu/LSMYl/n17oCOnplTOrpiwW3sUs4ZJmob5/wA
Ubg1Y/zrjUwAAABDdEVYdFNvZnR3YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8wMSBj
cmlzdHlAbXlzdGljLmVzLmR1cG9udC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUAODBiYmRhMjcy
NmRkYWNlOGFiOGEwMWY1OWRlMmViZGII/Q51AAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30AAAAA
SUVORK5CYII=" />       <img alt="4" src="data:image/png;base64,
iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAABzSURBVHja
HY0hEoUwEEMjkZVYZGVlr1CJxCKRXKPyy28reyVsZeXKsCFi573ZzAQk+x5jaQ6gFQAxIA8XceEN
ZEN3DkOCH/TobUoSVuAYwSSLyzbvaHWVFJxUmmp+PF+twrLkuXzLwPmZ8+OjtH8KS6pGvuoGNo5b
6rzDAAAAQ3RFWHRTb2Z0d2FyZQBAKCMpSW1hZ2VNYWdpY2sgNC4yLjggOTkvMDgvMDEgY3Jpc3R5
QG15c3RpYy5lcy5kdXBvbnQuY29tkbohuAAAACp0RVh0U2lnbmF0dXJlADlmODJmY2FjOWUwMzlj
YmRiNzIzODBhNDU5MTMyNGY1gLv4dgAAAA50RVh0UGFnZQAxMngxMiswKzCEbbt9AAAAAElFTkSu
QmCC" />
$ rekal --profile Win7SP0x64 --filename win7_trial_64bit.raw pslist --proc_reg DumpIt
  Offset (V)   Name                    PID   PPID   Thds     Hnds   Sess  Wow64 Start                Exit
-------------- -------------------- ------ ------ ------ -------- ------ ------ -------------------- --------------------
0xfa8001016060 DumpIt.exe             2860   1652      2       42      1   True 2012-02-22 11:28:59  -</code></pre>
</div></div>
<div class="colist arabic"><table>
<tr><td><img alt="1" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAABjSURBVHja
VY6xDcAwCAS/pPQaLim9QmajdOk2I2SNrMEIlARIoigU8Cek/4e7zdHaWOYOVwaoA6wOCw05Y7FB
gE0tIWQ+sBcwKM8qoD/wB5wGL8hjfdzWrh01GRp1hInGjDoXwHgsFuzBVLQAAABDdEVYdFNvZnR3
YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8wMSBjcmlzdHlAbXlzdGljLmVzLmR1cG9u
dC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUANThhMDcyZTA3MGRhMjJmNjEzNWNiZDNlNDE0NTQ2
ZjloaiHtAAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30AAAAASUVORK5CYII=" /></td><td>
The rekall program name (rekal).
</td></tr>
<tr><td><img alt="2" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAAB7SURBVHja
HY6hFcMwDEQ/NDQsNSwU9Apdo7Cw0CsIBoZmhKzQEQJLDQsFVclHpHu693W429Zr7bu541Pg3kCm
Y0K75u9TEUPhuGgWU4mQDvieEaSQEnsT6zKPeZY0EUNtrHMCXvYUuSUg0PsMjUSvpysUT6OOSil9
izp/VNk1YJ8vf6MAAABDdEVYdFNvZnR3YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8w
MSBjcmlzdHlAbXlzdGljLmVzLmR1cG9udC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUAODBlYWU1
MjljOTRhN2Y0N2RlY2NmYWRhMjhhY2I5ZGblb7ENAAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30A
AAAASUVORK5CYII=" /></td><td>
These are global options which are processed by the main rekall
executable (in this case --profile, --filename).
</td></tr>
<tr><td><img alt="3" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAAB4SURBVHja
JU6rFcNADBM09BqBhl6ltDCwKxQeDOwKB7tGYGCoYaChK6cmlt7TD1W5uap/sgoVBnEXWBTSoOdx
7gpLDOAVorWC0ABdcBPqwZtx8Muf+DPXJpQ96Nu/LSMYl/n17oCOnplTOrpiwW3sUs4ZJmob5/wA
Ubg1Y/zrjUwAAABDdEVYdFNvZnR3YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8wMSBj
cmlzdHlAbXlzdGljLmVzLmR1cG9udC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUAODBiYmRhMjcy
NmRkYWNlOGFiOGEwMWY1OWRlMmViZGII/Q51AAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30AAAAA
SUVORK5CYII=" /></td><td>
The name of the command plugin to run. This will actually run the first
class to extend plugin.Command() which is also active (in this case
pslist. Since the profile is a windows profile, the WinPSList class will be
invoked).
</td></tr>
<tr><td><img alt="4" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAABzSURBVHja
HY0hEoUwEEMjkZVYZGVlr1CJxCKRXKPyy28reyVsZeXKsCFi573ZzAQk+x5jaQ6gFQAxIA8XceEN
ZEN3DkOCH/TobUoSVuAYwSSLyzbvaHWVFJxUmmp+PF+twrLkuXzLwPmZ8+OjtH8KS6pGvuoGNo5b
6rzDAAAAQ3RFWHRTb2Z0d2FyZQBAKCMpSW1hZ2VNYWdpY2sgNC4yLjggOTkvMDgvMDEgY3Jpc3R5
QG15c3RpYy5lcy5kdXBvbnQuY29tkbohuAAAACp0RVh0U2lnbmF0dXJlADlmODJmY2FjOWUwMzlj
YmRiNzIzODBhNDU5MTMyNGY1gLv4dgAAAA50RVh0UGFnZQAxMngxMiswKzCEbbt9AAAAAElFTkSu
QmCC" /></td><td>
These options are specific to the plugin - i.e. they have been defined in
the args() classmethod (in this case the process name regex selector).
</td></tr>
</table></div>
<div class="paragraph"><p>Rekall is strict with the order in which commands are supplied. For example it
is not valid to provide the --proc_reg parameter before the pslist keyword
(since it is a module level parameter). Similarly it is not legal to provide the
--filename parameter after the command name (pslist). This strictness allows
different modules to define the same command line option for their own needs and
avoids any command line option clashes between different plugins.</p></div>
<div class="paragraph"><p>This strictness can easily be observed when requesting help. Without a module
name, the help output simply lists those options processed by the main program
(i.e. global options). It also provides a list of available modules:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ rekal --help
usage: rekal [-h] [--pager PAGER]
             [--logging {debug,info,warning,critical,error}] [--debug]
             [-p PROFILE] [-f FILENAME] [--renderer RENDERER]
             [--plugin PLUGIN [PLUGIN ...]] [--output OUTPUT] [--overwrite]
             Plugin ...

optional arguments:
  -h, --help            show this help message and exit
  --pager PAGER         The pager to use when output is larger than a screen
                        full.
  --logging {debug,info,warning,critical,error}
                        Logging level to show messages.
  --debug               If set we break into the debugger on error conditions.
  -p PROFILE, --profile PROFILE
                        Name of the profile to load.
  -f FILENAME, --filename FILENAME
                        The raw image to load.
  --renderer RENDERER   The renderer to use. e.g. (TextRenderer,
                        JsonRenderer).
  --plugin PLUGIN [PLUGIN ...]
                        Load user provided plugin bundle.
  --output OUTPUT       Write to this output file.
  --overwrite           Allow overwriting of output files.

subcommands:
  The following plugins can be selected.

  Plugin
    modscan             Scan Physical memory for _LDR_DATA_TABLE_ENTRY
                        objects.
    driverscan          Scan for driver objects _DRIVER_OBJECT
    memmap              Calculates the memory regions mapped by a process.
    load_as             Load address spaces into the session if its not
                        already loaded.</code></pre>
</div></div>
<div class="paragraph"><p>Once the module is provided, we see a per-module help output:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ rekal pslist --help
usage: rekal pslist [-h] [--kdbg KDBG] [--eprocess EPROCESS [EPROCESS ...]]
                     [--phys_eprocess PHYS_EPROCESS [PHYS_EPROCESS ...]]
                     [--pid PID [PID ...]] [--proc_regex PROC_REGEX]

List processes for windows.

optional arguments:
  -h, --help            show this help message and exit
  --kdbg KDBG           Location of the KDBG structure.
  --eprocess EPROCESS [EPROCESS ...]
                        Kernel addresses of eprocess structs.
  --phys_eprocess PHYS_EPROCESS [PHYS_EPROCESS ...]
                        Physical addresses of eprocess structs.
  --pid PID [PID ...]   One or more pids of processes to select.
  --proc_regex PROC_REGEX
                        A regex to select a profile by name.</code></pre>
</div></div>
</div>
<div class="sect2">
<h3 id="_interactive_session_invocation">2.3. Interactive Session Invocation.</h3>
<div class="paragraph"><p>When invoked without a command name, Rekall drops into the interactive
shell. This mode of operation is more efficient as many commands can be run
without needing to reinitialize the framework each time.</p></div>
<div class="paragraph"><p>This is what happens during initialization:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ rekal --profile Win7SP0x64 --filename win7_trial_64bit.raw
Python 2.6.5 (r265:79063, Apr 16 2010, 13:57:41)
Type "copyright", "credits" or "license" for more information.

The Rekall Memory Forensic Framework

"We can remember it for you wholesale!"

This program is free software; you can redistribute it and/or modify it under
the terms of the GNU General Public License.

Win7SP0x64:win7_trial_64bit.raw 01:32:55&gt; print session               <img alt="1" src="data:image/png;base64,
iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAABjSURBVHja
VY6xDcAwCAS/pPQaLim9QmajdOk2I2SNrMEIlARIoigU8Cek/4e7zdHaWOYOVwaoA6wOCw05Y7FB
gE0tIWQ+sBcwKM8qoD/wB5wGL8hjfdzWrh01GRp1hInGjDoXwHgsFuzBVLQAAABDdEVYdFNvZnR3
YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8wMSBjcmlzdHlAbXlzdGljLmVzLmR1cG9u
dC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUANThhMDcyZTA3MGRhMjJmNjEzNWNiZDNlNDE0NTQ2
ZjloaiHtAAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30AAAAASUVORK5CYII=" />
Rekall session Started on Sun Sep 23 01:32:57 2012.

Config:
 base_filename:  'win7_trial_64bit.raw'
 filename:  'win7_trial_64bit.raw'                                    <img alt="2" src="data:image/png;base64,
iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAAB7SURBVHja
HY6hFcMwDEQ/NDQsNSwU9Apdo7Cw0CsIBoZmhKzQEQJLDQsFVclHpHu693W429Zr7bu541Pg3kCm
Y0K75u9TEUPhuGgWU4mQDvieEaSQEnsT6zKPeZY0EUNtrHMCXvYUuSUg0PsMjUSvpysUT6OOSil9
izp/VNk1YJ8vf6MAAABDdEVYdFNvZnR3YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8w
MSBjcmlzdHlAbXlzdGljLmVzLmR1cG9udC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUAODBlYWU1
MjljOTRhN2Y0N2RlY2NmYWRhMjhhY2I5ZGblb7ENAAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30A
AAAASUVORK5CYII=" />
 logging:  'INFO'
 overwrite:  False
 pager:  &lt;Set this to your favourite pager.&gt;
 paging_limit:  50
...

Win7SP0x64:win7_trial_64bit.raw 01:33:07&gt; plugins.[tab][tab]          <img alt="3" src="data:image/png;base64,
iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAAB4SURBVHja
JU6rFcNADBM09BqBhl6ltDCwKxQeDOwKB7tGYGCoYaChK6cmlt7TD1W5uap/sgoVBnEXWBTSoOdx
7gpLDOAVorWC0ABdcBPqwZtx8Muf+DPXJpQ96Nu/LSMYl/n17oCOnplTOrpiwW3sUs4ZJmob5/wA
Ubg1Y/zrjUwAAABDdEVYdFNvZnR3YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8wMSBj
cmlzdHlAbXlzdGljLmVzLmR1cG9udC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUAODBiYmRhMjcy
NmRkYWNlOGFiOGEwMWY1OWRlMmViZGII/Q51AAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30AAAAA
SUVORK5CYII=" />
plugins.atoms           plugins.dlldump         plugins.handles
plugins.atomscan        plugins.dlllist         plugins.hivedump
plugins.callbacks       plugins.driverirp       plugins.hivescan
plugins.clipboard       plugins.driverscan      plugins.imagecopy
....

Win7SP0x64:win7_trial_64bit.raw 01:34:57&gt; pslist proc_regex="DumpIt"  <img alt="4" src="data:image/png;base64,
iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAABzSURBVHja
HY0hEoUwEEMjkZVYZGVlr1CJxCKRXKPyy28reyVsZeXKsCFi573ZzAQk+x5jaQ6gFQAxIA8XceEN
ZEN3DkOCH/TobUoSVuAYwSSLyzbvaHWVFJxUmmp+PF+twrLkuXzLwPmZ8+OjtH8KS6pGvuoGNo5b
6rzDAAAAQ3RFWHRTb2Z0d2FyZQBAKCMpSW1hZ2VNYWdpY2sgNC4yLjggOTkvMDgvMDEgY3Jpc3R5
QG15c3RpYy5lcy5kdXBvbnQuY29tkbohuAAAACp0RVh0U2lnbmF0dXJlADlmODJmY2FjOWUwMzlj
YmRiNzIzODBhNDU5MTMyNGY1gLv4dgAAAA50RVh0UGFnZQAxMngxMiswKzCEbbt9AAAAAElFTkSu
QmCC" />
----------------------------------------&gt; pslist(proc_regex="DumpIt")
  Offset (V)   Name                    PID   PPID   Thds     Hnds   Sess  Wow64 Start                Exit
-------------- -------------------- ------ ------ ------ -------- ------ ------ -------------------- --------------------
0xfa8001016060 DumpIt.exe             2860   1652      2       42      1   True 2012-02-22 11:28:59  -</code></pre>
</div></div>
<div class="colist arabic"><table>
<tr><td><img alt="1" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAABjSURBVHja
VY6xDcAwCAS/pPQaLim9QmajdOk2I2SNrMEIlARIoigU8Cek/4e7zdHaWOYOVwaoA6wOCw05Y7FB
gE0tIWQ+sBcwKM8qoD/wB5wGL8hjfdzWrh01GRp1hInGjDoXwHgsFuzBVLQAAABDdEVYdFNvZnR3
YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8wMSBjcmlzdHlAbXlzdGljLmVzLmR1cG9u
dC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUANThhMDcyZTA3MGRhMjJmNjEzNWNiZDNlNDE0NTQ2
ZjloaiHtAAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30AAAAASUVORK5CYII=" /></td><td>
A new session.Session() object is created. This holds all information about
the current running session.
</td></tr>
<tr><td><img alt="2" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAAB7SURBVHja
HY6hFcMwDEQ/NDQsNSwU9Apdo7Cw0CsIBoZmhKzQEQJLDQsFVclHpHu693W429Zr7bu541Pg3kCm
Y0K75u9TEUPhuGgWU4mQDvieEaSQEnsT6zKPeZY0EUNtrHMCXvYUuSUg0PsMjUSvpysUT6OOSil9
izp/VNk1YJ8vf6MAAABDdEVYdFNvZnR3YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8w
MSBjcmlzdHlAbXlzdGljLmVzLmR1cG9udC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUAODBlYWU1
MjljOTRhN2Y0N2RlY2NmYWRhMjhhY2I5ZGblb7ENAAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30A
AAAASUVORK5CYII=" /></td><td>
Global command line args are parsed into the session - so for example, the
--filename argument is parsed into session.filename.
</td></tr>
<tr><td><img alt="3" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAAB4SURBVHja
JU6rFcNADBM09BqBhl6ltDCwKxQeDOwKB7tGYGCoYaChK6cmlt7TD1W5uap/sgoVBnEXWBTSoOdx
7gpLDOAVorWC0ABdcBPqwZtx8Muf+DPXJpQ96Nu/LSMYl/n17oCOnplTOrpiwW3sUs4ZJmob5/wA
Ubg1Y/zrjUwAAABDdEVYdFNvZnR3YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8wMSBj
cmlzdHlAbXlzdGljLmVzLmR1cG9udC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUAODBiYmRhMjcy
NmRkYWNlOGFiOGEwMWY1OWRlMmViZGII/Q51AAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30AAAAA
SUVORK5CYII=" /></td><td>
The is_active() method for all command plugins is called, and the names of
all active plugins are collected. For example, if we have a windows based
profile, WinPSList will return True for is_active() and will be considered
active.
</td></tr>
<tr><td><img alt="4" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAABzSURBVHja
HY0hEoUwEEMjkZVYZGVlr1CJxCKRXKPyy28reyVsZeXKsCFi573ZzAQk+x5jaQ6gFQAxIA8XceEN
ZEN3DkOCH/TobUoSVuAYwSSLyzbvaHWVFJxUmmp+PF+twrLkuXzLwPmZ8+OjtH8KS6pGvuoGNo5b
6rzDAAAAQ3RFWHRTb2Z0d2FyZQBAKCMpSW1hZ2VNYWdpY2sgNC4yLjggOTkvMDgvMDEgY3Jpc3R5
QG15c3RpYy5lcy5kdXBvbnQuY29tkbohuAAAACp0RVh0U2lnbmF0dXJlADlmODJmY2FjOWUwMzlj
YmRiNzIzODBhNDU5MTMyNGY1gLv4dgAAAA50RVh0UGFnZQAxMngxMiswKzCEbbt9AAAAAElFTkSu
QmCC" /></td><td>
For all active commands, we create wrapper functions in the session object
and the namespace of the interactive shell. The wrapper will automatically set
up a TextRenderer, instantiate the plugin and call its render method with the
text renderer. For example, when the user types pslist() in the interactive UI,
we create a new TextRenderer, instantiate the WinPSList class and call its
render method.
</td></tr>
</table></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="as">3. Address Spaces.</h2>
<div class="sectionbody">
<div class="paragraph"><p>Rekall uses an address space to abstract the handling of different images
and formats and therefore allow plugins to support multiple kind of input images
(or indeed live memory) easiy.</p></div>
<div class="paragraph"><p>An <em>address space</em> is an object which can satisfy a read request for data at a
certain offset. Exactly how this read request is satisfied is not important to
the rest of the code, so long as the read request is satisfied.</p></div>
<div class="paragraph"><p>There are a number of simple address spaces which simply provide access to a
specific data source:</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
FileAddressSpace - Simply opens a file and satisfies read requests from it.
</p>
</li>
<li>
<p>
WindowsHiberFileSpace - Supports windows hibernation files.
</p>
</li>
</ol></div>
<div class="paragraph"><p>However, many other address spaces satisfy their read requests by translating
these to an underlying <em>base</em> address space which does the actual reading. This
is called <em>Address Space Stacking</em> since address spaces are stacked over one
another.</p></div>
<div class="paragraph"><p>For example, the WindowsCrashDumpSpace32 address space usually stacks over a
FileAddressSpace - which does the actual reading. All the
WindowsCrashDumpSpace32 does it translate the read request from a the provided
offset to another read request at a different offset. Commonly address space
stacking occurs when rekall emulates the hardware page translation by
creating a <em>Virtual Address Space</em> with the IA32PagedMemory and Amd64 paged
address spaces stacked over the <em>Physical Address Space</em>.</p></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img alt="img/address_space.jpg"
src="data:image/jpeg;base64,
/9j/4AAQSkZJRgABAQEAtQCHAAD//gATQ3JlYXRlZCB3aXRoIEdJTVD/2wBDAAUDBAQEAwUEBAQF
BQUGBwwIBwcHBw8LCwkMEQ8SEhEPERETFhwXExQaFRERGCEYGh0dHx8fExciJCIeJBweHx7/2wBD
AQUFBQcGBw4ICA4eFBEUHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4e
Hh4eHh4eHh7/wAARCAG4AsoDASIAAhEBAxEB/8QAHAABAQEBAQEBAQEAAAAAAAAAAAcGBQgEAwIB
/8QAYRAAAQIEAgIJDQoKCAQEBgMAAAECAwQFBgcREiEIExYXMVVWlNEUFSJBUVdhdZGSk9LTGDI3
OFNxgaKksSMnQkZUcnSyweEzUmJlZoKh1DQ1drMlJkPDCSRESYWVtMTw/8QAFQEBAQAAAAAAAAAA
AAAAAAAAAAH/xAAVEQEBAAAAAAAAAAAAAAAAAAAAEf/aAAwDAQACEQMRAD8A9lgAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAMtiPfVGsSnS09WIU5GbMxVhQ2SsNrnZomaquk5qZfT2zC+6Ksniu
4ebwfagWMEc90VZPFdw83g+1HuirJ4ruHm8H2oFjBHPdFWTxXcPN4PtR7oqyeK7h5vB9qBYwRz3R
Vk8V3DzeD7Ue6Ksniu4ebwfagWMEc90VZPFdw83g+1HuirJ4ruHm8H2oFjBHPdFWTxXcPN4PtR7o
qyeK7h5vB9qBYwRz3RVk8V3DzeD7Ue6Ksniu4ebwfagWMEc90VZPFdw83g+1HuirJ4ruHm8H2oFj
BPbAxdtm9K+lFpkpVYEysJ0VqzMFjWKjcs0za92vX3ChAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAARzZM/mf44b/
AALGRzZM/mf44b/AsYAAAAAAAAAAAAAAAAAAASSa+NNKeIl+95WySTXxppTxEv3vK2AAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAABHNkz+Z/jhv8Cxkc2TP5n+OG/wLGAAAAAAAAAAAAAAAAAAAEkmvjTSniJfveVskk18
aaU8RL97ytgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAARzZM/mf44b/AsZHNkz+Z/jhv8CxgAAAAAAAAAAAAAAAAA
ABJJr400p4iX73lbJJNfGmlPES/e8rYAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEM2V8aaatoy8o9kOK+civhucm
ei9u1o1e3q7LuH4ZY7ctaNzeH/tz99lR/wAzsn9si/vQTbBWCyx25a0bm8P/AG4yx25a0bm8P/bm
9ARgssduWtG5vD/24yx25a0bm8P/AG5vQBgssduWtG5vD/24yx25a0bm8P8A25vQBgssduWtG5vD
/wBuMsduWtG5vD/25vQBgssduWtG5vD/ANuMsduWtG5vD/25vQBgssduWtG5vD/24yx25a0bm8P/
AG5vQBgssduWtG5vD/24yx25a0bm8P8A25vQBL7Fi3XC2RVKZdlTlqhUIshEY6LAYjW7VtcRzU1M
brzb3D0aeaLpuSTtPH2l12oQo0SVl5LRipBRFciPbEZmiKqZ5K5FPQNr3LQrnp6T1CqUCdg8DtBc
nMXuOautq+BUA6wAAAAAAAAAAAAAAAAAAAAACJ4/z1fiX5a9v0i4qhRoU7DfpvlIz2dlpcKo1zdL
g4FU5W4W9u+zcPnxvbAegQeftwt7d9m4fPje2G4W9u+zcPnxvbAegQeftwt7d9m4fPje2G4W9u+z
cPnxvbAegQeftwt7d9m4fPje2G4W9u+zcPnxvbAegQeftwt7d9m4fPje2G4W9u+zcPnxvbAegQef
twt7d9m4fPje2G4W9u+zcPnxvbAegQeftwt7d9m4fPje2G4W9u+zcPnxvbAegQeftwt7d9m4fPje
2G4W9u+zcPnxvbAegQQ7AmcuGWxOuK26vclRrUCUlGua6ajPf2WkzWiOc7R1OVNSlxAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACEbLGMyXmrOmIme1wpmO92SdpFgqp+W+9Zv
y07zdek+3ZUNR0xZrXIios/ERUVNS64ZpetFJ4skvQN6ArG771m/LTvN16RvvWb8tO83XpNl1opP
Fkl6BvQOtFJ4skvQN6AjG771m/LTvN16RvvWb8tO83XpNl1opPFkl6BvQOtFJ4skvQN6AMbvvWb8
tO83XpG+9Zvy07zdek2XWik8WSXoG9A60UniyS9A3oAxu+9Zvy07zdekb71m/LTvN16TZdaKTxZJ
egb0DrRSeLJL0DegDG771m/LTvN16RvvWb8tO83XpNl1opPFkl6BvQOtFJ4skvQN6AMbvvWb8tO8
3XpG+9Zvy07zdek2XWik8WSXoG9A60UniyS9A3oAxu+9Zvy07zdekb71m/LTvN16TZdaKTxZJegb
0DrRSeLJL0DegCaWfW6TdmyGpE3JMWPJukYsF7Y8LJHZQYuaKi8KazfXTg3KJPrXLDqca2au1dJr
YLlSXevcyTW1F7iZt/smZocvAltkxSocvAhQWdbXrow2I1M9CJ2kL6FRmnYpXJaE5DpOKVCiwGuf
oQ6tKQ9KFE8Kompe72OvL8krFDq9LrlPZUKRPy89Kv4IkF6OTPuL3F8C6z9qjJSdRk4knUJSBNy0
VMnwo0NHscnhRdRKK5hDO0WoPrmGVcjUSez0nScWIrpeJ/Z1ourwORyfMEV8EgoWL03R59lDxMoc
ehz2ei2chw1WXi/2u3q8LVcnzFYp87J1GThzshNQJqWipnDiwXo9jk8CpqUD9wAAAAAAAAAAAAAA
ARHGz4Z7I/Uf+8psTHY2fDPZH6j/AN5TYgAAAAAAAAAAAAAAAAAABjMIvh+u/wDYm/fCLgQ/CL4f
rv8A2Jv3wi4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABENlN/xVm/t7/v
hmyMbspv+Ks39vf98M2QAAAAAAAAAAAAAAAAAAAYSmfGcpXix/7kQvBB6Z8ZyleLH/uRC8AAAB8N
co9Krkg+QrFPl56Wfww4zEciL3U7i+FNZJ5/C65bPnH1bC6vRYTVXSiUmciaUKJ4EVdS9zsslT+s
WYASm1cZJPq9tDvqmRrYq7dTnRmqku9e7mutqL4c0/tFTgRYUeCyNAisiwnojmPY5HNci8CoqcKH
Lum2aFdEgslXaZAnYWvQV7cnw1Xttcmtq/MpLI1h35h7GdO4dVh9VpiKrn0eedn4V0eBF+dNF3zg
WoE0srGKg1ebSkXBBi23WWLoRJed7Biu7iPXLJfA5EXuZlLRUVEVFRUXgVAAAAAAAAAAPzgzECO6
I2DHhxFhu0Xox6Lou7i5cCn6ARHGz4Z7I/Uf+8psSc7ImQdV8XLXpSzUWWbGlNFIkNeyYqxH5qnh
1IfhvTf4vrPnfzApoJlvTf4vrPnfzG9N/i+s+d/MCmgmW9N/i+s+d/Mb03+L6z538wKaCZb03+L6
z538xvTf4vrPnfzApoJlvTf4vrPnfzG9N/i+s+d/MCmgmW9N/i+s+d/Mb03+L6z538wKaCZb03+L
6z538xvTf4vrPnfzApoJlvTf4vrPnfzG9N/i+s+d/MDtYRfD9d/7E374RcDzxgDTVouN1xUrquNN
JBpjkWLFXsn9nBXNfKehwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAiGym
/wCKs39vf98M2Rh9llFiQn2isGHtkVJqM9jf6yptWSfTmcrdjiPyC+s7pCqaCZbscR+QX1ndI3Y4
j8gvrO6QimgmW7HEfkF9Z3SN2OI/IL6zukCmgmW7HEfkF9Z3SN2OI/IL6zukCmgmW7HEfkF9Z3SN
2OI/IL6zukCmgmW7HEfkF9Z3SN2OI/IL6zukCmgmW7HEfkF9Z3SN2OI/IL6zukCmgmW7HEfkF9Z3
SN2OI/IL6zukDpUz4zlK8WP/AHIheDzXh5U6xUdkNSJiuUnrZNOkorEg5r71IURUd9Os9KAAAAAP
4jRYUCGsSNFZDYnC57kRE+lQP7Bn6je9nU/Pqy6KPCc3hZ1YxX+ai5/6GcqONOHMmrmpXlmXp+TA
lYrv9dHR/wBQNDetk21eEptFcpsONERqthzDOxjQv1Xpr8OS5p3UUmjrdxMwyVYtqzrrqt+GmunT
GaxoTe4xE16k/qeYfdFx+tuNEWFR6DX6lETtMgNRP9HKvd7R/O+hiDUcko+FFTYi8ESbe9rV4O6x
qd3tgaOwsV7XuqKki+K6kVZF0XSU4qMcru2jHcDtfa1L4DfHnS8bPxQxBiNjVay7bpcZNTZpIujG
y7jlbEcqpr4FTV3D4rjoOOVoW/DayuzU9ToTeyWnx1ixICdxdJqPyRO5mieAD0wfHUKtSqcirUKl
JSiJ8vHaz718KHnmwrdo2ILUhzuK1wzc6uuJIzDlgxU4feo570cif2c8u3lmb2n4B2BLLnHZVJ7u
7fNZZ+YjQNNUMTsP5HPb7spj8vkIm3fuZmcqOPWH0rntEzUJ7L5CUVM/P0f/APKaCnYWYeyCosC1
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" />
</div>
<div class="title">Figure 1. A sample address space stacking.</div>
</div>
<div class="paragraph"><p>The figure above shows an IA32PagedMemory Virtual address space stacked over a
FileAddressSpace physical address space. A read request to the virtual address
space get translated through the page tables into a read in the physical memory
address space. The other interesting point is that the Virtual Address space is
sparse - i.e. there are regions where a read request is meaningless because
there is no valid mapping. This happens in the IA32PagedMemory address space
whenever there is no corresponding page translation.</p></div>
<div class="paragraph"><p>New address spaces, should extend the BaseAddressSpace class and implement at
least:</p></div>
<div class="dlist"><dl>
<dt class="hdlist1">
<code>__init__(base, **kwargs)</code>
</dt>
<dd>
<p>
 You will receive the address space you need to stack over. The constructor is
 supposed to implement the required sanity checks. If it is not possible to
 stack over the base address for some reason, you must raise an
 ASAssertionError(). Its best to use self.as_assert() to test for various
 conditions.
</p>
</dd>
<dt class="hdlist1">
<code>read(address, length)</code>
</dt>
<dd>
<p>
 This function should return a buffer read at the specified address. If the
 address is invalid it should return a null padded buffer instead. Note that in
 general memory forensics should expect a read to fail since any page can be
 invalid at any time. To determine if the page is really invalid callers can use
 the vrop() method below.
</p>
</dd>
<dt class="hdlist1">
<code>vtop(address)</code>
</dt>
<dd>
<p>
 This function returns the physical translation for the virtual address. I.e. it
 returns the offset that this AS will be reading into its base. If the address
 is invalid returns None. This is a quick way to check if a certain address is
 valid.
</p>
</dd>
<dt class="hdlist1">
<code>get_address_ranges()</code>
</dt>
<dd>
<p>
 Many address spaces are sparse and quite large (e.g. AMD64PagedMemory). When
 scanning these address spaces we need to know which regions are valid so we can
 skip unmapped regions. This function basically returns a list of ranges which
 are valid.
</p>
</dd>
</dl></div>
<div class="paragraph"><p>Many image file formats implement essentially a sparse file (i.e. the image
consists of sections which are stored back to back but which refer to sparse
memory regions.). To make it easier to support these there is a generic
RunBasedAddressSpace. Extending this class and populating the self.runs array
with the mappings from virtual space to physical space is all that is required
to support these image file formats. Currently the address spaces which are
supported in this way are WindowsCrashDumpSpace, Elf64CoreDump (for virtual
box), MACHOCoreDump (for osx).</p></div>
<div class="sect2">
<h3 id="_automatic_address_space_selection">3.1. Automatic Address Space Selection</h3>
<div class="paragraph"><p>Most rekall plugins expect to have valid address spaces set in the session
object before they run. There are two main session parameters which are commonly
required, the <em>session.physical_address_space</em> and
<em>session.kernel_address_space</em>. Usually if these parameters are not provided in
the session, the plugins will automatically invoke the <em>load_as()</em> plugin.</p></div>
<div class="paragraph"><p>The load_as plugin is just a regular command plugin, which means that it can be
implemented by different plugin.Command() classes (autoselected via the
is_active() class method - see <a href="#commands">Command Plugin</a>). This means we can
have one implementation for windows, one for linux etc.</p></div>
<div class="paragraph"><p>The load_as plugin is responsible for loading two different address spaces. The
physical address space refers to loading the image in whatever format it might
be into a direct linear address space. The kernel virtual address space is the
view of the virtual memory as seen by the kernel.</p></div>
<div class="paragraph"><p>The physical address space is derived by an automatic voting algorithm to
auto-detect the memory image format:</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
Start with the None address space and pass it to all address spaces in their
requested order (classes are sorted by their <em>order</em> attribute). Address spaces
which are incompatible with the base address space will raise ASAssertionError
and will be skipped.
</p>
</li>
<li>
<p>
The first address space which instantiates successfully, will be accepted as
the next base address space.
</p>
</li>
<li>
<p>
The process is repeated until all address spaces failed to instantiate. We
then return the last successfully instantiated address space.
</p>
</li>
</ol></div>
<div class="paragraph"><p>For example, suppose we have a Windows Crash dump image which we compressed
using the EWF format. In the first voting round, the EWF address space will
detect that this is a valid EWF format, and will be selected. Then all the other
image address spaces will be tried on the decompressed EWF image, and the crash
dump address space will detect it as a valid crash dump.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img alt="Note" src="data:image/png;base64,
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" />
</td>
<td class="content">
<div class="paragraph"><p>For an address space to be eligible to participate in physical address space
voting, it must have the <code>_md_image</code> attribute set. This indicate that this
address space applies to a memory image.</p></div>
</td>
</tr></table>
</div>
<div class="paragraph"><p>In the windows <code>load_as()</code> plugin, the virtual address space is created from the
kernel&#8217;s Directory Table Base (DTB). If the DTB is not directly provided, the
<code>load_as()</code> plugin employs the <code>find_dtb()</code> plugin to detect the dtb. On
Windows, the <code>find_dtb()</code> plugin scans the image for the Idle process. In other
implementations, the kernel DTB is calculated using some other way
(e.g. directly from debug symbols). The correct <code>find_dtb()</code> plugin for the
selected profile will be used, allowing a different algorithm to be used for
windows or linux.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img alt="Note" src="data:image/png;base64,
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" />
</td>
<td class="content">
<div class="paragraph"><p>Finding the kernel&#8217;s DTB is required before we can construct the kernel&#8217;s
address space. Without a valid DTB there is very little analysis Rekall can do. Furthermore, in many operating system&#8217;s finding the kernel DTB is a slow and error prone process. For this reason its always better for the acquisition tool to provide us with the correct DTB value in advance. Some imaging tools print the value to the console, while some store it in the image (e.g. in Crash dumps).</p></div>
<div class="paragraph"><p>Rekall&#8217;s Pmem imaging tools store the value of the DTB (found from the CR3
register during imaging) when writing to the following image formats: Crash
Dump, ELF, MACHO. When writing to a raw image, image metadata can optionally be
appended to the end of the raw file.</p></div>
</td>
</tr></table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_object_parsing_system">4. The object parsing system.</h2>
<div class="sectionbody">
<div class="paragraph"><p>Computers use volatile memory in order to organize data and for program
control. Memory analysis is ultimately all about trying to make sense of a
memory image, and deducing higher level constructs from the low level "ones and
zeros" in memory.</p></div>
<div class="paragraph"><p>For example, if a C program defines the following struct:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">typedef</span></span> <span style="color: #009900">unsigned</span> <span style="color: #009900">char</span> uchar<span style="color: #990000">;</span>
<span style="font-weight: bold"><span style="color: #0000FF">enum</span></span> <span style="color: #FF0000">{</span>
  OPT1<span style="color: #990000">,</span>
  OPT2
<span style="color: #FF0000">}</span> options<span style="color: #990000">;</span>

<span style="font-weight: bold"><span style="color: #0000FF">struct</span></span> <span style="color: #008080">foobar</span> <span style="color: #FF0000">{</span>
    <span style="font-weight: bold"><span style="color: #0000FF">enum</span></span> <span style="color: #008080">options</span> flags<span style="color: #990000">;</span>
    <span style="color: #009900">short</span> <span style="color: #009900">int</span> bar<span style="color: #990000">;</span>
    <span style="color: #008080">uchar</span> <span style="color: #990000">*</span>foo<span style="color: #990000">;</span>
<span style="color: #FF0000">}</span></tt></pre></div></div>
<div class="paragraph"><p>What should the memory layout be? The answer is not so simple - it depends on
many things such as the compiler used, architecture etc. For example, the
compiler might enforce an alignment on the struct members by inserting padding
between elements. The compiler may use 32 bits to store integers, or maybe 64
bits.</p></div>
<div class="paragraph"><p>In practice it is impossible to predict from source code alone what the memory
layout should be. We therefore need the compiler itself to inform us about how
it is planning to lay out the memory in practice. This information is available
through debug symbol.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img alt="Note" src="data:image/png;base64,
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" />
</td>
<td class="content">
<div class="paragraph"><p>Rekall is in many ways emulating a native debugger. Just like a debugger,
rekall is making sense from the memory image, using debugging symbols.</p></div>
</td>
</tr></table>
</div>
<div class="paragraph"><p>There are basically two types of debugging systems - the Microsoft PDB system
and the DWARF standard.</p></div>
<div class="dlist"><dl>
<dt class="hdlist1">
DWARF
</dt>
<dd>
<p>
  This standard is used mostly on Unix like operating systems (e.g. Linux or
  OSX). It consists of a DWARF section attached to the binary object (e.g. ELF
  file) with a specially encoded stream providing information about symbols,
  structures and offsets. In order to obtain debugging information, the binary
  must be rebuilt with the appropriate flags.
</p>
</dd>
<dt class="hdlist1">
Microsoft PDB
</dt>
<dd>
<p>
 This standard keeps debugging information outside the final binary. The pdb
 file contains the debugging information, and is stored on a server (may be
 private or public). The advantage of this system is that debugging symbols may
 be obtained for release binaries as well (i.e. you do not need to build with
 debugging turned on before hand).
</p>
</dd>
</dl></div>
<div class="paragraph"><p>Another important concept to understand is that of a <em>Compilation Unit</em>. A
compilation unit is a self consistent unit of compiled code which uses the same
memory layout for structs. For example a DLL or an object file is a compilation
unit. It is important to note that the same struct may be defined with the same
name but different layout in different compilation units without any problem.</p></div>
<div class="paragraph"><p>In Rekall we want to derive high level semantic information from the low level
memory layout. We use the object system to instantiate high level classes (with
behaviours at specified memory addresses). The Rekall <code>object system</code> is built
on top of the base class found in <code>rekall.obj.BaseObject()</code>:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="font-weight: bold"><span style="color: #000000">BaseObject</span></span><span style="color: #990000">(</span>object<span style="color: #990000">):</span>
    <span style="font-weight: bold"><span style="color: #0000FF">def</span></span> <span style="font-weight: bold"><span style="color: #000000">__init__</span></span><span style="color: #990000">(</span>self<span style="color: #990000">,</span> theType<span style="color: #990000">=</span>None<span style="color: #990000">,</span> offset<span style="color: #990000">=</span><span style="color: #993399">0</span><span style="color: #990000">,</span> vm<span style="color: #990000">=</span>None<span style="color: #990000">,</span> profile<span style="color: #990000">=</span>None<span style="color: #990000">,</span>
                 parent<span style="color: #990000">=</span>None<span style="color: #990000">,</span> name<span style="color: #990000">=</span><span style="color: #FF0000">''</span><span style="color: #990000">,</span> context<span style="color: #990000">=</span>None<span style="color: #990000">,</span> <span style="color: #990000">**</span>kwargs<span style="color: #990000">):</span>
<span style="font-style: italic"><span style="color: #9A1900">        """Constructor for Base object.</span></span>

<span style="font-style: italic"><span style="color: #9A1900">        Args:</span></span>

<span style="font-style: italic"><span style="color: #9A1900">          theType: The name of the type of this object. This different</span></span>
<span style="font-style: italic"><span style="color: #9A1900">             from the class name, since the same class may implement many types</span></span>
<span style="font-style: italic"><span style="color: #9A1900">             (e.g. Struct implements every instance in the vtype definition).</span></span>

<span style="font-style: italic"><span style="color: #9A1900">          offset: The offset within the address space to this object exists.</span></span>

<span style="font-style: italic"><span style="color: #9A1900">          vm: The address space this object uses to read itself from.</span></span>

<span style="font-style: italic"><span style="color: #9A1900">          profile: The profile this object may use to dereference other</span></span>
<span style="font-style: italic"><span style="color: #9A1900">           types.</span></span>

<span style="font-style: italic"><span style="color: #9A1900">          parent: The object which created this object.</span></span>

<span style="font-style: italic"><span style="color: #9A1900">          name: The name of this object.</span></span>

<span style="font-style: italic"><span style="color: #9A1900">          context: An opaque dict which is passed to all objects created from</span></span>
<span style="font-style: italic"><span style="color: #9A1900">            this object. This dict may contain context specific information</span></span>
<span style="font-style: italic"><span style="color: #9A1900">            which each derived instance can use.</span></span>

<span style="font-style: italic"><span style="color: #9A1900">          kwargs: Arbitrary args this object may accept - these can be passed in</span></span>
<span style="font-style: italic"><span style="color: #9A1900">             the vtype language definition.</span></span>
<span style="font-style: italic"><span style="color: #9A1900">        """</span></span>
<span style="color: #990000">....</span></tt></pre></div></div>
<div class="paragraph"><p>So in order to instantiate a Rekall object, we need to provide at a minimum an
address space to read and an offset of where in the address space to read. More
complex objects may require more parameters. For example, to define a <code>Struct</code>
class we also need to provide the list of members and the total size of the
struct:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="font-weight: bold"><span style="color: #000000">Struct</span></span><span style="color: #990000">(</span>BaseAddressComparisonMixIn<span style="color: #990000">,</span> BaseObject<span style="color: #990000">):</span>
<span style="font-style: italic"><span style="color: #9A1900">    """ A Struct is an object which represents a c struct</span></span>

<span style="font-style: italic"><span style="color: #9A1900">    Structs have members at various fixed relative offsets from our own base</span></span>
<span style="font-style: italic"><span style="color: #9A1900">    offset.</span></span>
<span style="font-style: italic"><span style="color: #9A1900">    """</span></span>
    <span style="font-weight: bold"><span style="color: #0000FF">def</span></span> <span style="font-weight: bold"><span style="color: #000000">__init__</span></span><span style="color: #990000">(</span>self<span style="color: #990000">,</span> members <span style="color: #990000">=</span> None<span style="color: #990000">,</span> struct_size <span style="color: #990000">=</span> <span style="color: #993399">0</span><span style="color: #990000">,</span> <span style="color: #990000">**</span>kwargs<span style="color: #990000">):</span>
       <span style="color: #990000">....</span>

<span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="font-weight: bold"><span style="color: #000000">String</span></span><span style="color: #990000">(</span>obj<span style="color: #990000">.</span>StringProxyMixIn<span style="color: #990000">,</span> obj<span style="color: #990000">.</span>NativeType<span style="color: #990000">):</span>
<span style="font-style: italic"><span style="color: #9A1900">    """Class for dealing with Null terminated C Strings.</span></span>
<span style="font-style: italic"><span style="color: #9A1900">    """</span></span>
    <span style="font-weight: bold"><span style="color: #0000FF">def</span></span> <span style="font-weight: bold"><span style="color: #000000">__init__</span></span><span style="color: #990000">(</span>self<span style="color: #990000">,</span> length <span style="color: #990000">=</span> <span style="color: #993399">1024</span><span style="color: #990000">,</span> term<span style="color: #990000">=</span><span style="color: #FF0000">"\x00"</span><span style="color: #990000">,</span> <span style="color: #990000">**</span>kwargs<span style="color: #990000">):</span>
        <span style="color: #990000">....</span>

<span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="font-weight: bold"><span style="color: #000000">Pointer</span></span><span style="color: #990000">(</span>NativeType<span style="color: #990000">):</span>
<span style="font-style: italic"><span style="color: #9A1900">    """A pointer reads an 'address' object from the address space."""</span></span>

    <span style="font-weight: bold"><span style="color: #0000FF">def</span></span> <span style="font-weight: bold"><span style="color: #000000">__init__</span></span><span style="color: #990000">(</span>self<span style="color: #990000">,</span> target<span style="color: #990000">=</span>None<span style="color: #990000">,</span> target_args<span style="color: #990000">=</span>None<span style="color: #990000">,</span> value<span style="color: #990000">=</span>None<span style="color: #990000">,</span> <span style="color: #990000">**</span>kwargs<span style="color: #990000">):</span>
<span style="font-style: italic"><span style="color: #9A1900">        """Constructor.</span></span>

<span style="font-style: italic"><span style="color: #9A1900">        Args:</span></span>
<span style="font-style: italic"><span style="color: #9A1900">           target: The name of the target object (A string). We use the profile</span></span>
<span style="font-style: italic"><span style="color: #9A1900">             to instantiate it.</span></span>
<span style="font-style: italic"><span style="color: #9A1900">           target_args: The target will receive these as kwargs.</span></span>
<span style="font-style: italic"><span style="color: #9A1900">        """</span></span>
        <span style="color: #990000">....</span></tt></pre></div></div>
<div class="paragraph"><p>In the above examples of Rekall objects, new keyword args are introduced which
are specific for each new type. Note in particular the use the keyword arg
<code>target</code> and <code>target_args</code> which by convention are used for any class which will
instantiate some other class. For example, the pointer is told which class will
be instantiated upon de-referencing the pointer (i.e. which object it is
pointing to). Similarly the Array() object is told which object will be
constructed at each slot of the array. We try to be consistent with the keyword
naming to make remembering of these keywords easier.</p></div>
<div class="paragraph"><p>The object system allows us to instantiate high level objects at specified
offsets in the address space. However, this is not very convenient to do by hand
since we would need to know where in the address space we should instantiate
each object ourselves. What we need is a way to control the creation of Rekall
object automatically by using debug symbol information. This is done through the
<code>profile</code> object, and its <code>vtype language</code> definitions.</p></div>
<div class="sect2">
<h3 id="_the_vtypes_language">4.1. The VTypes language.</h3>
<div class="paragraph"><p>In order to control object creation automatically, we need to describe how they
are to be created. This description is termed the <code>vtypes language</code>. It is
really a data driven description of how to create instances of the <code>Struct()</code>
class.</p></div>
<div class="paragraph"><p>The precise format of a <code>vtype language</code> struct definition is as follows:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-style: italic"><span style="color: #9A1900">#     <img alt="1" src="data:image/png;base64,
iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAABjSURBVHja
VY6xDcAwCAS/pPQaLim9QmajdOk2I2SNrMEIlARIoigU8Cek/4e7zdHaWOYOVwaoA6wOCw05Y7FB
gE0tIWQ+sBcwKM8qoD/wB5wGL8hjfdzWrh01GRp1hInGjDoXwHgsFuzBVLQAAABDdEVYdFNvZnR3
YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8wMSBjcmlzdHlAbXlzdGljLmVzLmR1cG9u
dC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUANThhMDcyZTA3MGRhMjJmNjEzNWNiZDNlNDE0NTQ2
ZjloaiHtAAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30AAAAASUVORK5CYII=" />            <img alt="2" src="data:image/png;base64,
iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAAB7SURBVHja
HY6hFcMwDEQ/NDQsNSwU9Apdo7Cw0CsIBoZmhKzQEQJLDQsFVclHpHu693W429Zr7bu541Pg3kCm
Y0K75u9TEUPhuGgWU4mQDvieEaSQEnsT6zKPeZY0EUNtrHMCXvYUuSUg0PsMjUSvpysUT6OOSil9
izp/VNk1YJ8vf6MAAABDdEVYdFNvZnR3YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8w
MSBjcmlzdHlAbXlzdGljLmVzLmR1cG9udC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUAODBlYWU1
MjljOTRhN2Y0N2RlY2NmYWRhMjhhY2I5ZGblb7ENAAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30A
AAAASUVORK5CYII=" /></span></span>
<span style="color: #FF0000">"Struct Name"</span><span style="color: #990000">:</span> <span style="color: #990000">[</span>Struct Size<span style="color: #990000">:</span> <span style="color: #990000">{</span>
<span style="font-style: italic"><span style="color: #9A1900">#        <img alt="3" src="data:image/png;base64,
iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAAB4SURBVHja
JU6rFcNADBM09BqBhl6ltDCwKxQeDOwKB7tGYGCoYaChK6cmlt7TD1W5uap/sgoVBnEXWBTSoOdx
7gpLDOAVorWC0ABdcBPqwZtx8Muf+DPXJpQ96Nu/LSMYl/n17oCOnplTOrpiwW3sUs4ZJmob5/wA
Ubg1Y/zrjUwAAABDdEVYdFNvZnR3YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8wMSBj
cmlzdHlAbXlzdGljLmVzLmR1cG9udC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUAODBiYmRhMjcy
NmRkYWNlOGFiOGEwMWY1OWRlMmViZGII/Q51AAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30AAAAA
SUVORK5CYII=" />             <img alt="4" src="data:image/png;base64,
iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAABzSURBVHja
HY0hEoUwEEMjkZVYZGVlr1CJxCKRXKPyy28reyVsZeXKsCFi573ZzAQk+x5jaQ6gFQAxIA8XceEN
ZEN3DkOCH/TobUoSVuAYwSSLyzbvaHWVFJxUmmp+PF+twrLkuXzLwPmZ8+OjtH8KS6pGvuoGNo5b
6rzDAAAAQ3RFWHRTb2Z0d2FyZQBAKCMpSW1hZ2VNYWdpY2sgNC4yLjggOTkvMDgvMDEgY3Jpc3R5
QG15c3RpYy5lcy5kdXBvbnQuY29tkbohuAAAACp0RVh0U2lnbmF0dXJlADlmODJmY2FjOWUwMzlj
YmRiNzIzODBhNDU5MTMyNGY1gLv4dgAAAA50RVh0UGFnZQAxMngxMiswKzCEbbt9AAAAAElFTkSu
QmCC" />            <img alt="5" src="data:image/png;base64,
iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAAB2SURBVHja
FY6hEcQwDAQPChqGGhoaqgWX8PUYBhqGBn4rX0JooKDh/UlsZ3b2BJKXH8XPTYLh1lpt1h+BwxkR
A23jhsCQd2IkfH9T3HEkzPFegCXUKSUSpJUPsN7UFOgc9VkZUBoz9l0yrVHZarUcJZeb9XznDyNb
Ny9CX3/7AAAAQ3RFWHRTb2Z0d2FyZQBAKCMpSW1hZ2VNYWdpY2sgNC4yLjggOTkvMDgvMDEgY3Jp
c3R5QG15c3RpYy5lcy5kdXBvbnQuY29tkbohuAAAACp0RVh0U2lnbmF0dXJlAGZlNjkwNDYzMzc5
ZWIyNWU1NjJmY2M4Y2M5YjNjN2Uw37I5ngAAAA50RVh0UGFnZQAxMngxMiswKzCEbbt9AAAAAElF
TkSuQmCC" />             <img alt="6" src="data:image/png;base64,
iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAAB9SURBVHja
FY0hEsMwDAQXChaaBgoG+guB/UZhvlAYWFhqmCeUBvoJoYaCgqrMbudu9oiI86m6tQyEb1AU6kjI
3GxcQnVO2K0Uq/Ahi6tpFWClwLDe+wNkwt0R2yfk7Negv+csw8uWZR4c+NS4Z6FOTKmkTO88Df9W
kfXwiD+zczjqCrgbWQAAAEN0RVh0U29mdHdhcmUAQCgjKUltYWdlTWFnaWNrIDQuMi44IDk5LzA4
LzAxIGNyaXN0eUBteXN0aWMuZXMuZHVwb250LmNvbZG6IbgAAAAqdEVYdFNpZ25hdHVyZQBkMjVk
NzE3NmQ2N2EwMzhhZmMxYzU2NTU4ZTNkZmIxYf0Q9bUAAAAOdEVYdFBhZ2UAMTJ4MTIrMCswhG27
fQAAAABJRU5ErkJggg==" /></span></span>
    <span style="color: #FF0000">"Member name"</span><span style="color: #990000">:</span> <span style="color: #990000">[</span>Member Offset<span style="color: #990000">,</span> <span style="color: #990000">[</span><span style="color: #FF0000">"Class Name"</span><span style="color: #990000">,</span> Keyword Args<span style="color: #990000">]],</span>
   <span style="color: #990000">}]</span></tt></pre></div></div>
<div class="colist arabic"><table>
<tr><td><img alt="1" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAABjSURBVHja
VY6xDcAwCAS/pPQaLim9QmajdOk2I2SNrMEIlARIoigU8Cek/4e7zdHaWOYOVwaoA6wOCw05Y7FB
gE0tIWQ+sBcwKM8qoD/wB5wGL8hjfdzWrh01GRp1hInGjDoXwHgsFuzBVLQAAABDdEVYdFNvZnR3
YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8wMSBjcmlzdHlAbXlzdGljLmVzLmR1cG9u
dC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUANThhMDcyZTA3MGRhMjJmNjEzNWNiZDNlNDE0NTQ2
ZjloaiHtAAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30AAAAASUVORK5CYII=" /></td><td>
This is the name of the struct we are describing.
</td></tr>
<tr><td><img alt="2" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAAB7SURBVHja
HY6hFcMwDEQ/NDQsNSwU9Apdo7Cw0CsIBoZmhKzQEQJLDQsFVclHpHu693W429Zr7bu541Pg3kCm
Y0K75u9TEUPhuGgWU4mQDvieEaSQEnsT6zKPeZY0EUNtrHMCXvYUuSUg0PsMjUSvpysUT6OOSil9
izp/VNk1YJ8vf6MAAABDdEVYdFNvZnR3YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8w
MSBjcmlzdHlAbXlzdGljLmVzLmR1cG9udC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUAODBlYWU1
MjljOTRhN2Y0N2RlY2NmYWRhMjhhY2I5ZGblb7ENAAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30A
AAAASUVORK5CYII=" /></td><td>
This is the total size of the struct. This is used for example, when
    constructing an array of objects.
</td></tr>
<tr><td><img alt="3" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAAB4SURBVHja
JU6rFcNADBM09BqBhl6ltDCwKxQeDOwKB7tGYGCoYaChK6cmlt7TD1W5uap/sgoVBnEXWBTSoOdx
7gpLDOAVorWC0ABdcBPqwZtx8Muf+DPXJpQ96Nu/LSMYl/n17oCOnplTOrpiwW3sUs4ZJmob5/wA
Ubg1Y/zrjUwAAABDdEVYdFNvZnR3YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8wMSBj
cmlzdHlAbXlzdGljLmVzLmR1cG9udC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUAODBiYmRhMjcy
NmRkYWNlOGFiOGEwMWY1OWRlMmViZGII/Q51AAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30AAAAA
SUVORK5CYII=" /></td><td>
The name of the field in the struct.
</td></tr>
<tr><td><img alt="4" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAABzSURBVHja
HY0hEoUwEEMjkZVYZGVlr1CJxCKRXKPyy28reyVsZeXKsCFi573ZzAQk+x5jaQ6gFQAxIA8XceEN
ZEN3DkOCH/TobUoSVuAYwSSLyzbvaHWVFJxUmmp+PF+twrLkuXzLwPmZ8+OjtH8KS6pGvuoGNo5b
6rzDAAAAQ3RFWHRTb2Z0d2FyZQBAKCMpSW1hZ2VNYWdpY2sgNC4yLjggOTkvMDgvMDEgY3Jpc3R5
QG15c3RpYy5lcy5kdXBvbnQuY29tkbohuAAAACp0RVh0U2lnbmF0dXJlADlmODJmY2FjOWUwMzlj
YmRiNzIzODBhNDU5MTMyNGY1gLv4dgAAAA50RVh0UGFnZQAxMngxMiswKzCEbbt9AAAAAElFTkSu
QmCC" /></td><td>
The field&#8217;s offset relative to the beginning of the Struct.
</td></tr>
<tr><td><img alt="5" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAAB2SURBVHja
FY6hEcQwDAQPChqGGhoaqgWX8PUYBhqGBn4rX0JooKDh/UlsZ3b2BJKXH8XPTYLh1lpt1h+BwxkR
A23jhsCQd2IkfH9T3HEkzPFegCXUKSUSpJUPsN7UFOgc9VkZUBoz9l0yrVHZarUcJZeb9XznDyNb
Ny9CX3/7AAAAQ3RFWHRTb2Z0d2FyZQBAKCMpSW1hZ2VNYWdpY2sgNC4yLjggOTkvMDgvMDEgY3Jp
c3R5QG15c3RpYy5lcy5kdXBvbnQuY29tkbohuAAAACp0RVh0U2lnbmF0dXJlAGZlNjkwNDYzMzc5
ZWIyNWU1NjJmY2M4Y2M5YjNjN2Uw37I5ngAAAA50RVh0UGFnZQAxMngxMiswKzCEbbt9AAAAAElF
TkSuQmCC" /></td><td>
When this field is accessed, this class will be instantiated at the
    specified offset (The struct&#8217;s start address plus the relative offset into
    the struct specified in &lt;4&gt;).
</td></tr>
<tr><td><img alt="6" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAAB9SURBVHja
FY0hEsMwDAQXChaaBgoG+guB/UZhvlAYWFhqmCeUBvoJoYaCgqrMbudu9oiI86m6tQyEb1AU6kjI
3GxcQnVO2K0Uq/Ahi6tpFWClwLDe+wNkwt0R2yfk7Negv+csw8uWZR4c+NS4Z6FOTKmkTO88Df9W
kfXwiD+zczjqCrgbWQAAAEN0RVh0U29mdHdhcmUAQCgjKUltYWdlTWFnaWNrIDQuMi44IDk5LzA4
LzAxIGNyaXN0eUBteXN0aWMuZXMuZHVwb250LmNvbZG6IbgAAAAqdEVYdFNpZ25hdHVyZQBkMjVk
NzE3NmQ2N2EwMzhhZmMxYzU2NTU4ZTNkZmIxYf0Q9bUAAAAOdEVYdFBhZ2UAMTJ4MTIrMCswhG27
fQAAAABJRU5ErkJggg==" /></td><td>
When instantiating this class, we also pass these keyword args to the class
    constructor.
</td></tr>
</table></div>
<div class="paragraph"><p>The VTypes language was designed to allow:</p></div>
<div class="ulist"><ul>
<li>
<p>
Partial definition of struct members - not all members in the struct must be
  defined. The offset of the member in the struct is explicitly given. This
  allows us to create aliases (i.e. many fields which access the same memory
  location) as well as sparse structs (i.e. structs with only a few fields
  known).
</p>
</li>
<li>
<p>
Struct members are simply names of object classes (inherited from
  obj.BaseObject). These classes take care of actually parsing the data. This
  allows us to interpret the memory offset in arbitrary ways.  These classes are
  instantiated at the required offset.
</p>
</li>
</ul></div>
<div class="paragraph"><p>The following is an example of a vtype definition generated from debugging symbols:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>  <span style="color: #FF0000">'_EPROCESS'</span> <span style="color: #990000">:</span> <span style="color: #990000">[</span> <span style="color: #993399">0x270</span><span style="color: #990000">,</span> <span style="color: #990000">{</span>                                          <span style="font-style: italic"><span style="color: #9A1900">#<img alt="1" src="data:image/png;base64,
iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAABjSURBVHja
VY6xDcAwCAS/pPQaLim9QmajdOk2I2SNrMEIlARIoigU8Cek/4e7zdHaWOYOVwaoA6wOCw05Y7FB
gE0tIWQ+sBcwKM8qoD/wB5wGL8hjfdzWrh01GRp1hInGjDoXwHgsFuzBVLQAAABDdEVYdFNvZnR3
YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8wMSBjcmlzdHlAbXlzdGljLmVzLmR1cG9u
dC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUANThhMDcyZTA3MGRhMjJmNjEzNWNiZDNlNDE0NTQ2
ZjloaiHtAAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30AAAAASUVORK5CYII=" /></span></span>
    <span style="color: #FF0000">'Pcb'</span> <span style="color: #990000">:</span> <span style="color: #990000">[</span> <span style="color: #993399">0x0</span><span style="color: #990000">,</span> <span style="color: #990000">[</span><span style="color: #FF0000">'_KPROCESS'</span><span style="color: #990000">]],</span>                                  <span style="font-style: italic"><span style="color: #9A1900">#<img alt="2" src="data:image/png;base64,
iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAAB7SURBVHja
HY6hFcMwDEQ/NDQsNSwU9Apdo7Cw0CsIBoZmhKzQEQJLDQsFVclHpHu693W429Zr7bu541Pg3kCm
Y0K75u9TEUPhuGgWU4mQDvieEaSQEnsT6zKPeZY0EUNtrHMCXvYUuSUg0PsMjUSvpysUT6OOSil9
izp/VNk1YJ8vf6MAAABDdEVYdFNvZnR3YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8w
MSBjcmlzdHlAbXlzdGljLmVzLmR1cG9udC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUAODBlYWU1
MjljOTRhN2Y0N2RlY2NmYWRhMjhhY2I5ZGblb7ENAAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30A
AAAASUVORK5CYII=" /></span></span>
    <span style="color: #FF0000">'ProcessLock'</span> <span style="color: #990000">:</span> <span style="color: #990000">[</span> <span style="color: #993399">0x80</span><span style="color: #990000">,</span> <span style="color: #990000">[</span><span style="color: #FF0000">'_EX_PUSH_LOCK'</span><span style="color: #990000">]],</span>
    <span style="color: #FF0000">'CreateTime'</span> <span style="color: #990000">:</span> <span style="color: #990000">[</span> <span style="color: #993399">0x88</span><span style="color: #990000">,</span> <span style="color: #990000">[</span><span style="color: #FF0000">'_LARGE_INTEGER'</span><span style="color: #990000">]],</span>
    <span style="color: #FF0000">'ExitTime'</span> <span style="color: #990000">:</span> <span style="color: #990000">[</span> <span style="color: #993399">0x90</span><span style="color: #990000">,</span> <span style="color: #990000">[</span><span style="color: #FF0000">'_LARGE_INTEGER'</span><span style="color: #990000">]],</span>
    <span style="color: #FF0000">'RundownProtect'</span> <span style="color: #990000">:</span> <span style="color: #990000">[</span> <span style="color: #993399">0x98</span><span style="color: #990000">,</span> <span style="color: #990000">[</span><span style="color: #FF0000">'_EX_RUNDOWN_REF'</span><span style="color: #990000">]],</span>
    <span style="color: #FF0000">'UniqueProcessId'</span> <span style="color: #990000">:</span> <span style="color: #990000">[</span> <span style="color: #993399">0x9c</span><span style="color: #990000">,</span> <span style="color: #990000">[</span><span style="color: #FF0000">'Pointer'</span><span style="color: #990000">,</span> <span style="font-weight: bold"><span style="color: #000000">dict</span></span><span style="color: #990000">(</span>target<span style="color: #990000">=</span><span style="color: #FF0000">"Void"</span><span style="color: #990000">)]],</span>  <span style="font-style: italic"><span style="color: #9A1900">#<img alt="3" src="data:image/png;base64,
iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAAB4SURBVHja
JU6rFcNADBM09BqBhl6ltDCwKxQeDOwKB7tGYGCoYaChK6cmlt7TD1W5uap/sgoVBnEXWBTSoOdx
7gpLDOAVorWC0ABdcBPqwZtx8Muf+DPXJpQ96Nu/LSMYl/n17oCOnplTOrpiwW3sUs4ZJmob5/wA
Ubg1Y/zrjUwAAABDdEVYdFNvZnR3YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8wMSBj
cmlzdHlAbXlzdGljLmVzLmR1cG9udC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUAODBiYmRhMjcy
NmRkYWNlOGFiOGEwMWY1OWRlMmViZGII/Q51AAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30AAAAA
SUVORK5CYII=" /></span></span>
    <span style="color: #FF0000">'ActiveProcessLinks'</span> <span style="color: #990000">:</span> <span style="color: #990000">[</span> <span style="color: #993399">0xa0</span><span style="color: #990000">,</span> <span style="color: #990000">[</span><span style="color: #FF0000">'_LIST_ENTRY'</span><span style="color: #990000">]],</span>
    <span style="color: #FF0000">'QuotaUsage'</span> <span style="color: #990000">:</span> <span style="color: #990000">[</span> <span style="color: #993399">0xa8</span><span style="color: #990000">,</span> <span style="color: #990000">[</span><span style="color: #FF0000">'Array'</span><span style="color: #990000">,</span> <span style="font-weight: bold"><span style="color: #000000">dict</span></span><span style="color: #990000">(</span>                          <span style="font-style: italic"><span style="color: #9A1900">#<img alt="4" src="data:image/png;base64,
iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAABzSURBVHja
HY0hEoUwEEMjkZVYZGVlr1CJxCKRXKPyy28reyVsZeXKsCFi573ZzAQk+x5jaQ6gFQAxIA8XceEN
ZEN3DkOCH/TobUoSVuAYwSSLyzbvaHWVFJxUmmp+PF+twrLkuXzLwPmZ8+OjtH8KS6pGvuoGNo5b
6rzDAAAAQ3RFWHRTb2Z0d2FyZQBAKCMpSW1hZ2VNYWdpY2sgNC4yLjggOTkvMDgvMDEgY3Jpc3R5
QG15c3RpYy5lcy5kdXBvbnQuY29tkbohuAAAACp0RVh0U2lnbmF0dXJlADlmODJmY2FjOWUwMzlj
YmRiNzIzODBhNDU5MTMyNGY1gLv4dgAAAA50RVh0UGFnZQAxMngxMiswKzCEbbt9AAAAAElFTkSu
QmCC" /></span></span>
                   target<span style="color: #990000">=</span><span style="color: #FF0000">'unsigned long'</span><span style="color: #990000">,</span>
                   count<span style="color: #990000">=</span><span style="color: #993399">3</span>
                   <span style="color: #990000">)]],</span>
    <span style="color: #FF0000">'QuotaPeak'</span> <span style="color: #990000">:</span> <span style="color: #990000">[</span> <span style="color: #993399">0xb4</span><span style="color: #990000">,</span> <span style="color: #990000">[</span><span style="color: #FF0000">'Array'</span><span style="color: #990000">,</span>  <span style="font-weight: bold"><span style="color: #000000">dict</span></span><span style="color: #990000">(</span>
                   target<span style="color: #990000">=</span><span style="color: #FF0000">'unsigned long'</span><span style="color: #990000">,</span>
                   count<span style="color: #990000">=</span><span style="color: #993399">3</span>
                   <span style="color: #990000">)]],</span>
    <span style="color: #FF0000">'CommitCharge'</span> <span style="color: #990000">:</span> <span style="color: #990000">[</span> <span style="color: #993399">0xc0</span><span style="color: #990000">,</span> <span style="color: #990000">[</span><span style="color: #FF0000">'unsigned long'</span><span style="color: #990000">]],</span>
    <span style="color: #FF0000">'PeakVirtualSize'</span> <span style="color: #990000">:</span> <span style="color: #990000">[</span> <span style="color: #993399">0xc4</span><span style="color: #990000">,</span> <span style="color: #990000">[</span><span style="color: #FF0000">'unsigned long'</span><span style="color: #990000">]],</span>
    <span style="color: #FF0000">'VirtualSize'</span> <span style="color: #990000">:</span> <span style="color: #990000">[</span> <span style="color: #993399">0xc8</span><span style="color: #990000">,</span> <span style="color: #990000">[</span><span style="color: #FF0000">'unsigned long'</span><span style="color: #990000">]],</span>
    <span style="color: #FF0000">'SessionProcessLinks'</span> <span style="color: #990000">:</span> <span style="color: #990000">[</span> <span style="color: #993399">0xcc</span><span style="color: #990000">,</span> <span style="color: #990000">[</span><span style="color: #FF0000">'_LIST_ENTRY'</span><span style="color: #990000">]],</span></tt></pre></div></div>
<div class="colist arabic"><table>
<tr><td><img alt="1" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAABjSURBVHja
VY6xDcAwCAS/pPQaLim9QmajdOk2I2SNrMEIlARIoigU8Cek/4e7zdHaWOYOVwaoA6wOCw05Y7FB
gE0tIWQ+sBcwKM8qoD/wB5wGL8hjfdzWrh01GRp1hInGjDoXwHgsFuzBVLQAAABDdEVYdFNvZnR3
YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8wMSBjcmlzdHlAbXlzdGljLmVzLmR1cG9u
dC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUANThhMDcyZTA3MGRhMjJmNjEzNWNiZDNlNDE0NTQ2
ZjloaiHtAAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30AAAAASUVORK5CYII=" /></td><td>
This defines the <em>_EPROCESS</em> struct as having a size of 0x270 bytes.
</td></tr>
<tr><td><img alt="2" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAAB7SURBVHja
HY6hFcMwDEQ/NDQsNSwU9Apdo7Cw0CsIBoZmhKzQEQJLDQsFVclHpHu693W429Zr7bu541Pg3kCm
Y0K75u9TEUPhuGgWU4mQDvieEaSQEnsT6zKPeZY0EUNtrHMCXvYUuSUg0PsMjUSvpysUT6OOSil9
izp/VNk1YJ8vf6MAAABDdEVYdFNvZnR3YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8w
MSBjcmlzdHlAbXlzdGljLmVzLmR1cG9udC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUAODBlYWU1
MjljOTRhN2Y0N2RlY2NmYWRhMjhhY2I5ZGblb7ENAAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30A
AAAASUVORK5CYII=" /></td><td>
The <em>Pcb</em> member of this struct is found at offset 0 and it is of type
<em>_KPROCESS</em>.
</td></tr>
<tr><td><img alt="3" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAAB4SURBVHja
JU6rFcNADBM09BqBhl6ltDCwKxQeDOwKB7tGYGCoYaChK6cmlt7TD1W5uap/sgoVBnEXWBTSoOdx
7gpLDOAVorWC0ABdcBPqwZtx8Muf+DPXJpQ96Nu/LSMYl/n17oCOnplTOrpiwW3sUs4ZJmob5/wA
Ubg1Y/zrjUwAAABDdEVYdFNvZnR3YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8wMSBj
cmlzdHlAbXlzdGljLmVzLmR1cG9udC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUAODBiYmRhMjcy
NmRkYWNlOGFiOGEwMWY1OWRlMmViZGII/Q51AAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30AAAAA
SUVORK5CYII=" /></td><td>
The <em>UniqueProcessId</em> member is a pointer to void and is found at offset 0x9c.
</td></tr>
<tr><td><img alt="4" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAABzSURBVHja
HY0hEoUwEEMjkZVYZGVlr1CJxCKRXKPyy28reyVsZeXKsCFi573ZzAQk+x5jaQ6gFQAxIA8XceEN
ZEN3DkOCH/TobUoSVuAYwSSLyzbvaHWVFJxUmmp+PF+twrLkuXzLwPmZ8+OjtH8KS6pGvuoGNo5b
6rzDAAAAQ3RFWHRTb2Z0d2FyZQBAKCMpSW1hZ2VNYWdpY2sgNC4yLjggOTkvMDgvMDEgY3Jpc3R5
QG15c3RpYy5lcy5kdXBvbnQuY29tkbohuAAAACp0RVh0U2lnbmF0dXJlADlmODJmY2FjOWUwMzlj
YmRiNzIzODBhNDU5MTMyNGY1gLv4dgAAAA50RVh0UGFnZQAxMngxMiswKzCEbbt9AAAAAElFTkSu
QmCC" /></td><td>
The <em>QuotaUsage</em> member is an array which will be instantiated at offset
0xa8 from the start of the _EPROCESS struct. The array will have 3 members each
of type <em>unsigned long</em>.
</td></tr>
</table></div>
</div>
<div class="sect2">
<h3 id="_overlaying">4.2. Overlaying</h3>
<div class="paragraph"><p>Rekall aims to specify semantic information about each field type. That means that we are really looking for the meaning behind each field, not just the mechanics of how to parse it. For example, the following struct may be defined in C:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">struct</span></span> <span style="color: #008080">module</span>
<span style="color: #FF0000">{</span>
<span style="color: #990000">...</span>
         <span style="font-style: italic"><span style="color: #9A1900">/* Unique handle for this module */</span></span>
         <span style="color: #009900">char</span> name<span style="color: #990000">[</span>MODULE_NAME_LEN<span style="color: #990000">];</span>
<span style="color: #990000">...</span>
<span style="color: #FF0000">}</span></tt></pre></div></div>
<div class="paragraph"><p>The debugging symbols will generate for this field an array of char objects:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #FF0000">"module"</span><span style="color: #990000">:</span> <span style="color: #990000">[</span><span style="color: #993399">0x2FF</span><span style="color: #990000">,</span> <span style="color: #990000">{</span>
  <span style="color: #FF0000">'name'</span><span style="color: #990000">:</span> <span style="color: #990000">[</span><span style="color: #993399">0x4F</span><span style="color: #990000">,</span> <span style="color: #990000">[</span><span style="color: #FF0000">'Array'</span><span style="color: #990000">,</span> <span style="font-weight: bold"><span style="color: #000000">dict</span></span><span style="color: #990000">(</span>
          target<span style="color: #990000">=</span><span style="color: #FF0000">'char'</span><span style="color: #990000">,</span>
          count<span style="color: #990000">=</span><span style="color: #993399">60</span>
         <span style="color: #990000">)]]</span>
<span style="color: #990000">}]</span></tt></pre></div></div>
<div class="paragraph"><p>However, while technically correct, this is not semantically correct. We know
that the array of char objects should really be interpreted as a null terminated
unicode string in UTF8. We know that the offset of this field is correct though,
just that its meaning according to the debug symbols is inaccurate.</p></div>
<div class="paragraph"><p>The <code>vtype language</code> allows specification of <code>Overlays</code> to "correct" or adjust
the values of lower layers. In this case we load the debug generated vtype
first, then we load an overlay like:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>    <span style="color: #FF0000">'module'</span> <span style="color: #990000">:</span> <span style="color: #990000">[</span>None<span style="color: #990000">,</span> <span style="color: #990000">{</span>
            <span style="color: #FF0000">'name'</span><span style="color: #990000">:</span> <span style="color: #990000">[</span>None <span style="color: #990000">,</span> <span style="color: #990000">[</span><span style="color: #FF0000">'UnicodeString'</span><span style="color: #990000">,</span> <span style="font-weight: bold"><span style="color: #000000">dict</span></span><span style="color: #990000">(</span>length <span style="color: #990000">=</span> <span style="color: #993399">60</span><span style="color: #990000">)]],</span>
            <span style="color: #990000">}],</span></tt></pre></div></div>
<div class="paragraph"><p>Over the top. The overlay may specify a value of None for the offset, or the
struct size positions. This will allow these values to "bubble up" from the
lower level description. However, specifying a new class name will override the
values in the lower vtype description.</p></div>
<div class="paragraph"><p>In practice this is used to provide higher level semantic information to
existing fields in a version independent manner. The exact offsets of fields is
obtained from the debugging symbols, but semantic meaning is obtained from the
overlay.</p></div>
<div class="paragraph"><p>The <code>vtype language</code> allows recursive definition of field types. This is
encouraged since it leads to semantically readable code which exactly describes
the nature of the memory objects. For example:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>    <span style="color: #FF0000">'module'</span> <span style="color: #990000">:</span> <span style="color: #990000">[</span>None<span style="color: #990000">,</span> <span style="color: #990000">{</span>
            <span style="color: #FF0000">'name'</span><span style="color: #990000">:</span> <span style="color: #990000">[</span>None <span style="color: #990000">,</span> <span style="color: #990000">[</span><span style="color: #FF0000">'UnicodeString'</span><span style="color: #990000">,</span> <span style="font-weight: bold"><span style="color: #000000">dict</span></span><span style="color: #990000">(</span>length <span style="color: #990000">=</span> <span style="color: #993399">60</span><span style="color: #990000">)]],</span>
            <span style="color: #FF0000">'kp'</span><span style="color: #990000">:</span> <span style="color: #990000">[</span>None<span style="color: #990000">,</span> <span style="color: #990000">[</span><span style="color: #FF0000">'Pointer'</span><span style="color: #990000">,</span> <span style="font-weight: bold"><span style="color: #000000">dict</span></span><span style="color: #990000">(</span>
                        target<span style="color: #990000">=</span><span style="color: #FF0000">'Array'</span><span style="color: #990000">,</span>
                        target_args<span style="color: #990000">=</span><span style="font-weight: bold"><span style="color: #000000">dict</span></span><span style="color: #990000">(</span>
                            target<span style="color: #990000">=</span><span style="color: #FF0000">'kernel_param'</span><span style="color: #990000">,</span>
                            count<span style="color: #990000">=</span><span style="font-weight: bold"><span style="color: #0000FF">lambda</span></span> x<span style="color: #990000">:</span> x<span style="color: #990000">.</span>num_kp<span style="color: #990000">))]],</span>
            <span style="color: #990000">}],</span></tt></pre></div></div>
<div class="paragraph"><p>Specifies the <code>name</code> member to be a unicode string of length 60, while the <code>kp</code>
field is a pointer to an array of <code>kernel_param</code> objects. The array size is
specified in the module&#8217;s <code>num_kp</code> member.</p></div>
<div class="paragraph"><p>Note that <code>None</code> is specified for some fields in this vtype description. This
means that the value in this position will be <code>overlayed</code> (or taken from a
previous layer).</p></div>
<div class="paragraph"><p>In order to simplify the description within the vtypes languages, we can replace
many of the fields with python callables (usually <code>lambda</code> ). In the above
example, we specified the <code>count</code> parameter of the Array constructor as a
callable fetching the value from the <code>module</code> object&#8217;s <code>num_kp</code> field:</p></div>
<div class="ulist"><ul>
<li>
<p>
Specifying a callable in place of the struct&#8217;s size can determine the size
  from the actual struct itself (e.g. if the size is stored in a member).
</p>
</li>
<li>
<p>
Callables in the field offset position specify the offset of the field. Note
  that this is evaluated to the absolute offset.
</p>
</li>
<li>
<p>
Callables in the keyword args field are evaluated when the field is accessed.
</p>
</li>
</ul></div>
<div class="paragraph"><p>By convention, Rekall specifies pure data in the lowest vtype description layer
(usually extracted from debugging symbols), while callables are only specified
in overlays (possibly leaving gaps for the debugging information to bubble
through them). This means that the lowest layer vtype descriptions are purely
data, and can therefore be encoded in a safe format, such as JSON.</p></div>
<div class="sidebarblock">
<div class="content">
<div class="title">How to generate a windows profile.</div>
<div class="paragraph"><p>To generate a vtypes file for a windows executable, simple use the <code>fetch_pdb</code>
and <code>parse_pdb</code> plugins. For example, suppose you have a memory image which you
are not quite sure what exact version of Windows it is.</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
The first step is to figure out the precise version of the windows kernel this
image has. We do this by scanning for the GUID of the <code>ntoskrnl.exe</code> process
from the image itself.
</p>
</li>
<li>
<p>
We then fetch the debugging symbols (pdb file) for this kernel from
Microsoft&#8217;s debug symbols.
</p>
</li>
<li>
<p>
Finally we convert the pdb file into Rekall&#8217;s own json format.
</p>
</li>
</ol></div>
<div class="listingblock">
<div class="content">
<pre><code>$ rekal -f ~/images/win7.elf version_scan | grep ntkrnl
0x0000027bb5fc f8e2a8b5c9b74bf4a6e4a48f180099942 ntkrnlmp.pdb

$ rekal fetch_pdb --dump-dir . --filename ntkrnlmp.pdb --guid f8e2a8b5c9b74bf4a6e4a48f180099942
Trying to fetch http://msdl.microsoft.com/download/symbols/ntkrnlmp.pdb/F8E2A8B5C9B74BF4A6E4A48F180099942/ntkrnlmp.pd_
Received 2675077 bytes
Extracting cabinet: ./ntkrnlmp.pd_
 extracting ntkrnlmp.pdb

All done, no errors.

$ rekal parse_pdb -f ntkrnlmp.pdb --output ntkrnlmp.json --profile_class Win7x64
$ rekal --profile ./ntkrnlmp.json -f ~/images/win7.elf pslist
 Offset (V)   Name                    PID   PPID   Thds     Hnds   Sess  Wow64 Start                    Exit
-------------- -------------------- ------ ------ ------ -------- ------ ------ ------------------------ ------------------------
0xfa80008959e0 System                    4      0     84      511 ------  False 2012-10-01 21:39:51+0000 -
0xfa8001994310 smss.exe                272      4      2       29 ------  False 2012-10-01 21:39:51+0000 -
0xfa8002259060 csrss.exe               348    340      9      436      0  False 2012-10-01 21:39:57+0000 -
0xfa8000901060 wininit.exe             384    340      3       75      0  False 2012-10-01 21:39:57+0000 -
0xfa8000900420 csrss.exe               396    376      8      192      1  False 2012-10-01 21:39:57+0000 -
....</code></pre>
</div></div>
</div></div>
</div>
<div class="sect2">
<h3 id="_the_profile">4.3. The Profile.</h3>
<div class="paragraph"><p>The profile is essentially the factory class for all Rekall objects. A profile
is where a number of sources of information are combined in order to produce
information consistant with a single uniform <code>compilation unit</code>:</p></div>
<div class="ulist"><ul>
<li>
<p>
The vtype descriptions are added to the profile.
</p>
</li>
<li>
<p>
The overlays specific for an operating system are added (these bring semantic
  information).
</p>
</li>
<li>
<p>
Constants from debugging symbols are introduced.
</p>
</li>
</ul></div>
<div class="paragraph"><p>The profile is built by applying all relevant overlays and classes to parse the
compilation unit it cares about. For example the following is a base profile for
parsing the Windows kernel:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>class BaseWindowsProfile(basic.BasicClasses):
    """Common symbols for all of windows kernel profiles."""
    _md_os = "windows"

    def __init__(self, **kwargs):
        super(BaseWindowsProfile, self).__init__(**kwargs)

        self.add_classes({
            '_UNICODE_STRING': _UNICODE_STRING,
            '_EPROCESS': _EPROCESS,
            '_MMVAD_FLAGS2': _MMVAD_FLAGS2,
            '_MMSECTION_FLAGS': _MMSECTION_FLAGS,
            })

        self.add_overlay(windows_overlay)

        # Pooltags for common objects.
        self.add_constants(DRIVER_POOLTAG="Dri\xf6",
                           EPROCESS_POOLTAG="Pro\xe3",
                           THREAD_POOLTAG='\x54\x68\x72\xe5',
                           )</code></pre>
</div></div>
<div class="paragraph"><p>We can see this profile is applying classes, overlays and constants to the
profile. Viewed as a whole, the profile can be said to implement a parsing
system for the windows kernel.  When a user selects the profile with the
--profile command line arg, they are really selecting which profile should be
created for parsing the kernel.</p></div>
</div>
<div class="sect2">
<h3 id="_profile_serializations">4.4. Profile Serializations</h3>
<div class="paragraph"><p>In the code, the profile is an instance of the obj.Profile command. Generally
however, the profile contains large data structures such as the VType dictionary
and constant lists. It is much better to be able to serialize the profile to a
standard form (for example for storage in the profile repository as described
below).</p></div>
<div class="paragraph"><p>The <strong>Profile File</strong> is the serialization of a profile into a single JSON encoded
object. The file represents all the data required in order to instantiate the
profile instance. Among all the data serialization methods available in python,
JSON is perhaps the fastest since it is natively implemented in C, and so makes
sense for a permanent storage format.</p></div>
<div class="paragraph"><p>The JSON file is essentially a dictionary with the following keys:</p></div>
<div class="ulist"><ul>
<li>
<p>
<code>$METADATA</code>: This is a dictionary representing the metadata of this profile:
</p>
<div class="ulist"><ul>
<li>
<p>
<code>Type</code>: Currently can be <code>Profile</code> or <code>Symlink</code>.
</p>
</li>
<li>
<p>
<code>Version</code>: (Code version) if present (otherwise assumes version 1).
</p>
</li>
<li>
<p>
<code>ProfileClass</code>: The name of the class to instantiate as the base for this
     profile.
</p>
</li>
</ul></div>
</li>
<li>
<p>
<code>$ENUM</code>: These represent dictionary of enum value&#8594;name mappings.
</p>
</li>
<li>
<p>
<code>$CONSTANTS</code>: These represent all constant addresses applicable for this
  profile (i.e. addresses of global symbols).
</p>
</li>
<li>
<p>
<code>$STRUCTS</code>: This is a dict with the descriptions of the structs using the vtypes
  language.
</p>
</li>
</ul></div>
<div class="paragraph"><p>In order to load the profile, the code parses the json serialized data:
. Examine the type of the blob (<code>$METADATA.Type</code>).
. If it is a profile, we search for the implementation specified in the ProfileClass and instantiate it.
. Call its add_constants() method with the constants found in the <code>$CONSTANTS</code> section.
. Call its add_types() method with the <code>$STRUCTS</code> section.
. Call its add_enums() method with <code>$ENUMS</code> section.</p></div>
<div class="paragraph"><p>A special case is when the <code>$METADATA.Type == "Symlink"</code>. In that case, the
object actually refers to a different named profile (Stored in
<code>$METADATA.Target</code>) , and that profile is opened instead. This mechanism allows
us to store a specific profiles by build numbers (e.g. for windows
<code>5.1.2600.6165_I386</code>) but still have those accessible via a human readable name
like <code>WinXPSP1x86</code>.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img alt="Tip" src="data:image/png;base64,
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" />
</td>
<td class="content">
<div class="paragraph"><p>In Rekall terminology we refer to a "profile" as the actual file which contains
the vtype information, as well as the instance of the <code>Profile()</code> class which is
created from this file. These are mostly distinct concepts and it may be
slightly confusing to refer to both using the same name.</p></div>
</td>
</tr></table>
</div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img alt="Note" src="data:image/png;base64,
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" />
</td>
<td class="content">
<div class="paragraph"><p>The Rekall profile file contains pure data in json format. Rekall does not
support python code in profile files and will not evaluate any code. The profile
file is purely data. This allows users to open potentially untrusted profile
files without fear of giving arbitrary code execution to the repository owners.</p></div>
</td>
</tr></table>
</div>
</div>
<div class="sect2">
<h3 id="_profile_repositories">4.5. Profile Repositories.</h3>
<div class="paragraph"><p>Most of the information in a profile is extracted from debugging symbols
specific for the executable of interest. In the case of operating systems,
debugging information is extracted from the operating system kernels (via DWARF
or PDB symbols).</p></div>
<div class="paragraph"><p>In practice Rekall supports so many different operating systems and versions
that it is impractical to ship Rekall with all the profiles it natively
supports. For example, each OSX version has a unique set of vtypes extracted for
each kernel version (currently over 40 OSX Darwin releases are supported with an
average profile size of around 400kb). Additionally each Linux kernel version
must use a different profile file for each linux build and kernel version (even
the standard distributions like Ubuntu ship many kernels each year). Similarly
if Rekall is used as a library in another application, adding these profiles
directly into the Rekall source code will needlessly bloat the application.</p></div>
<div class="paragraph"><p>In order to solve this problem, the Rekall project provides for <code>Profile
Repositories</code>. When a profile is specified (using the <code>--profile</code> command line,
or when passed to the <code>session.LoadProfile()</code> function), Rekall will search for
this profile using the profile path configuration parameter. By adding the
public profile repository to the search path, it is possible to automatically
use the public repository for profiles that are widely known. It is also
possible to add a secondary profile repository for local or less commonly seen
profiles.</p></div>
<div class="paragraph"><p>The following sections give examples of generating new profiles for various operating systems.</p></div>
<div class="sect3">
<h4 id="_generating_linux_profiles">4.5.1. Generating Linux Profiles</h4>
<div class="paragraph"><p>To generate a linux profile, one must compile a linux module against the target
kernel with debugging symbols enabled. The target system must also have the
Linux kernel headers for the currently running kernel as well as compilers
installed.</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
Download the linux pmem build directory
(e.g. <a href="http://downloads.rekall.googlecode.com/git/Linux/linux_pmem_1.0RC1.tgz">http://downloads.rekall.googlecode.com/git/Linux/linux_pmem_1.0RC1.tgz</a>)
</p>
</li>
<li>
<p>
Unpack somewhere and build:
</p>
</li>
</ol></div>
<div class="listingblock">
<div class="content">
<pre><code>/tmp$ wget http://downloads.rekall.googlecode.com/git/Linux/linux_pmem_1.0RC1.tgz
--2014-01-17 10:57:19--  http://downloads.rekall.googlecode.com/git/Linux/linux_pmem_1.0RC1.tgz
Resolving downloads.rekall.googlecode.com (downloads.rekall.googlecode.com)... 2a00:1450:4001:c02::52, 173.194.70.82
Connecting to downloads.rekall.googlecode.com (downloads.rekall.googlecode.com)|2a00:1450:4001:c02::52|:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 10854 (11K) [application/octet-stream]
Saving to: `linux_pmem_1.0RC1.tgz'

100%[=============================================&gt;] 10,854      --.-K/s   in 0.005s

2014-01-17 10:57:20 (2.08 MB/s) - `linux_pmem_1.0RC1.tgz' saved [10854/10854]

/tmp$ tar -xvzf linux_pmem_1.0RC1.tgz
linux/
linux/ko_patcher.py
linux/module.c
linux/pmem.c
linux/README
linux/.gitignore
linux/Makefile
/tmp$ cd linux/

/tmp/linux$ sudo make profile
make -C /usr/src/linux-headers-3.8.0-35-generic CONFIG_DEBUG_INFO=y M=`pwd` modules
make[1]: Entering directory `/usr/src/linux-headers-3.8.0-35-generic'
  CC [M]  /tmp/linux/module.o
  CC [M]  /tmp/linux/pmem.o
  Building modules, stage 2.
  MODPOST 2 modules
  CC      /tmp/linux/module.mod.o
  LD [M]  /tmp/linux/module.ko
  CC      /tmp/linux/pmem.mod.o
  LD [M]  /tmp/linux/pmem.ko
make[1]: Leaving directory `/usr/src/linux-headers-3.8.0-35-generic'
cp module.ko module_dwarf.ko
zip "`uname -r`.zip" module_dwarf.ko /boot/System.map-`uname -r`
  adding: module_dwarf.ko (deflated 66%)
  adding: boot/System.map-3.8.0-35-generic (deflated 79%)

/tmp/linux$ unzip -l 3.8.0-35-generic.zip
Archive:  3.8.0-35-generic.zip
  Length      Date    Time    Name
---------  ---------- -----   ----
   371919  2014-01-17 10:57   module_dwarf.ko
  3192757  2013-12-04 18:49   boot/System.map-3.8.0-35-generic
---------                     -------
  3564676                     2 files</code></pre>
</div></div>
<div class="paragraph"><p>The zip file contains both the kernel module compiled with symbols and the
system map. We now get rekal to convert this into a proper linux profile.</p></div>
<div class="listingblock">
<div class="content">
<pre><code>11:01:17&gt; convert_profile "3.8.0-35-generic.zip", "3.8.0-35-generic"</code></pre>
</div></div>
<div class="paragraph"><p>This new profile can now simply be added to the repository (i.e. dropped into
the repository directory). It can also be compressed to save space.</p></div>
</div>
<div class="sect3">
<h4 id="_generating_windows_profiles">4.5.2. Generating Windows Profiles</h4>
<div class="paragraph"><p>Although windows releases are less frequent than Linux releases, the number of
distinct windows kernels in existance can be quite large. Usually the user will
simply select a profile like <code>Win7SP1x64</code>, however, even for Service Pack 1
there are many different kernel variants. For most purposes it can be close
enough, but users might need to build a profile for the exact version of their
windows kernel.</p></div>
<div class="paragraph"><p>The first step is to copy the windows kernel from the target system (this is
usually found in <code>C:\Windows\ntoskrnl.exe</code>. The binary contains a special GUID
which can be used to retrieve the debugging symbols from Microsoft&#8217;s debugging
server.</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ rekall peinfo --filename ntoskrnl.exe

Attribute            Value
-------------------- -----
Machine              IMAGE_FILE_MACHINE_AMD64
TimeDateStamp        2013-03-19 03:32:06+0000
Characteristics      IMAGE_FILE_EXECUTABLE_IMAGE, IMAGE_FILE_LARGE_ADDRESS_AWARE
GUID                 2c39f687423840e793308f28c4fde0cd

.......
Version Information:
key                  value
-------------------- -----
CompanyName          Microsoft Corporation
FileDescription      NT Kernel &amp; System
FileVersion          6.1.7600.17273 (win7_gdr.130318-1532)
InternalName         ntkrnlmp.exe
LegalCopyright       Microsoft Corporation. All rights reserved.
OriginalFilename     ntkrnlmp.exe
ProductName          Microsoft Windows Operating System
ProductVersion       6.1.7600.17273</code></pre>
</div></div>
<div class="paragraph"><p>Note the exact product version and GUID for this kernel. We now use rekall to
fetch the pdb file which contains debugging symbols:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ rekal fetch_pdb --filename ntoskrnl.exe -D .
Trying to fetch http://msdl.microsoft.com/download/symbols/ntkrnlmp.pdb/2C39F687423840E793308F28C4FDE0CD2/ntkrnlmp.pd_
Received 2654299 bytes
Extracting cabinet: /tmp/ntkrnlmp.pd_
  extracting ntkrnlmp.pdb

All done, no errors.</code></pre>
</div></div>
<div class="paragraph"><p>Now we simply parse the pdb into a rekall profiles</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ rekal parse_pdb -f /tmp/ntkrnlmp.pdb --output 2C39F687423840E793308F28C4FDE0CD2 \
  --profile_class Win7x64
$ head 2C39F687423840E793308F28C4FDE0CD2
{
 "$METADATA": {
  "ProfileClass": "Win7x64",
  "Type": "Profile"
  },
 "$STRUCTS": {
  "BATTERY_REPORTING_SCALE": [8, {
   "Capacity": [4, ["unsigned long", {}]],
   "Granularity": [0, ["unsigned long", {}]]
   }],</code></pre>
</div></div>
<div class="paragraph"><p>Windows profiles are usually stored in the repository by their GUIDs, e.g. the
above is stored under
<code>ntoskrnl.exe/AMD64/6.1.7600.17273/2C39F687423840E793308F28C4FDE0CD2.gz</code>.</p></div>
</div>
<div class="sect3">
<h4 id="_symbolic_names">4.5.3. Symbolic names</h4>
<div class="paragraph"><p>The above profile would need to be specified in full to precisely use it for the
command line. For example:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ rekal --profile ntoskrnl.exe/AMD64/6.1.7600.17273/2C39F687423840E793308F28C4FDE0CD2 \
  -f ~/images/win7.elf pslist</code></pre>
</div></div>
<div class="paragraph"><p>This is very hard for a human to remember.</p></div>
<div class="paragraph"><p>It is possible to create a <code>Symlink</code> in the profile repository to essentially
give a profile a short name. We simply create a JSON file and store it in the repository under its short name:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>{
  "$METADATA": {
    "Type": "Symlink",
    "Target": "ntoskrnl.exe/AMD64/6.1.7601.17514/3844dbb920174967be7aa4a2c20430fa"
  }
}</code></pre>
</div></div>
<div class="paragraph"><p>When accessed, Rekall will automatically retrieve the correct profile:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ rekal -v --profile Win7SP1x64  -f ~/images/win7.elf pslist
INFO:root:Loaded profile ntoskrnl.exe/AMD64/6.1.7601.17514/3844dbb920174967be7aa4a2c20430fa from URL:http://profiles.rekall.googlecode.com/git/
INFO:root:Loaded profile Win7SP1x64 from URL:http://profiles.rekall.googlecode.com/git/
....</code></pre>
</div></div>
</div>
</div>
<div class="sect2">
<h3 id="_profile_modifications">4.6. Profile Modifications</h3>
<div class="paragraph"><p>The profile is a self contained system for parsing the kernel data
structures. However, some modules would like to alter the profile slightly - for
example to add new classes replacing the default classes (with additional
methods), or maybe adding new information obtained by reverse engineering
certain data structures. In these cases we wish to <em>modify</em> the profile
definition by adding an improved class definition system.</p></div>
<div class="paragraph"><p>It is normally discouraged to directly add new BaseObject class implementations
to the rekall framework since the changes will appear in all users of the
profile - potentially clashing with others' modifications. In other words we
want to modify the profile only for the users of this profile.</p></div>
<div class="paragraph"><p>This can be done by explicitly calling the ProfileModification class in your
plugin. This will install the updated implementation in your profile - without
affecting other profiles. This localized change opens the door for multiple
implementations of profile parsing systems.</p></div>
<div class="paragraph"><p>For example consider the standard registry parsing implementation in
<em>rekall.plugins.windows.registry.registry</em>. This implementation is a fast,
self contained and complete implementation of registry parsing in the windows
kernel. For a plugin to use this implementation, they will need to add it to
their current profile:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>class RekallRegisteryImplementation(obj.ProfileModification):
    """The standard rekall registry parsing subsystem."""

    @classmethod
    def modify(cls, profile):                                           <img alt="1" src="data:image/png;base64,
iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAABjSURBVHja
VY6xDcAwCAS/pPQaLim9QmajdOk2I2SNrMEIlARIoigU8Cek/4e7zdHaWOYOVwaoA6wOCw05Y7FB
gE0tIWQ+sBcwKM8qoD/wB5wGL8hjfdzWrh01GRp1hInGjDoXwHgsFuzBVLQAAABDdEVYdFNvZnR3
YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8wMSBjcmlzdHlAbXlzdGljLmVzLmR1cG9u
dC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUANThhMDcyZTA3MGRhMjJmNjEzNWNiZDNlNDE0NTQ2
ZjloaiHtAAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30AAAAASUVORK5CYII=" />
        profile.add_classes(dict(
                _CM_KEY_NODE=_CM_KEY_NODE, _CM_KEY_INDEX=_CM_KEY_INDEX,
                _CM_KEY_VALUE=_CM_KEY_VALUE, _CMHIVE=_CMHIVE
                ))

        profile.add_overlay(registry_overlays)


class RegistryPlugin(common.WindowsCommandPlugin):
    def __init__(self, **kwargs):
        """Operate on in memory registry hives.
        super(RegistryPlugin, self).__init__(**kwargs)

        # Install our specific implementation of registry support.
        self.profile = RekallRegisteryImplementation(self.profile)  <img alt="2" src="data:image/png;base64,
iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAAB7SURBVHja
HY6hFcMwDEQ/NDQsNSwU9Apdo7Cw0CsIBoZmhKzQEQJLDQsFVclHpHu693W429Zr7bu541Pg3kCm
Y0K75u9TEUPhuGgWU4mQDvieEaSQEnsT6zKPeZY0EUNtrHMCXvYUuSUg0PsMjUSvpysUT6OOSil9
izp/VNk1YJ8vf6MAAABDdEVYdFNvZnR3YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8w
MSBjcmlzdHlAbXlzdGljLmVzLmR1cG9udC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUAODBlYWU1
MjljOTRhN2Y0N2RlY2NmYWRhMjhhY2I5ZGblb7ENAAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30A
AAAASUVORK5CYII=" /></code></pre>
</div></div>
<div class="colist arabic"><table>
<tr><td><img alt="1" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAABjSURBVHja
VY6xDcAwCAS/pPQaLim9QmajdOk2I2SNrMEIlARIoigU8Cek/4e7zdHaWOYOVwaoA6wOCw05Y7FB
gE0tIWQ+sBcwKM8qoD/wB5wGL8hjfdzWrh01GRp1hInGjDoXwHgsFuzBVLQAAABDdEVYdFNvZnR3
YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8wMSBjcmlzdHlAbXlzdGljLmVzLmR1cG9u
dC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUANThhMDcyZTA3MGRhMjJmNjEzNWNiZDNlNDE0NTQ2
ZjloaiHtAAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30AAAAASUVORK5CYII=" /></td><td>
The RekallRegisteryImplementation profile modification implements a
complete registry parsing system. It does this by modifying a profile and
replacing certain classes within it with newer classes with additional
functionality.
</td></tr>
<tr><td><img alt="2" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAAB7SURBVHja
HY6hFcMwDEQ/NDQsNSwU9Apdo7Cw0CsIBoZmhKzQEQJLDQsFVclHpHu693W429Zr7bu541Pg3kCm
Y0K75u9TEUPhuGgWU4mQDvieEaSQEnsT6zKPeZY0EUNtrHMCXvYUuSUg0PsMjUSvpysUT6OOSil9
izp/VNk1YJ8vf6MAAABDdEVYdFNvZnR3YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8w
MSBjcmlzdHlAbXlzdGljLmVzLmR1cG9udC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUAODBlYWU1
MjljOTRhN2Y0N2RlY2NmYWRhMjhhY2I5ZGblb7ENAAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30A
AAAASUVORK5CYII=" /></td><td>
A plugin wishing to use this new functionality, can upgrade its profile
using the RekallRegisteryImplementation modification. Note that the
modification simply produces a new, enhanced profile - the plugin could use the
modified profile interchangeably with the old unmodified profile.  The
modification does not affect other users of the profile.
</td></tr>
</table></div>
<div class="sect3">
<h4 id="_the_registry_parsing_implementation">4.6.1. The Registry parsing implementation.</h4>
<div class="paragraph"><p>This section describes the Rekall registry parsing implementation found in
<em>rekall.plugins.windows.registry.registry</em>.</p></div>
</div>
<div class="sect3">
<h4 id="_the_pe_parsing_implementation">4.6.2. The PE parsing implementation.</h4>
<div class="paragraph"><p>The PE parsing implementation is found in
<em>rekall.plugins.overlays.windows.pe_vtypes</em>.</p></div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_testing">5. Testing</h2>
<div class="sectionbody">
<div class="paragraph"><p>Rekall introduces an automated testing framework to assist in detecting
regressions and bugs when handling different images. The idea is to
automatically compare the output of rekall between different runs for each
plugin. If the output differs, a regression bug may have been uncovered. Note
that the test framework does not check that the output is actually correct, only
that the output of each plugin is the same as it was some time in the past. Once
the output of each plugin (for the same image) is inspected manually as being
correct, any changes will be flagged and can be reinspected.</p></div>
<div class="paragraph"><p>We do this by creating a <em>baseline</em> file which describes the output of one
version of rekall. Ideally the baseline file is the ground truth and can be
independently verified to be correct. We then run the current version of
rekall against the baseline and compare the output in some way.</p></div>
<div class="paragraph"><p>The baseline itself is created using a template which is generated by the test
case itself. This template can be tweaked for the specific image we have.</p></div>
<div class="paragraph"><p>The process is therefore:</p></div>
<div class="ulist"><ul>
<li>
<p>
Create a test directory and place the image inside it (or a symlink).
</p>
</li>
<li>
<p>
Create a test template for this image. The template specifies information
about executing Rekall for each test. For example, command line
parameters. Note that common data is interpolated from the DEFAULT section:
</p>
</li>
</ul></div>
<div class="listingblock">
<div class="title">Sample test configuration file.</div>
<div class="content">
<pre><code>[DEFAULT]
--profile = Win7SP1x64
--filename = %(testdir)s/win7.elf

# When any test is looking for a pid, use this one.
pid = 2912

[TestDT]
commandline = dt _EPROCESS

[TestDump]
commandline = dump 0xfa8002193060

[TestVtoP]
commandline = vtop 0xfa8002193060

[TestDisassemble]
func = 0xfa8002193060</code></pre>
</div></div>
<div class="listingblock">
<div class="content">
<pre><code>$ python tools/testing/build_suite.py template \                <img alt="1" src="data:image/png;base64,
iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAABjSURBVHja
VY6xDcAwCAS/pPQaLim9QmajdOk2I2SNrMEIlARIoigU8Cek/4e7zdHaWOYOVwaoA6wOCw05Y7FB
gE0tIWQ+sBcwKM8qoD/wB5wGL8hjfdzWrh01GRp1hInGjDoXwHgsFuzBVLQAAABDdEVYdFNvZnR3
YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8wMSBjcmlzdHlAbXlzdGljLmVzLmR1cG9u
dC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUANThhMDcyZTA3MGRhMjJmNjEzNWNiZDNlNDE0NTQ2
ZjloaiHtAAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30AAAAASUVORK5CYII=" />
  --file xp-laptop-2005-06-25_trunk/xp-laptop-2005-06-25.img    <img alt="2" src="data:image/png;base64,
iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAAB7SURBVHja
HY6hFcMwDEQ/NDQsNSwU9Apdo7Cw0CsIBoZmhKzQEQJLDQsFVclHpHu693W429Zr7bu541Pg3kCm
Y0K75u9TEUPhuGgWU4mQDvieEaSQEnsT6zKPeZY0EUNtrHMCXvYUuSUg0PsMjUSvpysUT6OOSil9
izp/VNk1YJ8vf6MAAABDdEVYdFNvZnR3YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8w
MSBjcmlzdHlAbXlzdGljLmVzLmR1cG9udC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUAODBlYWU1
MjljOTRhN2Y0N2RlY2NmYWRhMjhhY2I5ZGblb7ENAAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30A
AAAASUVORK5CYII=" /></code></pre>
</div></div>
<div class="colist arabic"><table>
<tr><td><img alt="1" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAABjSURBVHja
VY6xDcAwCAS/pPQaLim9QmajdOk2I2SNrMEIlARIoigU8Cek/4e7zdHaWOYOVwaoA6wOCw05Y7FB
gE0tIWQ+sBcwKM8qoD/wB5wGL8hjfdzWrh01GRp1hInGjDoXwHgsFuzBVLQAAABDdEVYdFNvZnR3
YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8wMSBjcmlzdHlAbXlzdGljLmVzLmR1cG9u
dC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUANThhMDcyZTA3MGRhMjJmNjEzNWNiZDNlNDE0NTQ2
ZjloaiHtAAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30AAAAASUVORK5CYII=" /></td><td>
Run the tool in template mode.
</td></tr>
<tr><td><img alt="2" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAAB7SURBVHja
HY6hFcMwDEQ/NDQsNSwU9Apdo7Cw0CsIBoZmhKzQEQJLDQsFVclHpHu693W429Zr7bu541Pg3kCm
Y0K75u9TEUPhuGgWU4mQDvieEaSQEnsT6zKPeZY0EUNtrHMCXvYUuSUg0PsMjUSvpysUT6OOSil9
izp/VNk1YJ8vf6MAAABDdEVYdFNvZnR3YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8w
MSBjcmlzdHlAbXlzdGljLmVzLmR1cG9udC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUAODBlYWU1
MjljOTRhN2Y0N2RlY2NmYWRhMjhhY2I5ZGblb7ENAAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30A
AAAASUVORK5CYII=" /></td><td>
Specify the image the template will use - the template file is placed in the
same directory.
<div class="ulist"><ul>
<li>
<p>
Build baselines for all the tests specified in this template. It might be
necessary to manually tweak the template here (for example if command line args
have changed between the old and new versions.).
</p>
</li>
</ul></div>
</td></tr>
</table></div>
<div class="listingblock">
<div class="content">
<pre><code>$ python tools/testing/build_suite.py baseline \                <img alt="1" src="data:image/png;base64,
iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAABjSURBVHja
VY6xDcAwCAS/pPQaLim9QmajdOk2I2SNrMEIlARIoigU8Cek/4e7zdHaWOYOVwaoA6wOCw05Y7FB
gE0tIWQ+sBcwKM8qoD/wB5wGL8hjfdzWrh01GRp1hInGjDoXwHgsFuzBVLQAAABDdEVYdFNvZnR3
YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8wMSBjcmlzdHlAbXlzdGljLmVzLmR1cG9u
dC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUANThhMDcyZTA3MGRhMjJmNjEzNWNiZDNlNDE0NTQ2
ZjloaiHtAAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30AAAAASUVORK5CYII=" />
  --config xp-laptop-2005-06-25_trunk/tests.config             <img alt="2" src="data:image/png;base64,
iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAAB7SURBVHja
HY6hFcMwDEQ/NDQsNSwU9Apdo7Cw0CsIBoZmhKzQEQJLDQsFVclHpHu693W429Zr7bu541Pg3kCm
Y0K75u9TEUPhuGgWU4mQDvieEaSQEnsT6zKPeZY0EUNtrHMCXvYUuSUg0PsMjUSvpysUT6OOSil9
izp/VNk1YJ8vf6MAAABDdEVYdFNvZnR3YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8w
MSBjcmlzdHlAbXlzdGljLmVzLmR1cG9udC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUAODBlYWU1
MjljOTRhN2Y0N2RlY2NmYWRhMjhhY2I5ZGblb7ENAAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30A
AAAASUVORK5CYII=" /></code></pre>
</div></div>
<div class="colist arabic"><table>
<tr><td><img alt="1" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAABjSURBVHja
VY6xDcAwCAS/pPQaLim9QmajdOk2I2SNrMEIlARIoigU8Cek/4e7zdHaWOYOVwaoA6wOCw05Y7FB
gE0tIWQ+sBcwKM8qoD/wB5wGL8hjfdzWrh01GRp1hInGjDoXwHgsFuzBVLQAAABDdEVYdFNvZnR3
YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8wMSBjcmlzdHlAbXlzdGljLmVzLmR1cG9u
dC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUANThhMDcyZTA3MGRhMjJmNjEzNWNiZDNlNDE0NTQ2
ZjloaiHtAAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30AAAAASUVORK5CYII=" /></td><td>
Run the tool in baseline mode.
</td></tr>
<tr><td><img alt="2" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAAB7SURBVHja
HY6hFcMwDEQ/NDQsNSwU9Apdo7Cw0CsIBoZmhKzQEQJLDQsFVclHpHu693W429Zr7bu541Pg3kCm
Y0K75u9TEUPhuGgWU4mQDvieEaSQEnsT6zKPeZY0EUNtrHMCXvYUuSUg0PsMjUSvpysUT6OOSil9
izp/VNk1YJ8vf6MAAABDdEVYdFNvZnR3YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8w
MSBjcmlzdHlAbXlzdGljLmVzLmR1cG9udC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUAODBlYWU1
MjljOTRhN2Y0N2RlY2NmYWRhMjhhY2I5ZGblb7ENAAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30A
AAAASUVORK5CYII=" /></td><td>
Specify the testing template to use.
</td></tr>
</table></div>
<div class="paragraph"><p>The tool will create a json file for each test in the testing directory. This is
called the baseline data. The baseline contains information about the output
generated:</p></div>
<div class="listingblock">
<div class="title">Sample baseline image for a test case.</div>
<div class="content">
<pre><code>{
    "time_used": 4.6139168739318848,
    "output": [
        "Offset(V) ||Name                ||   PID||  PPID||  Thds||    Hnds||  Sess|| Wow64||Start               ||Exit                ",
        "----------||--------------------||------||------||------||--------||------||------||--------------------||--------------------",
        "0x823c87c0||System              ||     4||     0||    61||    1140||------||     0||                    ||                    ",
        "0x81fdf020||smss.exe            ||   448||     4||     3||      21||------||     0||2005-06-25 16:47:28 ||                    ",
        "0x81ed84e8||dd.exe              ||  4012||  2624||     1||      22||     0||     0||2005-06-25 16:58:46 ||                    "
    ],
    "options": {
        "--profile": "WinXPSP2x86",
        "commandline": "pslist",
        "--filename": "/tmp/xp-laptop-2005-06-25_trunk/xp-laptop-2005-06-25.img",
    }
}</code></pre>
</div></div>
<div class="ulist"><ul>
<li>
<p>
Finally test the current output against the baseline:
</p>
</li>
</ul></div>
<div class="listingblock">
<div class="content">
<pre><code>$ python tools/testing/build_suite.py test \                    <img alt="1" src="data:image/png;base64,
iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAABjSURBVHja
VY6xDcAwCAS/pPQaLim9QmajdOk2I2SNrMEIlARIoigU8Cek/4e7zdHaWOYOVwaoA6wOCw05Y7FB
gE0tIWQ+sBcwKM8qoD/wB5wGL8hjfdzWrh01GRp1hInGjDoXwHgsFuzBVLQAAABDdEVYdFNvZnR3
YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8wMSBjcmlzdHlAbXlzdGljLmVzLmR1cG9u
dC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUANThhMDcyZTA3MGRhMjJmNjEzNWNiZDNlNDE0NTQ2
ZjloaiHtAAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30AAAAASUVORK5CYII=" />
  --config xp-laptop-2005-06-25_trunk/tests.config              <img alt="2" src="data:image/png;base64,
iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAAB7SURBVHja
HY6hFcMwDEQ/NDQsNSwU9Apdo7Cw0CsIBoZmhKzQEQJLDQsFVclHpHu693W429Zr7bu541Pg3kCm
Y0K75u9TEUPhuGgWU4mQDvieEaSQEnsT6zKPeZY0EUNtrHMCXvYUuSUg0PsMjUSvpysUT6OOSil9
izp/VNk1YJ8vf6MAAABDdEVYdFNvZnR3YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8w
MSBjcmlzdHlAbXlzdGljLmVzLmR1cG9udC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUAODBlYWU1
MjljOTRhN2Y0N2RlY2NmYWRhMjhhY2I5ZGblb7ENAAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30A
AAAASUVORK5CYII=" /></code></pre>
</div></div>
<div class="colist arabic"><table>
<tr><td><img alt="1" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAABjSURBVHja
VY6xDcAwCAS/pPQaLim9QmajdOk2I2SNrMEIlARIoigU8Cek/4e7zdHaWOYOVwaoA6wOCw05Y7FB
gE0tIWQ+sBcwKM8qoD/wB5wGL8hjfdzWrh01GRp1hInGjDoXwHgsFuzBVLQAAABDdEVYdFNvZnR3
YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8wMSBjcmlzdHlAbXlzdGljLmVzLmR1cG9u
dC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUANThhMDcyZTA3MGRhMjJmNjEzNWNiZDNlNDE0NTQ2
ZjloaiHtAAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30AAAAASUVORK5CYII=" /></td><td>
Run the tool in test mode.
</td></tr>
<tr><td><img alt="2" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAAB7SURBVHja
HY6hFcMwDEQ/NDQsNSwU9Apdo7Cw0CsIBoZmhKzQEQJLDQsFVclHpHu693W429Zr7bu541Pg3kCm
Y0K75u9TEUPhuGgWU4mQDvieEaSQEnsT6zKPeZY0EUNtrHMCXvYUuSUg0PsMjUSvpysUT6OOSil9
izp/VNk1YJ8vf6MAAABDdEVYdFNvZnR3YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8w
MSBjcmlzdHlAbXlzdGljLmVzLmR1cG9udC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUAODBlYWU1
MjljOTRhN2Y0N2RlY2NmYWRhMjhhY2I5ZGblb7ENAAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30A
AAAASUVORK5CYII=" /></td><td>
Specify the testing template to use.
</td></tr>
</table></div>
<div class="paragraph"><p>The test will run and be compared with the baseline. The test will fail if there
was any discrepancy with the baseline.</p></div>
</div>
</div>
</div>
<div id="footnotes"><hr /></div>
<div id="footer">
<div id="footer-text">
Last updated 2014-12-19 17:12:45 AEST
</div>
</div>
<script src="/js/asciidoc.js"></script>

<p>

<nav class="navbar navbar-default plugins" role="navigation">

  <ul class="nav navbar-nav navbar-left">
    <li class="active">
       <a href="/docs/Developers/epydocs.html">
         <span class="glyphicon glyphicon-arrow-left"></span>
         Generated API Docs.
       </a>
    </li>
  </ul>


  <ul class="nav navbar-nav navbar-right">
    <li class="active">
       <a href="/docs/Developers/renderers.html">
          The Rekall Rendering framework.
          <span class="glyphicon glyphicon-arrow-right"></span>
       </a>
    </li>
  </ul>

</nav>


  </div>
</div>
</div>
  <div class="footer">
    <div class="container">
      <p class="text-muted">
        &copy; 2015 Google Inc.
        Rekall is licensed under the The GPL License.
        Pmem is licensed under the Apache license.
        <a href="#" class="pull-right text-muted">Back to top</a>
      </p>
    </div>
  </div>

  <script>
   $(".activate_tooltip").tooltip();
  </script>
  </div>
 </body>
</html>

