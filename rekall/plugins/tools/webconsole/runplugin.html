<div ng-controller="RekallRunPluginController" class="well pythoncall">
  <div ng-if="node.state == 'edit'" on-alt-enter="saveNode(node)">
    <form class="form" role="form">
      <div class="form-group">
        <label>Plugin:</label>
        <div class="row">
        <div class="col-sm-3">
          <input class="form-control input-sm"
                 type="text"
                 ng-model="node.source.plugin"
                 typeahead-editable="false"
                 typeahead="plugin as plugin.name for plugin in pluginsValues | filter:{name:$viewValue} | orderBy:'name'" ></input>
        </div>
        <div class="col-sm-9">
          <h3 style="margin-top: 5px"><small>{{firstLineOnly(node.source.plugin.description)}}</small></h3>
        </div>
        </div>
      </div>

      <div class="row-fluid" ng-if="requiredArguments">
        <h5 class=""><span class="glyphicon glyphicon-link"></span> Optional arguments</h5>
        <rekall-plugin-arguments arguments="requiredArguments"
                                 filled-arguments="node.source.arguments" />
      </div>

      <div class="row-fluid" ng-if="optionalArguments">
        <h5 class=""><span class="glyphicon glyphicon-link"></span> Optional arguments</h5>
        <rekall-plugin-arguments arguments="optionalArguments"
                                 filled-arguments="node.source.arguments" />
      </div>

  </div>

  <div ng-if="node.state != 'edit'" ng-dblclick="editNode(node)">
    <h3>{{node.source.plugin.name}} <small>{{firstLineOnly(node.source.plugin.description)}}</small></h3>
    <div ng-if="node.source.arguments">
      <table class="table table-condensed">
        <tr ng-repeat="(key, value) in node.source.arguments">
          <td width="20%" ng-if="value != ''">
            <small>{{key}}</small>
            <h5 ng-repeat="argument in node.source.plugin.arguments | filter:{'name': key}">
              <small>{{argument.help}}</small>
            </h5>
          </td>
          <td width="80%"><small>{{value}}</small></td>
      </table>
    </div>
  </div>

  <div ng-if="node.state == 'render'" style="padding-top: 2em; padding-bottom: 2em">
    <div class="progress progress-striped active">
      <div class="progress-bar"  role="progressbar" aria-valuenow="45" aria-valuemin="0" aria-valuemax="100" style="width: 50%">
        <span class="sr-only">Loading...</span>
      </div>
    </div>
  </div>

  <div ng-if="node.state == 'edit' || node.state == 'show'">
    <div ng-if="node.rendered.stderr">
      <code-editor language="plaintext" readonly="true" ng-model="node.rendered.stderr" split-list></code-editor>
    </div>

    <div ng-if="node.rendered.stdout">
      <code-editor language="plaintext" readonly="true" ng-model="node.rendered.stdout" split-list></code-editor>
    </div>

    <div ng-if="node.rendered.error">
      <code-editor language="python" readonly="true" ng-model="node.rendered.error" split-list></code-editor>
    </div>
  </div>

</div>
